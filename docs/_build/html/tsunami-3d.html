

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality &mdash; SCALE Manual 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SAMS: Sensitivity Analysis Module for Scale" href="sams.html" />
    <link rel="prev" title="XSDRNPM Data File Formats" href="tsunami-1d-appA.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SCALE Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Reactor Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TRITON.html">TRITON: A Multipurpose Transport, Depletion, And Sensitivity and Uncertainty Analysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRITONAppABC.html">TRITON Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Polaris.html">POLARIS - 2D Light Water Reactor Lattice Physics Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolarisA.html">SCALE 6.2 Polaris Input Format</a></li>
</ul>
<p class="caption"><span class="caption-text">Depletion, Activation, and Spent Fuel Source Terms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Depletion%2C%20Activation%2C%20and%20Spent%20Fuel%20Source%20Terms%20Overview.html">Depletion, Activation, and Spent Fuel Source Terms Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN.html">Origen: Neutron Activation, Actinide Transmutation, Fission Product Generation, and Radiation Source Term Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html">Origen Data Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#energy-resource">Energy Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#decay-resource-format">Decay Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#fission-yield-resource-format">Fission Yield Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#gamma-resource-format">Gamma Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#origen-end7dec-nuclide-set">ORIGEN “end7dec” Nuclide Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGAMI.html">ORIGAMI: A Code for Computing Assembly Isotopics with ORIGEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="SLIG.html">SCALE/Origen Library Generator (SLIG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Origenutil.html">ORIGEN Utility Programs</a></li>
</ul>
<p class="caption"><span class="caption-text">Sensitivity and Uncertainty Analysis</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Sensitivity%20and%20Uncertainty%20Analysis%20Overview.html">Snesitivity and Uncertainty Analysis Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d.html">TSUNAMI-1D:  Control Module for One-Dimensional Cross-Section Sensitivity and Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d-appA.html">XSDRNPM Data File Formats</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multigroup-tsunami-3d-techniques">Multigroup TSUNAMI-3D Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-energy-tsunami-3d-techniques">Continuous-Energy TSUNAMI-3D Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ce-tsunami-methodology">CE TSUNAMI methodology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ifp-methodology">IFP methodology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clutch-methodology">CLUTCH methodology</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ce-tsunami-generalized-perturbation-theory-capability">CE TSUNAMI Generalized Perturbation Theory capability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ce-tsunami-sequence-description">CE TSUNAMI sequence description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tsunami-3d-input-description">TSUNAMI-3D Input Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#analytical-sequence-specification-record">Analytical sequence specification record</a></li>
<li class="toctree-l3"><a class="reference internal" href="#title-data">Title data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xsproc-execution">XSProc Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#keno-v-a-or-keno-vi-problem-description">KENO V.A or KENO-VI problem description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sensitivity-calculation-data">Sensitivity calculation data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-termination">Input termination</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sample-problems">Sample problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generating-reference-direct-perturbation-sensitivity-coefficients">Generating reference direct perturbation sensitivity coefficients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-mg-sample-problem">Simple MG Sample Problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multigroup-sample-problem-with-spatial-flux-mesh">Multigroup sample problem with spatial flux mesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#complex-sample-problem">Complex sample problem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loosely-coupled-sample-problem">Loosely coupled sample problem</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#ce-tsunami-sample-problem">CE TSUNAMI Sample Problem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sams.html">SAMS: Sensitivity Analysis Module for Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="sams-appA.html">Sensitivity Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsar.html">TSAR: Tool for Sensitivity Analysis of Reactivity Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip.html">TSUNAMI Utility Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip-appAB.html">Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer.html">TSURFER: An Adjustment Code to Determine Biases and Uncertainties in Nuclear System Responses by Consolidating Differential Data and Benchmark Integral Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer-appA.html">TSURFER Appendix A: Sensitivity/Uncertainty Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler.html">Sampler: A Module for Statistical Uncertainty Analysis with Scale Sequences</a></li>
</ul>
<p class="caption"><span class="caption-text">Criticality Safety</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Criticality%20Safety%20Overview.html">Criticality Safety Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5.html">CSAS5:  Control Module For Enhanced Criticality Safety Analysis Sequences With KENO V.a</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5App.html">Additional Example Applications of CSAS5</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6.html">CSAS6:  Control Module for Enhanced Criticality Safety Analysis with KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6App.html">Additional Example Applications of CSAS6</a></li>
<li class="toctree-l1"><a class="reference internal" href="STARBUCS.html">STARBUCS: A Scale Control Module for Automated Criticality Safety Analyses Using Burnup Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sourcerer.html">Sourcerer: Deterministic Starting Source for Criticality Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DEVC.html">DEVC: Denovo EigenValue Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="KMART.html">KMART5 and KMART6: Postprocessors for KENO V.A and KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="K5C5.html">K5toK6 and C5toC6: Input File Conversion Programs for KENO and CSAS</a></li>
</ul>
<p class="caption"><span class="caption-text">Material Specification and Cross Section Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Material%20Specification%20and%20Cross%20Section%20Processing%20Overview.html">Material Specification and Cross Section Processing Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProc.html">XSPROC: The Material and Cross Section Processing Module for SCALE</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppA.html">XSProc: Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppB.html">XSProc Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppC.html">Examples of Complete XSProc Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="stdcmp.html">Standard Composition Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="BONAMI.html">BONAMI: Resonance Self-Shielding by the Bondarenko Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="CENTRM.html">CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="PMC.html">PMC: A Program to Produce Multigroup Cross Sections Using Pointwise Energy Spectra from CENTRM</a></li>
<li class="toctree-l1"><a class="reference internal" href="PMCAppAB.html">PMC Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHOPS.html">CHOPS: Module to Compute Pointwise Disadvantage Factors and Produce a Cell-Homogenized CENTRM Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRAWDAD.html">CRAWDAD: Module to Produce CENTRM-Formatted Continuous-Energy Nuclear Data Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="MCDancoff.html">MCDancoff Data Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAJUN.html">CAJUN: Module for Combining and Manipulating CENTRM Continuous-Energy Libraries</a></li>
</ul>
<p class="caption"><span class="caption-text">Monte Carlo Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Monte%20Carlo%20Transport%20Overview.html">Monte Carlo Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoA.html">Keno Appendix A: KENO V.a Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoB.html">Keno Appendix B: KENO VI Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoC.html">Keno Appendix C: Sample problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Monaco.html">Monaco: A Fixed-Source Monte Carlo Transport Code for Shielding Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Radiation Shielding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="MAVRIC.html">MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAAScapability.html">MAVRIC Appendix A: CAAS Capability</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixb.html">MAVRIC Appendix B: MAVRIC Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixc.html">MAVRIC Appendix C: Advanced Features</a></li>
</ul>
<p class="caption"><span class="caption-text">Deterministic Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Deterministic%20Transport%20Intro.html">Deterministic Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSD.html">XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSDAppAB.html">XSDRNPM Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="NEWT.html">NEWT:  A New Transport Algorithm for Two-Dimensional Discrete-Ordinates Analysis in Non-Orthogonal Geometries</a></li>
</ul>
<p class="caption"><span class="caption-text">Nuclear Data Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nuclear%20Data%20Libraries%20Overview.html">SCALE Nuclear Data Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLib.html">SCALE Cross Section Libraries</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SCALE Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tsunami-3d.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tsunami-3d-control-module-for-three-dimensional-cross-section-sensitivity-and-uncertainty-analysis-for-criticality">
<span id="id1"></span><h1>TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality<a class="headerlink" href="#tsunami-3d-control-module-for-three-dimensional-cross-section-sensitivity-and-uncertainty-analysis-for-criticality" title="Permalink to this headline">¶</a></h1>
<p><em>B. T. Rearden, C. M. Perfetti, and L. M. Petrie</em></p>
<p>ABSTRACT</p>
<p>TSUNAMI-3D (<strong>T</strong>ools for <strong>S</strong>ensitivity and <strong>Un</strong>certainty
<strong>A</strong>nalysis <strong>M</strong>ethodology <strong>I</strong>mplementation in <strong>Three</strong>
<strong>D</strong>imensions) is a SCALE control module that facilitates the
application of sensitivity and uncertainty analysis theory to
criticality safety analysis. In multigroup (MG) mode, TSUNAMI-3D
provides for resonance self-shielding of cross section data, calculation
of the implicit effects of resonance self-shielding calculations,
calculation of forward and adjoint Monte Carlo neutron transport
solutions, and calculation of eigenvalue sensitivity coefficients. In
continuous-energy (CE) mode, sensitivity coefficients are computed in a
single forward Monte Carlo neutron transport calculation for either
eigenvalue or generalized reaction rate ratio responses. In both MG and
CE modes, the KENO V.a or KENO‑VI module is used for transport solvers,
and the SAMS module is used to compute and/or create edits of the
sensitivity of the calculated responses to the nuclear data used in the
calculation as a function of nuclide, reaction type, and energy. SAMS
also computes the uncertainty in the calculated responses resulting from
uncertainties in the basic nuclear data used in the calculation through
energy-dependent cross section covariance matrices. In both MG and CE
calculations, a sensitivity data file is produced for use in subsequent
analysis.</p>
<p>ACKNOWLEDGMENTS</p>
<p>The author wishes to acknowledge M. L. Williams, B. L. Broadhead, and K.
B. Bekar, of Oak Ridge National Laboratory (ORNL), and R. L. Childs,
formerly of ORNL, for their assistance with this work. The support and
encouragement of C. M. Hopper, formerly of ORNL, and C. V. Parks and D.
E Mueller of ORNL is also appreciated. The continued support of the U.S.
Department of Energy Nuclear Criticality Safety Program and the ORNL
Laboratory-Directed Research and Development Program is gratefully
acknowledged.</p>
<div class="section" id="introduction">
<span id="id2"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>TSUNAMI-3D (<strong>T</strong>ools for <strong>S</strong>ensitivity and <strong>Un</strong>certainty
<strong>A</strong>nalysis <strong>M</strong>ethodology <strong>I</strong>mplementation in <strong>Three</strong>
<strong>D</strong>imensions) is a SCALE control module that facilitates the
application of sensitivity and uncertainty theory to criticality safety
analysis. The data computed with TSUNAMI-3D are the sensitivity of
computed responses (e.g. <em>k</em><sub>eff</sub> and ratios of reaction rates) to each
constituent nuclear data component used in the calculation. The
sensitivity data are coupled with cross section uncertainty data, in the
form of multigroup (MG) covariance matrices, to produce an uncertainty
in the computed responses due to uncertainties in the underlying nuclear
data. The group-wise sensitivity data computed with TSUNAMI‑3D are
stored in a sensitivity data file format (.sdf file) that is suitable
for use in data visualization with Fulcrum, similarity assessment with
TSUNAMI-IP, and bias assessment with TSURFER.</p>
<p>This manual is intended to provide the user with a detailed reference on
code input options and some examples of the application of TSUNAMI-3D to
generate sensitivity and uncertainty data. The techniques used in the MG
and continuous-energy (CE) versions of TSUNAMI-3D are described in
<a class="reference internal" href="#id3"><span class="std std-ref">Multigroup TSUNAMI-3D Techniques</span></a> and <a class="reference internal" href="#id4"><span class="std std-ref">Continuous-Energy TSUNAMI-3D Techniques</span></a>, respectively. The input for TSUNAMI-3D is
presented in <a class="reference internal" href="#id19"><span class="std std-ref">TSUNAMI-3D Input Description</span></a>, and the use of TSUNAMI-3D to obtain accurate
sensitivity coefficients for several sample problems is given in
<a class="reference internal" href="#id27"><span class="std std-ref">Sample problems</span></a>. Additional information is provided in the appendix. A new user
may wish to review the sample problems and then refer to the input
description in <a class="reference internal" href="#id19"><span class="std std-ref">TSUNAMI-3D Input Description</span></a> to obtain specific guidance on preparing
input for specific models.</p>
<p>TSUNAMI-3D provides automated, problem-dependent cross sections using
the same methods and input as the <strong>C</strong>riticality <strong>S</strong>afety
<strong>A</strong>nalysis <strong>S</strong>equences (CSASs). Although CE calculations with
TSUNAMI do not require resonance self-shielding calculations because of
its use of CE cross sections, MG TSUNAMI-3D uses self-shielding codes
that are similar to those used in MG CSAS calculations. The BONAMIST
code computes the sensitivity of resonance self-shielded cross to the
input data, the so-called “implicit sensitivities” for MG calculations.</p>
<p>After the cross sections are processed, the MG TSUNAMI-3D-K5 sequence
performs two KENO V.a criticality calculations, one forward and one
adjoint; the MG TSUNAMI-3D-K6 sequence performs two KENO-VI
calculations. Finally, the sequence calls the SAMS module to calculate
the sensitivity coefficients that indicate the sensitivity of the
computed responses to changes in the cross sections and the uncertainty
in the computed responses that is due to uncertainties in the basic
nuclear data. SAMS prints energy-integrated sensitivity coefficients and
their statistical uncertainties to the SCALE output file and generates a
separate data file containing the energy-dependent sensitivity
coefficients. CE calculations in TSUNAMI do not require a separate
adjoint criticality calculation; instead, they calculate sensitivity
coefficients and produce a sensitivity data file during a single forward
simulation. The SAMS module is used to print user output for CE
calculations.</p>
<p>Choosing poor values for any of several adjustable parameters in TSUNAMI
inputs may result in inaccurate sensitivity coefficient estimates; thus,
users are advised to always compare their calculated sensitivity
coefficients to reference values to verify the suitability of their
TSUNAMI input parameters. <a class="reference internal" href="#id27"><span class="std std-ref">Sample problems</span></a> describes the
direct perturbation approach for generating reference sensitivity
coefficients for the total cross section of nuclides in a system. It is
difficult to calculate high fidelity, energy-dependent, reference
sensitivity coefficients using direct perturbation (although possible
using stochastic sampling of cross section data), but at the minimum
users are advised to verify the accuracy of TSUNAMI-produced total
nuclide sensitivity coefficients for all key nuclides in their
application.</p>
</div>
<div class="section" id="multigroup-tsunami-3d-techniques">
<span id="id3"></span><h2>Multigroup TSUNAMI-3D Techniques<a class="headerlink" href="#multigroup-tsunami-3d-techniques" title="Permalink to this headline">¶</a></h2>
<p>TSUNAMI-3D is a SCALE control module. As such, its primary function is
to control a sequence of calculations that are performed by other codes.
A thorough theoretical development of MG eigenvalue sensitivity theory
is described in the SAMS section of the SCALE documentation. Currently,
two computational sequences are available with TSUNAMI-3D: TSUNAMI-3D-K5
and TSUNAMI-3D-K6. The input for TSUNAMI-3D-K5 is very similar to that
used for CSAS5 and the input for TSUNAMI‑3D‑K6 is very similar to that
of CSAS6. TSUNAMI-3D uses the same material and cell data input
as all other SCALE sequences. TSUNAMI-3D can calculate eigenvalue
sensitivity coefficients using either MG or CE Monte Carlo simulations,
but the theoretical approaches for each calculation mode differ greatly.
MG TSUNAMI-3D techniques will be discussed in this section, and CE
TSUNAMI-3D calculations will be discussed in <a class="reference internal" href="#id4"><span class="std std-ref">Continuous-Energy TSUNAMI-3D Techniques</span></a>. The control
sequences available in MG TSUNAMI-3D are summarized in <a class="reference internal" href="#tab6-2-1"><span class="std std-numref">Table 69</span></a>,
where the functional modules that are executed are also shown. A general
flow diagram of MG TSUNAMI-3D is shown in <a class="reference internal" href="#fig6-2-1"><span class="std std-numref">Fig. 53</span></a>.</p>
<span id="tab6-2-1"></span><table class="docutils align-center" id="id46">
<caption><span class="caption-number">Table 69 </span><span class="caption-text">Multigroup TSUNAMI-3D control sequences.</span><a class="headerlink" href="#id46" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Control</strong></p>
<p><strong>sequence</strong></p>
</td>
<td><p><strong>Functional
modules
executed
by the
control
module</strong></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>TSUNAMI-3
D-K5</p></td>
<td><p>XSProc</p></td>
<td><p>KENO V.a</p>
<p>forward</p>
</td>
<td><p>KENO V.a</p>
<p>adjoint</p>
</td>
<td><p>BONAMIST</p></td>
<td><p>SAMS5</p></td>
</tr>
<tr class="row-odd"><td><p>TSUNAMI-3
D-K6</p></td>
<td><p>XSProc</p></td>
<td><p>KENO-VI</p>
<p>forward</p>
</td>
<td><p>KENO-VI</p>
<p>adjoint</p>
</td>
<td><p>BONAMIST</p></td>
<td><p>SAMS6</p></td>
</tr>
</tbody>
</table>
<p>TSUNAMI-3D and many other SCALE sequences apply a standardized procedure
to provide appropriate cross sections for the calculation. This
procedure is carried out by routines of the XSProc module, which
generate number densities and related information, prepare geometry data
for resonance self-shielding and flux-weighting cell calculations, and
create data input files for the cross section processing codes.</p>
<p>By default, the MG TSUNAMI-3D sequence performs cross-section processing
with XSProc, exercising all available options there, performs the
forward and adjoint KENO calculations, calls BONAMIST to produce
implicit sensitivity coefficients, then calls SAMS to produce
sensitivity and uncertainty output and <em>sdf</em> files. Optional sequence
level parameters can be used to change methods applied in resonance
self-shielding and exclude the implicit sensitivity calculation, which
are detailed later in this document.</p>
<div class="figure align-center" id="id47">
<span id="fig6-2-1"></span><a class="reference internal image-reference" href="_images/fig138.png"><img alt="_images/fig138.png" src="_images/fig138.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 53 </span><span class="caption-text">General flow diagram of MG TSUNAMI-3D.</span><a class="headerlink" href="#id47" title="Permalink to this image">¶</a></p>
</div>
<p>Once the appropriate AMPX libraries are prepared, TSUNAMI-3D prepares
KENO V.a or KENO-VI inputs for forward and adjoint calculations from the
criticality model provided by the user. The input requirements for the
KENO V.a input sections are identical to those for the CSAS5 sequence,
with some optional additional data. Also, the input requirements for the
KENO-VI are identical to those for CSAS6, with some optional additional
data. Additional input is prepared for the SAMS module using an optional
user-defined input block for SAMS. TSUNAMI-3D executes forward and
adjoint KENO calculations, generates implicit sensitivity data with
BONAMIST, and then executes the SAMS module to compute the sensitivity
and uncertainty data using the data accumulated from the codes
previously executed in the sequence. Details concerning calculation of
sensitivity and uncertainty data using MG forward and adjoint
calculations are provided in the SAMS chapter of the SCALE manual. Of
particular interest, the <em>filename.sdf</em> file, where <em>filename</em> is the
name of the input file less any extensions, contains energy-dependent
sensitivity coefficients. SCALE returns this file to the same directory
as the input file.</p>
<p>The XSProc module is responsible for reading the standard composition
data and other engineering-type specifications, including volume
fraction or percent theoretical density, temperature, and isotopic
distribution as well as the unit cell data. The techniques used in the
XSProc module and their applications and limitations are discussed in
the XSProc chapter. The input data for XSProc is the same for all
analytical sequences available through TSUNAMI-3D, TSUNAMI-1D, CSAS, and
many other SCALE sequences.</p>
</div>
<div class="section" id="continuous-energy-tsunami-3d-techniques">
<span id="id4"></span><h2>Continuous-Energy TSUNAMI-3D Techniques<a class="headerlink" href="#continuous-energy-tsunami-3d-techniques" title="Permalink to this headline">¶</a></h2>
<p>Like MG TSUNAMI-3D, the CE TSUNAMI-3D capability is a control module
that uses codes within the SCALE code package to calculate eigenvalue
sensitivity coefficients and other information for models of eigenvalue
problems. The CE and MG TSUNAMI-3D calculations differ dramatically in
their approach for calculating sensitivity coefficients and as a result
have different user interfaces. CE TSUNAMI calculations are
automatically enabled when the user selects a CE cross-section library.</p>
<div class="section" id="ce-tsunami-methodology">
<span id="id5"></span><h3>CE TSUNAMI methodology<a class="headerlink" href="#ce-tsunami-methodology" title="Permalink to this headline">¶</a></h3>
<p>CE TSUNAMI currently contains two separate approaches for performing
eigenvalue sensitivity coefficient calculations: Iterated Fission
Probability (IFP) approach and Contributon-Linked eigenvalue
sensitivity/Uncertainty estimation via Tracklength importance
Characterization (CLUTCH) approach. Both IFP and CLUTCH calculate
sensitivity coefficients during a single forward Monte Carlo (KENO)
simulation, and, unlike MG TSUNAMI-3D, do not require the simulation of
adjoint histories, calculation of angular flux moments using a flux
mesh, volume calculations, or treatment of implicit sensitivity effects.
The theoretical background of each method is discussed in detail in the
following sections, but in general IFP is easier to use than CLUTCH, but
CLUTCH has greater computational efficiency and a lower memory
footprint.</p>
<div class="section" id="ifp-methodology">
<span id="id6"></span><h4>IFP methodology<a class="headerlink" href="#ifp-methodology" title="Permalink to this headline">¶</a></h4>
<p>The IFP methodology, developed by Hurwitz in the 1940s and 1950s,
determines the importance of events during a particle history using the
notion that an event’s importance is proportional to the number of
neutrons present in the system during some future generation that are
descendants, or progeny, of the original event. <a class="footnote-reference brackets" href="#id35" id="id7">1</a><sup>,</sup> <a class="footnote-reference brackets" href="#id36" id="id8">2</a> In
practice, the IFP method requires storing reaction rate tallies for
particles for some number of generations until the average population of
their descendants in the system, or “asymptotic population,” is
obtained. This process is illustrated in <a class="reference internal" href="#fig6-2-2"><span class="std std-numref">Fig. 54</span></a>. Once obtained,
the asymptotic population of the original neutron is used to weight
reaction rate tallies for that neutron and to produce sensitivity
coefficient estimates via the first-order perturbation
equation. A number of generations, referred to as the
“latent generations,” must be skipped before calculating the asymptotic
population for an event to guarantee that the progeny of the event have
had sufficient time to impact all regions in the system and to converge
to a true estimate of the asymptotic population. The number of latent
generations required to calculate accurate sensitivity coefficients
varies based on the complexity of the system and the desired sensitivity
coefficient fidelity, but in general 20 generations is a conservative
number of latent generations to ensure convergence to the asymptotic
population. The IFP method is useful for benchmarking the accuracy of
other sensitivity coefficient methods and is very easy to use because
the only assumption of the IFP method (besides the standard CE Monte
Carlo and first order perturbation theory assumptions) is that the
asymptotic population that is reached after the chosen number of latent
generations is representative of the importance of the original event.
Thus a user who is new to sensitivity methods can assume a conservative
number of latent generations and can use the IFP method to accurately
calculate sensitivity coefficients for a system so long as the user’s
computer has sufficient computational memory for the simulation.</p>
<div class="figure align-center" id="id48">
<span id="fig6-2-2"></span><a class="reference internal image-reference" href="_images/fig224.png"><img alt="_images/fig224.png" src="_images/fig224.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 54 </span><span class="caption-text">Illustration of the Iterated Fission Probability process.</span><a class="headerlink" href="#id48" title="Permalink to this image">¶</a></p>
</div>
<p>The IFP method requires storage of region-, isotope-, reaction-, and
energy-dependent reaction rates for every particle for some number of
latent generations. Complex problems can require simulating tens of
thousands or hundreds of thousands of particles during each generation,
and IFP simulations for these systems can easily require many gigabytes
of computational memory storage. The IFP implementation in TSUNAMI‑3D
makes use of dynamic memory allocation to minimize memory requirements,
but the method frequently produces large memory footprints despite these
optimizations. The IFP memory requirements are proportional to the
number of latent generations used in the calculations, and perhaps the
best approach for minimizing the memory requirements of the IFP method
is to minimize the number of latent generations used in a calculation.
Twenty is typically a conservative number of latent generations, and it
is recommended that the user always use as few latent generations as
possible for IFP simulations. The 10 latent generations that IFP assumes
by default is a reasonable starting guess, but users should compare IFP
nuclide sensitivity coefficients with direct perturbation sensitivities
to determine if they need to use more or fewer latent generations.
Determining the adequate number of latent generations can be done by
starting with a small number of latent generations and slowly increasing
the number until the IFP-calculated sensitivity coefficients agree well
with reference sensitivities. The memory requirements of the IFP method
are also proportional to the number of particles used in each generation
(NPG), and high-memory simulations can decrease NPG to decrease the
memory requirements of the IFP method. This should be done with caution
because making NPG too small can affect the fission source convergence
and thus can produce poor tally Monte Carlo variance estimates.</p>
</div>
<div class="section" id="clutch-methodology">
<span id="id9"></span><h4>CLUTCH methodology<a class="headerlink" href="#clutch-methodology" title="Permalink to this headline">¶</a></h4>
<p>The CLUTCH method was developed by Perfetti in 2012, based in part on
the Contributon theory explored by M. L. Williams of ORNL, to produce an
accurate and efficient means for calculating eigenvalue sensitivity
coefficients with a small computational memory footprint. <a class="footnote-reference brackets" href="#id37" id="id10">3</a> Like the
IFP method, CLUTCH calculates sensitivities during a single forward
Monte Carlo calculation and does not require tallying angular flux
moments. Instead, the CLUTCH method calculates the importance of events
during a particle’s lifetime by examining how many fission neutrons are
created by that particle after those events occur. Consider a neutron
source <em>Q</em> that is equal to the fission source of a system:</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-1">
<span class="eqno">(87)<a class="headerlink" href="#equation-eq6-2-1" title="Permalink to this equation">¶</a></span>\[Q = \lambda F\phi.\]</div>
<p>Multiplying this source by the adjoint flux and integrating over phase space gives</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-2">
<span class="eqno">(88)<a class="headerlink" href="#equation-eq6-2-2" title="Permalink to this equation">¶</a></span>\[\left\langle \phi^{*}Q \right\rangle = \lambda\left\langle \phi^{*}\text{Fϕ} \right\rangle.\]</div>
<p>Consider now a neutron emitted in phase space <span class="math notranslate nohighlight">\(\tau_{s}\)</span> such that
<span class="math notranslate nohighlight">\(Q\left( \tau_{s} \right) = Q_{s}\ \delta(\tau - \tau_{s})\)</span>. This
source definition reduces <a class="reference internal" href="#equation-eq6-2-2">(88)</a> and allows the importance of the neutron
in phase space <span class="math notranslate nohighlight">\(\tau_{s}\)</span> to be calculated by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-3">
<span class="eqno">(89)<a class="headerlink" href="#equation-eq6-2-3" title="Permalink to this equation">¶</a></span>\[\phi^{*}\left(\tau_{s}\right)=\frac{\lambda}{Q_{s}} \int_{V} G\left(\tau_{s} \rightarrow r\right) F^{*}(r) d r\]</div>
<p>where the transfer function
<span class="math notranslate nohighlight">\(G\left( \tau_{s} \rightarrow r \right)\)</span> is equal to the expected
number of fission neutrons generated in all energies and directions at
<span class="math notranslate nohighlight">\(r\)</span> due to a neutron emitted at phase space <em>τ</em><sub>s</sub> and is given
by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-4">
<span class="eqno">(90)<a class="headerlink" href="#equation-eq6-2-4" title="Permalink to this equation">¶</a></span>\[G\left(\tau_{s} \rightarrow r\right)=\frac{1}{Q_{s}} \int_{E} \int_{\Omega} v \Sigma_{f}(r, E) \phi\left(r, E, \Omega \mid Q\left(\tau_{s}\right)\right) d \Omega d E\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\left( \ r,E,\Omega\  \middle| \text{\ Q}\left( \tau_{s} \right)\  \right)\)</span>
is the flux created in phase space <span class="math notranslate nohighlight">\((r,E,\Omega)\)</span> given the source
<span class="math notranslate nohighlight">\(Q\left( \tau_{s} \right)\)</span>. The weighting function
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> is defined to be equal to the expected
importance generated by a fission neutron emitted at <span class="math notranslate nohighlight">\(r\)</span> and is
given by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-5">
<span class="eqno">(91)<a class="headerlink" href="#equation-eq6-2-5" title="Permalink to this equation">¶</a></span>\[F^{*}(r)=\int_{E} \int_{\Omega} \frac{\chi(r, E)}{4 \pi} \phi^{*}(r, E, \Omega) d \Omega dE .\]</div>
<p>In practice, the CLUTCH method calculates the integral of
<span class="math notranslate nohighlight">\(G\left( \tau_{s} \rightarrow r \right)\)</span>, weighted by
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span>, to calculate the importance of every
event in a particle’s lifetime. For example, the importance of a
scattering event would be determined by tallying how many fission
neutrons, weighted by the value of <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> at the
sites where they are born, are created by the neutron that emerges from
the scattering collision. The CLUTCH method cannot calculate the
importance of events until after the particle that caused these events
dies, which requires that CLUTCH store reaction rate information for
every collision that a particle undergoes during its lifetime. This is a
manageable amount of information because these tallies are not energy
dependent (a particle’s energy is constant between any two collisions)
and because this information can be deleted once the particle dies. In
contrast, the IFP method requires much more memory because it stores
energy-dependent reaction rate tallies for every particle for some
number of generations.</p>
<p>The only assumption made by the CLUTCH method (besides the standard CE
Monte Carlo assumptions) is that <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> provides
an accurate estimate of the average importance of fission neutrons at
<span class="math notranslate nohighlight">\(r\)</span>. The current approach for calculating
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> takes advantage of the definition of the
unconstrained fission spectrum sensitivity coefficient, which is given
by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-6">
<span class="eqno">(92)<a class="headerlink" href="#equation-eq6-2-6" title="Permalink to this equation">¶</a></span>\[S_{k, \chi}(r)=\frac{1}{D} \frac{1}{k} \int_{0}^{\infty} \int_{4 \pi} \bar{v} \Sigma_{f}(r, E) \phi(r, E, \Omega) d \Omega d E \int_{0}^{\infty} \int_{4 \pi} \frac{\chi\left(r, E^{\prime}\right)}{4 \pi} \phi^{*}\left(r, E^{\prime}, \Omega^{\prime}\right) d \Omega^{\prime} d E^{\prime}\]</div>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the adjoint-weighted fission source for the system.
The right-most integral of <a class="reference internal" href="#equation-eq6-2-6">(92)</a> is recognized as the definition of
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> in <a class="reference internal" href="#equation-eq6-2-5">(91)</a> and the terms in <a class="reference internal" href="#equation-eq6-2-6">(92)</a> can be
rearranged to define <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-7">
<span class="eqno">(93)<a class="headerlink" href="#equation-eq6-2-7" title="Permalink to this equation">¶</a></span>\[F^{*}\left( r \right) = \ \frac{D \times S_{k,\ \chi}(r)}{\int_{0}^{\infty}{\int_{4\pi}^{\ }{\frac{{\overline{\upsilon}\Sigma}_{f}\left(r,E \right)\phi\left( r,E,\Omega \right)}{k}\text{dΩdE}}}}\]</div>
<p>This approach assumes that the energy spectrum of neutrons emitted from
a fission event is not strongly dependent on the parent isotope or the
energy of the neutron causing the fission. The current CLUTCH
implementation tallies the unconstrained chi sensitivity in the
numerator of <a class="reference internal" href="#equation-eq6-2-7">(93)</a> during the inactive generations to estimate
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> for the active generation sensitivity
coefficient calculations. The spatial dependence of
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> is currently accounted for by calculating
and storing <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> on a spatial mesh, although
kernel density estimators might be used in the future to store
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> using spatially continuous functional
representations. <a class="footnote-reference brackets" href="#id38" id="id11">4</a> Because <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> is only
nonzero for regions containing fissionable material, the
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh used in a CE TSUNAMI calculation must
only encompass all fissionable material in the system, rather than the
entire system as required by MG TSUNAMI. The <span class="math notranslate nohighlight">\(D\)</span> term in <a class="reference internal" href="#equation-eq6-2-7">(93)</a> can
be ignored because it is constant for all regions in a problem and is
cancelled out by the presence of <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> terms in
both the numerator and denominator of the first-order perturbation
equation. The denominator in <a class="reference internal" href="#equation-eq6-2-7">(93)</a> is simply the total weight of fission
neutrons born in each <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh region, which
must also be tallied during the inactive generations.</p>
<p>Because <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> describes the contribution to the
chi sensitivity that is created per fission neutron born at a point, a
converged fission source is not required to begin
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> calculations; thus,
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> tallies begin during the inactive
generations of Monte Carlo simulations to obtain useful information from
the typically discarded inactive particle histories. The fission source
must converge well enough during the inactive generations so that
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> is tallied in all fissile regions to a
desired statistical uncertainty, and it is sometimes necessary to
simulate extra inactive generations to allow
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> tallies to fully converge; however, the
ability to begin <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> tallies before the
fission source is converged essentially provides “free” tallies while
the fission source is converging.</p>
<p>Although several approaches exist for calculating the unconstrained chi
sensitivity coefficients needed to calculate
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span>, an IFP-based approach has been determined
to be the best approach.<sup>3</sup> Although the IFP method can produce
large memory footprints for full sensitivity coefficient calculations,
the amount of memory required by the method to calculate unconstrained
chi sensitivity coefficients and <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> is
generally negligible. The spatial dependence of <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> is
currently described using a spatial mesh, and an interval of 1 to 2 cm
mesh is typically sufficiently refined to obtain accurate
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> estimates. Users should simulate at least
on the order of 50 to 100 inactive histories per mesh interval to allow
for sufficient <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> convergence; sometimes this necessitates
simulating a large number of additional inactive histories/generations.</p>
</div>
</div>
<div class="section" id="ce-tsunami-generalized-perturbation-theory-capability">
<span id="id12"></span><h3>CE TSUNAMI Generalized Perturbation Theory capability<a class="headerlink" href="#ce-tsunami-generalized-perturbation-theory-capability" title="Permalink to this headline">¶</a></h3>
<p>The CLUTCH and IFP methods were combined in 2013 by Perfetti to enable
sensitivity calculations for generalized neutronic response ratios. <a class="footnote-reference brackets" href="#id39" id="id13">5</a>
This Generalized Perturbation Theory (GPT) capability is known as the
GEneralized Adjoint Responses in Monte Carlo (GEAR-MC) method.
Applications for GPT sensitivity coefficients differ from the
traditional criticality safety applications of TSUNAMI, and may include
S/U analyses for multigroup cross sections that are produced by a
continuous-energy Monte Carlo code, the relative power of pins in a LWR,
or ratios of foil activities in an irradiation experiment.</p>
<p>Two approaches for performing the GEAR-MC method have been included in
this release as demonstration capabilities. One implementation relies
heavily on the IFP method for sensitivity calculations and is therefore
subject to the long runtimes and large memory footprint that may be
encountered when using the IFP method. The other implementation does not
use the IFP method when calculating sensitivities. Instead, it uses only
the CLUTCH method with an <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh that has been modified
for performing generalized response sensitivity calculations. Because it
does not use the IFP method except for calculating the <span class="math notranslate nohighlight">\(F^{*}(r)\)</span>
function, this approach typically produces a significantly lower memory
footprint than the first GEAR-MC implementation and can be performed in
a parallel environment. <a class="footnote-reference brackets" href="#id40" id="id14">6</a> Both approaches are experimental
capabilities and have been included in this release to demonstrate the
expanding SCALE S/U capabilities. The current format for inputting
response information allows for the sensitivity calculations for a
single response in each sensitivity calculation; future implementations
will allow for the calculation of multiple response sensitivities in a
single calculation.</p>
<p>The theory behind the GEAR-MC method will now be described. Rather than
calculating eigenvalue sensitivities, the GEAR-MC method calculates the
sensitivity of a response, <span class="math notranslate nohighlight">\(R\)</span>, to perturbations or uncertainties
in the system parameters. The generalized response sensitivity
coefficient for the system parameter <span class="math notranslate nohighlight">\(\Sigma_{x}\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-8">
<span class="eqno">(94)<a class="headerlink" href="#equation-eq6-2-8" title="Permalink to this equation">¶</a></span>\[S_{R,\Sigma_{x}} = \frac{\delta R/R}{\delta\Sigma_{x}/\Sigma_{x}}\]</div>
<p>The GEAR-MC method calculates sensitivities of responses that are
defined as ratios of neutron reaction rates integrated over some region
of phase space such that</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-9">
<span class="eqno">(95)<a class="headerlink" href="#equation-eq6-2-9" title="Permalink to this equation">¶</a></span>\[R = \frac{\left\langle \Sigma_{1}\phi \right\rangle}{\left\langle \Sigma_{2}\phi \right\rangle}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Sigma_{1}\)</span> and <span class="math notranslate nohighlight">\(\Sigma_{2}\)</span> are nuclear cross
sections. The reaction rates in <a class="reference internal" href="#equation-eq6-2-9">(95)</a> can be isotope- or
material-dependent reaction rates and can also represent neutron flux
responses if <span class="math notranslate nohighlight">\(\Sigma = 1\)</span>. The fractional change in <span class="math notranslate nohighlight">\(R\)</span> due
to a perturbation <span class="math notranslate nohighlight">\(\delta\Sigma_{x}\)</span> to the system parameter
<span class="math notranslate nohighlight">\(\Sigma_{x}\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-10">
<span class="eqno">(96)<a class="headerlink" href="#equation-eq6-2-10" title="Permalink to this equation">¶</a></span>\[\frac{\text{δR}}{R} = \left\langle \ \frac{1}{R}\frac{\partial R}{\partial\Sigma_{x}}\delta\Sigma_{x} + \frac{1}{R}\frac{\partial R}{\partial\phi}\frac{\partial\phi}{\partial\Sigma_{x}}\delta\Sigma_{x} \right\rangle\]</div>
<p>The first term in <a class="reference internal" href="#equation-eq6-2-10">(96)</a> is known as the “direct effect term” and describes
how perturbations in <span class="math notranslate nohighlight">\(\Sigma_{x}\)</span> affect the response function of
the response reaction rates. The second term, known as the “indirect
effect term,” describes how perturbations affect the neutron flux
spectrum in the response region. <a class="footnote-reference brackets" href="#id41" id="id15">7</a> Calculating the sensitivity of the
response to the direct effect term is relatively simple and involves
tallying the fraction of the total numerator and denominator responses
that is generated for each energy, region, isotope, and material in the
response region(s). For example, consider a response that is defined as
the ratio of the energy-integrated fission rate to the energy-integrated
capture rate in a uranium fuel pin. The direct effect sensitivity of
this response to the thermal fission cross section is simply the
fraction of the fission reaction rate in the pin that is caused by
neutrons with thermal energies.</p>
<p>The indirect effect term in <a class="reference internal" href="#equation-eq6-2-10">(96)</a> cannot be calculated as simply as the
direct effect term and has historically posed a greater challenge. The
GEAR-MC method offers an approach for calculating the indirect effect
term during a single, unperturbed Monte Carlo transport calculation. The
neutron balance equation for an eigenvalue problem is given by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-11">
<span class="eqno">(97)<a class="headerlink" href="#equation-eq6-2-11" title="Permalink to this equation">¶</a></span>\[L\phi\  - \ \lambda P\phi = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is the neutron loss operator and <span class="math notranslate nohighlight">\(P\)</span> is the
fission neutron production operator. The change induced in the neutron
balance equation in response to a first-order perturbation is given by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-12">
<span class="eqno">(98)<a class="headerlink" href="#equation-eq6-2-12" title="Permalink to this equation">¶</a></span>\[\left( L - \lambda P \right)\delta\phi = \ \delta\lambda P\phi + (\lambda\delta P - \delta L)\phi\]</div>
<p>Consider now the generalized adjoint balance equation</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-13">
<span class="eqno">(99)<a class="headerlink" href="#equation-eq6-2-13" title="Permalink to this equation">¶</a></span>\[(L^{*} - \lambda P^{*})\Gamma^{*} = S^{*}\]</div>
<p>where <span class="math notranslate nohighlight">\(L^{*}\)</span> is the adjoint loss operator, <span class="math notranslate nohighlight">\(P^{*}\)</span> is the
adjoint fission neutron production operator, <span class="math notranslate nohighlight">\(S^{*}\)</span> is a source
of importance for the response that is defined such that
<span class="math notranslate nohighlight">\(\left\langle \text{ϕ\ S}^{*} \right\rangle = 0\)</span>, and
<span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> is the generalized importance function that provides
the solution to this equation.<sup>7</sup> Multiplying <a class="reference internal" href="#equation-eq6-2-12">(98)</a> and <a class="reference internal" href="#equation-eq6-2-13">(99)</a> by
<span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> and <span class="math notranslate nohighlight">\(\text{δϕ}\)</span>, respectively, and taking the
inner product gives, respectively,</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-14">
<span class="eqno">(100)<a class="headerlink" href="#equation-eq6-2-14" title="Permalink to this equation">¶</a></span>\[\left\langle \Gamma^{*}\left( L- \lambda P \right)\text{\ δϕ} \right\rangle = \ \delta\lambda\left\langle \Gamma^{*}\text{Pϕ} \right\rangle + \left\langle \Gamma^{*}\ (\lambda\delta P - \delta L)\phi \right\rangle\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-15">
<span class="eqno">(101)<a class="headerlink" href="#equation-eq6-2-15" title="Permalink to this equation">¶</a></span>\[\left\langle\delta \phi\left(L^{*}-\lambda P^{*}\right) \Gamma^{*}\right\rangle=\left\langle\delta \phi S^{*}\right\rangle\]</div>
<p>The source of adjoint importance in <a class="reference internal" href="#equation-eq6-2-15">(101)</a> is defined to conveniently
provide an expression for the indirect effect term. Defining
<span class="math notranslate nohighlight">\(S^{*}\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-16">
<span class="eqno">(102)<a class="headerlink" href="#equation-eq6-2-16" title="Permalink to this equation">¶</a></span>\[S^{*} \equiv \frac{1}{R} \frac{\delta R}{\delta \phi}=\frac{\Sigma_{1}}{\left\langle\Sigma_{1} \phi\right\rangle}-\frac{\Sigma_{2}}{\left\langle\Sigma_{2} \phi\right\rangle}\]</div>
<p>and applying the adjoint property allows <a class="reference internal" href="#equation-eq6-2-14">(100)</a> and <a class="reference internal" href="#equation-eq6-2-16">(102)</a> to be combined to
express the indirect effect term as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-17">
<span class="eqno">(103)<a class="headerlink" href="#equation-eq6-2-17" title="Permalink to this equation">¶</a></span>\[\left\langle\frac{1}{R} \frac{\delta R}{\delta \phi} \delta \phi\right\rangle=\left\langle\delta \lambda \Gamma^{*} P \phi\right\rangle+\left\langle\Gamma^{*}(\lambda \delta P-\delta L) \phi\right\rangle\]</div>
<p><a class="reference internal" href="#equation-eq6-2-17">(103)</a> is usually equal to zero because <span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> is typically
orthogonal to <span class="math notranslate nohighlight">\(\text{Pϕ}\)</span>. The effect of this orthogonality can be
interpreted in a more physical manner by realizing that perturbations to
the eigenvalue of a system do not alter the steady-state neutron flux
shape or spectrum of the system. As a result, perturbations affect the
response numerator and denominator terms equally.</p>
<p>The GEAR-MC methodology uses <a class="reference internal" href="#equation-eq6-2-13">(99)</a> and <a class="reference internal" href="#equation-eq6-2-17">(103)</a> to calculate the generalized
importance function <span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> for neutrons during a single
forward Monte Carlo simulation, thus enabling the calculation of the
indirect effect term in <a class="reference internal" href="#equation-eq6-2-10">(96)</a>. and thus sensitivity coefficients for
generalized responses using GPT. The approach developed for calculating
<span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> is similar to the approach used by the CLUTCH method
for calculating eigenvalue sensitivity coefficients.</p>
<p>Assuming that the fission production term, <span class="math notranslate nohighlight">\(\text{λPϕ}\)</span>, in <a class="reference internal" href="#equation-eq6-2-11">(97)</a>. is
the sole source of neutron production in a system, <span class="math notranslate nohighlight">\(Q\)</span>,
multiplying <a class="reference internal" href="#equation-eq6-2-11">(97)</a> and <a class="reference internal" href="#equation-eq6-2-13">(99)</a> by <span class="math notranslate nohighlight">\(\Gamma^{*}\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>,
respectively, and integrating over all phase space gives</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-18">
<span class="eqno">(104)<a class="headerlink" href="#equation-eq6-2-18" title="Permalink to this equation">¶</a></span>\[\left\langle \Gamma^{*}\text{Lϕ} \right\rangle = \left\langle \Gamma^{*}Q\right\rangle\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-19">
<span class="eqno">(105)<a class="headerlink" href="#equation-eq6-2-19" title="Permalink to this equation">¶</a></span>\[\left\langle \phi L^{*}\Gamma^{*} \right\rangle = \lambda\left\langle \phi P^{*}\Gamma^{*} \right\rangle + \left\langle \phi S^{*} \right\rangle\]</div>
<p>Nonfission neutron production reactions, such as (<em>n,Xn</em>) reactions, are
included in the <span class="math notranslate nohighlight">\(L^{*}\)</span> adjoint loss term in <a class="reference internal" href="#equation-eq6-2-19">(105)</a>. Combining <a class="reference internal" href="#equation-eq6-2-18">(104)</a> and <a class="reference internal" href="#equation-eq6-2-19">(105)</a>.
and using the adjoint property gives</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-20">
<span class="eqno">(106)<a class="headerlink" href="#equation-eq6-2-20" title="Permalink to this equation">¶</a></span>\[\left\langle \Gamma^{*}Q \right\rangle = \lambda\left\langle \Gamma^{*}\text{Pϕ} \right\rangle + \left\langle \phi S^{*} \right\rangle\]</div>
<p>The terms in <a class="reference internal" href="#equation-eq6-2-20">(106)</a> are all equal to zero in inner product space, but it
can be used to extract information about the importance of events by
considering the neutron source to be a single neutron traveling through
the phase space <span class="math notranslate nohighlight">\(\tau_{s}\)</span>, such as a neutron entering or leaving
a collision at some point. This concept is used similarly in Williams’
Contributon theory for calculating eigenvalue sensitivity coefficients
and assumes that</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-21">
<span class="eqno">(107)<a class="headerlink" href="#equation-eq6-2-21" title="Permalink to this equation">¶</a></span>\[Q = Q_{s}\text{\ δ}\left( \tau - \tau_{s} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(Q_{s}\)</span> is the source strength for this
neutron. <a class="footnote-reference brackets" href="#id42" id="id16">8</a><sup>,</sup> <a class="footnote-reference brackets" href="#id43" id="id17">9</a> Substituting <a class="reference internal" href="#equation-eq6-2-21">(107)</a> into <a class="reference internal" href="#equation-eq6-2-20">(106)</a> produces an
expression for the generalized importance function at
<span class="math notranslate nohighlight">\(\tau_{s}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-22">
<span class="eqno">(108)<a class="headerlink" href="#equation-eq6-2-22" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\Gamma^{*}\left(\tau_{s}\right) &amp;=\frac{1}{Q_{S}}\left\langle S^{*}(r) \phi\left(\tau_{s} \rightarrow r\right)\right\rangle+\frac{\lambda}{Q_{s}}\left\langle\Gamma^{*}(r) P \phi\left(\tau_{s} \rightarrow r\right)\right\rangle \\
&amp;=\frac{1}{Q_{s}}\left\langle\frac{1}{R} \frac{\delta R}{\delta \phi}(r) \phi\left(\tau_{s} \rightarrow r\right)\right\rangle+\frac{\lambda}{Q_{s}}\left\langle\Gamma^{*}(r) P \phi\left(\tau_{s} \rightarrow r\right)\right\rangle
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi(\tau_{s} \rightarrow r)\)</span> is the neutron flux created
at <span class="math notranslate nohighlight">\(r\)</span> by the neutron originating at <span class="math notranslate nohighlight">\(\tau_{s}\)</span>. The two
terms on the right-hand side of <a class="reference internal" href="#equation-eq6-2-20">(106)</a> and <a class="reference internal" href="#equation-eq6-2-22">(108)</a> represent the intragenerational
and intergenerational effects of an event on the importance of a
particle, respectively. The intragenerational effect term describes how
much importance the neutron in phase space <span class="math notranslate nohighlight">\(\tau_{s}\)</span> generates in
the response region(s) during its lifetime; the intergenerational effect
term describes how many fission neutrons this neutron creates and how
much importance these fission neutrons will generate in future
generations. The intragenerational term can be determined by tallying
the amount of flux generated in the response region(s) and weighted by
<span class="math notranslate nohighlight">\(S^{*}\left( r \right)\)</span> from <a class="reference internal" href="#equation-eq6-2-16">(102)</a> from the time the particle enters
phase space <span class="math notranslate nohighlight">\(\tau_{s}\)</span> until its death. Thus the intragenerational
term is given by</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-23">
<span class="eqno">(109)<a class="headerlink" href="#equation-eq6-2-23" title="Permalink to this equation">¶</a></span>\[\left\langle S^{*}(r) \phi\left(\tau_{s} \rightarrow r\right)\right\rangle=\frac{\Sigma_{1} \phi\left(\tau_{s} \rightarrow r\right)}{\left\langle\Sigma_{1} \phi\right\rangle}-\frac{\Sigma_{2} \phi\left(\tau_{s} \rightarrow r\right)}{\left\langle\Sigma_{2} \phi\right\rangle}\]</div>
<p>The approach for calculating the intragenerational importance term in
<a class="reference internal" href="#equation-eq6-2-23">(109)</a> is similar to the approach used by the CLUTCH method during
eigenvalue sensitivity coefficient calculations and requires storing
tracklength information for each collision that a particle enters and
determining the importance of that collision after the particle
dies. The presence of both positive and negative terms in
<a class="reference internal" href="#equation-eq6-2-23">(109)</a> allows a single event to generate either a positive or negative
importance. The intergenerational contribution to the importance
function can be calculated by tallying the cumulative score of
<span class="math notranslate nohighlight">\(S^{*}\left( r \right)\phi(\tau_{s} \rightarrow r)\)</span> that is
generated by the particle’s daughter fission neutrons, or “progeny,”
over some number of generations. The GEAR-MC method estimates the
intergenerational importance by summing the intragenerational
importance, <span class="math notranslate nohighlight">\(\Gamma_{i}^{*}\)</span>, generated by the fission production,
<span class="math notranslate nohighlight">\(F_{i}\)</span>, of neutrons in the <span class="math notranslate nohighlight">\(i\)</span>th generation of a fission
chain over some number of generations:</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-24">
<span class="eqno">(110)<a class="headerlink" href="#equation-eq6-2-24" title="Permalink to this equation">¶</a></span>\[\lambda\left\langle\Gamma^{*}(r) P \phi\left(\tau_{s} \rightarrow r\right)\right\rangle=\Gamma_{1}^{*} F_{1}+\Gamma_{2}^{*} F_{2}+\Gamma_{3}^{*} F_{3}+\ldots+0\]</div>
<p>This approach is used similarly by the IFP approach for calculating the
importance of events during eigenvalue sensitivity calculations, except
that the IFP method tallies the importance only one time after the
daughter neutrons have established an asymptotic population in the
system. The <span class="math notranslate nohighlight">\(\text{δλ}\)</span> term in <a class="reference internal" href="#equation-eq6-2-17">(103)</a>. demands that the
<span class="math notranslate nohighlight">\(\left\langle \Gamma^{*}\text{Pϕ} \right\rangle\)</span> term be equal to
zero, which causes the <span class="math notranslate nohighlight">\(\Gamma_{i}^{*}F_{i}\)</span> terms in <a class="reference internal" href="#equation-eq6-2-24">(110)</a> to
approach zero as <span class="math notranslate nohighlight">\(i\)</span> approaches infinity; therefore, the
intergenerational importance term is obtained by taking the sum of the
<span class="math notranslate nohighlight">\(\Gamma_{i}^{*}F_{i}\)</span> terms as they asymptotically approach zero.</p>
</div>
<div class="section" id="ce-tsunami-sequence-description">
<span id="id18"></span><h3>CE TSUNAMI sequence description<a class="headerlink" href="#ce-tsunami-sequence-description" title="Permalink to this headline">¶</a></h3>
<p>The code flow of CE calculations with TSUNAMI is significantly simpler
than the flow of MG TSUNAMI because CE Monte Carlo does not require
resonance self-shielding of MG cross sections or the calculation of
implicit sensitivity coefficients and calculates sensitivity
coefficients during a single forward calculation. The CE control
sequences available in TSUNAMI are summarized in <a class="reference internal" href="#tab6-2-2"><span class="std std-numref">Table 70</span></a>, where the
functional modules executed are also shown. A general flow diagram of a
CE calculation with TSUNAMI is shown in <a class="reference internal" href="#fig6-2-3"><span class="std std-numref">Fig. 55</span></a>.</p>
<span id="tab6-2-2"></span><table class="docutils align-center" id="id49">
<caption><span class="caption-number">Table 70 </span><span class="caption-text">CE TSUNAMI-3D control sequences.</span><a class="headerlink" href="#id49" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 71%" />
<col style="width: 9%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Control</strong></p>
<p><strong>sequence</strong></p>
</td>
<td><p><strong>Functional modules executed by the control module</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>TSUNAMI-3D-K5</p></td>
<td><p>KENO V.a</p></td>
<td><p>SAMS5</p></td>
</tr>
<tr class="row-odd"><td><p>TSUNAMI-3D-K6</p></td>
<td><p>KENO-VI</p></td>
<td><p>SAMS6</p></td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id50">
<span id="fig6-2-3"></span><a class="reference internal image-reference" href="_images/fig322.png"><img alt="_images/fig322.png" src="_images/fig322.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 55 </span><span class="caption-text">General flow diagram of CE TSUNAMI-3D.</span><a class="headerlink" href="#id50" title="Permalink to this image">¶</a></p>
</div>
<p>Eigenvalue sensitivity coefficients are calculated during the KENO Monte
Carlo transport calculation, and the energy-dependent sensitivity
coefficients are summarized by KENO in a sensitivity data file (sdf).
The SAMS module then uses the <em>.sdf</em> file produced by KENO and cross
section covariance data to complete the eigenvalue uncertainty analysis
for the problem and estimate the data-induced eigenvalue uncertainty.</p>
</div>
</div>
<div class="section" id="tsunami-3d-input-description">
<span id="id19"></span><h2>TSUNAMI-3D Input Description<a class="headerlink" href="#tsunami-3d-input-description" title="Permalink to this headline">¶</a></h2>
<p>The input for TSUNAMI-3D is designed to be very compatible with those
used for the CSAS criticality safety analysis sequences. Given a CSAS
input, MG TSUNAMI-3D calculations only require several input
modifications to obtain adequate flux solutions, and CE TSUNAMI
calculations require as little as one additional parameter. Additional
optional input may be added to control the sensitivity calculations.</p>
<p>The input to TSUNAMI-3D consists of an input title, SCALE analytical
sequence specification record, SCALE XSProc data, KENO V.a or KENO-VI
input descriptions with some additional optional parameter data, and
optional sensitivity and uncertainty data. These data are processed
using the SCALE free-form reading routines, which allow alphanumeric
data, floating-point data, and integer data to be entered in an
unstructured manner. The input is not case sensitive, so either upper-
or lowercase letters may be used. A maximum of 252 columns per line may
be used for input, although some exceptions for this rule exist, such as
the 80 character title data. Data can usually start or end in any column
with a few exceptions. As an example, the word END beginning in column 1
and followed by two blank spaces will end the problem, any data
following will be ignored. Each data entry must be followed by one or
more blanks to terminate the data entry. For numeric data, either a
comma or a blank can be used to terminate each data entry. Integers may
be entered for floating values. For example, 10 will be interpreted as
10.0. Imbedded blanks are not allowed within a data entry unless an E
precedes a single blank as in an unsigned exponent in a floating-point
number. For example, 1.0E 4 would be correctly interpreted as
1.0 × 10<sup>4</sup>.</p>
<div class="section" id="analytical-sequence-specification-record">
<span id="id20"></span><h3>Analytical sequence specification record<a class="headerlink" href="#analytical-sequence-specification-record" title="Permalink to this headline">¶</a></h3>
<p>The analytical sequence specification begins in column 1 of the first
line of the input file and must contain the following:</p>
<p>=TSUNAMI-3D-K5</p>
<p>This sequence is used for sensitivity and uncertainty
calculations with KENO V.a.</p>
<p>=TSUNAMI-3D-K6</p>
<p>This sequence is used for sensitivity and uncertainty
calculations with KENO-VI.</p>
<p>Optional keyword input may be entered after the analytical sequence
specification record. These keywords are</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>PARM=CHECK</p>
<p>PARM=CHK</p>
</td>
<td><p>This option allows the input data
to be read and checked without
executing any functional modules.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following PARM setting only apply to MG calculations and are ignored
for CE calculations:</p>
</div>
<dl class="describe">
<dt>
<code class="sig-name descname">PARM=SIZE=n</code></dt>
<dd><p>The amount of memory requested in four-byte words may be set
with this entry. The default value for n is 20000000. This value only
affects calculations in BONAMIST, where this value of the SIZE parameter
is used for allocation of storage for the derivatives. Please see the
documentation on BONAMIST in the Sensitivity Utility Modules chapter for
more details. All other codes use dynamic memory allocation and this
value has no effect.</p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">PARM=BONAMIST</code></dt>
<dd><p>This is the default configuration for MG TSUNAMI-3D
calculations. XSProc is used with BONAMI and CENTRM for cross section
processing. Implicit sensitivities are produced with BONAMIST.</p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">PARM=CENTRM</code></dt>
<dd><p>XSProc is used with BONAMI and CENTRM for cross section
processing, but BONAMIST is not run. <strong>MG TSUNAMI-3D calculations with
PARM=CENTRM do not account for contributions by implicit sensitivity
effects, and should be used with caution.</strong></p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">PARM=BONAMI</code></dt>
<dd><p>XSProc is used with BONAMI for cross section processing, but
BONAMIST is not run. <strong>MG TSUNAMI-3D calculations with PARM=BONAMI do
not account for contributions by implicit sensitivity effects, and
should be used with caution.</strong></p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">PARM=2REGION</code></dt>
<dd><p>XSProc (with BONAMI and CENTRM) use Dancoff factors to
compute neutron escape probabilities for an accelerated, yet more
approximate, CENTRM calculation. Implicit sensitivities are computed
with BONAMIST.</p>
</dd></dl>

<p>Multiple parameters can be used simultaneously by enclosing them in
parentheses and separating them with commas such as PARM=(SIZE=2000000,
CHECK).</p>
</div>
<div class="section" id="title-data">
<span id="id21"></span><h3>Title data<a class="headerlink" href="#title-data" title="Permalink to this headline">¶</a></h3>
<p>A <em>title</em>, a character string, must be entered as the second line of the
input file. The syntax for the title is a string of characters with a
length of up to 80 characters, including blanks.</p>
</div>
<div class="section" id="xsproc-execution">
<span id="id22"></span><h3>XSProc Execution<a class="headerlink" href="#xsproc-execution" title="Permalink to this headline">¶</a></h3>
<p>XSProc reads the standard composition specification data for MG and CE
and the unit cell geometry specifications for MG resonance
self-shielding calculations. CE TSUNAMI calculations do not require the
specification of unit cells. Please see chapters on the Material
Information Processor for input specifications. The cross section data
library that is to be used by TSUNAMI must also be entered as the third
line of the TSUNAMI input; a list of the currently available libraries
are listed in the table <em>Standard SCALE cross section libraries</em> of the
XSLIB chapter.</p>
</div>
<div class="section" id="keno-v-a-or-keno-vi-problem-description">
<span id="id23"></span><h3>KENO V.A or KENO-VI problem description<a class="headerlink" href="#keno-v-a-or-keno-vi-problem-description" title="Permalink to this headline">¶</a></h3>
<p>The KENO V.a or KENO-VI problem description follows the Material Input
Processor section in the TSUNAMI-3D input. The input for KENO V.a and
KENO-VI in TSUNAMI-3D is very similar to that described in section <em>KENO
V.a Data Guide</em> in chapter KENO V.a or section <em>KENO-VI Data Guide</em> in
the KENO-VI chapter, with only a few differences in the default values
for the parameter data and a few additional parameters to control the
adjoint criticality calculation. Otherwise, geometry, array, biasing,
boundary, start, and plot data are entered exactly as described for
KENO. Default parameter values for MG TSUNAMI-3D that are different from
those used for other MG KENO calculations are shown in <a class="reference internal" href="#tab6-2-3"><span class="std std-numref">Table 71</span></a>.
Parameters that are unique to TSUNAMI-3D and are used to control to the
MG adjoint calculation are shown in <a class="reference internal" href="#tab6-2-4"><span class="std std-numref">Table 72</span></a>. These adjoint
parameters are optional and can be entered with other parameters in the
standard <em>READ PARAMETER</em> input block in KENO problem description.
Parameters that are unique to CE TSUNAMI-3D are shown in <a class="reference internal" href="#tab6-2-5"><span class="std std-numref">Table 73</span></a>;
these parameters can also be entered in the KENO <em>READ PARAMETER</em> input
block.</p>
<p>Several features were added to KENO V.a and KENO-VI to allow the
calculation of sensitivity coefficients from the MG Monte Carlo
analysis. One significant addition is the calculation of neutron flux
moments and/or angular fluxes, both of which give directional components
to the neutron flux solution required to compute the sensitivity of
<em>k</em><sub>eff</sub> to scattering cross sections. Another significant addition is
the ability to compute fluxes that are subdivided over a cubic mesh or
Cartesian spatial grid. These mesh fluxes simplify the accurate
computation of the product of the forward and adjoint flux solutions,
sometimes called the “inner product.” Both of the flux moments and the
spatial flux mesh options must be correctly applied to obtain accurate
sensitivity coefficients. Generally, the refinement of the flux mesh to
sufficiently small intervals to capture relevant spatial effects while
maintaining a manageable memory footprint is the most challenging aspect
of performing MG calculations with TSUNAMI-3D.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is important to note
that TSUNAMI-3D provides no default mesh for these flux tallies, and the
user must input a mesh using either the MSH parameter or a GridGeometry
input to access this feature.</p>
</div>
<p>New input data that aid in the accurate calculation of sensitivity
coefficients are the parameter inputs: NQD, PNM, MFX, MSH, TFM, APG,
AGN, ABK, ASG, CET, CFP, CGD, FST, NNC, NMA, NMT, DNC, DMA, DMT, NMX,
NMN, DMX, and DMN. Thus, these parameters may require modification when
using TSUNAMI-3D. The <em>READ GRID</em> block of KENO input is used with MSH
to input the planar grid for MG TSUNAMI-3D calculations and also to
input the spatial grid for the calculation and storage of
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> for CE TSUNAMI calculations. Also, if
using the coordinate transform for angular flux or flux moment
calculations, use of the optional <em>CENTER</em> modifier in the KENO geometry
input may be required. Users should note that when using the <em>xlinear</em>,
<em>ylinear</em>, or <em>zlinear</em> options in the <em>READ GRID</em> block that KENO
checks to determine whether the boundaries of each grid coincide with
the global unit boundaries. If any planes in the grid boundaries are
identical to the planes used in the global boundary, then KENO will
extend the outermost plane in that grid by a distance equal to one-tenth
of the grid mesh interval to ensure that the grid mesh covers the entire
geometry.</p>
<p>Some KENO parameters (e.g., SCD, MFX, CDS, GFX, and CGD) may be used to
assign user provided grid definitions for use with specific tallies.
These are described in <span class="xref std std-ref">8-1-2-3</span> of the SCALE KENO chapter. Grid
IDs in the READ GRID blocks should be limited to no more than 4 integer
characters (i.e., 1 ≤ ID ≤ 9999).</p>
<span id="tab6-2-3"></span><table class="colwidths-given docutils align-center" id="id51">
<caption><span class="caption-number">Table 71 </span><span class="caption-text">Default values KENO parameters in MG TSUNAMI-3D</span><a class="headerlink" href="#id51" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 27%" />
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Default value
for
TSUNAMI-3D</strong></p></th>
<th class="head"><p><strong>Default value
for KENO in
CSAS Sequences
or as
stand-alone
code</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CFX</p></td>
<td><p>YES</p></td>
<td><p>NO</p></td>
<td><p>Collect fluxes</p></td>
</tr>
<tr class="row-odd"><td><p>GEN</p></td>
<td><p>550</p></td>
<td><p>203</p></td>
<td><p>Number of
generations to
be run</p></td>
</tr>
<tr class="row-even"><td><p>NSK</p></td>
<td><p>50</p></td>
<td><p>3</p></td>
<td><p>Number of
generations to
be omitted when
collecting
results</p></td>
</tr>
<tr class="row-odd"><td><p>PNM</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>Highest order
of flux moments
tallies</p></td>
</tr>
<tr class="row-even"><td><p>TFM</p></td>
<td><p>YES</p></td>
<td><p>NO</p></td>
<td><p>Perform
coordinate
transform for
flux moment and
angular flux
calculations</p></td>
</tr>
</tbody>
</table>
<span id="tab6-2-4"></span><table class="docutils align-center" id="id52">
<caption><span class="caption-number">Table 72 </span><span class="caption-text">Default values of TSUNAMI-3D parameters for KENO MG adjoint calculation.</span><a class="headerlink" href="#id52" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Default value
for
TSUNAMI-3D</strong></p></th>
<th class="head"><p><strong>Corresponding
KENO</strong></p>
<p><strong>parameter</strong></p>
</th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ABK</p></td>
<td><p>APG × 2</p></td>
<td><p>NBK</p></td>
<td><p>Number of
positions in
the neutron
bank for the
adjoint
calculation</p></td>
</tr>
<tr class="row-odd"><td><p>AGN</p></td>
<td><p>GEN - NSK + ASK</p></td>
<td><p>GEN</p></td>
<td><p>Number of
generations to
be run for the
adjoint
calculation –
default value
produces the
same number of
active
generations as
the forward
calculation</p></td>
</tr>
<tr class="row-even"><td><p>APG</p></td>
<td><p>NPG × 3</p></td>
<td><p>NPG</p></td>
<td><p>Number of
particles per
generation</p></td>
</tr>
<tr class="row-odd"><td><p>ASG</p></td>
<td><p>SIG (default
SIG=0)</p></td>
<td><p>SIG</p></td>
<td><p>if &gt; 0.0, this
is the standard
deviation at
which the
adjoint problem
will terminate</p></td>
</tr>
<tr class="row-even"><td><p>ASK</p></td>
<td><p>NSK × 3</p></td>
<td><p>NSK</p></td>
<td><p>Number of
generations to
be omitted when
collecting
results for the
adjoint
calculation</p></td>
</tr>
</tbody>
</table>
<p>MG TSUNAMI sensitivity coefficient estimates can be very sensitive to
the values of a problem’s input parameters, and users should always
check the accuracy of their sensitivity coefficients by comparing them
with reference direct perturbation sensitivities, discussed in <a class="reference internal" href="#id28"><span class="std std-ref">Generating reference direct perturbation sensitivity coefficients</span></a>.
The default values for parameters in <a class="reference internal" href="#tab6-2-3"><span class="std std-numref">Table 71</span></a> and
<a class="reference internal" href="#tab6-2-4"><span class="std std-numref">Table 72</span></a> generally serve as good starting values for a MG TSUNAMI
calculation, but users may need to use a higher order of flux moments to
better capture the angular dependence of the flux (typically PNM=5 is
sufficient), and may need to simulate more histories/generations to
reduce the uncertainty in sensitivity coefficient estimates. The
dimensions of the flux mesh are another important MG TSUNAMI parameter,
and a reasonable starting guess for the width of the flux mesh intervals
is 1/10<sup>th</sup> of the diameter of the fuel-containing region. Users
should take care when increasing the order of the flux moment tallies
and the number of intervals in the spatial flux mesh as the memory
footprint of a MG TSUNAMI calculation increases quickly as these
parameters increase.</p>
<p>CE TSUNAMI calculations are in many respects simpler than MG TSUNAMI
calculations because they use state-of-the-art sensitivity methodologies
that typically require less user input to perform sensitivity
calculations. CE TSUNAMI calculations do not use any of the input
parameters in <a class="reference internal" href="#tab6-2-3"><span class="std std-numref">Table 71</span></a> or <a class="reference internal" href="#tab6-2-4"><span class="std std-numref">Table 72</span></a> and do not require flux moment
tallies, flux mesh tallies (except for calculating
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span>), or the simulation of adjoint histories.
CET, CFP, and CDG are the three parameters that control CE TSUNAMI
eigenvalue sensitivity calculations. CET specifies which CE sensitivity
method (either CLUTCH, IFP, or GEAR-MC) will be used in the CE TSUNAMI
calculation. CFP specifies how many latent generations will be used by
the IFP method for either calculating sensitivity coefficients (CET=2/5)
or for calculating <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> during the inactive
generations (CET=1/4); if CET=1 or 4 and CFP= -1, then CE TSUNAMI will
perform a CLUTCH calculation assuming that <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span>
is equal to one everywhere for CET=1 and zero everywhere for CET=4. The
number of latent generations (CFP) and the number of generations skipped
for fission source convergence (NSK) control very different things.</p>
<p>The typical workflow for generating an IFP-based CE TSUNAMI <em>k</em><sub>eff</sub>
sensitivity input is given below:</p>
<ol class="arabic simple">
<li><p>Set CET=2.</p></li>
<li><p>Set your number of latent generations using CFP=# (usually between 5
and 10).</p></li>
</ol>
<p>The typical workflow for generating a CLUTCH-based CE TSUNAMI <em>k</em><sub>eff</sub>
sensitivity input is given below:</p>
<ol class="arabic simple">
<li><p>Set CET=1.</p></li>
<li><p>Set your number of latent generations using CFP=# (usually between 5
and 10).</p></li>
<li><p>Create a GridGeometry for the <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh;
this mesh must cover all fissionable regions of the problem and the
width of the mesh voxels is usually between 1 and 2 cm in the X-, Y-,
and Z-dimensions.</p></li>
<li><p>Tell CE TSUNAMI the ID of this GridGeometry using the CGD=#
parameter.</p></li>
<li><p>Consider simulating extra inactive generations to allow the
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh to converge – most
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh calculations require between 10
and 100 inactive histories per mesh voxel to sufficiently converge.</p></li>
</ol>
<blockquote>
<div><p>Ex: A problem using a 20×30×40 <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh
contains 24,000 voxels. Assuming at least 10 inactive histories per
mesh interval means this problem will require 240,000 inactive
histories for the <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh to converge. If
the problem uses 1,000 particles per generation (NPG=1000), then the
user should use at least 240 skipped generations (NSK=240) to allow
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh tallies to converge.</p>
</div></blockquote>
<p>When performing CLUTCH calculations using <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span>
(i.e., when CET=1 or 4 and CFP is not -1) a spatial grid for
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> must be specified in the <em>READ
GRIDGEOMETRY</em> block of KENO input. CGD specifies the ID of this
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> grid. Failure to specify a grid or using
the ID of a nonexistent grid results in an error message. The entries in
the <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> grid can be printed to a 3dmap file by
setting the parameter FST=YES. This information is printed to a file
with the same name as the input but with a _FStar_map.3dmap extension
(i.e., <em>problem.inp</em> prints information to <em>problem_FStar_map.3dmap</em>).
This .3dmap file can be viewed using the Fulcrum interface, as shown for
a CLUTCH <em>k</em><sub>eff</sub> sensitivity test problem in <a class="reference internal" href="#fig6-2-4"><span class="std std-numref">Fig. 56</span></a>. Values for
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> are set by default to one/zero in CLUTCH
<em>k</em><sub>eff</sub>/GPT sensitivity calculations, respectively, for regions that do
not contain fissionable material and/or did not generate any
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> tallies. When doing GPT sensitivity
calculations using <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> CE TSUNAMI will produce
two <span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> meshes: one for the numerator term in
the response of interest and another for the denominator term;
therefore, 3dmaps that are produced from CE TSUNAMI GPT
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> calculations will contain two meshes, as
shown in <a class="reference internal" href="#fig6-2-5"><span class="std std-numref">Fig. 57</span></a>.</p>
<span id="tab6-2-5"></span><table class="longtable docutils align-center" id="id53">
<caption><span class="caption-number">Table 73 </span><span class="caption-text">CE TSUNAMI-3D parameters and default values.</span><a class="headerlink" href="#id53" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Default value for
TSUNAMI-3D</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CET</p></td>
<td><p>1</p></td>
<td><p>Mode for CE TSUNAMI</p>
<p>0 = No sensitivity
calculations</p>
<p>1 = CLUTCH
sensitivity
calculation</p>
<p>2 = IFP sensitivity
calculation</p>
<p>4 = GEAR-MC
calculation (with
CLUTCH only)</p>
<p>5 = GEAR-MC
calculation (with
CLUTCH+IFP)</p>
<p>7 = Undersampling
metric calculation</p>
</td>
</tr>
<tr class="row-odd"><td><p>CFP</p></td>
<td><p>5</p></td>
<td><p>Number of latent
generations used for
IFP sensitivity or
<span class="math notranslate nohighlight">\(F^{*}\left( r
\right)\)</span>
calculations. Note:</p>
<ul class="simple">
<li><p>If CET=1 and CFP=
-1 then
<span class="math notranslate nohighlight">\(F^{*}\left(
r \right)\)</span>
is assumed to
equal one
everywhere.</p></li>
<li><p>If CET=4 and CFP=
-1 then
<span class="math notranslate nohighlight">\(F^{*}\left(
r \right)\)</span>
is assumed to
equal zero
everywhere.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>CGD</p></td>
<td><p>NONE</p></td>
<td><p>ID of the gridgeom
mesh used for CLUTCH
<span class="math notranslate nohighlight">\(F^{*}\left( r
\right)\)</span>
calculations.</p></td>
</tr>
<tr class="row-odd"><td><p>FST</p></td>
<td><p>NO</p></td>
<td><p>Print the
<span class="math notranslate nohighlight">\(F^{*}\left( r
\right)\)</span>
grid values to a
.3dmap file.</p></td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id54">
<span id="fig6-2-4"></span><a class="reference internal image-reference" href="_images/fig417.png"><img alt="_images/fig417.png" src="_images/fig417.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 56 </span><span class="caption-text"><em>F*(r)</em> mesh from a sample CLUTCH eigenvalue sensitivity calculation.</span><a class="headerlink" href="#id54" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id55">
<span id="fig6-2-5"></span><a class="reference internal image-reference" href="_images/fig516.png"><img alt="_images/fig516.png" src="_images/fig516.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 57 </span><span class="caption-text"><em>F*(r)</em> meshes from a sample CLUTCH GPT sensitivity
calculation.</span><a class="headerlink" href="#id55" title="Permalink to this image">¶</a></p>
</div>
<p>Setting CET=7 will activate an experimental capability for detecting
computational biases due to the undersampling of fission sites and
particle histories during a Monte Carlo simulation. This capability does
not calculate sensitivity coefficients and does not require selecting a
number of latent generations or building an
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh. Instead, this approach scores flux
and reaction rate tallies for various materials and nuclides in a system
and reports the tallies to a <em>.sdf</em> file after the simulation ends,
along with scores for various statistical metrics that may predict
undersampling biases in the reported tallies. An undersampling metric
calculation will produce four <em>.sdf</em> files, as described below:</p>
<div class="line-block">
<div class="line"><em>input_name</em>_metric1.sdf = Reaction rate and flux tallies</div>
<div class="line"><em>input_name</em>_metric2.sdf = Number of nonzero scores per generation for each tally</div>
<div class="line"><em>input_name</em>_metric3.sdf = Tally Entropy scores for each tally</div>
<div class="line"><em>input_name</em>_metric4.sdf = Heidelberger-Welch RHW scores for each tally</div>
</div>
<p>Each of these undersampling metrics is described in detail in Reference
<a class="footnote-reference brackets" href="#id44" id="id24">10</a>. The values reported in the _metric2/3/4.sdf files correspond to
each of the tallies scored in the _metric1.sdf file. As in typical
sensitivity coefficient <em>.sdf</em> files, the undersampling metric <em>.sdfs</em>
report energy-dependent and energy-integrated information for various
reaction rates in every material and nuclide in a system; however, the
undersampling metric calculations also report information for flux
tallies within each material/nuclide under the name of the fictitious
isotope H-111. This undersampling metric capability is only peripherally
related to the scope and application of sensitivity coefficient
calculations and was included with CE TSUNAMI-3D predominantly to take
advantage of the established TSUNAMI tally scoring framework and
sensitivity visualization/postprocessing tools (i.e., Fulcrum).</p>
<p>Performing GPT sensitivity calculations with CE TSUNAMI requires the
user to enter some additional input to specify the GPT response being
examined in the calculation. For the IFP+CLUTCH GPT implementation
(CET=5) users can define GPT reaction rate ratios using the
“Definitions” and “SystemResponses” blocks (please see <em>Sensitivity and
uncertainty calculation data</em> in the TSUNAMI-1D chapter), which are used
similarly in TSUNAMI-1D and TSUNAMI-2D. Both TSUNAMI-3D GPT capabilities
can currently only accept total cross section (MT=1), fission (MT=18),
n,gamma (MT=102), nu-fission (MT=452), or flux reaction response
definitions. The CLUTCH-only GPT implementation (CET=4) currently cannot
accept GPT response input from the Definitions and SystemResponses
blocks, and may only calculate GPT sensitivity coefficients for one
response per TSUNAMI-3D simulation. The input parameters for defining
the GPT response in these (CET=4) calculations are described in
<a class="reference internal" href="#tab6-2-6"><span class="std std-numref">Table 74</span></a>. The two GEAR-MC implementations (CET=4 or CET=5) both
require the user to specify a value for CFP; the CLUTCH-only GEAR-MC
implementation requires the user to specify an
<span class="math notranslate nohighlight">\(F^{*}\left( r \right)\)</span> mesh using the gridGeom block and the CGD
parameter.</p>
<span id="tab6-2-6"></span><table class="docutils align-center" id="id56">
<caption><span class="caption-number">Table 74 </span><span class="caption-text">CE TSUNAMI-3D GPT sensitivity parameters and default values.</span><a class="headerlink" href="#id56" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab61.svg"><img alt="_images/tab61.svg" src="_images/tab61.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sensitivity-calculation-data">
<span id="id25"></span><h3>Sensitivity calculation data<a class="headerlink" href="#sensitivity-calculation-data" title="Permalink to this headline">¶</a></h3>
<p>A data block for controlling the sensitivity calculation is optional. If
included, this data block begins with the keywords <em>READ SAMS</em> and ends
with the keywords <em>END SAMS</em>. Any of the optional SAMS input data may be
entered in free-form format between the <em>READ SAMS</em> and <em>END SAMS</em>
keywords. The optional SAMS input data are shown with the default values
specific to TSUNAMI-3D in <a class="reference internal" href="#tab6-2-7"><span class="std std-numref">Table 75</span></a>. Certain options in <a class="reference internal" href="#tab6-2-8"><span class="std std-numref">Table 76</span></a>
are not available for CE calculations. Parameters used to specify
default covariance data to supplement or correct values on the files
specified by <em>coverx=</em> are shown in <a class="reference internal" href="#tab6-2-8"><span class="std std-numref">Table 76</span></a>. A more detailed
explanation of the SAMS parameters is provided in the SAMS chapter.</p>
<span id="tab6-2-7"></span><table class="docutils align-center" id="id57">
<caption><span class="caption-number">Table 75 </span><span class="caption-text">SAMS input keywords.</span><a class="headerlink" href="#id57" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab71.svg"><img alt="_images/tab71.svg" src="_images/tab71.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<span id="tab6-2-8"></span><table class="docutils align-center" id="id58">
<caption><span class="caption-number">Table 76 </span><span class="caption-text">SAMS input keywords for default covariance data.</span><a class="headerlink" href="#id58" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab81.svg"><img alt="_images/tab81.svg" src="_images/tab81.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<p>Additionally, user-defined covariance data can be specified for
individual nuclides and reactions using the COVARIANCE data block. This
data block begins with the keywords <em>READ COVARIANCE</em> and ends with the
keywords <em>END</em> <em>COVARIANCE</em>. Any of the optional <em>COVARIANCE</em> input data
may be entered in free-form format between the <em>READ COVARIANCE</em> and
<em>END COVARIANCE</em> keywords. The specifications for the COVARIANCE data
block are described in the “User Input Covariance Data” section of the
TSUNAMI_IP chapter of the TSUNAMI Utility Modules manual.</p>
<p>As the SAMS module generates HTML output, the optional HTML data block
provides user control over some formats of the output. This data block
begins with the keywords <em>READ HTML</em> and ends with the keywords <em>END
HTML</em>. Any of the optional HTML input data may be entered in free-form
format between the <em>READ HTML</em> and <em>END HTML</em> keywords. The
specifications for the HTML data block are described in the “HTML Data”
section or the TSUNAMI_IP chapter of the TSUNAMI Utility Modules manual.</p>
</div>
<div class="section" id="input-termination">
<span id="id26"></span><h3>Input termination<a class="headerlink" href="#input-termination" title="Permalink to this headline">¶</a></h3>
<p>The input for TSUNAMI-3D must terminate with a line containing <em>END</em> in
column 1. This <em>END</em> terminates the control sequence.</p>
</div>
</div>
<div class="section" id="sample-problems">
<span id="id27"></span><h2>Sample problems<a class="headerlink" href="#sample-problems" title="Permalink to this headline">¶</a></h2>
<p>Five sample problems are given in this section. In each example, the use
of a new feature is explained to guide the user in the proper definition
of input models so that reliable sensitivity coefficients can be
obtained. The user must ensure that the necessary options are employed
for each model to obtain accurate results. Please note, <strong>the results
shown here were generated with a previous version of SCALE</strong>, so current
data libraries and code implementations may product different results.
However, the techniques demonstrated are applicable to the current
version of TSUNAMI-3D.</p>
<div class="section" id="generating-reference-direct-perturbation-sensitivity-coefficients">
<span id="id28"></span><h3>Generating reference direct perturbation sensitivity coefficients<a class="headerlink" href="#generating-reference-direct-perturbation-sensitivity-coefficients" title="Permalink to this headline">¶</a></h3>
<p>The accuracy of the energy-integrated sensitivity coefficients can be
confirmed through the use of central difference direct perturbation
sensitivity calculations. Through this technique, the sensitivity of
<em>k</em><sub>eff</sub> to the number density of particular nuclide can be obtained.
This sensitivity of <em>k</em><sub>eff</sub> to the number density is equivalent to the
sensitivity of <em>k</em><sub>eff</sub> to the total cross section integrated over
energy. Because the total cross section sensitivity coefficient tests
much of the data used to compute all other sensitivity coefficients, it
is considered an adequate test for verification. For each sensitivity
coefficient examined by direct perturbation, the <em>k</em><sub>eff</sub> of the system
is computed first with the nominal values of the input quantities, then
with a selected nominal input value increased by a certain percentage,
and then with the nominal value decreased by the same percentage. The
direct perturbation sensitivity coefficient of <em>k</em><sub>eff</sub> to some input
value α is computed as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-25">
<span class="eqno">(111)<a class="headerlink" href="#equation-eq6-2-25" title="Permalink to this equation">¶</a></span>\[S_{k, \alpha}=\frac{\alpha}{k} \times \frac{d k}{d \alpha}=\frac{\alpha}{k} \times \frac{k_{\alpha^{+}}-k_{\alpha^{-}}}{\alpha^{+}-\alpha^{-}}\]</div>
<p>where<span class="math notranslate nohighlight">\(\alpha^{+}\)</span> and alpha^{-} represent the increased and decreased
values, respectively, of the input quantity <em>α</em> and <span class="math notranslate nohighlight">\(k_{\alpha^{+}}\)</span> and
<span class="math notranslate nohighlight">\(k_{\alpha^{-}}\)</span> represent the corresponding values of <em>k</em><sub>eff</sub>. In general,
perturbations used for calculating direct perturbation sensitivities
should be large enough to induce a statistically significant (10
<span class="math notranslate nohighlight">\(\sigma_{\text{keff}}\)</span>) change in the eigenvalue of the system but
not large enough to induce second-order effects in the perturbed
eigenvalue. Statistical uncertainties in the computed values of <em>k</em><sub>eff</sub>
are propagated to uncertainties in direct perturbation sensitivity
coefficients by standard error propagation techniques as</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-26">
<span class="eqno">(112)<a class="headerlink" href="#equation-eq6-2-26" title="Permalink to this equation">¶</a></span>\[\sigma_{S}=\left(\left(\frac{\left(\sigma_{k^{+}}^{2}+\sigma_{k^{-}}^{2}\right)}{\left(k^{+}-k^{-}\right)^{2}}+\frac{\sigma_{k}^{2}}{k^{2}}\right) \times\left(\frac{k^{+}-k^{-}}{k}\right)^{2}\right)^{1 / 2} \times \frac{\alpha}{\alpha^{+}-\alpha^{-}}\]</div>
<p>In MG TSUNAMI sensitivity calculations it is important to ensure that
the <em>k</em><sub>eff</sub> value of the forward and adjoint solutions closely agree.
If the <em>k</em><sub>eff</sub> values do not agree, then the quality of at least one of
the transport calculations may be in question. Typically, the transport
calculation of concern is the adjoint calculation. By default,
TSUNAMI-3D triples the number of histories per generation requested for
the forward case to produce the adjoint solution. Experience has shown
that agreement to less than 0.5% difference in <em>k</em><sub>eff</sub> between the
forward and adjoint calculations is adequate to obtain accurate
sensitivity coefficients.</p>
</div>
<div class="section" id="simple-mg-sample-problem">
<span id="id29"></span><h3>Simple MG Sample Problem<a class="headerlink" href="#simple-mg-sample-problem" title="Permalink to this headline">¶</a></h3>
<p>A simple sample problem with INFHOMMEDIUM MG cross section processing is
based on an unreflected rectangular parallelepiped consisting of a
homogeneous mixture UF<sub>4</sub> and paraffin with an enrichment of 2
wt% in <sup>235</sup>U. The H/<sup>235</sup>U atomic ratio is 294:1. The
dimensions of the experiment are 56.22 × 56.22 × 122.47 cm.<sup>11</sup>
For consistency with a TSUNAMI-1D model of the same sample problem, this
experiment was modeled as a sphere with a critical radius of 38.50 cm.
This configuration is used in the TSUNAMI-3D_K5-1 and TSUNAMI-3D_K6-1
sample problems distributed with SCALE. An annotated TSUNAMI-3D-K5 input
for this experiment is shown in <a class="reference internal" href="#fig6-2-6"><span class="std std-numref">Fig. 58</span></a>. The composition data are
input as number densities for each nuclide. Because the material is
treated as INFHOMMEDIUM, no explicit unit cell model is necessary, and
the READ CELL block is omitted. The KENO V.a problem description
contains parameter data to request 10,000 generations (<em>gen=10000</em>) with
3000 neutrons per generation (<em>npg=3000</em>), deactivate the HTML output
for KENO V.a (<em>htm=no</em>), stop the forward calculation when <em>k</em><sub>eff</sub> has
converged to one standard deviation of 0.005 (<em>sig=0.005</em>), and to stop
the adjoint calculation when <em>k</em><sub>eff</sub> has converged to one standard
deviation of 0.010 (<em>asg=0.010</em>). The KENO V.a geometry consists of nine
concentric spheres, up to an outer radius of 38.5 cm, with each sphere
containing the material defined as mixture 1. The geometry subdivision
is necessary to adequately resolve the spatial dependence of the angular
moments of the forward and adjoint flux solutions. The optional
sensitivity calculation data block is used to request edits of the
sensitivity coefficients for each region (<em>prtgeom</em>) and edits of the
explicit, implicit, and complete sensitivity coefficients <em>(prtimp</em>).
The code output from each functional module is not given here, but is
described in the manual section for each functional module.</p>
<div class="figure align-center" id="id59">
<span id="fig6-2-6"></span><a class="reference internal image-reference" href="_images/fig613.png"><img alt="_images/fig613.png" src="_images/fig613.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 58 </span><span class="caption-text">TSUNAMI-3D-K5 simple sample problem input.</span><a class="headerlink" href="#id59" title="Permalink to this image">¶</a></p>
</div>
<p>For this problem, direct perturbation results were obtained for the
number densities of each nuclide using an equivalent 1D model. In these
calculations, the number density of each nuclide was perturbed by ±2%
and the calculation was repeated using the TSUNAMI-1DC sequence. The
sensitivity of <em>k</em><sub>eff</sub> to the number density is equivalent to the
sensitivity of <em>keff­</em> to the total cross section, integrated over
energy. The direct perturbation sensitivity coefficients were computed
by using the <em>k</em><sub>eff</sub> values from the unperturbed and perturbed cases in
<a class="reference internal" href="#equation-eq6-2-26">(112)</a>.</p>
<p>This experiment was modeled with the nine-region model shown in
<a class="reference internal" href="#fig6-2-6"><span class="std std-numref">Fig. 58</span></a>, and as a single computational region (not shown). Flux
moments were expanded to third order in both cases, which is the default
configuration. TSUNAMI-3D-K5 automatically increases the number of
particles per generation by a factor of three for the adjoint analysis.
For the single region case, the <em>k</em><sub>eff</sub> values for the forward and
adjoint cases are in good agreement at 1.00682 +/- 0.00094, and 1.0013
+/- 0.0049, respectively. The sensitivity results shown in <a class="reference internal" href="#tab6-2-9"><span class="std std-numref">Table 77</span></a>
were extracted from the output file from the edit titled “Energy,
Region, and Mixture Integrated Sensitivity Coefficients for this
Problem.” The uncertainty in the sensitivity coefficients represents one
standard deviation and is present due to the use of Monte Carlo methods
to compute the fluxes and <em>k</em><sub>eff</sub>. These results indicate similarity
with the direct perturbation results for some nuclides but not for
others. Differences between the TSUNAMI-3D-K5 results and the direct
perturbation results vary 1% for <sup>238</sup>U up to 16% for
<sup>1</sup>H. The results from the TSUNAMI-3D-K5 analysis with the model
divided into nine spherical shells, with all other parameters held
constant, are also shown in <a class="reference internal" href="#tab6-2-9"><span class="std std-numref">Table 77</span></a>. These results compare much more
favorably with the direct perturbation results. For this model, all
TSUNAMI-3D-K5 sensitivities agree with the direct perturbation values
within 0.1% for <sup>1</sup>H up to a maximum difference of 1.5% for
<sup>238</sup>U.</p>
<p>The differences in the results from the two TSUNAMI-3D models, one
region and nine regions, are due to the summation of the product of the
forward and adjoint fluxes over the regions in the problem. For a region
in which the flux moments vary greatly by position, subdividing the
geometry will provide better resolution of the variation of the flux
across the system and will produce more accurate results. The number of
regions necessary for accurate computation of the sensitivity
coefficients was determined through an iterative process. Models divided
into more regions produce the equivalent results to those produced by
the nine-region model. Increasing the number of computational regions
increases the run time for this problem by about 10%.</p>
<p>The sensitivity results from the nine-region model using TSUNAMI-3D-K5
with PARM=CENTRM, which does not include the contributions from the
implicit sensitivity coefficients, are also shown in <a class="reference internal" href="#tab6-2-9"><span class="std std-numref">Table 77</span></a>. The
differences between the TSUNAMI-3D-K5 PARM=CENTRM and the direct
perturbation results are 16% for <sup>1</sup>H and 19% for <sup>238</sup>U.
The use of the default cross section processing with the sensitivity
versions of the resonance processing codes is strongly recommended.
However, TSUNAMI-3D-K5 with PARM=CENTRM should produce accurate results
for fast systems where resonance self-shielding is not important. This
is illustrated with the second sample problem for TSUNAMI-1D and will
not be repeated here.</p>
<span id="tab6-2-9"></span><table class="docutils align-center" id="id60">
<caption><span class="caption-number">Table 77 </span><span class="caption-text">Energy- and region-integrated sensitivity coefficients from
TSUNAMI-3D UF<sub>4</sub> sample problem.</span><a class="headerlink" href="#id60" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab92.svg"><img alt="_images/tab92.svg" src="_images/tab92.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="id61">
<caption><span class="caption-number">Table 78 </span><span class="caption-text">Energy- and region-integrated sensitivity coefficients from
TSUNAMI-3D UF<sub>4</sub> sample problem (continued).</span><a class="headerlink" href="#id61" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab9cont.svg"><img alt="_images/tab9cont.svg" src="_images/tab9cont.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<p>The uncertainty information from SAMS for the UF<sub>4</sub> sample
problem is shown in <a class="reference internal" href="#list6-2-1"><span class="std std-numref">Listing 76</span></a>. Based on the 44GROUPCOV covariance
data file, the uncertainty in <em>k</em><sub>eff</sub> due to these covariance data is
0.6110% ∆k/k. A more detailed description of the uncertainty information
is given in the SAMS chapter.</p>
<p>The energy-dependent sensitivity data are available in the sensitivity
data file, which is returned to the same directory as the input file and
given the same name as the users input file with the extension .<em>sdf</em>.
In the case of the nine-region model, the sensitivity data file contains
495 individual sensitivity profiles with varying reaction types, each in
the 238-group energy structure. There are 45 profiles that are
integrated over all regions, one for each reaction of each nuclide in
the system. The sum of the sensitivity coefficients for the same nuclide
in all mixtures is printed unless <em>nomix</em> is entered in the SAMS data
block, so there are an additional 45 profiles, one for each reaction of
each nuclide in mixture 1. Additionally, because <em>prtgeom</em> was entered
in the SAMS data block, each reaction of each nuclide for each region in
the system model is represented with a sensitivity profile. There are
nine regions in the model, each with 45 sensitivity profiles, making for
a total of 495 sensitivity profiles on the data file and a total of
117,810 energy-dependent sensitivity coefficients.</p>
<p>Some plots of the energy-dependent sensitivity data from the nine-region
model of the sample problem were generated with the plotting
capabilities of Fulcrum. Energy-dependent sensitivity profiles for
<sup>235</sup>U fission and <sup>1</sup>H elastic scattering are shown in
<a class="reference internal" href="#fig6-2-8"><span class="std std-numref">Fig. 59</span></a>. The error bars represent one standard deviation for the
statistical uncertainty due to the use of Monte Carlo methods to compute
the fluxes and <em>keff.</em></p>
<div class="literal-block-wrapper docutils container" id="list6-2-1">
<div class="code-block-caption"><span class="caption-number">Listing 76 </span><span class="caption-text">Uncertainty information from UF<sub>4</sub> sample problem.</span><a class="headerlink" href="#list6-2-1" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-----------------------------
  Uncertainty Information
-----------------------------


the relative standard deviation of k-eff (% delta-k/k)
due to cross-section covariance data is:

  0.6110 +/- 0.0000 % delta-k/k

 contributions to uncertainty in k-eff (% delta-k/k) by
 individual energy covariance matrices:

 covariance matrix

        nuclide-reaction        with        nuclide-reaction            % delta-k/k due to this matrix
 ------------------------------      -------------------------------  -----------------------------------
         u-238 n,gamma                       u-238 n,gamma                 3.8714E-01 +/- 6.2871E-06
         u-235 nubar                         u-235 nubar                   2.8509E-01 +/- 7.9001E-06
         u-238 n,n&#39;                          u-238 n,n&#39;                    2.2073E-01 +/- 7.7594E-06
         u-235 n,gamma                       u-235 n,gamma                 1.6006E-01 +/- 1.7559E-06
          f-19 elastic                        f-19 elastic                 1.3624E-01 +/- 5.0707E-06
         u-238 elastic                       u-238 n,n&#39;                   -1.2828E-01 +/- 1.7674E-06
         u-235 fission                       u-235 n,gamma                 1.2387E-01 +/- 8.3076E-07
         u-235 fission                       u-235 fission                 1.2134E-01 +/- 1.2085E-06
           h-1 elastic                         h-1 elastic                 1.1972E-01 +/- 2.1606E-06
          f-19 elastic                        f-19 n,n&#39;                   -1.1793E-01 +/- 3.1965E-06
          f-19 n,n&#39;                           f-19 n,n&#39;                    1.1286E-01 +/- 3.8652E-06
         u-235 chi                           u-235 chi                     8.8178E-02 +/- 1.5583E-05
         u-238 elastic                       u-238 elastic                 6.9520E-02 +/- 1.1586E-06
         u-238 nubar                         u-238 nubar                   5.8614E-02 +/- 5.4192E-07
           h-1 n,gamma                         h-1 n,gamma                 5.0829E-02 +/- 1.6728E-07
         u-238 elastic                       u-238 n,gamma                 5.0286E-02 +/- 1.7408E-06
          f-19 n,alpha                        f-19 n,alpha                 1.9795E-02 +/- 1.0127E-07
         u-238 fission                       u-238 fission                 1.7394E-02 +/- 3.4394E-08
             c elastic                           c elastic                 1.5520E-02 +/- 5.5754E-08
         u-238 n,2n                          u-238 n,2n                    1.3981E-02 +/- 1.2056E-07
          f-19 n,gamma                        f-19 n,gamma                 9.7994E-03 +/- 6.0845E-09
             c n,n&#39;                              c elastic                -9.0325E-03 +/- 3.2330E-08
             c n,n&#39;                              c n,n&#39;                    8.6479E-03 +/- 5.6289E-08
          f-19 elastic                        f-19 n,alpha                 6.6750E-03 +/- 1.2243E-08
         u-238 chi                           u-238 chi                     5.8854E-03 +/- 6.7274E-08
         u-235 elastic                       u-235 n,gamma                 4.4783E-03 +/- 8.4753E-09
         u-235 elastic                       u-235 fission                -3.3039E-03 +/- 1.0089E-08
         u-238 fission                       u-238 n,gamma                 2.7661E-03 +/- 8.1090E-10
          f-19 n,p                            f-19 n,p                     2.0897E-03 +/- 1.3810E-09
         u-238 elastic                       u-238 n,2n                   -1.9405E-03 +/- 1.8719E-09
         u-238 elastic                       u-238 fission                -1.8278E-03 +/- 3.9798E-10
             c n,alpha                           c n,alpha                 1.6271E-03 +/- 1.2097E-09
             c n,gamma                           c n,gamma                 1.4922E-03 +/- 1.4387E-10
         u-235 n,n&#39;                          u-235 n,n&#39;                    1.3833E-03 +/- 2.5316E-10
         u-235 elastic                       u-235 n,n&#39;                   -8.8072E-04 +/- 6.2537E-11
          f-19 elastic                        f-19 n,p                     5.9136E-04 +/- 2.5027E-10
          f-19 elastic                        f-19 n,gamma                 4.4592E-04 +/- 4.9929E-10
         u-235 elastic                       u-235 elastic                 4.3974E-04 +/- 3.1277E-11
          f-19 n,d                            f-19 n,d                     2.7814E-04 +/- 4.7485E-11
         u-235 n,2n                          u-235 n,2n                    1.5578E-04 +/- 1.1389E-11
             c n,n&#39;                              c n,alpha                -1.2708E-04 +/- 7.1578E-10
          f-19 elastic                        f-19 n,2n                   -6.9247E-05 +/- 1.2530E-11
          f-19 elastic                        f-19 n,d                     6.6212E-05 +/- 1.0124E-11
          f-19 n,t                            f-19 n,t                     6.3390E-05 +/- 3.8183E-12
         u-235 elastic                       u-235 n,2n                   -2.7965E-05 +/- 3.3228E-13
          f-19 n,2n                           f-19 n,2n                    2.1907E-05 +/- 1.0175E-12
          f-19 n,n&#39;                           f-19 n,2n                   -1.9896E-05 +/- 5.7304E-12
          f-19 elastic                        f-19 n,t                     1.4406E-05 +/- 5.0542E-13
             c n,n&#39;                              c n,gamma                 7.0412E-06 +/- 1.1010E-14
             c n,d                               c n,d                     6.9094E-07 +/- 9.1360E-15
             c n,p                               c n,p                     3.8587E-07 +/- 2.0164E-15
             c n,n&#39;                              c n,d                    -2.8704E-07 +/- 0.0000E+00
             c n,n&#39;                              c n,p                    -1.4206E-07 +/- 0.0000E+00

 Note: relative standard deviation in k-eff can be computed from
 individual values by adding the square of the values with positive signs and
 subtracting the square of the values with negative signs, then taking the square root
</pre></div>
</div>
</div>
<div class="figure align-center" id="id62">
<span id="fig6-2-8"></span><a class="reference internal image-reference" href="_images/fig89.png"><img alt="_images/fig89.png" src="_images/fig89.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 59 </span><span class="caption-text">Energy-dependent sensitivity profiles from TSUNAMI-3D-K5 for simple sample problem.</span><a class="headerlink" href="#id62" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="multigroup-sample-problem-with-spatial-flux-mesh">
<span id="id30"></span><h4>Multigroup sample problem with spatial flux mesh<a class="headerlink" href="#multigroup-sample-problem-with-spatial-flux-mesh" title="Permalink to this headline">¶</a></h4>
<p>In the previous example, subdivision of the system geometry was
necessary to obtain adequate resolution of the flux solution to obtain
the appropriate product of the forward and adjoint fluxes necessary for
the sensitivity calculations. To simplify the geometry refinement
procedure, the meshing of KENO V.a or KENO-VI is used where fluxes are
tallied in a cubic mesh that is superimposed over each region of the
system geometry. If mesh fluxes are generated in the KENO solution, they
are automatically used by the SAMS module in the calculation of the
sensitivity coefficients.</p>
<p>To demonstrate the use of the mesh flux option in TSUNAMI-3D-K5, another
simple system has been selected. This system is an unreflected
rectangular parallelepiped consisting of a homogeneous mixture of
UF<sub>4</sub> and paraffin with an enrichment of 2 wt% in <sup>235</sup>U.
The H/<sup>235</sup>U atomic ratio is 972:1. The dimensions of the
experiment are 81.45 × 86.70 × 88.22 cm. This system is identified as
LEU-COMP-THERM-033 case 45 from the <em>International Handbook of Evaluated
Criticality Safety Benchmark Experiments</em> (IHECSBE). <a class="footnote-reference brackets" href="#id45" id="id31">11</a> The model
provided in the IHECSBE was converted to a TSUNAMI-3D-K5 input and is
shown in <a class="reference internal" href="#list6-2-2"><span class="std std-numref">Listing 77</span></a>. Here the experiment is modeled as a single
cuboid. This model is included as an example and is not distributed as a
TSUNAMI-3D sample problem.</p>
<p>Direct perturbation sensitivity results were obtained for <sup>235</sup>U,
<sup>238</sup>U, and <sup>1</sup>H with a ±4% change in the number density.
Each direct perturbation calculation was conducted with 15,000 particles
per generation and 1400 active generations. All TSUNAMI-3D-K5 results
presented in this section were obtained with 10,000 particles per
generation for the forward case and 30,000 particles per generation for
the adjoint case. Both the forward and adjoint cases requested up to
10,000 active generations, but the calculation was requested to stop
when the <em>k</em><sub>eff</sub> value converged to a standard deviation of 0.0001
(<em>sig=0.0001</em>). For the model shown in <a class="reference internal" href="#list6-2-2"><span class="std std-numref">Listing 77</span></a>, the forward and
adjoint <em>k</em><sub>eff</sub> values agreed well at 0.99250 ± 0.00056 and 0.9905 ±
0.0049, respectively. The direct perturbation results and the
TSUNAMI-3D-K5 results are shown in <a class="reference internal" href="#tab6-2-10"><span class="std std-numref">Table 79</span></a>. When modeled as a
single region, the TSUNAMI-3D-K5 results differed from the direct
perturbation results by 2.6% for <sup>238</sup>U, 3.1% for <sup>235</sup>U,
and 15% for <sup>1</sup>H.</p>
<p>To improve the agreement in the values, the model was divided into 6
cuboids nested inside of each other. The input for this model is given
in <a class="reference internal" href="#list6-2-3"><span class="std std-numref">Listing 78</span></a> and is illustrated in <a class="reference internal" href="#fig6-2-11"><span class="std std-numref">Fig. 60</span></a>. The results for
this model are also given in Table 6.2.10. Here the TSUNAMI-3D-K5
sensitivity coefficients agree with the direct perturbation within 0.3%
for <sup>238</sup>U, 1.7% for <sup>235</sup>U, and 0.8% for <sup>1</sup>H.</p>
<p>To simplify the generation of a refined geometrical representation of
this system, the same geometry as the initial model was used with an 8
cm mesh for the flux tallies. The input for this model is shown in
<a class="reference internal" href="#list6-2-4"><span class="std std-numref">Listing 79</span></a>. The mesh is illustrated in <a class="reference internal" href="#fig6-2-13"><span class="std std-numref">Fig. 61</span></a>, using a larger
(15 cm) mesh interval for illustrative purposes. The mesh flux option is
activated by entering <em>mfx=yes</em> in the input, and the size of the mesh
is defined with the <em>msh=8</em> entry. The 8 following <em>msh=</em> indicates that
a cubic grid with a length of 8 cm on the side of each cube will be
superimposed on each geometry region. For this system, the flux will be
tallied in 1728 mesh intervals. When the forward and adjoint mesh flux
solutions are processed by the SAMS module, the product of the forward
and adjoint solutions are produced for each mesh interval, then summed
for each region. This technique provides a simple input parameter to
produce accurate sensitivity coefficients. The results from
TSUNAMI-3D-K5 with an 8 cm mesh flux are given in <a class="reference internal" href="#tab6-2-10"><span class="std std-numref">Table 79</span></a>. Similar
to the results with the manual subdivision, sensitivity coefficients
agree with the direct perturbation within 0.7% for <sup>238</sup>U, 2.1%
for <sup>235</sup>U, and 0.03% for <sup>1</sup>H.</p>
<p>The sensitivity results for <sup>235</sup>U and <sup>238</sup>U show little
variation with modifications in the geometry subdivision. The products
of the forward and adjoint flux moments, which are derived from the
angular flux solution, are most impacted by the mesh flux. The flux
moments are used to compute the scattering terms of the sensitivity
coefficients. For isotopes with limited scattering cross sections, such
as <sup>235</sup>U and <sup>238</sup>U, the impact of refinement of the flux
solution is reduced.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-2">
<div class="code-block-caption"><span class="caption-number">Listing 77 </span><span class="caption-text">TSUNAMI-3D-K5 input for LEU-COMP-THERM-033 case 45.</span><a class="headerlink" href="#list6-2-2" title="Permalink to this code">¶</a></div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">uf</span><span class="m">4</span> <span class="err">paraffin</span> <span class="err">mixture</span> <span class="err">u</span><span class="m">2</span><span class="err">f</span><span class="m">4</span><span class="err">-</span><span class="m">6</span>
<span class="err">v</span><span class="m">6</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">h-poly</span>      <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">060586</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">f</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">012302</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">029128</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2282</span><span class="err">e-</span><span class="m">05</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0030126</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2548</span><span class="err">e-</span><span class="m">07</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">10000</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">sig=</span><span class="m">0</span><span class="err">.</span><span class="m">0001</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>   <span class="m">40</span><span class="err">.</span><span class="m">725</span>  <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">725</span>    <span class="m">43</span><span class="err">.</span><span class="m">35</span>   <span class="err">-</span><span class="m">43</span><span class="err">.</span><span class="m">35</span>    <span class="m">44</span><span class="err">.</span><span class="m">11</span>   <span class="err">-</span><span class="m">44</span><span class="err">.</span><span class="m">11</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">read</span><span class="err"> </span><span class="n">sams</span>
  <span class="err">prtgeom</span> <span class="err">prtimp</span>
<span class="n">end</span><span class="err"> </span><span class="n">sams</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<span id="tab6-2-10"></span><table class="docutils align-center" id="id63">
<caption><span class="caption-number">Table 79 </span><span class="caption-text">Energy- and region-integrated sensitivity coefficients from LEU-COMP-THERM-033 case 45 sample problem.</span><a class="headerlink" href="#id63" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab101.svg"><img alt="_images/tab101.svg" src="_images/tab101.svg" width="1000" /></a>
</td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="list6-2-3">
<div class="code-block-caption"><span class="caption-number">Listing 78 </span><span class="caption-text">TSUNAMI-3D-K5 input LEU-COMP-THERM-033 case 45 with manual geometrical subdivision.</span><a class="headerlink" href="#list6-2-3" title="Permalink to this code">¶</a></div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">uf</span><span class="m">4</span> <span class="err">paraffin</span> <span class="err">mixture</span> <span class="err">u</span><span class="m">2</span><span class="err">f</span><span class="m">4</span><span class="err">-</span><span class="m">6</span>
<span class="err">v</span><span class="m">6</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">h-poly</span>      <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">060586</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">f</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">012302</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">029128</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2282</span><span class="err">e-</span><span class="m">05</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0030126</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2548</span><span class="err">e-</span><span class="m">07</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">10000</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">sig=</span><span class="m">0</span><span class="err">.</span><span class="m">0001</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>       <span class="m">10</span>      <span class="err">-</span><span class="m">10</span>       <span class="m">10</span>      <span class="err">-</span><span class="m">10</span>       <span class="m">10</span>      <span class="err">-</span><span class="m">10</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>       <span class="m">20</span>      <span class="err">-</span><span class="m">20</span>       <span class="m">20</span>      <span class="err">-</span><span class="m">20</span>       <span class="m">20</span>      <span class="err">-</span><span class="m">20</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>       <span class="m">30</span>      <span class="err">-</span><span class="m">30</span>       <span class="m">30</span>      <span class="err">-</span><span class="m">30</span>       <span class="m">30</span>      <span class="err">-</span><span class="m">30</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>       <span class="m">35</span>      <span class="err">-</span><span class="m">35</span>       <span class="m">35</span>      <span class="err">-</span><span class="m">35</span>       <span class="m">35</span>      <span class="err">-</span><span class="m">35</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>       <span class="m">38</span>      <span class="err">-</span><span class="m">38</span>       <span class="m">41</span>      <span class="err">-</span><span class="m">41</span>       <span class="m">42</span>      <span class="err">-</span><span class="m">42</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>   <span class="m">40</span><span class="err">.</span><span class="m">725</span>  <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">725</span>    <span class="m">43</span><span class="err">.</span><span class="m">35</span>   <span class="err">-</span><span class="m">43</span><span class="err">.</span><span class="m">35</span>    <span class="m">44</span><span class="err">.</span><span class="m">11</span>   <span class="err">-</span><span class="m">44</span><span class="err">.</span><span class="m">11</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">read</span><span class="err"> </span><span class="n">sams</span>
  <span class="err">prtgeom</span> <span class="err">prtimp</span>
<span class="n">end</span><span class="err"> </span><span class="n">sams</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="figure align-center" id="id64">
<span id="fig6-2-11"></span><a class="reference internal image-reference" href="_images/fig1113.png"><img alt="_images/fig1113.png" src="_images/fig1113.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 60 </span><span class="caption-text">Cutaway view of LEU-COMP-THERM-033 case 45 with manual subdivision.</span><a class="headerlink" href="#id64" title="Permalink to this image">¶</a></p>
</div>
<div class="literal-block-wrapper docutils container" id="list6-2-4">
<div class="code-block-caption"><span class="caption-number">Listing 79 </span><span class="caption-text">TSUNAMI-3D-K5 input for LEU-COMP-THERM-033 case 45 with 8 cm automated mesh.</span><a class="headerlink" href="#list6-2-4" title="Permalink to this code">¶</a></div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">uf</span><span class="m">4</span> <span class="err">paraffin</span> <span class="err">mixture</span> <span class="err">u</span><span class="m">2</span><span class="err">f</span><span class="m">4</span><span class="err">-</span><span class="m">6</span>
<span class="err">v</span><span class="m">6</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">h-poly</span>      <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">060586</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">f</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">012302</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">029128</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2282</span><span class="err">e-</span><span class="m">05</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0030126</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">6</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">2548</span><span class="err">e-</span><span class="m">07</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">10000</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">sig=</span><span class="m">0</span><span class="err">.</span><span class="m">0001</span>
 <span class="err">mfx=yes</span>
 <span class="err">msh=</span><span class="m">8</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>   <span class="m">40</span><span class="err">.</span><span class="m">725</span>  <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">725</span>    <span class="m">43</span><span class="err">.</span><span class="m">35</span>   <span class="err">-</span><span class="m">43</span><span class="err">.</span><span class="m">35</span>    <span class="m">44</span><span class="err">.</span><span class="m">11</span>   <span class="err">-</span><span class="m">44</span><span class="err">.</span><span class="m">11</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">read</span><span class="err"> </span><span class="n">sams</span>
 <span class="err">prtimp</span> <span class="err">prtgeom</span>
<span class="n">end</span><span class="err"> </span><span class="n">sams</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="figure align-center" id="id65">
<span id="fig6-2-13"></span><a class="reference internal image-reference" href="_images/fig139.png"><img alt="_images/fig139.png" src="_images/fig139.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 61 </span><span class="caption-text">TSUNAMI-3D-K5 input for LEU-COMP-THERM-033 case 45 with 8 cm automated mesh.</span><a class="headerlink" href="#id65" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="complex-sample-problem">
<span id="id32"></span><h3>Complex sample problem<a class="headerlink" href="#complex-sample-problem" title="Permalink to this headline">¶</a></h3>
<p>A more complex sample problem is a critical assembly of 4.31
wt%-enriched UO<sub>2</sub> fuel rods with a pitch of 2.54 cm in clusters
that are separated by copper plates. This system is identified as
LEU-COMP-THERM-009 case 10 from the IHECSBE. This system is
used for sample problem TSUNAMI-3D_K5-2 that is distributed with SCALE.
The TSUNAMI-3D_K5-2 sample problem input is shown in <a class="reference internal" href="#list6-2-5"><span class="std std-numref">Listing 80</span></a>, and
the geometry is illustrated in <a class="reference internal" href="#fig6-2-15"><span class="std std-numref">Fig. 62</span></a>. The KENO V.a input section
for this model is essentially the same as that presented in the IHECSBE
except that the parameter data have been modified for the TSUNAMI
calculation. Also, in the IHECSBE model, all water was assigned to the
same mixture. For this model, the water in the reflector region is
entered as a separate mixture from the water in the pin cell to generate
separate sensitivity coefficients in these regions.</p>
<p>For this system, direct perturbation results were obtained for
<sup>235</sup>U, <sup>238</sup>U, and <sup>1</sup>H in the pin cell model
(mixture 2) and for <sup>1</sup>H in the reflector (mixture 7). Direct
perturbation sensitivity coefficients can be difficult to obtain for
large systems using Monte Carlo techniques. For a small change in a
number density (1% or 2%), the effect of <em>k</em><sub>eff</sub> may not be significant
enough to be observed outside of statistical uncertainties. If a larger
perturbation (5% or 10%) is used, the effect on <em>k</em><sub>eff</sub> may not be
linear and may produce misleading results. Also, if the magnitude of the
difference in <em>k</em><sub>eff</sub> between the baseline value and the increased
density perturbed model is different from the magnitude of the
difference in <em>k</em><sub>eff</sub> between the baseline model and the decreased
density perturbed model, the response may be nonlinear. In these
calculations, the amount of the perturbation was carefully chosen to
produce approximately 10 standard deviations of change in <em>k</em><sub>eff</sub>
between the perturbed and unperturbed case. The amount of perturbation
for each nuclide is shown in <a class="reference internal" href="#tab6-2-11"><span class="std std-numref">Table 80</span></a>.</p>
<p>TSUNAMI-3D-K5 was executed with no flux mesh, a 15 cm flux mesh, and a 5
cm flux mesh using the default coordinate transform setting (<em>tfm=yes</em>).
Also, the 15 cm and 5 cm mesh cases were run with the coordinate
transform turned off (<em>tfm=no</em>).</p>
<p>Where a region is repeatedly used in KENO, the flux data are averaged
over all occurrences of a region. In this model, only one fuel pin is
explicitly modeled. This single pin is used repeatedly in arrays to
create the system model. The flux data for this single pin are averaged
over all occurrences throughout the system to create the sensitivity
data. Using the mesh flux option, the flux is accumulated for the fuel
pin in each mesh interval. For the model with no mesh, the flux in the
UO<sub>2</sub> portion of the fuel pin is averaged over a single region.
With the 15 cm mesh, the flux in UO<sub>2</sub> is accumulated in 126
separate mesh intervals distributed across the core. For the 5 cm mesh,
the flux in UO<sub>2</sub> is accumulated in 2280 mesh intervals. For all
regions of the model with no mesh, the flux is only stored for 17 unique
locations, one for each region. For the 15 cm mesh, the flux is stored
in 1968 unique mesh intervals. For the 5 cm mesh mode, the flux is
stored in 34,298 unique mesh intervals.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-5">
<div class="code-block-caption"><span class="caption-number">Listing 80 </span><span class="caption-text">TSUNAMI-3D LEU-COMP-THERM-009 case 10 sample problem input.</span><a class="headerlink" href="#list6-2-5" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">tsunami-</span><span class="m">3</span><span class="err">d</span> <span class="err">sample</span> <span class="m">2</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">1835</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0010102</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">236</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">1395</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">022157</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">046753</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">h</span>           <span class="m">2</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">066675</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">2</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">033338</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">al</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">058433</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">cr</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">231</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">cu</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">3731</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">mg</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">00066651</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">mn</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">2115</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">ti</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">5375</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">cu</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">0967</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">si</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">00034607</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">fe</span>          <span class="m">3</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">00010152</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">4</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">043562</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">h</span>           <span class="m">4</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">058178</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">ca</span>          <span class="m">4</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002566</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">s</span>           <span class="m">4</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0004782</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">si</span>          <span class="m">4</span> <span class="m">0</span> <span class="m">9</span><span class="err">.</span><span class="m">636</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">4</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">012461</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">h</span>           <span class="m">5</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">056642</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">5</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">035648</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">5</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">014273</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">c</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0015194</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">cu</span>          <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">084128</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">fe</span>          <span class="m">6</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">8444</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">mg</span>          <span class="m">6</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">4168</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">na</span>          <span class="m">6</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">6695</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">00010064</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">si</span>          <span class="m">6</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">8223</span><span class="err">e-</span><span class="m">05</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">s</span>           <span class="m">6</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">3474</span><span class="err">e-</span><span class="m">06</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">h</span>           <span class="m">7</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">066675</span> <span class="m">295</span>   <span class="n">end</span>
 <span class="err">o</span>           <span class="m">7</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">033338</span> <span class="m">295</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">celldata</span>
  <span class="err">latticecell</span> <span class="err">squarepitch</span> <span class="err">fuelr=</span><span class="m">0</span><span class="err">.</span><span class="m">6325</span> <span class="m">1</span> <span class="err">gapr=</span><span class="m">0</span><span class="err">.</span><span class="m">6415</span> <span class="m">0</span> <span class="err">cladr=</span><span class="m">0</span><span class="err">.</span><span class="m">7075</span> <span class="m">3</span> <span class="err">hpitch=</span><span class="m">1</span><span class="err">.</span><span class="m">27</span> <span class="m">2</span> <span class="n">end</span>
  <span class="err">inf</span> <span class="m">4</span> <span class="n">end</span>
  <span class="err">inf</span> <span class="m">5</span> <span class="n">end</span>
  <span class="err">inf</span> <span class="m">6</span> <span class="n">end</span>
  <span class="err">inf</span> <span class="m">7</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">celldata</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">gen=</span><span class="m">10000</span>
 <span class="err">sig=</span><span class="m">0</span><span class="err">.</span><span class="m">0002</span>
 <span class="err">tfm=yes</span>
 <span class="err">msh=</span><span class="m">15</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&#39;fuel pin &#39;</span>
 <span class="err">zcylinder</span> <span class="m">1</span> <span class="m">1</span>  <span class="m">0</span><span class="err">.</span><span class="m">6325</span>   <span class="m">92</span><span class="err">.</span><span class="m">075</span>        <span class="m">0</span>
 <span class="err">zcylinder</span> <span class="m">0</span> <span class="m">1</span>  <span class="m">0</span><span class="err">.</span><span class="m">6415</span>   <span class="m">92</span><span class="err">.</span><span class="m">075</span>        <span class="m">0</span>
 <span class="err">zcylinder</span> <span class="m">4</span> <span class="m">1</span>  <span class="m">0</span><span class="err">.</span><span class="m">6415</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">zcylinder</span> <span class="m">3</span> <span class="m">1</span>  <span class="m">0</span><span class="err">.</span><span class="m">7075</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">cuboid</span> <span class="m">2</span> <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">27</span>    <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">27</span>     <span class="m">1</span><span class="err">.</span><span class="m">27</span>    <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">27</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>

<span class="err">Figure</span> <span class="m">6</span><span class="err">.</span><span class="m">2</span><span class="err">.</span><span class="m">14</span><span class="err">.</span> <span class="err">TSUNAMI-</span><span class="m">3</span><span class="err">D</span> <span class="err">LEU-COMP-THERM-</span><span class="m">009</span> <span class="err">case</span> <span class="m">10</span> <span class="err">sample</span> <span class="err">problem</span> <span class="err">input.</span>

<span class="err">unit</span> <span class="m">2</span>
<span class="err">com=</span><span class="s">&#39;array of fuel pins &#39;</span>
  <span class="err">array</span> <span class="m">1</span>       <span class="m">0</span>        <span class="m">0</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">replicate</span> <span class="m">5</span> <span class="m">1</span>       <span class="m">0</span>        <span class="m">0</span>        <span class="m">0</span>        <span class="m">0</span>        <span class="m">0</span>     <span class="m">2</span><span class="err">.</span><span class="m">54</span> <span class="m">1</span>
 <span class="err">replicate</span> <span class="m">7</span> <span class="m">1</span>       <span class="m">0</span>        <span class="m">0</span>     <span class="m">7</span><span class="err">.</span><span class="m">64</span>     <span class="m">7</span><span class="err">.</span><span class="m">64</span>        <span class="m">0</span>        <span class="m">0</span> <span class="m">1</span>
<span class="err">unit</span> <span class="m">3</span>
<span class="err">com=</span><span class="s">&#39;water between clusters 7.422 cm &#39;</span>
 <span class="err">cuboid</span> <span class="m">7</span> <span class="m">1</span>    <span class="m">7</span><span class="err">.</span><span class="m">422</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">cuboid</span> <span class="m">5</span> <span class="m">1</span>    <span class="m">7</span><span class="err">.</span><span class="m">422</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">4</span><span class="err">.</span><span class="m">7625</span>
<span class="err">unit</span> <span class="m">4</span>
<span class="err">com=</span><span class="s">&#39;cu poison plate between clusters,0.646 cm wide &#39;</span>
 <span class="err">cuboid</span> <span class="m">6</span> <span class="m">1</span>    <span class="m">0</span><span class="err">.</span><span class="m">646</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>     <span class="m">91</span><span class="err">.</span><span class="m">5</span>        <span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">7</span> <span class="m">1</span>    <span class="m">0</span><span class="err">.</span><span class="m">646</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">cuboid</span> <span class="m">5</span> <span class="m">1</span>    <span class="m">0</span><span class="err">.</span><span class="m">646</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">4</span><span class="err">.</span><span class="m">7625</span>
<span class="err">unit</span> <span class="m">5</span>
<span class="err">com=</span><span class="s">&#39;water between clusters,0.084cm wide &#39;</span>
 <span class="err">cuboid</span> <span class="m">7</span> <span class="m">1</span>    <span class="m">0</span><span class="err">.</span><span class="m">084</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">cuboid</span> <span class="m">5</span> <span class="m">1</span>    <span class="m">0</span><span class="err">.</span><span class="m">084</span>        <span class="m">0</span>    <span class="m">27</span><span class="err">.</span><span class="m">96</span>    <span class="err">-</span><span class="m">7</span><span class="err">.</span><span class="m">64</span>  <span class="m">94</span><span class="err">.</span><span class="m">2975</span>  <span class="err">-</span><span class="m">4</span><span class="err">.</span><span class="m">7625</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">6</span>
<span class="err">com=</span><span class="s">&#39;clusters with water between &#39;</span>
  <span class="err">array</span> <span class="m">2</span>       <span class="m">0</span>        <span class="m">0</span>  <span class="err">-</span><span class="m">2</span><span class="err">.</span><span class="m">2225</span>
 <span class="err">replicate</span> <span class="m">7</span> <span class="m">1</span>    <span class="m">30</span><span class="err">.</span><span class="m">5</span>     <span class="m">30</span><span class="err">.</span><span class="m">5</span>    <span class="m">22</span><span class="err">.</span><span class="m">86</span>    <span class="m">22</span><span class="err">.</span><span class="m">86</span>  <span class="m">12</span><span class="err">.</span><span class="m">7775</span>     <span class="m">15</span><span class="err">.</span><span class="m">3</span> <span class="m">1</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">array</span>
<span class="err">ara=</span><span class="m">1</span> <span class="err">nux=</span><span class="m">15</span> <span class="err">nuy=</span><span class="m">8</span> <span class="err">nuz=</span><span class="m">1</span>
 <span class="err">fill</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>    <span class="m">1</span>
 <span class="n">end</span><span class="err"> </span><span class="n">fill</span>
<span class="err">ara=</span><span class="m">2</span> <span class="err">nux=</span><span class="m">9</span> <span class="err">nuy=</span><span class="m">1</span> <span class="err">nuz=</span><span class="m">1</span>
 <span class="err">fill</span>
    <span class="m">2</span>    <span class="m">3</span>    <span class="m">4</span>    <span class="m">5</span>    <span class="m">2</span>    <span class="m">5</span>    <span class="m">4</span>    <span class="m">3</span>    <span class="m">2</span>
 <span class="n">end</span><span class="err"> </span><span class="n">fill</span>
<span class="n">end</span><span class="err"> </span><span class="n">array</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">read</span><span class="err"> </span><span class="n">sams</span>
  <span class="err">prtgeom</span>
  <span class="err">prtimp</span>
<span class="n">end</span><span class="err"> </span><span class="n">sams</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="figure align-center" id="id66">
<span id="fig6-2-15"></span><a class="reference internal image-reference" href="_images/fig154.png"><img alt="_images/fig154.png" src="_images/fig154.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 62 </span><span class="caption-text">Graphical representation of KENO V.a geometry for LEU-COMP-THERM-009 case 10 sample problem.</span><a class="headerlink" href="#id66" title="Permalink to this image">¶</a></p>
</div>
<p>Sensitivity coefficients and their statistical uncertainties are shown
in <a class="reference internal" href="#tab6-2-11"><span class="std std-numref">Table 80</span></a>. For <sup>235</sup>U, the TSUNAMI-3D and direct
perturbation results agree within one standard deviation for all cases.
For <sup>238</sup>U, TSUNAMI-3D agrees within two standard deviations for
all cases except the no-mesh case, which disagrees by more than four
standard deviations. Similarly for <sup>1</sup>H in the pin cell, all
meshed cases agree with the direct perturbation results to less than one
standard deviation, but the case with no geometrical subdivision
disagrees by five standard deviations. For <sup>1</sup>H in the reflector,
again, the meshed cases all agree well with the direct perturbation
results, but the non-mesh case shows large discrepancy of 21 standard
deviations.</p>
<p>Also, only small differences are observed with and without the transform
where an adequate flux mesh is used. Because of the computational
resources required for computing the transform while performing neutron
tracking, setting <em>tfm=no</em> can decrease runtime by ~50%. However, in
cases where an adequate computational mesh is not used, setting <em>tfm=no</em>
can lead to erroneous results.</p>
<p>The energy-dependent sensitivity profiles for <sup>1</sup>H elastic
scattering for the three TSUNAMI-3D models are shown in <a class="reference internal" href="#fig6-2-16"><span class="std std-numref">Fig. 63</span></a>.
The differences in the groupwise sensitivity coefficients are most
pronounced in the intermediate- to high-energy regions.</p>
<span id="tab6-2-11"></span><table class="docutils align-center" id="id67">
<caption><span class="caption-number">Table 80 </span><span class="caption-text">Energy- and region-integrated total sensitivity coefficients for LEU-COMP-THERM-009 case 10.</span><a class="headerlink" href="#id67" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab111.svg"><img alt="_images/tab111.svg" src="_images/tab111.svg" width="800" /></a>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id68">
<span id="fig6-2-16"></span><a class="reference internal image-reference" href="_images/fig163.png"><img alt="_images/fig163.png" src="_images/fig163.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 63 </span><span class="caption-text">Sensitivity profiles from TSUNAMI-3D for <sup>1</sup>H
elastic scattering in mixture 2 of LEU-COMP-THERM-009 case 10 sample
problem.</span><a class="headerlink" href="#id68" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="loosely-coupled-sample-problem">
<span id="id33"></span><h4>Loosely coupled sample problem<a class="headerlink" href="#loosely-coupled-sample-problem" title="Permalink to this headline">¶</a></h4>
<p>Another sample problem demonstrates the use of the <em>GRID</em> input block to
input a nonuniform mesh. This sample problem consists of three tanks
containing plutonium nitrate solution that are suspended in air inside
of a large concrete room. This system is identified as PU-SOL-THERM-014
case 19 in the IHECSBE. A TSUNAMI-3D-K5 input for this system
is shown in <a class="reference internal" href="#list6-2-6"><span class="std std-numref">Listing 81</span></a>. The system geometry is illustrated in
<a class="reference internal" href="#fig6-2-18"><span class="std std-numref">Fig. 64</span></a>, where the concrete room is shown in light blue and the
solution tanks are shown in dark blue. A single tank is shown in
<a class="reference internal" href="#fig6-2-19"><span class="std std-numref">Fig. 65</span></a>, where the tank wall is shown in dark blue and the
plutonium nitrate solution is shown in gray.</p>
<p>The KENO V.a option to compute the matrix <em>k</em><sub>eff</sub> by hole was used
(<em>mkh=yes)</em> to give the self-multiplication of each tank. This analysis
revealed a system <em>k</em><sub>eff</sub> of 1.0049 ± 0.0003 for the forward case and
1.002 ± 0.002 for the adjoint case. The <em>k</em><sub>eff</sub> of a single tank for
the forward solution was found to be 1.0044 ± 0.0017. Thus the
interaction between the tanks has a limited effect on the system
multiplication factor.</p>
<p>Direct perturbation sensitivity coefficients were generated for
<sup>239</sup>Pu, <sup>240</sup>Pu, and <sup>1</sup>H in the solution using
number density perturbations to produce a 20 standard deviation change
in <em>k</em><sub>eff</sub>, where the requested <em>k</em><sub>eff</sub> convergence for the CSAS
direct perturbation calculation was 10<sup>-4</sup>. These values are
shown in <a class="reference internal" href="#tab6-2-12"><span class="std std-numref">Table 81</span></a> along with the corresponding TSUNAMI-3D results.
The results generated by the model shown in <a class="reference internal" href="#list6-2-6"><span class="std std-numref">Listing 81</span></a>, which has no
geometric subdivision, agree well with the direct perturbation results
for <sup>239</sup>Pu, but the <sup>1</sup>H values differ by more than six
standard deviations, indicating poor agreement.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-6">
<div class="code-block-caption"><span class="caption-number">Listing 81 </span><span class="caption-text">TSUNAMI-3D-K5 input for sample problem PU-SOL-THERM-014 case 19.</span><a class="headerlink" href="#list6-2-6" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">PU-SOL-THERM-</span><span class="m">014</span><span class="err">-</span><span class="m">019</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">comp</span>
<span class="err">PU-</span><span class="m">238</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">0965</span><span class="err">E-</span><span class="m">8</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">239</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">7672</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">240</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">2209</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">241</span> <span class="m">1</span> <span class="m">0</span> <span class="m">9</span><span class="err">.</span><span class="m">0317</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">242</span> <span class="m">1</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">5817</span><span class="err">E-</span><span class="m">8</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">AM-</span><span class="m">241</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">1013</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">N</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">3837</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">O</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">7011</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">H</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">0930</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">5125</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CA</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">3839</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CR</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">6711</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">NI</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">3151</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">8686</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CR</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6469</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">NI</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">8</span><span class="err">.</span><span class="m">1061</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">MN</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">7319</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">SI</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6939</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">C</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">5857</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">P</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">1439</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">S</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">4518</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">H</span>      <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">0350</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">B-</span><span class="m">10</span>   <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6020</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">O</span>      <span class="m">3</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">3470</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">AL</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">5630</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">SI</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">4170</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CA</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">4240</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">7</span><span class="err">.</span><span class="m">6210</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">END</span> <span class="err">COMP</span>
<span class="err">READ</span> <span class="err">PARA</span>
<span class="err">TME=</span><span class="m">500</span><span class="err">.</span><span class="m">0</span> <span class="err">GEN=</span><span class="m">15000</span> <span class="err">NPG=</span><span class="m">5000</span>  <span class="err">NSK=</span><span class="m">5</span> <span class="err">TBA=</span><span class="m">10</span><span class="err">.</span><span class="m">0</span>
<span class="err">RUN=YES</span> <span class="err">AMX=NO</span> <span class="err">FLX=NO</span> <span class="err">FDN=NO</span> <span class="err">FAR=NO</span> <span class="err">PLT=NO</span> <span class="err">sig=</span><span class="m">0</span><span class="err">.</span><span class="m">0001</span>
<span class="err">END</span> <span class="err">PARA</span>
<span class="err">READ</span> <span class="err">GEOM</span>
<span class="err">UNIT</span> <span class="m">1</span>
<span class="err">COM=</span><span class="s">&#39;CYLINDER + SOLUTION&#39;</span>
<span class="err">CYLINDER</span> <span class="m">1</span> <span class="m">1</span> <span class="m">14</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">10</span><span class="err">.</span><span class="m">7555</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">5855</span>
<span class="err">CYLINDER</span> <span class="m">0</span> <span class="m">1</span> <span class="m">14</span><span class="err">.</span><span class="m">7</span> <span class="m">50</span><span class="err">.</span><span class="m">5855</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">5855</span>
<span class="err">CYLINDER</span> <span class="m">2</span> <span class="m">1</span> <span class="m">15</span><span class="err">.</span><span class="m">0</span> <span class="m">51</span><span class="err">.</span><span class="m">7855</span> <span class="err">-</span><span class="m">51</span><span class="err">.</span><span class="m">9145</span>
<span class="err">GLOBAL</span>
<span class="err">UNIT</span> <span class="m">2</span>
<span class="err">COM=</span><span class="s">&#39;CONCRETE BUILDING + ARRAY&#39;</span>
<span class="err">CUBOID</span> <span class="m">0</span> <span class="m">1</span> <span class="m">2</span><span class="err">P</span><span class="m">605</span><span class="err">.</span><span class="m">0</span> <span class="m">2</span><span class="err">P</span><span class="m">440</span><span class="err">.</span><span class="m">0</span> <span class="m">2</span><span class="err">P</span><span class="m">500</span><span class="err">.</span><span class="m">0</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">310</span><span class="err">.</span><span class="m">0</span>      <span class="m">55</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">160</span><span class="err">.</span><span class="m">0</span>   <span class="err">-</span><span class="m">95</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">310</span><span class="err">.</span><span class="m">0</span>   <span class="err">-</span><span class="m">95</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">CUBOID</span> <span class="m">3</span> <span class="m">1</span> <span class="m">2</span><span class="err">P</span><span class="m">750</span><span class="err">.</span><span class="m">0</span> <span class="m">2</span><span class="err">P</span><span class="m">585</span><span class="err">.</span><span class="m">0</span> <span class="m">570</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">540</span><span class="err">.</span><span class="m">0</span>
<span class="err">END</span> <span class="err">GEOM</span>
<span class="err">READ</span> <span class="err">STAR</span>
<span class="err">NST=</span><span class="m">1</span>
<span class="err">END</span> <span class="err">STAR</span>
<span class="err">END</span> <span class="err">DATA</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="figure align-center" id="id69">
<span id="fig6-2-18"></span><a class="reference internal image-reference" href="_images/fig184.png"><img alt="_images/fig184.png" src="_images/fig184.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 64 </span><span class="caption-text">Cutaway view of PU-SOL-THERM-014 case 19 sample problem.</span><a class="headerlink" href="#id69" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id70">
<span id="fig6-2-19"></span><a class="reference internal image-reference" href="_images/fig192.png"><img alt="_images/fig192.png" src="_images/fig192.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 65 </span><span class="caption-text">Cutaway view of single solution tank from PU-SOL-THERM-014 case 19 sample problem.</span><a class="headerlink" href="#id70" title="Permalink to this image">¶</a></p>
</div>
<span id="tab6-2-12"></span><table class="docutils align-center" id="id71">
<caption><span class="caption-number">Table 81 </span><span class="caption-text">Energy- and region-integrated total sensitivity
coefficients for PU-SOL-THERM-014 case 19.</span><a class="headerlink" href="#id71" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td></td>
<td><p>** <sup>1</sup>H**</p></td>
<td><p>** <sup>239</sup>Pu**</p></td>
</tr>
<tr class="row-even"><td><p>Percent change in
number density for
direct perturbation</p></td>
<td><p>0.32</p></td>
<td><p>2.39</p></td>
</tr>
<tr class="row-odd"><td><p>Direct perturbation</p></td>
<td><p>5.99E-01 ± 2.56E-02</p></td>
<td><p>7.57E-02 ± 8.29E-03</p></td>
</tr>
<tr class="row-even"><td><p>TSUNAMI-3D-K5 base
model</p></td>
<td><p>4.34E-01 ± 1.82E-05</p></td>
<td><p>7.58E-02 ± 4.42E-06</p></td>
</tr>
<tr class="row-odd"><td><p>TSUNAMI-3D-K5 grid
geometry model</p></td>
<td><p>6.05E-01 ± 3.42E-04</p></td>
<td><p>7.84E-02 ± 3.80E-05</p></td>
</tr>
</tbody>
</table>
<p>Because of the large size of the room included in this model relative to
the size of the fuel tanks, use of the uniform mesh flux proved to be
impractical due to excessive memory requirements. The directional
dependence of the flux needs to be computed separately for each tank
through the use of adequate spatial refinement with the flux mesh
through the use of the grid geometry input.</p>
<p>The <em>GRID</em> block in KENO V.a and KENO-VI enables the use of a nonuniform
mesh for this problem that is coarse throughout the room to save memory,
yet refined within the fueled regions to obtain accurate results. As
with previous examples, the use of a sufficiently fine mesh provides
accurate results without the use of the transform (<em>tfm=no</em>). The
TSUNAMI‑3D‑K5 input listing for this model using the user-defined <em>GRID</em>
is shown in <a class="reference internal" href="#list6-2-7"><span class="std std-numref">Listing 82</span></a>, where the transform is disabled with
<em>tfm=no</em>, the mesh fluxes are requested with <em>mfx=yes</em>, and the grid is
defined in the <em>read grid</em> block. The <em>msh</em> parameter that defines a
uniform mesh is not used. The input requirements for the grid are
described in the READ GRID section of the KENO documentation and will
not be repeated here. It is required that the user-defined mesh
completely encloses the geometry of the system. In the model in
<a class="reference internal" href="#list6-2-11"><span class="std std-numref">Listing 86</span></a>, the grid extends past the geometry by 1 cm in each
direction to ensure that potential round-off errors do not cause the
grid to appear to terminate inside the geometry at any point.</p>
<p>When the user-defined grid is used without the transform, the
TSUNAMI-3D-K5 and direct perturbation sensitivities agree within one
standard deviation for both <sup>1</sup>H and <sup>239</sup>Pu, as shown in
<a class="reference internal" href="#tab6-2-12"><span class="std std-numref">Table 81</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-7">
<div class="code-block-caption"><span class="caption-number">Listing 82 </span><span class="caption-text">TSUNAMI-3D-K5 input with <em>GRID</em> input for sample problem PU SOL-THERM-014 case 19.</span><a class="headerlink" href="#list6-2-7" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k5</span>
<span class="err">PU-SOL-THERM-</span><span class="m">014</span><span class="err">-</span><span class="m">019</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">238</span>
<span class="n">read</span><span class="err"> </span><span class="n">comp</span>
<span class="err">PU-</span><span class="m">238</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">0965</span><span class="err">E-</span><span class="m">8</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">239</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">7672</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">240</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">2209</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">241</span> <span class="m">1</span> <span class="m">0</span> <span class="m">9</span><span class="err">.</span><span class="m">0317</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">PU-</span><span class="m">242</span> <span class="m">1</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">5817</span><span class="err">E-</span><span class="m">8</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">AM-</span><span class="m">241</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">1013</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">N</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">3837</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">O</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">3</span><span class="err">.</span><span class="m">7011</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">H</span>      <span class="m">1</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">0930</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">5125</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CA</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">3839</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CR</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">6711</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">NI</span>     <span class="m">1</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">3151</span><span class="err">E-</span><span class="m">7</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">5</span><span class="err">.</span><span class="m">8686</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CR</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6469</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">NI</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">8</span><span class="err">.</span><span class="m">1061</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">MN</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">7319</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">SI</span>     <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6939</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">C</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">5857</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">P</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">1439</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">S</span>      <span class="m">2</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">4518</span><span class="err">E-</span><span class="m">5</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">H</span>      <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">0350</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">B-</span><span class="m">10</span>   <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">6020</span><span class="err">E-</span><span class="m">6</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">O</span>      <span class="m">3</span> <span class="m">0</span> <span class="m">4</span><span class="err">.</span><span class="m">3470</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">AL</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">5630</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">SI</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">1</span><span class="err">.</span><span class="m">4170</span><span class="err">E-</span><span class="m">2</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">CA</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">6</span><span class="err">.</span><span class="m">4240</span><span class="err">E-</span><span class="m">3</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">FE</span>     <span class="m">3</span> <span class="m">0</span> <span class="m">7</span><span class="err">.</span><span class="m">6210</span><span class="err">E-</span><span class="m">4</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="err">END</span>
<span class="err">END</span> <span class="err">COMP</span>

<span class="err">READ</span> <span class="err">PARA</span>
<span class="err">TME=</span><span class="m">500</span><span class="err">.</span><span class="m">0</span> <span class="err">GEN=</span><span class="m">10000</span> <span class="err">NPG=</span><span class="m">10000</span> <span class="err">SIG=</span><span class="m">0</span><span class="err">.</span><span class="m">0005</span> <span class="err">ASG=</span><span class="m">0</span><span class="err">.</span><span class="m">001</span> <span class="err">NSK=</span><span class="m">5</span> <span class="err">TBA=</span><span class="m">10</span><span class="err">.</span><span class="m">0</span>
<span class="err">RUN=YES</span> <span class="err">AMX=NO</span> <span class="err">FLX=NO</span> <span class="err">FDN=NO</span> <span class="err">FAR=NO</span> <span class="err">PLT=NO</span>
<span class="err">tfm=no</span>  <span class="err">mfx=yes</span>
<span class="err">END</span> <span class="err">PARA</span>
<span class="err">READ</span> <span class="err">GEOM</span>
<span class="err">UNIT</span> <span class="m">1</span>
<span class="err">COM=</span><span class="s">&#39;CYLINDER + SOLUTION&#39;</span>
<span class="err">CYLINDER</span> <span class="m">1</span> <span class="m">1</span> <span class="m">14</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">10</span><span class="err">.</span><span class="m">7555</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">5855</span>
<span class="err">CYLINDER</span> <span class="m">0</span> <span class="m">1</span> <span class="m">14</span><span class="err">.</span><span class="m">7</span> <span class="m">50</span><span class="err">.</span><span class="m">5855</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">5855</span>
<span class="err">CYLINDER</span> <span class="m">2</span> <span class="m">1</span> <span class="m">15</span><span class="err">.</span><span class="m">0</span> <span class="m">51</span><span class="err">.</span><span class="m">7855</span> <span class="err">-</span><span class="m">51</span><span class="err">.</span><span class="m">9145</span>
<span class="err">GLOBAL</span>
<span class="err">UNIT</span> <span class="m">4</span>
<span class="err">COM=</span><span class="s">&#39;CONCRETE BUILDING + ARRAY&#39;</span>
<span class="err">CUBOID</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">140</span> <span class="err">-</span><span class="m">330</span> <span class="m">75</span> <span class="err">-</span><span class="m">115</span> <span class="err">-</span><span class="m">290</span> <span class="err">-</span><span class="m">405</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">310</span><span class="err">.</span><span class="m">0</span>      <span class="m">55</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">160</span><span class="err">.</span><span class="m">0</span>   <span class="err">-</span><span class="m">95</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">HOLE</span> <span class="m">1</span>   <span class="err">-</span><span class="m">310</span><span class="err">.</span><span class="m">0</span>   <span class="err">-</span><span class="m">95</span><span class="err">.</span><span class="m">0</span>        <span class="err">-</span><span class="m">344</span><span class="err">.</span><span class="m">0855</span>
<span class="err">CUBOID</span> <span class="m">3</span> <span class="m">1</span> <span class="m">2</span><span class="err">P</span><span class="m">750</span><span class="err">.</span><span class="m">0</span> <span class="m">2</span><span class="err">P</span><span class="m">585</span><span class="err">.</span><span class="m">0</span> <span class="m">570</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">540</span><span class="err">.</span><span class="m">0</span>
<span class="err">END</span> <span class="err">GEOM</span>
<span class="n">read</span><span class="err"> </span><span class="n">grid</span>
<span class="m">1</span>
<span class="err">xplanes=-</span><span class="m">751</span><span class="err">,</span> <span class="err">-</span><span class="m">500</span><span class="err">,</span> <span class="err">-</span><span class="m">400</span><span class="err">,</span> <span class="err">-</span><span class="m">350</span><span class="err">,</span>
<span class="err">-</span><span class="m">331</span><span class="err">,</span> <span class="err">-</span><span class="m">311</span><span class="err">,</span> <span class="err">-</span><span class="m">291</span><span class="err">,</span> <span class="err">-</span><span class="m">271</span><span class="err">,</span> <span class="err">-</span><span class="m">261</span><span class="err">,</span> <span class="err">-</span><span class="m">241</span><span class="err">,</span> <span class="err">-</span><span class="m">221</span><span class="err">,</span> <span class="err">-</span><span class="m">201</span><span class="err">,</span> <span class="err">-</span><span class="m">180</span><span class="err">,</span> <span class="err">-</span><span class="m">160</span><span class="err">,</span> <span class="err">-</span><span class="m">139</span><span class="err">,</span>
<span class="err">-</span><span class="m">325</span><span class="err">,</span> <span class="err">-</span><span class="m">322</span><span class="err">,</span> <span class="err">-</span><span class="m">319</span><span class="err">,</span> <span class="err">-</span><span class="m">316</span><span class="err">,</span> <span class="err">-</span><span class="m">313</span><span class="err">,</span> <span class="err">-</span><span class="m">310</span><span class="err">,</span> <span class="err">-</span><span class="m">307</span><span class="err">,</span> <span class="err">-</span><span class="m">304</span><span class="err">,</span> <span class="err">-</span><span class="m">301</span><span class="err">,</span> <span class="err">-</span><span class="m">298</span><span class="err">,</span> <span class="err">-</span><span class="m">295</span><span class="err">,</span> <span class="err">-</span><span class="m">292</span><span class="err">,</span>
<span class="err">-</span><span class="m">175</span><span class="err">,</span> <span class="err">-</span><span class="m">172</span><span class="err">,</span> <span class="err">-</span><span class="m">169</span><span class="err">,</span> <span class="err">-</span><span class="m">166</span><span class="err">,</span> <span class="err">-</span><span class="m">163</span><span class="err">,</span> <span class="err">-</span><span class="m">160</span><span class="err">,</span> <span class="err">-</span><span class="m">157</span><span class="err">,</span> <span class="err">-</span><span class="m">154</span><span class="err">,</span> <span class="err">-</span><span class="m">151</span><span class="err">,</span> <span class="err">-</span><span class="m">148</span><span class="err">,</span> <span class="err">-</span><span class="m">145</span><span class="err">,</span> <span class="err">-</span><span class="m">142</span>
<span class="err">-</span><span class="m">90</span><span class="err">,</span> <span class="m">0</span><span class="err">,</span> <span class="m">100</span><span class="err">,</span> <span class="m">300</span><span class="err">,</span> <span class="m">500</span><span class="err">,</span> <span class="m">751</span> <span class="n">end</span>
<span class="err">yplanes=-</span><span class="m">586</span><span class="err">,</span> <span class="err">-</span><span class="m">400</span><span class="err">,</span> <span class="err">-</span><span class="m">200</span><span class="err">,</span> <span class="err">-</span><span class="m">150</span><span class="err">,</span>
<span class="err">-</span><span class="m">116</span><span class="err">,</span> <span class="err">-</span><span class="m">96</span><span class="err">,</span> <span class="err">-</span><span class="m">76</span><span class="err">,</span> <span class="err">-</span><span class="m">56</span><span class="err">,</span> <span class="err">-</span><span class="m">36</span><span class="err">,</span> <span class="err">-</span><span class="m">16</span><span class="err">,</span> <span class="m">4</span><span class="err">,</span> <span class="m">24</span><span class="err">,</span> <span class="m">44</span><span class="err">,</span> <span class="m">64</span><span class="err">,</span> <span class="m">84</span><span class="err">,</span>
<span class="m">40</span><span class="err">,</span> <span class="m">43</span><span class="err">,</span> <span class="m">46</span><span class="err">,</span> <span class="m">49</span><span class="err">,</span> <span class="m">52</span><span class="err">,</span> <span class="m">55</span><span class="err">,</span> <span class="m">58</span><span class="err">,</span> <span class="m">61</span><span class="err">,</span> <span class="m">64</span><span class="err">,</span> <span class="m">67</span><span class="err">,</span> <span class="m">70</span><span class="err">,</span>
<span class="err">-</span><span class="m">110</span><span class="err">,</span> <span class="err">-</span><span class="m">107</span><span class="err">,</span> <span class="err">-</span><span class="m">104</span><span class="err">,</span> <span class="err">-</span><span class="m">101</span><span class="err">,</span> <span class="err">-</span><span class="m">98</span><span class="err">,</span> <span class="err">-</span><span class="m">95</span><span class="err">,</span> <span class="err">-</span><span class="m">92</span><span class="err">,</span> <span class="err">-</span><span class="m">89</span><span class="err">,</span> <span class="err">-</span><span class="m">86</span><span class="err">,</span> <span class="err">-</span><span class="m">83</span><span class="err">,</span> <span class="err">-</span><span class="m">80</span><span class="err">,</span> <span class="err">-</span><span class="m">77</span><span class="err">,</span>
<span class="err">-</span><span class="m">25</span><span class="err">,</span> <span class="m">100</span><span class="err">,</span> <span class="m">300</span><span class="err">,</span> <span class="m">586</span> <span class="n">end</span>
<span class="err">zplanes=-</span><span class="m">541</span><span class="err">,</span> <span class="err">-</span><span class="m">450</span><span class="err">,</span> <span class="err">-</span><span class="m">406</span><span class="err">,</span> <span class="err">-</span><span class="m">386</span><span class="err">,</span> <span class="err">-</span><span class="m">366</span><span class="err">,</span> <span class="err">-</span><span class="m">346</span><span class="err">,</span> <span class="err">-</span><span class="m">326</span><span class="err">,</span> <span class="err">-</span><span class="m">306</span><span class="err">,</span> <span class="err">-</span><span class="m">286</span><span class="err">,</span>
<span class="err">-</span><span class="m">345</span><span class="err">,</span> <span class="err">-</span><span class="m">342</span><span class="err">,</span> <span class="err">-</span><span class="m">339</span><span class="err">,</span> <span class="err">-</span><span class="m">336</span><span class="err">,</span> <span class="err">-</span><span class="m">333</span><span class="err">,</span> <span class="err">-</span><span class="m">330</span><span class="err">,</span> <span class="err">-</span><span class="m">327</span><span class="err">,</span> <span class="err">-</span><span class="m">324</span><span class="err">,</span> <span class="err">-</span><span class="m">321</span><span class="err">,</span> <span class="err">-</span><span class="m">319</span><span class="err">,</span> <span class="err">-</span><span class="m">316</span><span class="err">,</span> <span class="err">-</span><span class="m">313</span><span class="err">,</span> <span class="err">-</span><span class="m">310</span><span class="err">,</span> <span class="err">-</span><span class="m">307</span><span class="err">,</span> <span class="err">-</span><span class="m">304</span><span class="err">,</span>
<span class="err">-</span><span class="m">250</span><span class="err">,</span> <span class="err">-</span><span class="m">100</span><span class="err">,</span> <span class="m">100</span><span class="err">,</span> <span class="m">300</span><span class="err">,</span> <span class="m">571</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">grid</span>
<span class="err">END</span> <span class="err">DATA</span>
<span class="n">read</span><span class="err"> </span><span class="n">sams</span><span class="err"> </span><span class="n">prtimp</span><span class="err"> </span><span class="n">prtgeom</span><span class="err"> </span><span class="n">end</span><span class="err"> </span><span class="n">sams</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ce-tsunami-sample-problem">
<span id="id34"></span><h3>CE TSUNAMI Sample Problem<a class="headerlink" href="#ce-tsunami-sample-problem" title="Permalink to this headline">¶</a></h3>
<p>The last sample problem focuses on performing CE TSUNAMI sensitivity
calculations starting from a CE KENO-VI model. The model used in this
example is a highly enriched uranium sphere (Godiva) using one-eighth
symmetry; this case is identified as HEU-MET-FAST-001 in
IHECSBE.<sup>11</sup> CE TSUNAMI inputs are in many ways easier to prepare
than MG TSUNAMI inputs because CE TSUNAMI does not require flux moment
calculations, a flux mesh (except for CLUTCH <span class="math notranslate nohighlight">\(F^{*}(r)\)</span>
calculations), implicit sensitivity calculations, or an adjoint
transport calculation, and thus require much less user input.
<a class="reference internal" href="#list6-2-8"><span class="std std-numref">Listing 83</span></a> shows the CE TSUNAMI input for this system. The input
lines that differ from those in the CE KENO-VI input are highlighted in
blue. This simulation uses the IFP sensitivity method (cet=2) and
assumes that daughter fission neutrons diffuse through the system and
produce an asymptotic population after five latent generations (cfp=5).
In general, IFP simulations require a cfp between 5 and 10 generations
to produce accurate sensitivity estimates, although IFP sensitivity
calculations can produce accurate sensitivities for this system using as
few as 2 latent generations. The runtime and memory requirements of the
IFP method are proportional to cfp, and users should minimize cfp when
performing IFP sensitivity calculations to maximize calculation
efficiency and minimize calculation memory footprint.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-8">
<div class="code-block-caption"><span class="caption-number">Listing 83 </span><span class="caption-text">CE TSUNAMI-3D-K6 input for the Godiva system using the IFP method.</span><a class="headerlink" href="#list6-2-8" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k6</span>
<span class="err">Godiva</span> <span class="err">sample</span> <span class="err">problem</span>
<span class="err">ce_v</span><span class="m">7</span><span class="err">_endf</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">000491995</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0449996</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002498</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">1200</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">nsk=</span><span class="m">200</span>
 <span class="err">htm=no</span>
 <span class="err">cet=</span><span class="m">2</span>
 <span class="err">cfp=</span><span class="m">5</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&quot;global unit 1&quot;</span>
 <span class="err">sphere</span> <span class="m">1</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>  <span class="err">chord</span> <span class="err">+x=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+y=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+z=</span><span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">2</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>
 <span class="err">media</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 <span class="err">media</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">1</span> <span class="m">2</span>
 <span class="err">boundary</span> <span class="m">2</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">bnds</span>
  <span class="err">body=</span><span class="m">2</span>
    <span class="err">surface(</span><span class="m">1</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">2</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">3</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">4</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">5</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">6</span><span class="err">)=mirror</span>
  <span class="n">end</span><span class="err"> </span><span class="n">bnds</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="#list6-2-9"><span class="std std-numref">Listing 84</span></a> shows the CE TSUNAMI input for the Godiva system using the
CLUTCH sensitivity method (cet=1). This input is different from the IFP
input in that the CLUTCH method requires a spatial grid for tallying the
CLUTCH <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> function. This grid is specified in the “read
gridGeometry” block and the ID of the grid specified in this block is
passed to CLUTCH in the parameter block (cgd=11). In general, CLUTCH
calculations are much faster than IFP calculations and produce a
significantly smaller memory footprint, but CLUTCH calculations must
have an accurate <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh to obtain accurate sensitivity
coefficients. The <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh is currently calculated during
inactive generations using the IFP method, and the cfp=5 card specifies
how many latent generations are used in this calculation. Using more
latent generations will increase the accuracy of the <span class="math notranslate nohighlight">\(F^{*}(r)\)</span>
mesh and will not significantly affect the memory footprint of the
CLUTCH method, but it will increase the variance of the <span class="math notranslate nohighlight">\(F^{*}(r)\)</span>
mesh values. In general an <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh with 1 cm to 2 cm mesh
intervals is sufficiently refined to obtain accurate sensitivity
coefficients. <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> is calculated during the inactive
generations, and in general users should simulate at least on the order
of 10 to 100 inactive histories per mesh interval to allow for
sufficient <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> convergence. This sometimes necessitates
simulating a large number of additional inactive histories/generations.
Fission source convergence is not necessary to begin accurate
<span class="math notranslate nohighlight">\(F^{*}(r)\)</span> estimates. Therefore, <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> can be tallied
during the inactive generations while the fission source is still
converging.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-9">
<div class="code-block-caption"><span class="caption-number">Listing 84 </span><span class="caption-text">CE TSUNAMI-3D-K6 input for the Godiva system using the CLUTCH method.</span><a class="headerlink" href="#list6-2-9" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k6</span>
<span class="err">Godiva</span> <span class="err">sample</span> <span class="err">problem</span>
<span class="err">ce_v</span><span class="m">7</span><span class="err">_endf</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">000491995</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0449996</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002498</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">1200</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">nsk=</span><span class="m">200</span>
 <span class="err">htm=no</span>
 <span class="err">cet=</span><span class="m">1</span>
 <span class="err">cfp=</span><span class="m">5</span>
 <span class="err">cgd=</span><span class="m">11</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&quot;global unit 1&quot;</span>
 <span class="err">sphere</span> <span class="m">1</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>  <span class="err">chord</span> <span class="err">+x=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+y=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+z=</span><span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">2</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>
 <span class="err">media</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 <span class="err">media</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">1</span> <span class="m">2</span>
 <span class="err">boundary</span> <span class="m">2</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">bnds</span>
  <span class="err">body=</span><span class="m">2</span>
    <span class="err">surface(</span><span class="m">1</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">2</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">3</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">4</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">5</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">6</span><span class="err">)=mirror</span>
  <span class="n">end</span><span class="err"> </span><span class="n">bnds</span>
<span class="n">read</span><span class="err"> </span><span class="n">gridGeometry</span><span class="err"> 11</span>
    <span class="err">title=</span><span class="s">&quot;Mesh for collecting fission source distribution&quot;</span>
    <span class="err">xLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
    <span class="err">yLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
    <span class="err">zLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
<span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<p>It is possible to perform a CE TSUNAMI CLUTCH sensitivity calculation
using the assumption that <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> equals one everywhere. This
will not produce accurate sensitivity coefficient estimates for systems
where the importance of fission neutrons varies significantly as a
function of space, but it will produce accurate sensitivity coefficients
for systems with relatively flat importance functions, such as an
infinitely reflected model of a single fuel pin or an infinite media
problem. This calculation mode requires no additional inactive
generations for the calculation of <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> and is useful for
estimating the runtime or memory requirements of a CLUTCH calculation
and for obtaining rough estimates of the sensitivity coefficients of
complicated systems. <a class="reference internal" href="#list6-2-10"><span class="std std-numref">Listing 85</span></a> shows the CE TSUNAMI input for the
Godiva system using the CLUTCH sensitivity method (cet=1). The
<span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh calculation is disabled using cfp=-1, making the
“read gridGeometry” and “cgd=###” inputs not required.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-10">
<div class="code-block-caption"><span class="caption-number">Listing 85 </span><span class="caption-text">CE TSUNAMI-3D-K6 input for the Godiva system using the CLUTCH method with no F*(r) mesh.</span><a class="headerlink" href="#list6-2-10" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k6</span>
<span class="err">Godiva</span> <span class="err">sample</span> <span class="err">problem</span>
<span class="err">ce_v</span><span class="m">7</span><span class="err">_endf</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">000491995</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0449996</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002498</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">1200</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">nsk=</span><span class="m">200</span>
 <span class="err">htm=no</span>
 <span class="err">cet=</span><span class="m">1</span>
 <span class="err">cfp=-</span><span class="m">1</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&quot;global unit 1&quot;</span>
 <span class="err">sphere</span> <span class="m">1</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>  <span class="err">chord</span> <span class="err">+x=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+y=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+z=</span><span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">2</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>
 <span class="err">media</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 <span class="err">media</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">1</span> <span class="m">2</span>
 <span class="err">boundary</span> <span class="m">2</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">bnds</span>
  <span class="err">body=</span><span class="m">2</span>
    <span class="err">surface(</span><span class="m">1</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">2</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">3</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">4</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">5</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">6</span><span class="err">)=mirror</span>
  <span class="n">end</span><span class="err"> </span><span class="n">bnds</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<p>The three previously described CE TSUNAMI inputs were simulated. The
total nuclide sensitivity coefficients from these runs are compared with
reference direct perturbation and MG TSUNAMI-3D sensitivities in
<a class="reference internal" href="#tab6-2-13"><span class="std std-numref">Table 82</span></a>. The difference between the calculated and reference
sensitivities, in terms of the effective number of standard deviations,
is given in the table in parentheses below each calculated sensitivity
coefficient. Although the reference direct perturbation sensitivity
estimates had uncertainties that were a bit large (it is recommended
that their relative uncertainties are less than 5%), the four TSUNAMI
calculations all produced sensitivity coefficients that seem to agree
well with the reference sensitivities.</p>
<span id="tab6-2-13"></span><table class="docutils align-center" id="id72">
<caption><span class="caption-number">Table 82 </span><span class="caption-text">CE TSUNAMI Godiva sensitivity coefficient comparison.</span><a class="headerlink" href="#id72" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab131.svg"><img alt="_images/tab131.svg" src="_images/tab131.svg" width="800" /></a>
</td>
</tr>
</tbody>
</table>
<p>Two sample inputs have been included to illustrate how a user can run
GEAR-MC sensitivity calculations starting from the CE KENO-VI Godiva
model. The first, CLUTCH-only GPT input requires specifying a number of
latent generations for the GPT <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> calculation (cfp=5),
creating a gridGeom for the <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh, and specifying
reaction rates, materials, and energy ranges for the numerator and
denominator response terms. The generalized response examined in this
problem is the <sup>235</sup>U fast ( &gt; 0.6 MeV and &lt; 20 MeV) fission
cross section; in other words:</p>
<div class="math notranslate nohighlight" id="equation-eq6-2-27">
<span class="eqno">(113)<a class="headerlink" href="#equation-eq6-2-27" title="Permalink to this equation">¶</a></span>\[R = \frac{\left\langle \Sigma_{f}^{U - 235}\phi \right\rangle^{\text{fast}}}{\left\langle \phi\right\rangle^{\text{fast}}} .\]</div>
<p>Therefore, the reaction rate in the numerator term of this response is
the <sup>235</sup>U fast fission reaction rate in material 1 (<code class="docutils literal notranslate"><span class="pre">nnc=92235</span></code>,
<code class="docutils literal notranslate"><span class="pre">nma=1</span></code>, <code class="docutils literal notranslate"><span class="pre">nmt=18</span></code>, <code class="docutils literal notranslate"><span class="pre">nmx=20e7</span></code>, and n``mn=600000``) and the denominator term is the
fast flux in material 1 (<code class="docutils literal notranslate"><span class="pre">dnc=-1</span></code>, <code class="docutils literal notranslate"><span class="pre">dma=1</span></code>, <code class="docutils literal notranslate"><span class="pre">dmt=0</span></code>, <code class="docutils literal notranslate"><span class="pre">dmx=20e7</span></code>, and
<code class="docutils literal notranslate"><span class="pre">dmn=600000</span></code>).</p>
<div class="literal-block-wrapper docutils container" id="list6-2-11">
<div class="code-block-caption"><span class="caption-number">Listing 86 </span><span class="caption-text">CE TSUNAMI-3D-K6 input for the Godiva system using GEAR-MC with only the CLUTCH method.</span><a class="headerlink" href="#list6-2-11" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k6</span>
<span class="err">Godiva</span> <span class="err">sample</span> <span class="err">problem</span>
<span class="err">ce_v</span><span class="m">7</span><span class="err">_endf</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">000491995</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0449996</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002498</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">1200</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">nsk=</span><span class="m">200</span>
 <span class="err">htm=no</span>
 <span class="err">cet=</span><span class="m">4</span>
 <span class="err">cfp=</span><span class="m">5</span>
 <span class="err">cgd=</span><span class="m">11</span>
 <span class="err">nnc=</span><span class="m">92235</span>
 <span class="err">nma=</span><span class="m">1</span>
 <span class="err">nmt=</span><span class="m">18</span>
 <span class="err">dnc=-</span><span class="m">1</span>
 <span class="err">dma=</span><span class="m">1</span>
 <span class="err">dmt=</span><span class="m">0</span>
 <span class="err">nmx</span><span class="m">=20e7</span>
 <span class="err">nmn=</span><span class="m">600000</span>
 <span class="err">dmx</span><span class="m">=20e7</span>
 <span class="err">dmn=</span><span class="m">600000</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&quot;global unit 1&quot;</span>
 <span class="err">sphere</span> <span class="m">1</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>  <span class="err">chord</span> <span class="err">+x=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+y=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+z=</span><span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">2</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>
 <span class="err">media</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 <span class="err">media</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">1</span> <span class="m">2</span>
 <span class="err">boundary</span> <span class="m">2</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">bnds</span>
  <span class="err">body=</span><span class="m">2</span>
    <span class="err">surface(</span><span class="m">1</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">2</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">3</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">4</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">5</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">6</span><span class="err">)=mirror</span>
  <span class="n">end</span><span class="err"> </span><span class="n">bnds</span>
<span class="n">read</span><span class="err"> </span><span class="n">gridGeometry</span><span class="err"> 11</span>
    <span class="err">title=</span><span class="s">&quot;Mesh for collecting fission source distribution&quot;</span>
    <span class="err">xLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
    <span class="err">yLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
    <span class="err">zLinear</span>   <span class="m">10</span>  <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">8</span><span class="err">.</span><span class="m">741</span>
<span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<p>This problem can be specified using the input option <code class="docutils literal notranslate"><span class="pre">cet=5</span></code>, which uses
the IFP method to estimate the intergenerational effect term on the fly
rather than tallying the effect in an <span class="math notranslate nohighlight">\(F^{*}(r)\)</span> mesh. For this
cet=5 case the Definitions and SystemResponses blocks (found in the
SystemResponses block sections in the TSUNAMI-1D chapter of the SCALE
manual) are used to specify the GPT responses rather than using KENO
input parameters; eventually, both <code class="docutils literal notranslate"><span class="pre">cet=4</span></code> and <code class="docutils literal notranslate"><span class="pre">cet=5</span></code> will use exclusively
the Definitions and SystemResponses blocks for specifying GPT responses.</p>
<div class="literal-block-wrapper docutils container" id="list6-2-12">
<div class="code-block-caption"><span class="caption-number">Listing 87 </span><span class="caption-text">CE TSUNAMI-3D-K6 input for the Godiva system using GEAR-MC with the CLUTCH and IFP methods.</span><a class="headerlink" href="#list6-2-12" title="Permalink to this code">¶</a></div>
<div class="long highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=tsunami-3d-k6</span>
<span class="err">Godiva</span> <span class="err">sample</span> <span class="err">problem</span>
<span class="err">ce_v</span><span class="m">7</span><span class="err">_endf</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
 <span class="err">u-</span><span class="m">234</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">000491995</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">235</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0449996</span> <span class="m">300</span>   <span class="n">end</span>
 <span class="err">u-</span><span class="m">238</span>       <span class="m">1</span> <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">002498</span> <span class="m">300</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameter</span>
 <span class="err">gen=</span><span class="m">1200</span>
 <span class="err">npg=</span><span class="m">10000</span>
 <span class="err">nsk=</span><span class="m">200</span>
 <span class="err">htm=no</span>
 <span class="err">cet=</span><span class="m">5</span>
 <span class="err">cfp=</span><span class="m">5</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameter</span>
<span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
  <span class="err">response</span> <span class="m">10</span>
    <span class="err">mixture=</span><span class="m">1</span>
    <span class="err">nuclide=</span><span class="m">92235</span>
    <span class="err">reaction=fission</span>
    <span class="err">macro</span>
    <span class="err">ehigh</span><span class="m">=20e7</span>
    <span class="err">elow</span><span class="m">=6e5</span>
  <span class="n">end</span><span class="err"> </span><span class="n">response</span>
  <span class="err">response</span> <span class="m">30</span>
    <span class="err">mixture=</span><span class="m">1</span>
    <span class="err">unity</span>
    <span class="err">ehigh</span><span class="m">=20e7</span>
    <span class="err">elow</span><span class="m">=6e5</span>
  <span class="n">end</span><span class="err"> </span><span class="n">response</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
<span class="n">read</span><span class="err"> </span><span class="n">systemResponses</span>
  <span class="err">ratio</span> <span class="m">5</span>
    <span class="err">title=</span><span class="s">&quot;u-235 fast xs&quot;</span>
    <span class="err">numer</span> <span class="m">10</span>  <span class="n">end</span>
    <span class="err">denom</span> <span class="m">30</span>  <span class="n">end</span>
  <span class="n">end</span><span class="err"> </span><span class="n">ratio</span>
<span class="n">end</span><span class="err"> </span><span class="n">systemResponses</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
<span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
<span class="err">com=</span><span class="s">&quot;global unit 1&quot;</span>
 <span class="err">sphere</span> <span class="m">1</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>  <span class="err">chord</span> <span class="err">+x=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+y=</span><span class="m">0</span>  <span class="err">chord</span> <span class="err">+z=</span><span class="m">0</span>
 <span class="err">cuboid</span> <span class="m">2</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>    <span class="m">8</span><span class="err">.</span><span class="m">741</span>        <span class="m">0</span>
 <span class="err">media</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>
 <span class="err">media</span> <span class="m">0</span> <span class="m">1</span> <span class="err">-</span><span class="m">1</span> <span class="m">2</span>
 <span class="err">boundary</span> <span class="m">2</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">bnds</span>
  <span class="err">body=</span><span class="m">2</span>
    <span class="err">surface(</span><span class="m">1</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">2</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">3</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">4</span><span class="err">)=mirror</span>
    <span class="err">surface(</span><span class="m">5</span><span class="err">)=vacuum</span>
    <span class="err">surface(</span><span class="m">6</span><span class="err">)=mirror</span>
  <span class="n">end</span><span class="err"> </span><span class="n">bnds</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<p>REFERENCES</p>
<dl class="footnote brackets">
<dt class="label" id="id35"><span class="brackets"><a class="fn-backref" href="#id7">1</a></span></dt>
<dd><p>. H. Hurwitz, Jr., “<em>A Note on the Theory of Danger
Coefficients</em>, Tech. Rep. KAPL-98, Knolls Atomic Power Laboratory,
1948.</p>
</dd>
<dt class="label" id="id36"><span class="brackets"><a class="fn-backref" href="#id8">2</a></span></dt>
<dd><p>. B. C. Kiedrowski, “Adjoint Weighting for Continuous-Energy Monte
Carlo Radiation Transport,”, doctoral dissertation, University of
Wisconsin (2009).</p>
</dd>
<dt class="label" id="id37"><span class="brackets"><a class="fn-backref" href="#id10">3</a></span></dt>
<dd><p>. C. M. Perfetti, “Advanced Monte Carlo Methods for Eigenvalue
Sensitivity Coefficient Calculation,”, doctoral dissertation,
University of Michigan (2012).</p>
</dd>
<dt class="label" id="id38"><span class="brackets"><a class="fn-backref" href="#id11">4</a></span></dt>
<dd><p>. K. Banerjee, W. M. Martin, “Kernel Density Estimate Monte Carlo
Global Flux Tallies,” <em>Proc</em>eedings <em>of the International
Conference on Mathematics, Computational Methods &amp; Reactor Physics
(M&amp;C 2009)</em>, Saratoga Springs, New York, May 3–7, 2009.</p>
</dd>
<dt class="label" id="id39"><span class="brackets"><a class="fn-backref" href="#id13">5</a></span></dt>
<dd><p>. C. M. Perfetti, B. T. Rearden, “Continuous-Energy Monte Carlo
Methods for Calculating Generalized Response Sensitivities using
TSUNAMI-3D,” <em>Proceedings of the 2014 International Conference on the
Physics of Reactors (PHYSOR 2014),</em> Kyoto, Japan, September
28–October 3, 2014.</p>
</dd>
<dt class="label" id="id40"><span class="brackets"><a class="fn-backref" href="#id14">6</a></span></dt>
<dd><p>. C. M. Perfetti, B. T. Rearden, “Performance Enhancements to the
SCALE TSUNAMI-3D Generalized Response Sensitivity Capability,”
<em>Trans. Am. Nucl. Soc.</em> <strong>112</strong> (2014).</p>
</dd>
<dt class="label" id="id41"><span class="brackets"><a class="fn-backref" href="#id15">7</a></span></dt>
<dd><p>. M. L. Williams, “Perturbation Theory for Nuclear Reactor Analysis,”
in Y. Ronen, <em>CRC Handbook of Nuclear Reactor Calculations: Volume
III</em>, Boca Raton, Florida: CRC Press, Inc. (1986).</p>
</dd>
<dt class="label" id="id42"><span class="brackets"><a class="fn-backref" href="#id16">8</a></span></dt>
<dd><p>. M. L. Williams, “Generalized Contributon Response Theory,” <em>Nucl.
Sci. &amp; Engr.</em>, <strong>108</strong>, pp. 355–383 (1991).</p>
</dd>
<dt class="label" id="id43"><span class="brackets"><a class="fn-backref" href="#id17">9</a></span></dt>
<dd><p>. M. L. Williams, <em>Equations for Contributon Eigenvalue Solution</em>.
Unpublished document (2007).</p>
</dd>
<dt class="label" id="id44"><span class="brackets"><a class="fn-backref" href="#id24">10</a></span></dt>
<dd><p>. C. M. Perfetti, B. T. Rearden, “Metrics for Diagnosing
Undersampling in Monte Carlo Tally Estimates,” <em>Proceedings of M&amp;C
2015</em>, Nashville, Tennessee, April 19–23, 2015</p>
</dd>
<dt class="label" id="id45"><span class="brackets"><a class="fn-backref" href="#id31">11</a></span></dt>
<dd><p>11. <em>International Handbook of Evaluated Criticality Safety Benchmark
Experiments</em>, Nuclear Energy Agency Nuclear Science Committee of the
Organization for Economic Co-operation and Development,
NEA/NSC/DOC(95)03 (2010). Available at:
<a class="reference external" href="http://icsbep.inl.gov/handbook.shtml">http://icsbep.inl.gov/handbook.shtml</a></p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sams.html" class="btn btn-neutral float-right" title="SAMS: Sensitivity Analysis Module for Scale" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tsunami-1d-appA.html" class="btn btn-neutral float-left" title="XSDRNPM Data File Formats" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, SCALE developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>