

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells &mdash; SCALE Manual 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PMC: A Program to Produce Multigroup Cross Sections Using Pointwise Energy Spectra from CENTRM" href="PMC.html" />
    <link rel="prev" title="BONAMI: Resonance Self-Shielding by the Bondarenko Method" href="BONAMI.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SCALE Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Reactor Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TRITON.html">TRITON: A Multipurpose Transport, Depletion, And Sensitivity and Uncertainty Analysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRITONAppABC.html">TRITON Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Polaris.html">POLARIS - 2D Light Water Reactor Lattice Physics Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolarisA.html">SCALE 6.2 Polaris Input Format</a></li>
</ul>
<p class="caption"><span class="caption-text">Depletion, Activation, and Spent Fuel Source Terms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Depletion%2C%20Activation%2C%20and%20Spent%20Fuel%20Source%20Terms%20Overview.html">Depletion, Activation, and Spent Fuel Source Terms Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN.html">Origen: Neutron Activation, Actinide Transmutation, Fission Product Generation, and Radiation Source Term Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html">Origen Data Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#energy-resource">Energy Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#decay-resource-format">Decay Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#fission-yield-resource-format">Fission Yield Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#gamma-resource-format">Gamma Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#origen-end7dec-nuclide-set">ORIGEN “end7dec” Nuclide Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGAMI.html">ORIGAMI: A Code for Computing Assembly Isotopics with ORIGEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="SLIG.html">SCALE/Origen Library Generator (SLIG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Origenutil.html">ORIGEN Utility Programs</a></li>
</ul>
<p class="caption"><span class="caption-text">Sensitivity and Uncertainty Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Sensitivity%20and%20Uncertainty%20Analysis%20Overview.html">Snesitivity and Uncertainty Analysis Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d.html">TSUNAMI-1D:  Control Module for One-Dimensional Cross-Section Sensitivity and Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d-appA.html">XSDRNPM Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-3d.html">TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality</a></li>
<li class="toctree-l1"><a class="reference internal" href="sams.html">SAMS: Sensitivity Analysis Module for Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="sams-appA.html">Sensitivity Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsar.html">TSAR: Tool for Sensitivity Analysis of Reactivity Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip.html">TSUNAMI Utility Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip-appAB.html">Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer.html">TSURFER: An Adjustment Code to Determine Biases and Uncertainties in Nuclear System Responses by Consolidating Differential Data and Benchmark Integral Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer-appA.html">TSURFER Appendix A: Sensitivity/Uncertainty Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler.html">Sampler: A Module for Statistical Uncertainty Analysis with Scale Sequences</a></li>
</ul>
<p class="caption"><span class="caption-text">Criticality Safety</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Criticality%20Safety%20Overview.html">Criticality Safety Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5.html">CSAS5:  Control Module For Enhanced Criticality Safety Analysis Sequences With KENO V.a</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5App.html">Additional Example Applications of CSAS5</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6.html">CSAS6:  Control Module for Enhanced Criticality Safety Analysis with KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6App.html">Additional Example Applications of CSAS6</a></li>
<li class="toctree-l1"><a class="reference internal" href="STARBUCS.html">STARBUCS: A Scale Control Module for Automated Criticality Safety Analyses Using Burnup Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sourcerer.html">Sourcerer: Deterministic Starting Source for Criticality Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DEVC.html">DEVC: Denovo EigenValue Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="KMART.html">KMART5 and KMART6: Postprocessors for KENO V.A and KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="K5C5.html">K5toK6 and C5toC6: Input File Conversion Programs for KENO and CSAS</a></li>
</ul>
<p class="caption"><span class="caption-text">Material Specification and Cross Section Processing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Material%20Specification%20and%20Cross%20Section%20Processing%20Overview.html">Material Specification and Cross Section Processing Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProc.html">XSPROC: The Material and Cross Section Processing Module for SCALE</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppA.html">XSProc: Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppB.html">XSProc Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppC.html">Examples of Complete XSProc Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="stdcmp.html">Standard Composition Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="BONAMI.html">BONAMI: Resonance Self-Shielding by the Bondarenko Method</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#description-of-problem-solved">Description of problem solved</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nuclear-data-required-for-centrm">Nuclear data required for CENTRM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-assumptions-and-features">Code assumptions and features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#theory-and-analytical-models">Theory and Analytical Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#energy-lethargy-ranges-for-mg-and-pw-calculations">Energy/lethargy ranges for MG and PW calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-boltzmann-equation-for-neutron-transport">The Boltzmann equation for neutron transport</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#epithermal-elastic-scatter">Epithermal Elastic Scatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#epithermal-inelastic-scatter">Epithermal Inelastic Scatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermal-scatter">Thermal Scatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bound-thermal-kernels">Bound thermal kernels</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sub-moment-expansion-of-the-epithermal-scattering-source">Sub-moment expansion of the epithermal scattering source</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#characteristics-and-properties-of-the-sub-moment-expansion">Characteristics and Properties of the Sub-Moment Expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scattering-moments-expressed-with-cumulative-integral-operator">Scattering moments expressed with cumulative integral operator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#multigroup-boltzmann-equation">Multigroup Boltzmann equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multigroup-data-for-centrm-calculation">Multigroup data for CENTRM calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-of-multigroup-fluxes-to-pseudo-pointwise-values">Conversion of multigroup fluxes to pseudo-pointwise values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-boltzmann-equation-within-the-pw-range">The Boltzmann equation within the PW range</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#scattering-sources-for-the-pw-range">Scattering sources for the PW range</a></li>
<li class="toctree-l4"><a class="reference internal" href="#downscatter-source-from-high-region-of-the-umr-to-the-pw-range-shi"><strong>Downscatter source from</strong> high <strong>region of the UMR to the PW range (SHI)</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scattering-sources-from-umr-transition-region-and-epithermal-pw-range"><strong>Scattering sources from UMR</strong> transition <strong>region and epithermal PW range</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#pw-thermal-scatter-source">PW thermal scatter source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#downscatter-source-from-the-epithermal-pw-range-to-the-lmr">Downscatter source from the epithermal PW range to the LMR</a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermal-scatter-sources-from-lmr-and-pw-range">Thermal scatter sources from LMR and PW range</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#determination-of-energy-mesh-for-pw-flux-calculation">Determination of energy mesh for PW flux calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#centrm-cross-sections-and-fixed-sources">CENTRM cross sections and fixed sources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#centrm-pw-cross-section-libraries">CENTRM PW cross-section libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linearization-of-mg-cross-sections-and-fixed-sources">Linearization of MG cross sections and fixed sources</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#available-methods-for-solving-transport-equation">Available Methods for Solving Transport Equation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#discrete-ordinates">Discrete ordinates</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#homogenized-infinite-medium">Homogenized infinite medium</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#zonewise-infinite-medium">Zonewise infinite medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collision-probability-method">Collision probability method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#p1-diffusion-theory-method">P<sub>1</sub> (“Diffusion Theory”) method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-region-2r-method">Two-region (2R) method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#method-of-characteristics-for-a-2d-unit-cell">Method of characteristics for a 2D unit cell</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#centrm-input-data">CENTRM Input Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#centrm-data-notes">CENTRM data notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#centrm-i-o-files">CENTRM I/O files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description-of-the-centrm-ce-cross-section-file">Description of the CENTRM CE cross section file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description-of-the-centrm-output-pw-flux-file">Description of the CENTRM output PW flux file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-case">Example Case</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#centrm-input-for-example-case">CENTRM input for example case</a></li>
<li class="toctree-l3"><a class="reference internal" href="#centrm-output-for-example-case">CENTRM output for example case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#centrm-pw-library-and-flux-file-formats">CENTRM PW library and flux file formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id61">Description of the CENTRM CE cross section file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id63">Description of the CENTRM output PW flux file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#centrm-error-messages">CENTRM Error Messages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PMC.html">PMC: A Program to Produce Multigroup Cross Sections Using Pointwise Energy Spectra from CENTRM</a></li>
<li class="toctree-l1"><a class="reference internal" href="PMCAppAB.html">PMC Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHOPS.html">CHOPS: Module to Compute Pointwise Disadvantage Factors and Produce a Cell-Homogenized CENTRM Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRAWDAD.html">CRAWDAD: Module to Produce CENTRM-Formatted Continuous-Energy Nuclear Data Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="MCDancoff.html">MCDancoff Data Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAJUN.html">CAJUN: Module for Combining and Manipulating CENTRM Continuous-Energy Libraries</a></li>
</ul>
<p class="caption"><span class="caption-text">Monte Carlo Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Monte%20Carlo%20Transport%20Overview.html">Monte Carlo Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoA.html">Keno Appendix A: KENO V.a Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoB.html">Keno Appendix B: KENO VI Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoC.html">Keno Appendix C: Sample problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Monaco.html">Monaco: A Fixed-Source Monte Carlo Transport Code for Shielding Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Radiation Shielding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="MAVRIC.html">MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAAScapability.html">MAVRIC Appendix A: CAAS Capability</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixb.html">MAVRIC Appendix B: MAVRIC Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixc.html">MAVRIC Appendix C: Advanced Features</a></li>
</ul>
<p class="caption"><span class="caption-text">Deterministic Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Deterministic%20Transport%20Intro.html">Deterministic Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSD.html">XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSDAppAB.html">XSDRNPM Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="NEWT.html">NEWT:  A New Transport Algorithm for Two-Dimensional Discrete-Ordinates Analysis in Non-Orthogonal Geometries</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SCALE Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/CENTRM.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="centrm-a-neutron-transport-code-for-computing-continuous-energy-spectra-in-general-one-dimensional-geometries-and-two-dimensional-lattice-cells">
<span id="id1"></span><h1>CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells<a class="headerlink" href="#centrm-a-neutron-transport-code-for-computing-continuous-energy-spectra-in-general-one-dimensional-geometries-and-two-dimensional-lattice-cells" title="Permalink to this headline">¶</a></h1>
<p><em>M. L. Williams</em></p>
<p>Abstract</p>
<p>CENTRM computes continuous-energy neutron spectra for infinite media,
general one-dimensional (1D) systems, and two-dimensional (2D) unit
cells in a lattice, by solving the Boltzmann transport equation using a
combination of pointwise and multigroup nuclear data. Several
calculational options are available, including a slowing-down
computation for homogeneous infinite media, 1D discrete ordinates in
slab, spherical, or cylindrical geometries; a simplified two-region
solution; and 2D method of characteristics for a unit cell within a
square-pitch lattice. In SCALE, CENTRM is used mainly to calculate
problem-specific fluxes on a fine energy mesh (10,000–70,000 points),
which may be used to generate self-shielded multigroup cross sections
for subsequent radiation transport computations.</p>
<p>ACKNOWLEDGMENTS</p>
<p>Several current and former ORNL staff made valuable contributions to the
CENTRM development. The author acknowledges the contributions of former
ORNL staff members D. F. Hollenbach and N. M. Greene; as well as current
staff member L. M. Petrie. Special thanks go to Kang-Seog Kim who
developed the 2D method of characteristics option for CENTRM. Portions
of the original code development were performed by M. Asgari as partial
fulfillment of his PhD dissertation research at Louisiana State
University (LSU); and Riyanto Raharjo from LSU made significant
programming contributions for the inelastic scattering and thermal
calculations.</p>
<div class="section" id="introduction">
<span id="id2"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>CENTRM (<strong>C</strong>ontinuous <strong>EN</strong>ergy <strong>TR</strong>ansport <strong>M</strong>odule)
computes “continuous-energy” neutron spectra using various deterministic
approximations to the Boltzmann transport equation. Computational
methods are available for infinite media, general one-dimensional (1-D)
geometries, and two-dimensional (2D) unit cells in a square-pitch
lattice. The purpose of the code is to provide fluxes and flux moments
for applications that require a high resolution of the fine-structure
variation in the neutron energy spectrum. The major function of CENTRM
is to determine problem-specific fluxes for processing multigroup (MG)
data with the XSProc self-shielding module (Introduction in XSProc
chapter), which is executed by all SCALE MG sequences. XSProc calls an
application program interface (API) to perform a CENTRM calculation for
a representative model (e.g., a unit cell in a lattice), and then
utilizes the spectrum as a <em>problem-dependent</em> weight function for MG
averaging. The MG data processing is done in XSProc by calling an API
for the PMC code, which uses the CENTRM continuous-energy (CE) flux
spectra and cross-section data to calculate group-averaged
cross sections over some specified energy range. The resulting
application-specific library is used for MG neutron transport
calculations within SCALE sequences. In this approach the CENTRM/PMC
cross-section processing in XSProc becomes an active component in the
overall transport analysis. CENTRM can also be executed as a standalone
code, if the user provides all required input data and nuclear data
libraries; but execution through XSProc is much simpler and less prone
to error.</p>
<div class="section" id="description-of-problem-solved">
<span id="id3"></span><h3>Description of problem solved<a class="headerlink" href="#description-of-problem-solved" title="Permalink to this headline">¶</a></h3>
<p>CENTRM uses a combination of MG and pointwise (PW) solution techniques
to solve the neutron transport equation over the energy range ~0 to
20 MeV. The calculated CE spectrum consists of PW values for the flux
per unit lethargy defined on a discrete energy mesh, for which a linear
variation of the flux between energy points is assumed. Depending on the
specified transport approximation, the flux spectrum may vary as a
function of space and direction, in addition to energy. Spherical
harmonic moments of the angular flux, which may be useful in processing
MG matrices for higher order moments of the scattering cross section,
can also be determined as a function of space and energy mesh.</p>
<p>CENTRM solves the fixed-source (inhomogeneous) form of the transport
equation, with a user-specified fixed source term. The input source may
correspond to MG histogram spectra for volumetric or surface sources or
it may be a “fission source” which has a continuous-energy
fission-spectrum distribution (computed internally) appropriate for each
fissionable mixture. Note that eigenvalue calculations are <em>not</em>
performed in CENTRM—these must be performed by downstream MG transport
codes that utilize the self-shielded data processed with the CENTRM
spectra.</p>
</div>
<div class="section" id="nuclear-data-required-for-centrm">
<span id="id4"></span><h3>Nuclear data required for CENTRM<a class="headerlink" href="#nuclear-data-required-for-centrm" title="Permalink to this headline">¶</a></h3>
<p>A MG cross section library, a CE cross section library, and a CE thermal
kernel [S(α, β)] library are required for the CENTRM transport
calculation. During XSProc execution for a given unit cell in the CELL
DATA block, the MG library specified in the input is processed by BONAMI
prior to the CENTRM calculation, in order to provide self-shielded data
based on the Bondarenko approximation for the MG component of the CENTRM
solution. The shielded MG cross sections are also used in CENTRM to
correct infinitely dilute CE data in the unresolved resoance range. The
CRAWDAD module is executed by XSProc to generate the CENTRM CE cross
section and thermal kernel libraries, respectively, by concatenating
discrete PW data read from individual files for the nuclides in the unit
cell mixtures. CE resonance profiles are based strictly on
specifications in the nuclear data evaluations; e.g., Reich-Moore
formalism is specified for most materials in ENDF/B-VII. PW
data in the CENTRM library are processed such that values at any energy
can be obtained by linear interpolation within some error tolerance
specified during the library generation (usually ~0.1% or less). CRAWDAD
also interpolates the CE cross section data and the Legendre moments of
the thermal scattering kernels to the appropriate temperatures for the
unit cell mixtures. The format of the CENTRM library is described in
<a class="reference internal" href="#id61"><span class="std std-ref">Description of the CENTRM CE cross section file</span></a>.</p>
</div>
<div class="section" id="code-assumptions-and-features">
<span id="id5"></span><h3>Code assumptions and features<a class="headerlink" href="#code-assumptions-and-features" title="Permalink to this headline">¶</a></h3>
<p>As shown in <a class="reference internal" href="#fig7-4-1"><span class="std std-numref">Fig. 152</span></a>, the energy range of interest is divided into
three intervals called the Upper Multigroup Range (UMR), Pointwise Range
(PW), and Lower Multigroup Range (LMR), respectively, which are defined
by input. MG fluxes are computed using standard multigroup techniques
for the UMR and LMR, and these values are then divided by the group
lethargy width to obtain the average flux per lethargy within each
group. This “pseudo-pointwise” flux is assigned to the midpoint lethargy
of the group, so that there is one energy point per group in the UMR and
LMR energy intervals. However, for each group in the PW range there are
generally several, and possibly many, energy points for which CENTRM
computes flux values. In this manner a problem-dependent spectrum is
obtained over the entire energy range.</p>
<p>The default PW range goes from 0.001 eV to 20 keV, but the user can
modify the PW limits. The energy range for the PW transport calculation
is usually chosen to include the interval where the important absorber
nuclides have resolved resonances, while MG calculations are performed
where the cross sections characteristically have a smoother variation or
where shielding effects are less important. In the SCALE libraries the
thermal range is defined to be energies less than 5.0 eV. Above thermal
energies, scattering kinematics are based on the stationary nucleus
model, while molecular motion and possible chemical binding effects are
taken into account for thermal scattering, which can result in an
incease in the neutron incident energy. The CENTRM thermal calculation
uses Legendre coefficients from the CE kernel library that describes
point-to-point energy transfers for incoherent and coherent scattering,
as function of temperature, for all moderators that have thermal
scattering law data provided in ENDF/B. Thermal kernels for all other
materials are generated internally by CENTRM based on the free-gas
model.</p>
<div class="figure align-center" id="id66">
<span id="fig7-4-1"></span><a class="reference internal image-reference" href="_images/fig11.png"><img alt="_images/fig11.png" src="_images/fig11.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 152 </span><span class="caption-text">Definition of UMR, PW, and LMR energy ranges.</span><a class="headerlink" href="#id66" title="Permalink to this image">¶</a></p>
</div>
<p>Several transport computation methods are available for both MG and PW
calculations. These include a space-independent slowing down calculation
for infinite homogeneous media, 1D discrete ordinates or P1 methods for
slab, spherical, and cylindrical geometries, and a 2D method of
chracateristics (MoC) method for lattice unit cells. A simplified
two-region collision-probablity method is also available for ther
pointwise solution. In general the user may specify different transport
methods for the UMR, PW, and LMR, respectively; however, if the 2D MoC
method is specified for any range, it will be used for all.</p>
<p>The CENTRM 1D discrete ordinates calculation option has many of the same
features as the SCALE MG code XSDRNPM. It represents the directional
dependence of the angular flux with an arbitrary symmetric-quadrature
order, and uses Legendre expansions up to P<sub>5</sub> to represent the
scattering source. No restrictions are placed on the material
arrangement or the number of spatial intervals in the calculation, and
general boundary conditions (vacuum, reflected, periodic, albedo) can be
applied on either boundary of the 1D geometry. Lattice cells are
represented in the CENTRM discrete ordinates option by a 1D Wigner-Sitz
cylindrical or spherical model with a white boundary condition on the
outer surface.</p>
<p>Starting with SCALE-6.2, CENTRM also includes a 2D MoC solver for
lattice cell geometries consisting of a cylindrical fuel rod
(fuel/gap/clad) contained within a rectangular moderator region. The MoC
calculation is presently limited to square lattices. The 2D unit cell
uses a reflected boundary condition on the outer square surface, which
provides a more rigorous treatment than the 1D Wigner-Seitz model;
however the MoC option requires a longer execution time than the 1D
discrete ordinates method. The MoC option has been found to improve
results compared to the 1D Wigner-Seitz cell model for many cases, but
in other cases the improvement is marginal.</p>
<p>A variable PW energy mesh is generated internally to accurately
represent the fine-structure flux spectrum for the system of interest.
This gives CENTRM the capability to rigorously account for resonance
interference effects in systems with multiple resonance absorbers.
Because CENTRM calculates the space-dependent PW flux spectrum, the
spatial variation of the self-shielded cross sections within an absorber
body can be obtained. A radial temperature distribution can also be
specified, so that space-dependent Doppler broadening can be treated in
the transport solution. Within the epithermal PW range, the slowing-down
source due to elastic and discrete-level inelastic reactions is computed
with the analytical scatter kernel based upon the neutron kinematic
relations for <em>s</em>-wave scattering. Continuum inelastic scatter is
approximated by an analytical evaporation spectrum, assumed isotropic in
the laboratory system. For many thermal reactor and criticality safety
problems, self-shielding of inelastic cross sections has a minor impact,
and by default these options are turned off for faster execution. As
previously discussed, the thermal scatter kernel is based on the ENDF/B
scattering law data for bound moderators, and uses the free-gas model
for other materials.</p>
</div>
</div>
<div class="section" id="theory-and-analytical-models">
<span id="id6"></span><h2>Theory and Analytical Models<a class="headerlink" href="#theory-and-analytical-models" title="Permalink to this headline">¶</a></h2>
<p>This section describes the coupled MG and PW techniques used to solve
the neutron transport equation.</p>
<div class="section" id="energy-lethargy-ranges-for-mg-and-pw-calculations">
<span id="id7"></span><h3>Energy/lethargy ranges for MG and PW calculations<a class="headerlink" href="#energy-lethargy-ranges-for-mg-and-pw-calculations" title="Permalink to this headline">¶</a></h3>
<p>The combined MG/PW CENTRM calculation is performed over the energy range
spanned by the group structure in the input MG library. The energy
boundaries for the “IGM” neutron groups specified on the MG library
divide the entire energy range into energy intervals. The lowest energy
group contained in the UMR is defined to be “MGHI”; while the highest
energy group in the LMR is designated “MGLO.” The boundary between the
PW and UMR energy intervals is set by the energy value “DEMAX,” while
“DEMIN” is the boundary between the PW and LMR. The default values of
0.001 eV and 20 keV for DEMIN and DEMAX, respectively, can be modified
by user input, but the input values are altered by the code to
correspond to the closest group boundaries. Hence, DEMAX is always equal
to the lower energy boundary of group MGHI and DEMIN the upper energy
boundary of MGLO. The PW calculation is performed in terms of lethargy
(u), rather than energy (E). The origin (u=0) of the lethargy coordinate
corresponds to the energy E=DEMAX, which is the top of the PW range. See
<a class="reference internal" href="#fig7-4-2"><span class="std std-numref">Fig. 153</span></a>.</p>
<p>The highest energy group of the thermal range is defined by the
parameter “IFTG,” obtained from the MG library. If DEMIN is less than
the upper energy boundary of IFTG, the PW range extends into thermal. In
this case, scattering in the PW region of the thermal range is based on
the PW scattering kernel data; and the LMR calculation uses 2D transfer
matrices for incoherent and coherent scattering on the MG library.
Coupling between the MG and PW thermal calculations is treated, and
outer iterations are required to address effects of upscattering.</p>
<div class="figure align-center" id="id67">
<span id="fig7-4-2"></span><a class="reference internal image-reference" href="_images/fig21.png"><img alt="_images/fig21.png" src="_images/fig21.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 153 </span><span class="caption-text">Definition of <em>High</em> and <em>Transition</em> regions in upper multigroup region.</span><a class="headerlink" href="#id67" title="Permalink to this image">¶</a></p>
</div>
<p>With the exception of hydrogen moderation, elastic down-scattering
coupling the UMR and PW ranges, occurs only within a limited sub-range
of the UMR called the “transition region”. The highest energy group in
the transition region is designated “MGTOP.” The precise definition of
the transition region is given in <a class="reference internal" href="#id31"><span class="std std-ref">Scattering sources for the PW range</span></a>.</p>
<p>Energy boundaries of the group structure on the input MG library
correspond to the IGM+1 values, { G<sub>1</sub>, G<sub>2,</sub> …
G<sub>g,</sub> G<sub>g+1</sub>, …, G<sub>IGM+1</sub>}. It is convenient to
designate the number of groups in the UMR, PW, and LMR ranges equal to
NG<sub>U</sub>, NG<sub>P</sub>, and NG<sub>L</sub>, respectively, so that IGM
= NG<sub>U</sub> + NG<sub>P</sub> + NG<sub>L</sub>; or in terms of the
parameters MGHI and MGLO introduced previously:</p>
<blockquote>
<div><p>NG<sub>U</sub> = MGHI; NG<sub>P</sub> = MGLO − MGHI − 1; NG<sub>L</sub> = IGM
− MGLO + 1.</p>
</div></blockquote>
<p>The flux per unit lethargy is calculated for a discrete energy (or
lethargy) mesh spanning the MG structure. Groups in the UMR and LMR each
contain a single energy mesh point, while groups in the PW range
generally contain several points. The number of mesh <em>points</em> in the
UMR, PW, and LMR is equal respectively to NG<sub>U</sub>, N<sub>P</sub>, and
NG<sub>L</sub>; and the total number of points in the entire energy mesh
is designated as “N<sub>T</sub>,” which is equal to NG<sub>U</sub> +
N<sub>P</sub> + NG<sub>L</sub>. Thus the lethargy (u) mesh consists of the
set of points: {u:sub:<cite>1</cite>,….u<sub>NGU,</sub>
u<sub>NGU+1,</sub>….u<sub>NGU+NP</sub>,
u<sub>NGU+NP+1</sub>,…u<sub>NT</sub>}. Based on the lethargy origin at
E=DEMAX, the lethargy “u<sub>n</sub>” associated with any energy point
“E<sub>n</sub>” is equal to,</p>
<blockquote>
<div><p>u<sub>n</sub> = ln(DEMAX/E<sub>n</sub>).</p>
</div></blockquote>
<p>Lethargy points are arranged in order of increasing value. The lethargy
origin is at point NG<sub>U</sub>+1, the lower energy boundary of group
MGHI; i.e., <strong>u</strong><sub>NGU+1</sub>=0. Note that the entire UMR
(E&gt;DEMAX) corresponds to negative lethargy values. Lethargy values for
the first NG<sub>U</sub> and the last NG<sub>L</sub> points in the mesh are
defined to be the midpoint lethargies of groups in the UMR and LMR
ranges, respectively. For example, for the NG<sub>U</sub> groups within
the UMR,</p>
<blockquote>
<div><p>u<sub>1</sub> = 0.5[ln(DEMAX/G<sub>1</sub>) + ln(DEMAX/G<sub>2</sub>)];</p>
<p>u<sub>NGU</sub> = 0.5[ln(DEMAX/G<sub>MGHI</sub>) + ln(DEMAX/G<sub>MGHI + 1</sub>)];</p>
</div></blockquote>
<p>and similarly for the NG<sub>L</sub> groups in the LMR,</p>
<blockquote>
<div><p>u<sub>NGU + NP + 1</sub> = 0.5[ln(DEMAX/G<sub>MGLO</sub>) + ln(DEMAX/G<sub>MGLO + 1</sub>)]</p>
<p>u<sub>NT</sub> = 0.5[ln(DEMAX/G<sub>IGM</sub>) + ln(DEMAX/G<sub>IGM + 1</sub>)]</p>
</div></blockquote>
<p>The remaining N<sub>P</sub> points in the mesh (i.e., values
u<sub>NGU+1</sub> to u<sub>NGU+NP</sub>) are contained within the
NG<sub>P</sub> groups that span the PW range. By definition the first
point in the PW range is the lower energy boundary of group MGHI. The
other mesh points are computed internally by CENTRM, based on the
behavior of the macroscopic PW total cross sections and other criteria.</p>
<p>The neutron flux, as a function of space and direction, is calculated
for each energy/lethargy point in the mesh by solving the Boltzmann
transport equation. The transport equation at each lethargy point
generally includes a source term representing the production rate due to
elastic and inelastic scatter from other lethargies, which couples the
solutions at different lethargy mesh points. Except in the thermal
range, neutrons can only gain lethargy (lose energy) in a scattering
reaction; thus the PW flux is computed by solving the transport equation
at successive mesh points, sweeping from low to high lethargy values.</p>
</div>
<div class="section" id="the-boltzmann-equation-for-neutron-transport">
<span id="id8"></span><h3>The Boltzmann equation for neutron transport<a class="headerlink" href="#the-boltzmann-equation-for-neutron-transport" title="Permalink to this headline">¶</a></h3>
<p>The steady state neutron transport equation shown below represents a
particle balance-per unit phase space, at an arbitrary point ρ in phase
space,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-1">
<span class="eqno">(293)<a class="headerlink" href="#equation-eq7-4-1" title="Permalink to this equation">¶</a></span>\[\Omega \cdot \nabla \Psi(\rho)+\sum_{t}(\mathrm{r}, \mathrm{u}) \Psi(\rho)=\int_{0}^{\infty} \int_{0}^{4 \pi} \Sigma\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u} ; \mu_{0}\right) \Psi\left(\mathrm{u}^{\prime}, \Omega^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}+\mathrm{Q}_{\mathrm{ext}}(\rho)\]</div>
<p>where:</p>
<blockquote>
<div><p>ψ(p) = angular flux (per lethargy) at phase space coordinate ρ;</p>
<p>ρ = (r,u,Ω) = phase space point defined by the six independent
variables;</p>
<p>r = (x<sub>1</sub>,x<sub>2</sub>,x<sub>3</sub>) = space coordinates;</p>
<p>u = ln(E<sub>ref</sub>/E) = lethargy at energy E, relative to an origin
(u=0) at E<sub>ref</sub>;</p>
<p>Ω = (μ,ζ) = neutron direction defined by polar cosine μ and azimuthal
angle ζ;</p>
<p>Σ<sub>t</sub>(r,u) = macroscopic total cross section;</p>
<p>Σ(u′→u;μ<sub>0</sub>) = double differential scatter cross section;</p>
<p>μ<sub>0</sub> = cosine of scatter angle, measured in laboratory coordinate
system;</p>
<p>Q<sub>ext</sub>(ρ) = external source term, including fission source;</p>
</div></blockquote>
<p>The left and right sides of <a class="reference internal" href="#equation-eq7-4-1">(293)</a> respectively, are equal to the neutron
loss and production rates, per unit volume-direction-lethargy. In CENTRM
the spatial distribution of the fission source is input as a component
of the external source Q; hence, a fixed source rather than an
eigenvalue calculation is required for the transport solution.</p>
<p>The angular dependence of the double-differential macroscopic scatter
cross section of an arbitrary nuclide “j” is represented by a finite
Legendre expansion of arbitrary order L:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-2">
<span class="eqno">(294)<a class="headerlink" href="#equation-eq7-4-2" title="Permalink to this equation">¶</a></span>\[\Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u} ; \mu_{0}\right)=\sum_{=0}^{\mathrm{L}} \frac{2+1}{2} \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \quad \mathrm{P}\left(\mu_{0}\right)\]</div>
<p>where P<sub>ℓ</sub>(μ:sub:<cite>0</cite>) = Legendre polynomial evaluated at the
laboratory scattering cosine μ<sub>0</sub>; and</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\Sigma^{(j)}\left(u^{\prime} \rightarrow u\right)\)</span> = cross section moments of nuclide j, defined by the expression</p>
</div></blockquote>
<div class="math notranslate nohighlight" id="equation-eq7-4-3">
<span class="eqno">(295)<a class="headerlink" href="#equation-eq7-4-3" title="Permalink to this equation">¶</a></span>\[\Sigma^{(j)}\left(u^{\prime} \rightarrow u\right)=\int_{-1}^{1} \Sigma^{(j)}\left(u^{\prime} \rightarrow u ; \mu_{0}\right) P\left(\mu_{0}\right) d \mu_{0}\]</div>
<p>After substitution of the above Legendre expansions for the scattering
data of each nuclide, and applying the spherical harmonic addition
theorem in the usual manner, the scattering source on the right side of
<a class="reference internal" href="#equation-eq7-4-1">(293)</a> becomes <a class="bibtex reference internal" href="PMC.html#bell-nuclear-1970" id="id9">[BG70]</a>:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-4">
<span class="eqno">(296)<a class="headerlink" href="#equation-eq7-4-4" title="Permalink to this equation">¶</a></span>\[\mathrm{S}(\mathrm{r}, \mathrm{u}, \Omega) \equiv \int_{0}^{\infty} \int_{0}^{4 \pi} \Sigma\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u} ; \mu_{0}\right) \Psi\left(\mathrm{u}^{\prime}, \Omega^{\prime}\right) \mathrm{d} \Omega^{\prime} \mathrm{d} \mathrm{u}^{\prime}=\sum_{\mathrm{k}=1}^{\mathrm{LK}} \frac{2+1}{2} \mathrm{Y}_{\mathrm{k}}(\Omega) \mathrm{S}_{\mathrm{k}}(\mathrm{r}, \mathrm{u})\]</div>
<p>wherein,</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\mathrm{Y}_{\mathrm{k}}(\Omega)=\mathrm{Y}_{\mathrm{k}}(\mu, \zeta)\)</span> = the spherical harmonic function evaluated at direction Ω</p>
<p>S<sub>k</sub> = spherical harmonic moments of the scatter source, per unit letharagy.</p>
</div></blockquote>
<p>The summation index “ℓk” indicates a double sum over ℓ and k indices; in
the most general case it is defined as:</p>
<div class="math notranslate nohighlight">
\[\sum_{\mathrm{k}=1}^{\mathrm{LK}}=\sum_{=0}^{\mathrm{L}} \sum_{\mathrm{k}=0}\]</div>
<p>where “L” is the input value for the maximum order of scatter (input
parameter “ISCT”).</p>
<p>Due to symmetry conditions, some of the source moments may be zero. The
parameter LK is defined to be the total number of non-zero moments
(including scalar flux) for the particular geometry of interest, and is
equal to,</p>
<blockquote>
<div><p>LK = L + 1 for 1D slabs and spheres;</p>
<p>LK = L*(L+4)/4+1 for 1D cylinders, and</p>
<p>LK = L*(L+3)/2+1 for 2D MoC cells</p>
</div></blockquote>
<p>More details concerning the 1-D Boltzmann equation can be found in the
XSDRNPM chapter of the SCALE manual.</p>
<p id="id10">The S<sub>ℓk</sub> moments in <a class="reference internal" href="#equation-eq7-4-4">(296)</a>  correspond to expansion coefficients in
a spherical harmonic expansion of the scatter source. These can be
expressed in terms of the cross section and flux moments by</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-5">
<span class="eqno">(297)<a class="headerlink" href="#equation-eq7-4-5" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}(\mathrm{u})=\sum_{\mathrm{j}} \int_{\mathrm{u}^{\prime}} \mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{d} \mathrm{u}^{\prime}=\sum_{\mathrm{j}} \int_{\mathrm{u}^{\prime}} \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}\]</div>
<p>where ψ<sub>ℓk</sub>(u) = spherical harmonic moments of the angular
flux;</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-6">
<span class="eqno">(298)<a class="headerlink" href="#equation-eq7-4-6" title="Permalink to this equation">¶</a></span>\[= \int_{0}^{4 \pi} \mathrm{Y}_{\mathrm{k}}(\Omega) \Psi(\Omega) \mathrm{d} \Omega\]</div>
<p>and S<sub>ℓk</sub><sup>(j)</sup>(u′→u) = moments of the differential
scatter rate from lethargy u′ to u, for nuclide “j”;</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-7">
<span class="eqno">(299)<a class="headerlink" href="#equation-eq7-4-7" title="Permalink to this equation">¶</a></span>\[= \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right)\]</div>
<p>The ψ<sub>ℓk</sub> flux moments are the well known coefficients appearing
in a spherical harmonic expansion of the angular flux. These usually are
the desired output from the transport calculation. In particular, the
ℓ=0, k=0 moment corresponds to the scalar flux [indicated here as
Φ(r,u)],</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-8">
<span class="eqno">(300)<a class="headerlink" href="#equation-eq7-4-8" title="Permalink to this equation">¶</a></span>\[\Psi_{0,0}(\mathrm{r}, \mathrm{u})=\Phi(\mathrm{r}, \mathrm{u})=\int_{0}^{4 \pi} \Psi(\mathrm{r}, \mathrm{u}, \Omega) d \Omega\]</div>
<p>In general the epithermal component of the scatter source in <a class="reference internal" href="#equation-eq7-4-4">(296)</a>
contains contributions from both elastic and inelastic scatter
reactions; however, inelastic scatter is only possible above the
threshold energy corresponding to the lowest inelastic level. The
inelastic Q values for most materials are typically above 40 keV;
therefore, elastic scatter is most important for slowing down
calculations in the resolved resonance range of most absorber materials
of interest. For example, the inelastic Q values of <sup>238</sup>U, iron,
and oxygen are approximately 45 keV, 846 keV, and 6 MeV, respectively;
while the upper energy of the <sup>238</sup>U resolved resonance range is
20 keV in ENDF/B-VII. The inelastic thresholds of some fissile materials
like <sup>235</sup>U and <sup>239</sup>Pu are on the order of 10 keV;
however, with the exception of highly enriched fast systems, these
inelastic reactions usually contribute a negligible amount to the
overall scattering source. CENTRM assumes that continuum inelastic
scatter is isotropic in the laboratory system, while discrete level
inelastic scatter is isotropic in the <em>center of mass</em> (CM) coordinate
system.</p>
<p>Over a broad energy range, <em>elastic</em> scatter from most moderators can
usually be assumed isotropic
(<em>s</em>-wave) in the neutron-nucleus CM coordinate system. In the case of
hydrogen, this is true up to approximately 13 MeV; for carbon up to
2 MeV; and for oxygen up to 100 keV. However, it is well known that
isotropic CM scatter does not result in isotropic scattering in the
laboratory system. For <em>s‑</em>wave elastic scatter the average
scatter-cosine in the laboratory system is given by: <span class="math notranslate nohighlight">\(\bar{\mu}_{0}=0.667 / \mathrm{~A};^{3}\)</span> where
“A” is the mass number (in neutron mass units) of the scattering
material. This relation indicates that <em>s</em>-wave, elastic scattering
from low A materials tends to be more anisotropic in the laboratory,
and that the laboratory scattering distribution approaches isotropic
<span class="math notranslate nohighlight">\(\left(\bar{\mu}_{0}=0 ; \theta_{0}=90\right)\)</span> as A becomes large. For example, the <span class="math notranslate nohighlight">\(\bar{\mu}_{0}\)</span>
of hydrogen
is 0.667 (48.2°); while it is about 0.042 (87.6°) for oxygen. Because
<em>s</em>‑wave scattering from heavy materials is nearly isotropic in the
laboratory system, the differential scattering cross section (and thus
the scattering source) can usually be expressed accurately by a low
order Legendre expansion. On the other hand light moderators like
hydrogen may require more terms—depending on the flux anisotropy—to
accurately represent the elastic scatter source in the laboratory
system. The default settings in CENTRM are to use P0 (isotropic lab
scatter) for mass numbers greater than A=100, and P1 for lighter
masses.</p>
<p>An analytical expression can be derived for the cross-section moments in
the case of two-body reactions, such as elastic and discrete-level
inelastic scattering from “stationary” nuclei. Stationary here implies
that the effect of nuclear motion on neutron scattering kinematics is
neglected.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The stationary nucleus approximation for treating
scattering kinematics does not imply that the effect of nuclear motion
on Doppler broadening of resonance cross sections is ignored, since this
effect is included in the PW cross-section data.</p>
</div>
<p>In CENTRM the stationary nucleus approximation is applied above the
thermal cutoff, typically around 3-5 eV, but is not valid for low energy
neutrons. CENTRM has the capability to perform a PW transport
calculation in the thermal energy range using tabulated thermal
scattering law data for bound molecules, combined with the analytical
free-gas kernel for other materials. In this case the cross-section
moments appearing in <a class="reference internal" href="#equation-eq7-4-3">(295)</a>  include upscattering effects. The expressions
used in CENTRM to compute the PW scatter source moments in the thermal
range are given in <a class="reference internal" href="#id30"><span class="std std-ref">The Boltzmann equation within the PW range</span></a>.</p>
<p>The following two sections discuss the evaluation of the scatter source
moments for epithermal elastic and inelastic reactions, respectively.</p>
<div class="section" id="epithermal-elastic-scatter">
<span id="id11"></span><h4>Epithermal Elastic Scatter<a class="headerlink" href="#epithermal-elastic-scatter" title="Permalink to this headline">¶</a></h4>
<p>Consider a neutron with energy E′, traveling in a direction Ω′, that
scatters elastically from an arbitrary material “j,” having a
mass A<sup>(j)</sup> in neutron-mass units. Conservation of kinetic energy
and momentum requires that there be a unique relation between the angle
that the neutron scatters (relative to the initial direction) and its
final energy E after the collision. If the nucleus is assumed to be
stationary in the laboratory coordinate system, then the
cosine (μ<sub>0</sub>) of the scatter angle (θ<sub>0</sub>) measured in the
laboratory system, as a function of the initial and final energies, is
found to be</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-9">
<span class="eqno">(301)<a class="headerlink" href="#equation-eq7-4-9" title="Permalink to this equation">¶</a></span>\[\mu_{0} \equiv \Omega^{\prime} \cdot \Omega=\mathrm{G}^{(\mathrm{j})}\left(\mathrm{E}^{\prime}, \mathrm{E}\right) ,\]</div>
<p>where the kinematic correlation function G relating E′, E, and
μ<sub>0</sub> for elastic scatter is equal to</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-10">
<span class="eqno">(302)<a class="headerlink" href="#equation-eq7-4-10" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{array}{l}
\mathrm{G}^{(\mathrm{j})}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)=\mathrm{a}_{1}^{(\mathrm{j})} \times\left[\mathrm{E} / \mathrm{E}^{\prime}\right]^{\frac{1}{2}}-\mathrm{a}_{2}^{(\mathrm{j})} \times\left[\mathrm{E}^{\prime} / \mathrm{E}\right]^{\frac{1}{2}} \\
\text { and } \mathrm{a}_{1}^{(\mathrm{j})}=\left(\mathrm{A}^{(\mathrm{j})}+1\right) / 2 \quad ; \quad \mathrm{a}_{2}^{(\mathrm{j})}=\left(\mathrm{A}^{(\mathrm{j})}-1\right) / 2
\end{array} .\end{split}\]</div>
<p>The final energy E of an elastically scattered neutron is restricted to
the range,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-11">
<span class="eqno">(303)<a class="headerlink" href="#equation-eq7-4-11" title="Permalink to this equation">¶</a></span>\[\alpha^{(j)} E^{\prime} \leq E \leq E^{\prime}\]</div>
<p>where α<sup>(j)</sup> =  maximum fractional energy lost by elastic scatter</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-12">
<span class="eqno">(304)<a class="headerlink" href="#equation-eq7-4-12" title="Permalink to this equation">¶</a></span>\[= \left[\mathrm{a}_{2}^{(\mathrm{j})} / \mathrm{a}_{1}^{(\mathrm{j})}\right]^{2}\]</div>
<p>The corresponding range of scattered neutrons in terms of lethargy is equal to</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-13">
<span class="eqno">(305)<a class="headerlink" href="#equation-eq7-4-13" title="Permalink to this equation">¶</a></span>\[\mathrm{u}^{\prime} \leq \mathrm{u} \leq \mathrm{u}^{\prime}+\varepsilon^{(\mathrm{j})}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-14">
<span class="eqno">(306)<a class="headerlink" href="#equation-eq7-4-14" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{aligned}
\mathrm{u}, \mathrm{u}^{\prime} &amp;=\mathrm{u}(\mathrm{E}), \mathrm{u}^{\prime}\left(\mathrm{E}^{\prime}\right)=\text { lethargies corresponding to } \mathrm{E} \text { and } \mathrm{E}^{\prime}, \text { respectively; and } \\
\varepsilon^{(\mathrm{j})} &amp;=\text { maximum increase in lethargy, per elastic scatter }=\ln \left[1 / \alpha^{(j)}\right]
\end{aligned}\end{split}\]</div>
<p>The double-differential scatter kernel of nuclide j (per unit lethargy
and solid angle) for <em>s-</em>wave elastic scatter of neutrons from
stationary nuclei, is equal to</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-15">
<span class="eqno">(307)<a class="headerlink" href="#equation-eq7-4-15" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{aligned}
\Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u} ; \mu_{0}\right) &amp;=\frac{\mathrm{E} \Sigma^{(\mathrm{i})}\left(\mathrm{u}^{\prime}\right)}{\mathrm{E}^{\prime}\left(1-\alpha^{(\mathrm{j})}\right)} \delta\left[\mu_{0}-\mathrm{G}^{(\mathrm{j})}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)\right], \text { for } \mathrm{u}^{\prime} \leq \mathrm{u} \leq \mathrm{u}^{\prime}+\varepsilon^{(\mathrm{j})} \\
&amp;=0 \quad \mathrm{u}&lt;\mathrm{u}^{\prime} \text { or } \mathrm{u}&gt;\mathrm{u}^{\prime}+\varepsilon^{(\mathrm{j})}
\end{aligned}\end{split}\]</div>
<p>The presence of the Dirac delta function completely correlates the angle
of scatter and the values of the initial and final energies.
Substituting the double differential cross-section expression from <a class="reference internal" href="#equation-eq7-4-15">(307)</a>
into <a class="reference internal" href="#equation-eq7-4-3">(295)</a>  gives the single-differential Legendre moments of the
cross section, per final lethargy:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-16">
<span class="eqno">(308)<a class="headerlink" href="#equation-eq7-4-16" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{aligned}
\Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) &amp;=\frac{\mathrm{E} \mathrm{P}\left[\mathrm{G}^{(\mathrm{j})}\right] \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right)}{\mathrm{E}^{\prime}\left(1-\alpha^{(\mathrm{j})}\right)}, \text { for } \mathrm{u}^{\prime} \leq \mathrm{u} \leq \mathrm{u}^{\prime}+\varepsilon^{(\mathrm{j})} \\
&amp;=0 \quad \mathrm{u}^{\prime} \text { or } \mathrm{u}&gt;\mathrm{u}^{\prime}+\varepsilon^{(\mathrm{j})}
\end{aligned}\end{split}\]</div>
<p>where P<sub>ℓ</sub> = Legendre polynomial evaluated at argument
G<sup>(j)</sup> equal to the scatter cosine.</p>
<p>When the above expressions are used in <a class="reference internal" href="#equation-eq7-4-5">(297)</a> , the following is obtained
for the ℓk moment of the epithermal elastic scattering source at
lethargy u:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-17">
<span class="eqno">(309)<a class="headerlink" href="#equation-eq7-4-17" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}(\mathrm{u})=\sum_{\mathrm{j}} \int_{\left.\mathrm{u}-\varepsilon^{(\mathrm{i}}\right)}^{\mathrm{u}} \mathrm{S}_{\mathrm{k}}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{du}^{\prime}=\sum_{\mathrm{j}} \int_{\mathrm{u}-\varepsilon^{(j)}}^{\mathrm{u}} \frac{\mathrm{E} \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{P}\left[\mathrm{G}^{(\mathrm{j})}\right]}{\mathrm{E}^{\prime}\left(1-\alpha^{(\mathrm{j})}\right)} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \mathrm{du}^{\prime} .\]</div>
</div>
<div class="section" id="epithermal-inelastic-scatter">
<span id="id12"></span><h4>Epithermal Inelastic Scatter<a class="headerlink" href="#epithermal-inelastic-scatter" title="Permalink to this headline">¶</a></h4>
<p>If the input value of DEMAX is set above the inelastic threshold of some
materials in the problem, then inelastic scattering can occur in the
PW range. The pointwise transport calculation may optionally include
discrete-level and continuum inelastic reactions in computing the
PW scatter source moments. The multigroup calculations always consider
inelastic reactions.</p>
<p>Discrete-level inelastic reactions are two-body interactions, so that
kinematic relations can be derived relating the initial and final
energies and the angle of scatter. It can be shown that the kinematic
correlation function for discrete-level inelastic scatter can be written
in a form identical to that for elastic scatter by redefining the
parameter a<sub>1</sub> in <a class="reference internal" href="#equation-eq7-4-10">(302)</a>  to be the energy dependent function <a class="bibtex reference internal" href="#williams-submoment-2000" id="id13">[Wil00]</a>,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-18">
<span class="eqno">(310)<a class="headerlink" href="#equation-eq7-4-18" title="Permalink to this equation">¶</a></span>\[\mathrm{a}_{1}^{(\mathrm{~m}, \mathrm{j})} = \frac{\left(\mathrm{A}^{(\mathrm{j})}+1\right)}{2}+\frac{\left(-\mathrm{Q}^{(\mathrm{m}, \mathrm{j})}\right) \mathrm{A}^{(\mathrm{j})}}{2 \mathrm{E}}\]</div>
<p>The parameter Q<sup>(m, j)</sup> is the Q-value for the m<sub>th</sub> level
of nuclide “j”. The Q value is negative for inelastic scattering, while
it is zero for elastic scatter. The threshold energy in the laboratory
coordinate system is proportional to the Q-value of the inelastic level,
and is given by:</p>
<div class="math notranslate nohighlight">
\[\mathrm{E}_{\mathrm{T}}^{(\mathrm{m}, \mathrm{j})}=\frac{\mathrm{A}^{(\mathrm{j})}+1}{\mathrm{~A}^{(\mathrm{j})}} \times\left(-\mathrm{Q}^{(\mathrm{m}, \mathrm{j})}\right)\]</div>
<p>The range of energies that can contribute to the scatter source at E,
due to inelastic scatter from the m<sub>th</sub> level of nuclide j is
defined to be [E:sub:<cite>L</cite> , E:sub:<cite>H</cite> ], where
E<sub>H</sub> &gt;E:sub:<cite>L</cite> &gt;E:sub:<cite>T</cite> . This energy range has a
corresponding lethargy range of [u:sub:<cite>LO</cite> , u:sub:<cite>HI</cite> ] which is
equal to,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\mathrm{u}_{\mathrm{LO}}=\mathrm{u}-\ln \left(\frac{1}{\alpha_{1}^{(\mathrm{j})}\left(\mathrm{E}_{\mathrm{H}}\right)}\right)=\mathrm{u}-\varepsilon_{1}^{(\mathrm{j})} \\
\mathrm{u}_{\mathrm{HI}}=\mathrm{u}-\ln \left(\frac{1}{\alpha_{2}^{(\mathrm{j})}\left(\mathrm{E}_{\mathrm{L}}\right)}\right)=\mathrm{u}-\varepsilon_{2}^{(\mathrm{j})}
\end{array}\end{split}\]</div>
<p>The energy-dependent alpha parameters in the above expressions are defined as,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\alpha_{1}(\mathrm{E})=\left(\frac{\mathrm{A} \Delta^{(\mathrm{m}, \mathrm{j})}(\mathrm{E})-1}{\mathrm{~A}+1}\right)^{2} \\
\alpha_{2}(\mathrm{E})=\left(\frac{\mathrm{A} \Delta^{(\mathrm{m}, \mathrm{j})}(\mathrm{E})+1}{\mathrm{~A}+1}\right)^{2}
\end{array}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-19">
<span class="eqno">(311)<a class="headerlink" href="#equation-eq7-4-19" title="Permalink to this equation">¶</a></span>\[\Delta^{(\mathrm{m}, \mathrm{j})}(\mathrm{E})=\sqrt{1-\frac{\mathrm{E}_{\mathrm{T}}^{(\mathrm{m}, \mathrm{j})}}{\mathrm{E}}}\]</div>
<p>Modifying the epithermal elastic scatter source in <a class="reference internal" href="#equation-eq7-4-17">(309)</a>  to include
discrete-level inelastic scatter gives the following expression</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-20">
<span class="eqno">(312)<a class="headerlink" href="#equation-eq7-4-20" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}(\mathrm{u})=\sum_{m, j} \int_{u_{L O}}^{u_{H I}} \frac{\mathrm{E}}{\mathrm{E}^{\prime}} \frac{\Sigma^{(\mathrm{m}, \mathrm{j})}\left(\mathrm{E}^{\prime}\right) \mathrm{P}\left[\mathrm{G}^{(\mathrm{m}, \mathrm{j})}\right]}{\left(1-\alpha^{j}\right) \Delta^{(\mathrm{m}, \mathrm{j})}\left(\mathrm{E}^{\prime}\right)} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \mathrm{d} u^{\prime}\]</div>
<p>Detailed expressions for the lethargy limits are given in <a class="bibtex reference internal" href="#williams-submoment-2000" id="id14">[Wil00]</a>. Since
Δ<sup>(m,j)</sup> is equal to unity for elastic scatter, the above
equation reduces to <a class="reference internal" href="#equation-eq7-4-14">(306)</a> if there is no discrete-level inelastic
contribution.</p>
<p>At high energies, the inelastic levels of the nucleus become a
continuum. In this case CENTRM represents the energy distribution of the
scattered neutrons by an evaporation spectrum with an isotropic angular
distribution in the lab system; thus, only the P<sub>0</sub> moment
appears in the continuum inelastic scattering source. Including
continuum inelastic reactions in the PW calculation usually has a small
impact on the spectrum used for resonance self-shielding, and may
adversely impact the computer memory requirements and execution time.
Therefore, by default, CENTRM does not include continuum inelastic
reactions in the pointwise solution; however, it is always included in
the UMR solution.</p>
</div>
<div class="section" id="thermal-scatter">
<span id="id15"></span><h4>Thermal Scatter<a class="headerlink" href="#thermal-scatter" title="Permalink to this headline">¶</a></h4>
<p>Since thermal neutrons have energies comparable to the mean kinetic
energy of molecules in thermal equilibrium, the scattering kernels must
account for molecular motion. The scatter moments include both
downscatter as well as upscatter contributions; hence, the integration
limits appearing in <a class="reference internal" href="#equation-eq7-4-17">(309)</a>  must be extended from the lowest to the highest
energy of the thermal range. Furthermore the cross-section moments
correspond to the Legendre expansion coefficients of the thermal scatter
kernel, which has a substantially different form than the epithermal
kernel discussed in the previous two sections. In general the
ℓ<sub>th</sub> Legendre moment of the thermal scattering kernel at
temperature T, describing scattering from E to E′, is given by</p>
<div class="math notranslate nohighlight">
\[\sigma \quad\left(\mathrm{E}^{\prime} \rightarrow \mathrm{E} ; \mathrm{T}\right)=\frac{\sigma_{b}}{T} \sqrt{\frac{\mathrm{E}}{\mathrm{E}^{\prime}}} e^{-\frac{\beta\left(\mathrm{E}^{\prime} \rightarrow \mathrm{E}\right)}{2}} \int \mathrm{P}\left(\mu_{0}\right) \mathrm{S}[\alpha, \beta ; T] \quad d \mu_{0}\]</div>
<p>where β(E′→E) and α(E′,E,μ<sub>0</sub>) are dimensionless variables
(functions of temperature) defining the energy and momentum exchange,
respectively, of the collision <a class="bibtex reference internal" href="PMC.html#bell-nuclear-1970" id="id16">[BG70]</a>; σ<sub>b</sub> is the rigidly
bound scatter cross section, which is proportional to the free atom
cross section; and S(α, β; T) describes the temperature-dependent
thermal scattering law.</p>
<p>If atomic bonding effects are neglected, the atoms of a material behave
like a gas in thermal equilibrium at the temperature of the medium. In
this case S(α, β) can be expressed by an analytical function. CENTRM
uses the free gas model for all nuclides except those materials that
have thermal scattering laws available in the ENDF/B nuclear data files.
The ENDF/B scattering law data account for the effects of molecular
bonding and possible polyatomic crystalline structure. While free-gas
kernels are computed internally in CENTRM, the kernel moments describing
bound thermal scatterers are stored in a data file that can be accessed
by CENTRM.</p>
</div>
<div class="section" id="bound-thermal-kernels">
<span id="id17"></span><h4>Bound thermal kernels<a class="headerlink" href="#bound-thermal-kernels" title="Permalink to this headline">¶</a></h4>
<p>Thermal scattering from bound atoms is classified either as an
“inelastic reaction,” in which the neutron energy may change, or an
“elastic reaction,” in which the neutron changes direction, but does not
change energy. In ENDF/B the former reactions are treated as incoherent
inelastic scattering with a doubly differential kernel describing the
secondary neutron energy and angle distribution. The latter reactions
are usual treated as coherent elastic scatter characterized by
diffractive interference of the scattered deBroglie waves, although a
few materials are modeled by the incoherent elastic approximation.
Legendre moments for thermal elastic kernels describe the secondary
angular distribution with no energy exchange, at a given neutron energy.
Bound scatter kernels have been processed by the AMPX code system for
most of the ~25 compounds with thermal scatter laws in ENDF/B, and are
stored in individual kinematics files distributed with the SCALE code
system. These include materials such as: H in water, H and C in
polyethylene, H and Zr in ZrH, C in graphite, deuterium in heavy water,
Be metal, Be in BeO, etc. The CRAWDAD module processes scattering kernel
data for individual nuclides into a combined library used in CENTRM, and
also interpolates the kernels to the appropariate temperatures.</p>
<p>The bound scatter kernels are tabulated at different energy points from
the flux solution mesh; therefore it is necessary to map the data onto
the desired energy mesh in the CENTRM calculation. Because thermal
elastic scattering results in no energy loss, the elastic moments only
appear in the within-point term of the scattering source in the CENTRM
thermal calculation. Thus the coherent elastic data is easily
interpolated since it only involves a single energy index and
temperature. However, the incoherent inelastic moments are 2-D arrays in
terms of the initial and final energies, so that a 2-D interpolation
must be done for each temperature. CENTRM uses a simple type of
“unit-base transform” method to interpolate incoherent inelastic kernels
onto the flux solution mesh. The method attempts to preserve the
absolute peak of the secondary energy distribution, at given initial
energy. For water-bound hydrogen and several other moderators, this is
quite adequate, since the kernel generally has only a single maximum.
However, if more than one local extrema is present, such as for
graphite, the other local peaks are not explicitly preserved in the
interpolation method. For this reason it is necessary to include a
fairly dense set of initial energies in the tabulated kernels of
graphite and similar materials, to avoid gross changes in the kernel
shape at adjacent initial energy panels.</p>
<div class="section" id="free-gas-thermal-kernels">
<span id="id18"></span><h5>Free gas thermal kernels<a class="headerlink" href="#free-gas-thermal-kernels" title="Permalink to this headline">¶</a></h5>
<p>CENTRM computes free-gas kernels using the approach proposed by
Robinson <a class="bibtex reference internal" href="#robinson-notes-1981" id="id19">[Rob81]</a> as a modification to the original
FLANGE <a class="bibtex reference internal" href="#honeck-flange-ii-1971" id="id20">[HF71]</a> methodology.
Legendre moments of the free-gas scatter kernel per unit lethargy are
expressed as,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-21">
<span class="eqno">(313)<a class="headerlink" href="#equation-eq7-4-21" title="Permalink to this equation">¶</a></span>\[\Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right)=\mathrm{A}^{(\mathrm{j})} \Sigma_{\mathrm{free}}^{(\mathrm{j})} \frac{\mathrm{E}}{\mathrm{E}^{\prime}} \mathrm{e}^{-\beta / 2} \sum_{\mathrm{n}=0} \mathrm{W}_{\mathrm{n}} \mathrm{H}_{\mathrm{n}}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)\]</div>
<p>where W<sub>ℓn</sub> are constant coefficients associated with the
Legendre polynomial of order ℓ; Σ<sub>free</sub> is the constant free-atom
cross section for the material; and H<sub>n</sub> are the α-moments of the
free-gas scatter law, given as</p>
<div class="math notranslate nohighlight">
\[\mathrm{H}_{\mathrm{n}}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)=\frac{1}{\sqrt{\pi}} \int_{\alpha_{\mathrm{L}}}^{\alpha_{\mathrm{H}}} \alpha^{\mathrm{n}} \times\left(\frac{\mathrm{e}^{-\frac{\alpha^{2}+\beta^{2}}{4 \alpha}}}{2 \sqrt{\alpha}}\right) \mathrm{d} \alpha\]</div>
<p>The limits on the above integral correspond to:</p>
<div class="math notranslate nohighlight">
\[\alpha_{\mathrm{L}}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)=\alpha\left(\mathrm{E}^{\prime}, \mathrm{E}, \mu_{0}=-1\right) \quad \text { and } \quad \alpha_{\mathrm{H}}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)=\alpha\left(\mathrm{E}^{\prime}, \mathrm{E}, \mu_{0}=1\right) .\]</div>
<p>The alpha moments for n &gt; 0 can be evaluated very efficiently using a
recursive relation <a class="bibtex reference internal" href="#williams-submoment-2000" id="id21">[Wil00]</a>:</p>
<div class="math notranslate nohighlight">
\[\mathrm{H}_{\mathrm{n}}\left(\mathrm{E}^{\prime}, \mathrm{E}\right)=2(2 \mathrm{n}-1) \mathrm{H}_{\mathrm{n}-1}+\beta^{2} \mathrm{H}_{\mathrm{n}-2}-\left[\mathrm{F}_{\mathrm{n}}\left(\sqrt{\alpha_{\mathrm{H}}}, \beta\right)-\mathrm{F}_{\mathrm{n}}\left(\sqrt{\alpha_{\mathrm{L}}}, \beta\right)\right]\]</div>
<p>where F<sub>n</sub> is the function,</p>
<div class="math notranslate nohighlight">
\[\mathrm{F}_{\mathrm{n}}(\mathrm{t}, \beta)=\frac{\mathrm{t}^{2 \mathrm{n}-1} \mathrm{e}^{-\frac{1}{4}\left(\frac{\beta^{2}}{\mathrm{t}^{2}}+\mathrm{t}^{2}\right)}}{\sqrt{\pi} / 2}\]</div>
<p>Analytical expressions for the initial two moments,
H<sub>0</sub> and H:sub:` −1`, are given in <a class="bibtex reference internal" href="#robinson-notes-1981" id="id22">[Rob81]</a>.</p>
<p>The standard free-gas kernel is based on the assumption of a constant
free atom cross section. When averaged over the molecular velocity
distribution, this gives a 1/v variation in the effective free-gas
cross section at low energies. To approximately account for nuclear
structure effects on the energy dependence of the thermal cross section
(e.g., low energy resonances), the free-gas moments are multiplied by
the ratio σ<sub>s</sub>(E)/σ<sub>FG</sub>(E), where σ<sub>s</sub> is the
Doppler broadened scatter cross section processed from ENDF/B data; and
σ<sub>FG</sub> is the effective free-gas cross section,</p>
<div class="math notranslate nohighlight">
\[\sigma_{\mathrm{FG}}\left(\mathrm{E}^{\prime}\right)=\frac{\sigma_{\mathrm{free}}}{\mathrm{y}^{2}}\left[\left(\mathrm{y}^{2}+1 / 2\right) \operatorname{erf}(\mathrm{y})+\frac{\mathrm{y} \mathrm{e}^{-\mathrm{y}^{2}}}{\sqrt{\pi}}\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{y}^{2}=\mathrm{~A} \frac{\mathrm{E}}{\mathrm{kT}}\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="sub-moment-expansion-of-the-epithermal-scattering-source">
<span id="id23"></span><h3>Sub-moment expansion of the epithermal scattering source<a class="headerlink" href="#sub-moment-expansion-of-the-epithermal-scattering-source" title="Permalink to this headline">¶</a></h3>
<p>One difficulty in computing the epithermal scatter source moments is
that the Legendre polynomial in the integrand of <a class="reference internal" href="#equation-eq7-4-17">(309)</a>  and <a class="reference internal" href="#equation-eq7-4-20">(312)</a> is a function
of both the initial and final lethargy (or energy) of the scattered
neutrons, due to the correlation function G<sup>(j)</sup>(E,E′). At each
lethargy u this requires that the u′-integral be recomputed over all
lower lethargies, for every nuclide and moment. A more efficient
algorithm would be possible if the differential scattering moments
appearing in the integrand could be factored into a product of a
function of u multiplied by a function of u′ such as</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-22">
<span class="eqno">(314)<a class="headerlink" href="#equation-eq7-4-22" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right)=\mathrm{F}^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \quad \mathrm{H}^{(\mathrm{j})}(\mathrm{u})\]</div>
<p>where F and H are the two factors (to be specified later).</p>
<p>If this is done, the u-function can be factored from the scatter source
integrals, leaving only integrals over the u′-function as shown below:</p>
<div class="math notranslate nohighlight">
\[\mathrm{S}^{(\mathrm{j})}(\mathrm{u})=\int_{\mathrm{u}^{\prime}} \mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{du}^{\prime}=\mathrm{H}^{(\mathrm{j})}(\mathrm{u}) \int_{\mathrm{u}^{\prime}} \mathrm{F}^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{du}^{\prime}\]</div>
<p>Because the factored integrand does not depend on the variable u, a
running summation over all u′ points can be accumulated and saved as the
calculation sweeps from low to high lethargy. For example, note that the
ℓ = 0 moment in <a class="reference internal" href="#equation-eq7-4-17">(309)</a> is already separable into a product of u times u′
because P<sub>0</sub> is equal to one at all values of G. Thus the
isotropic component of the elastic differential scatter rate (per unit
lethargy) from u′ to u is proportional to E/E′, where</p>
<div class="math notranslate nohighlight">
\[\mathrm{E}=\mathrm{E}(\mathrm{u})=\mathrm{E}_{\mathrm{ref}} \mathrm{e}^{-\mathrm{u}}, \quad \text { and } \quad \mathrm{E}^{\prime}=\mathrm{E}^{\prime}\left(\mathrm{u}^{\prime}\right)=\mathrm{E}_{\mathrm{ref}} \mathrm{e}^{-\mathrm{u}^{\prime}}\]</div>
<p>Therefore, the two separable factors in the lowest moment,
S<sup>(j)</sup><sub>0.0</sub>(u′→u), are identified as,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l}
\mathrm{H}(\mathrm{u})=\mathrm{E} /\left(1-\alpha^{(\mathrm{j})}\right), \quad \text { and } \\
\mathrm{F}\left(\mathrm{u}^{\prime}\right)=\Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \Psi_{00}\left(\mathrm{u}^{\prime}\right) / \mathrm{E}^{\prime}
\end{array}\end{split}\]</div>
<p>However, the higher order Legendre moments contain the term
P<sub>ℓ</sub>(G) in the integrand; and the expression for G(E′,E) is a
difference of two terms that depend on both E and E′. A new method
called a “sub‑moment expansion” has been developed for CENTRM that
allows the Legendre polynomials appearing in the differential scatter
moments to be factored into the desired separable form. Each spherical
harmonic moment of the scattering source appears expanded in a series of
factored “sub‑moments.”</p>
<p>The Legendre polynomial of order ℓ is a polynomial containing terms up
to the ℓ<sup>th</sup> power. Applying the binomial expansion theorem and
some algebraic manipulation, the standard expression for P<sub>ℓ</sub>
evaluated at “G” can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-23">
<span class="eqno">(315)<a class="headerlink" href="#equation-eq7-4-23" title="Permalink to this equation">¶</a></span>\[\mathrm{P}_{\ell}(\mathrm{G})=\frac{\mathrm{E}^{\prime}}{\mathrm{E}} \times \mathrm{a}_{1}^{\ell} \sum_{\mathrm{K}=-\ell}^{\ell} \tilde{\mathrm{g}}_{\ell, \mathrm{K}}(\mathrm{E}) \quad \mathrm{h}_{\mathrm{K}}(\mathrm{E}) \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right)\]</div>
<p>where h<sub>k</sub>(E)=E<sup>1+K/2</sup>; and the expansion coefficients
<span class="math notranslate nohighlight">\(\tilde{\mathrm{g}}_{\ell, \mathrm{k}}\)</span> are equal to,
<span class="math notranslate nohighlight">\(\tilde{\mathrm{g}}_{\ell \mathrm{K}}=\frac{\mathrm{g}_{\ell \mathrm{K}}}{N_{\ell} \times \alpha_{1}^{\ell}}\)</span>
where the g<sub>ℓ,K</sub> (no tilde)
parameters were defined in <a class="bibtex reference internal" href="PMC.html#williams-computation-1995" id="id24">[WA95]</a> to be:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-24">
<span class="eqno">(316)<a class="headerlink" href="#equation-eq7-4-24" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
&amp;\mathrm{g}_{, \mathrm{K}}=\frac{\left(1+(-1)^{+\mathrm{K}}\right)}{2} \sum_{K^{\prime}=0}^{\frac{-K}{2}}(-1)^{K^{\prime}} b_{2 K^{\prime}+K},\left(\begin{array}{r}
2 K^{\prime}+K \\
K^{\prime}
\end{array}\right) \quad a_{1}^{K+K^{\prime}} a_{2}^{K^{\prime}} ; \quad \text { for } \quad \mathrm{K} \geq 0\\
&amp;\text { and }\\
&amp;=\left(-a_{2} / a_{1}\right)^{|K|} \quad g_{,|K|} \quad ; \quad \text { for } \quad K&lt;0
\end{aligned}\end{split}\]</div>
<p>In <a class="reference internal" href="#equation-eq7-4-23">(315)</a> –<a class="reference internal" href="#equation-eq7-4-24">(316)</a>, the constants b<sub>m,ℓ</sub> and N<sub>ℓ</sub> are the standard
Legendre constants and normalization factors, respectively, which are
tabulated in <a class="reference internal" href="#tab7-4-1"><span class="std std-numref">Table 240</span></a> for orders through P<sub>7</sub>; and <span class="math notranslate nohighlight">\(\left(\begin{array}{c}
\mathrm{m} \\
\mathrm{i}
\end{array}\right)=\)</span>
the binomial expansion coefficients<sup>(20)</sup> <span class="math notranslate nohighlight">\(= \frac{\mathrm{m} !}{(\mathrm{m}-\mathrm{i}) ! \quad \mathrm{i} !}\)</span></p>
<span id="tab7-4-1"></span><table class="docutils align-center" id="id68">
<caption><span class="caption-number">Table 240 </span><span class="caption-text">Constants appearing in Legendre polynomials.</span><a class="headerlink" href="#id68" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab1.svg"><img alt="_images/tab1.svg" src="_images/tab1.svg" width="800" /></a>
</td>
</tr>
</tbody>
</table>
<p>The explicit dependence of the constants a<sub>1</sub> and a<sub>2</sub> on
the nuclide index j [see <a class="reference internal" href="#equation-eq7-4-10">(302)</a>] has been suppressed to simplify notation.
For discrete-level inelastic scatter the parameter a<sub>1</sub> is an
energy dependent function given by <a class="reference internal" href="#equation-eq7-4-18">(310)</a>, but for elastic scatter this
reduces to the constant in <a class="reference internal" href="#equation-eq7-4-10">(302)</a>. Note that the g<sub>ℓ,K</sub> value is zero unless ℓ and K are both
even or both odd, respectively, so that about half the terms appearing
in the summation of <a class="reference internal" href="#equation-eq7-4-23">(315)</a> vanish. <a class="reference internal" href="#tab7-4-2"><span class="std std-numref">Table 241</span></a> through <a class="reference internal" href="#tab7-4-4"><span class="std std-numref">Table 243</span></a> give values
for the submoment expansion coefficients for
several nuclides.</p>
<p>The sub-moment expansion of the scattering source, including both
elastic and discrete-level inelastic reactions, is obtained by
substituting the expansion of the Legendre polynomial from <a class="reference internal" href="#equation-eq7-4-23">(315)</a>  into
<a class="reference internal" href="#equation-eq7-4-21">(313)</a>, giving</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-25">
<span class="eqno">(317)<a class="headerlink" href="#equation-eq7-4-25" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}(\mathrm{u})=\sum_{m, j} \sum_{K=-} \mathrm{Z}_{, \mathrm{K}}^{(\mathrm{m}, \mathrm{j})}(\mathrm{E}) \mathrm{h}_{\mathrm{K}}(\mathrm{E}) \int_{u_{L O}^{(m, j)}}^{u_{H}^{(m, j)}} \psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{m}, \mathrm{j})}\left(\mathrm{E}^{\prime}\right) \frac{\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right)}{\Delta^{(\mathrm{m}, \mathrm{j})}\left(\mathrm{E}^{\prime}\right)} \mathrm{du}^{\prime}\]</div>
<p>where <span class="math notranslate nohighlight">\(Z_{\ell \mathrm{K}}^{(\mathrm{m}, \mathrm{j})}(E)=a_{1}^{\ell}(E) \frac{\tilde{g}_{\ell, K}^{(m, j)}(E)}{\left(1-\alpha^{(j)}\right)}\)</span>.
For elastic scatter, the Z coefficients are independent
of energy.</p>
<p>With this approach the scatter source moments in <a class="reference internal" href="#equation-eq7-4-26">(318)</a> have been further
expanded into a summation of “submoments” identified by index K
(although some of these terms are equal to zero, due to the behavior of
the g<sub>ℓ,K `coefficients). Each term has the desired factored
form expressed in :eq:`eq7-4-22</sub>; i.e., separable in terms of the variables u and
u′ with</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-26">
<span class="eqno">(318)<a class="headerlink" href="#equation-eq7-4-26" title="Permalink to this equation">¶</a></span>\[\mathrm{H}_{, \mathrm{K}}^{(\mathrm{j})}(\mathrm{u})=\mathrm{Z}_{, \mathrm{K}}^{(\mathrm{j})}(\mathrm{E}) \mathrm{h}_{\mathrm{K}}(\mathrm{E}), \quad \text { and } \quad \mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{)})}\left(\mathrm{u}^{\prime}\right)=\frac{\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right)}{\Delta^{(\mathrm{m}, \mathrm{j})}\left(\mathrm{E}^{\prime}\right)}\]</div>
<p>so that the lk<sub>th</sub> moment of the scatter source can be written
as</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-27">
<span class="eqno">(319)<a class="headerlink" href="#equation-eq7-4-27" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}(\mathrm{u})=\sum_{m, j} \sum_{K=-1} \mathrm{H}_{, \mathrm{K}}^{(\mathrm{j})}(\mathrm{u}) \int_{\left.\mathrm{u}_{\mathrm{LO}}^{(\mathrm{m}, \mathrm{j}}\right)}^{\mathrm{u}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{m}, \mathrm{j})}} \mathrm{F}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}\]</div>
<div class="section" id="characteristics-and-properties-of-the-sub-moment-expansion">
<span id="id25"></span><h4>Characteristics and Properties of the Sub-Moment Expansion<a class="headerlink" href="#characteristics-and-properties-of-the-sub-moment-expansion" title="Permalink to this headline">¶</a></h4>
<p>The expansion in <a class="reference internal" href="#equation-eq7-4-23">(315)</a> becomes numerically unstable for heavy nuclides
(large A), with high Legendre orders. Using double precision arithmetic,
it was found that the accuracy of the expansion begins to break down for
heavy nuclides (A100) if the order of scatter exceeds P<sub>5</sub>;
although the expansion for lighter nuclides (viz, moderators) is very
accurate even for scattering orders as high as P<sub>7</sub> or more. For
this reason CENTRM has an option to restrict the Legendre expansion to
lower orders for heavy masses, while using the input value of “ISCT” for
lighter nuclides. The restricted Legendre order and mass cut-off value
can be controlled by user input, but the default is P<sub>0</sub> (i.e.,
isotropic lab scattering) for A&gt;100. <a class="reference internal" href="#tab7-4-5"><span class="std std-numref">Table 244</span></a> shows the maximum error
observed in the series representation of Legendre polynomials up to
P<sub>5</sub>, for selected mass numbers. These values were obtained by
evaluating the series expansion for P<em>ℓ</em>(G(x)) in <a class="reference internal" href="#equation-eq7-4-23">(315)</a>, and
comparing to the exact value computed at 11 equally spaced values for
E/E′. The observed error in the P<sub>5</sub> polynomial expansion is &lt; 1%
even for heavy materials such as <sup>238</sup>U, while nuclides whose
mass is &lt; 100 are computed nearly exactly by the expansion.</p>
<p>Although the accuracy of the submoment expansion is good through
P<sub>7</sub> scattering in moderators, Legendre expansions above P3 are
not recommended because the number of terms in the expansion increases
rapidly with increasing scattering order, especially for 2D MoC and 1D
cylindrical systems. The number of spherical harmonic moments appearing
in the scattering source depends on the order (L=ISCAT) of the Legendre
expansion used to represent the differential scatter cross section, as
well as on the type of geometry (slab, spherical, cylindrical, or 2D
MoC) used in the transport calculation. The submoment method further
expands each source moment. <a class="reference internal" href="#tab7-4-6"><span class="std std-numref">Table 245</span></a> shows the number of moments in
the cross-section expansion, and the number of moments and submoments in
the scatter source expansion, as a function of scatter order and
geometry type. Although the use of cumulative integrals discussed below
allows the sub-moments to be evaluated rapidly, the large number of
terms becomes prohibative for high scattering orders. Fortunately a
P<sub>1</sub> Legendre order is sufficient for most self-shielding
calculations, and orders beyond P<sub>2</sub> should seldom be required
for reactor physics and criticality applications.</p>
<span id="tab7-4-2"></span><table class="docutils align-center" id="id69">
<caption><span class="caption-number">Table 241 </span><span class="caption-text">Coefficients in expansion of Pℓ[G(x)]* for hydrogen (A = 1).</span><a class="headerlink" href="#id69" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab2.svg"><img alt="_images/tab2.svg" src="_images/tab2.svg" width="600" /></a>
</td>
</tr>
</tbody>
</table>
<span id="tab7-4-3"></span><table class="docutils align-center" id="id70">
<caption><span class="caption-number">Table 242 </span><span class="caption-text">Coefficients in expansion on Pℓ[G(x)]* for oxygen (A = 16).</span><a class="headerlink" href="#id70" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab3.svg"><img alt="_images/tab3.svg" src="_images/tab3.svg" width="600" /></a>
</td>
</tr>
</tbody>
</table>
<span id="tab7-4-4"></span><table class="docutils align-center" id="id71">
<caption><span class="caption-number">Table 243 </span><span class="caption-text">Coefficients in expansion of Pℓ[G(x)]* for U-238 (A = 236).</span><a class="headerlink" href="#id71" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab4.svg"><img alt="_images/tab4.svg" src="_images/tab4.svg" width="600" /></a>
</td>
</tr>
</tbody>
</table>
<span id="tab7-4-5"></span><table class="docutils align-center" id="id72">
<caption><span class="caption-number">Table 244 </span><span class="caption-text">Fractional error <sup>(1)</sup> in series expansion [Eq. (F18.2.25)] of Legendre polynomials.</span><a class="headerlink" href="#id72" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab5.svg"><img alt="_images/tab5.svg" src="_images/tab5.svg" width="600" /></a>
</td>
</tr>
</tbody>
</table>
<span id="tab7-4-6"></span><table class="docutils align-center" id="id73">
<caption><span class="caption-number">Table 245 </span><span class="caption-text">Number of moments and submoments as function of scattering order.</span><a class="headerlink" href="#id73" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/tab5.svg"><img alt="_images/tab5.svg" src="_images/tab5.svg" width="600" /></a>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scattering-moments-expressed-with-cumulative-integral-operator">
<span id="id26"></span><h4>Scattering moments expressed with cumulative integral operator<a class="headerlink" href="#scattering-moments-expressed-with-cumulative-integral-operator" title="Permalink to this headline">¶</a></h4>
<p>It will be convenient to express the scatter source moments in terms of
an integral operator <span class="math notranslate nohighlight">\(\mathbb{C}\)</span>, designated here as the “cumulative integral.” The
domain of this operator is the vector space of all integrable lethargy
functions. The operator is defined for an arbitrary domain element
f(u’), at an arbitrary lethargy limit U, to be:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-28">
<span class="eqno">(320)<a class="headerlink" href="#equation-eq7-4-28" title="Permalink to this equation">¶</a></span>\[\mathbb{C}(\mathrm{f} ; \mathrm{U})=\int_{\mathrm{u}_{0}}^{\mathrm{U}} \mathrm{f}\left(\mathrm{u}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}\]</div>
<p>where u<sub>0</sub> is an arbitrary reference point. In implementing this
method in CENTRM, it is convenient to set u<sub>0</sub>=u<sub>L</sub>;
i.e., the negative lethargy value corresponding to highest energy of the
transition range.</p>
<p>The cumulative integral at some lethargy mesh point u<sub>n</sub> is
related to the value at the previous lethargy mesh point u<sub>n−1</sub>
by the expression</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-29">
<span class="eqno">(321)<a class="headerlink" href="#equation-eq7-4-29" title="Permalink to this equation">¶</a></span>\[f\left(\text{f} ; \text{u}_{n}\right) = f\left(\text{f} ; \text{u}_{n-1}\right)+\int_{u_{n-1}}^{u_{n}} f\left(u^{\prime}\right) d u^{\prime}\]</div>
<p>where u<sub>n</sub> &gt; u<sub>n−1</sub>.</p>
<p>Note that only <em>a single panel of integration</em> over the interval
[u<sub>n−1</sub>, u<sub>n</sub>] must be performed to update the cumulative
integrals.</p>
<p>The sub-moment expansion of the scatter source in <a class="reference internal" href="#equation-eq7-4-25">(317)</a> can be expressed
in terms of the cumulative integral operator as follows:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-30">
<span class="eqno">(322)<a class="headerlink" href="#equation-eq7-4-30" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}(\mathrm{u})=\sum_{j} \sum_{K=-} \mathrm{H}_{, \mathrm{K}}^{(\mathrm{j})}(\mathrm{u}) \times\left[\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; u_{H I}^{(m, j)}\right)-\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; u_{L O}^{(m, j)}\right)\right]\]</div>
<p>For elastic scatter the value of <span class="math notranslate nohighlight">\(\mathrm{u}_{\mathrm{LO}}^{(\mathrm{m}, \mathrm{j})}\)</span> is equal to (u−ε<sup>(j)</sup>),
and <span class="math notranslate nohighlight">\(\mathrm{u}_{\mathrm{HI}}^{(\mathrm{m}, \mathrm{j})}\)</span> is equal to u.</p>
</div>
</div>
<div class="section" id="multigroup-boltzmann-equation">
<span id="id27"></span><h3>Multigroup Boltzmann equation<a class="headerlink" href="#multigroup-boltzmann-equation" title="Permalink to this headline">¶</a></h3>
<p>The MG form of the transport equation used in the UMR and LMR is derived
by integrating <a class="reference internal" href="#equation-eq7-4-1">(293)</a>  over the energy intervals defined by the group
structure in the MG library. Details concerning the MG transport
equation, including its solution using the discrete ordinates method,
can be found in the SCALE documentation of XSDRNPM. The CENTRM MG
solution is similar to the XSDRNPM method: however; the outer iteration
loop in CENTRM is limited to the thermal groups, since no eigenvalue
calculation is performed in CENTRM. The MG scatter source in the thermal
range has upscatter contributions that depend on group fluxes from lower
energy groups in the LMR, so that outer iterations are performed over
thermal groups in the LMR until the upscatter portion of the MG scatter
source converges.</p>
<div class="section" id="multigroup-data-for-centrm-calculation">
<span id="id28"></span><h4>Multigroup data for CENTRM calculation<a class="headerlink" href="#multigroup-data-for-centrm-calculation" title="Permalink to this headline">¶</a></h4>
<p>Group cross-section data for the MG calculations are taken from the
input MG library which should include a combined 2D transfer matrix
representing all pertinent scatter reactions (viz, elastic, inelastic,
coherent and incoherent thermal reactions, n-2n, etc). MG cross sections
also should be problem-dependent values. This is done by processing the
data with BONAMI prior to the CENTRM calculation. BONAMI converts the
problem-independent cross-sections into problem-dependent values by
using the Bondarenko factors on the MG library.</p>
</div>
<div class="section" id="conversion-of-multigroup-fluxes-to-pseudo-pointwise-values">
<span id="id29"></span><h4>Conversion of multigroup fluxes to pseudo-pointwise values<a class="headerlink" href="#conversion-of-multigroup-fluxes-to-pseudo-pointwise-values" title="Permalink to this headline">¶</a></h4>
<p>The MG flux solution provides the integrated flux over lethargy, for
each group interval. The average flux within a group is assumed to
approximate the value of the flux per unit lethargy at the midpoint
lethargy of the group; thus a set of “pseudo-pointwise” angular fluxes
and moments can be obtained for the NG<sub>U</sub> and NG<sub>L</sub> mesh
points in the UMR and LMR, respectively. For lethargy point u<sub>n</sub>
, corresponding to the midpoint lethargy of group g contained within the
LMR and UMR, a PW flux value is computed from the expression,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-31">
<span class="eqno">(323)<a class="headerlink" href="#equation-eq7-4-31" title="Permalink to this equation">¶</a></span>\[\Psi\left(\mathrm{u}_{\mathrm{n}}\right)=\Psi_{\mathrm{g}} / \Delta \mathrm{u}_{\mathrm{g}}\]</div>
<p>where Δu<sub>g</sub> is the lethargy width of group g. <a class="reference internal" href="#equation-eq7-4-31">(323)</a> provides
PW flux values for lethargy mesh points,</p>
<div class="math notranslate nohighlight">
\[\mathrm{u}_{1} \ldots \mathrm{u}_{\mathrm{NGU},} \quad \text { and } \quad \mathrm{u}_{\mathrm{NGU}+\mathrm{NP}+1} \cdots \ldots \mathrm{u}_{\mathrm{NT}}\]</div>
<p>A linear variation of the flux per unit lethargy is assumed between
lethargy points to obtain a continuous representation in the UMR and
LMR.</p>
</div>
</div>
<div class="section" id="the-boltzmann-equation-within-the-pw-range">
<span id="id30"></span><h3>The Boltzmann equation within the PW range<a class="headerlink" href="#the-boltzmann-equation-within-the-pw-range" title="Permalink to this headline">¶</a></h3>
<p>In contrast to the “pseudo-pointwise” fluxes obtained from the MG
transport calculation, a true PW solution is performed for the
N<sub>P</sub> lethargy points between DEMAX and DEMIN. The PW solution is
performed within a loop over energy groups: i.e., for each of the
NG<sub>P</sub> groups in the PW range there is an additional loop over all
lethargy mesh points contained inside the group. This approach
facilitates coupling of the scatter source from the UMR to the PW range
and from the PW and LMR.</p>
<p>Evaluating <a class="reference internal" href="#equation-eq7-4-1">(293)</a> at each of the N<sub>P</sub> energy mesh-points in the
PW range gives a system of integro-differential equations that can be
solved to obtain the PW flux moments, per lethargy, for the
N<sub>P</sub> energy mesh points in the range DEMAX to DEMIN—which
correspond to the lethargy points, <span class="math notranslate nohighlight">\(\mathrm{U}_{\mathrm{NGU}+1}, \ldots \mathrm{U}_{\mathrm{NGU}+\mathrm{NP}}\)</span>.
Again linear variation of
the flux between lethargy points is assumed, to obtain a continuous
spectrum. Substituting <a class="reference internal" href="#equation-eq7-4-4">(296)</a> into <a class="reference internal" href="#equation-eq7-4-1">(293)</a>, the PW transport equation at mesh
point n is found to be,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-32">
<span class="eqno">(324)<a class="headerlink" href="#equation-eq7-4-32" title="Permalink to this equation">¶</a></span>\[\Omega \bullet \nabla \Psi_{\mathrm{n}}(\mathrm{r}, \Omega)+\Sigma_{\mathrm{t}, \mathrm{n}}(\mathrm{r}) \Psi_{\mathrm{n}}(\mathrm{r}, \Omega)=\sum_{\mathrm{k}} \frac{2+1}{2} \mathrm{Y}_{\mathrm{k}}(\Omega) \quad \mathrm{S}_{\mathrm{k}, \mathrm{n}}(\mathrm{r})+\mathrm{Q}_{\mathrm{n}}(\mathrm{r}, \Omega)\]</div>
<p>for <span class="math notranslate nohighlight">\(\mathrm{n}=\left(\mathrm{NG}_{\mathrm{U}}+1\right), \ldots .,\left(\mathrm{NG}_{\mathrm{U}}+\mathrm{N}_{\mathrm{P}}\right)\)</span></p>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\sum_{\mathrm{t}, \mathrm{n}}(\mathbf{r}) &amp;=\sum_{\mathrm{t}}\left(\mathbf{r}, \mathrm{u}_{\mathrm{n}}\right) \\
\Psi_{\mathrm{n}}(\mathbf{r}, \Omega) &amp;=\Psi\left(\mathbf{r}, \Omega, \mathrm{u}_{\mathrm{n}}\right) \\
\mathrm{S}_{\mathrm{k}, \mathrm{n}}(\mathbf{r}) &amp;=\mathrm{S}_{\mathrm{k}}\left(\mathbf{r}, \mathrm{u}_{\mathrm{n}}\right)
\end{aligned}\end{split}\]</div>
<p>Aside from the definition of the cross-section data, the above equation
appears identical in form to the MG transport equation, and can be
solved with virtually the same algorithm as the MG solution, once the
scatter source moments are determined. The same computer routines in
CENTRM calculate both the MG and PW fluxes. However, a major conceptual
difference between the PW and MG transport equations is that the PW
equation describes a differential neutron balance per unit lethargy <em>at
an energy point</em>, while the MG equation represents an integral balance
over an interval of lethargy points. Although this type of point
solution is not inherently conservative over the intervals defined by
the energy mesh, the particle balance for each interval has been found
to be very good. It should also be noted that exact particle
conservation is not a strict requirement for this type of application
where flux spectra rather than particle balances are primarily of
interest.</p>
<p>In the PW range the scatter source is composed of (a) MG-to-PW scatter
from the UMR and possibly upscatter from the LMR if the PW range extends
into thermal, and (b) PW-to-PW scatter from points in the PW range. The
submoment expansion method described previously is used in CENTRM to
provide an efficient method of evaluating the PW-to-PW downscatter
source for the epithermal range, which includes most of the resolved
resonances.</p>
<div class="section" id="scattering-sources-for-the-pw-range">
<span id="id31"></span><h4>Scattering sources for the PW range<a class="headerlink" href="#scattering-sources-for-the-pw-range" title="Permalink to this headline">¶</a></h4>
<p>In the case of elastic scatter from nuclide “j,” only the lethargy
interval below u<sub>n</sub> −ε<sup>(j)</sup> can scatter to a lethargy
point u<sub>n</sub> in the PW range. If u<sub>n</sub> −ε<sup>(j)</sup> is
negative, then some portion of the source at u<sub>n</sub> is due to
UMR-to-PW from energies above DEMAX, since zero-lethargy is equal to the
top energy of the PW range. Otherwise, the elastic source is entirely
PW-to-PW.</p>
<p>For any given nuclide j, the lowest lethargy in the UMR range that
contributes to the elastic scatter source in the PW range is equal to
−ε<sup>(j)</sup>. Let “jL” represent the lightest <em>non-hydrogen</em> nuclide
(i.e., having the smallest A value greater than unity) in the system.
The associated fractional energy loss for this material is indicated as
α<sub>L</sub>, so that the highest energy neutron in the UMR range that
can scatter into the PW range from an elastic collision with any
non-hydrogenous moderator will have an energy equal to
DEMAX/α<sub>L</sub>. The corresponding lethargy is equal to be the
negative value −ε<sup>(L)</sup>, or −ln(1/α<sub>L</sub>). The value of
−ε<sup>(L)</sup> is actually adjusted in CENTRM to coincide with the
immediately preceding multigroup boundary, which has a lethargy value
designated as u<sub>L</sub>. The interval of negative lethargy in the UMR
between u<sub>L</sub> and 0 has been defined previously to be transition
range, because the elastic slowing-down source from this interval
provides a transition between the UMR and PW solutions, respectively.
The transition range always contains an integer number of groups,
corresponding to MGTOP to MGHI. The total downscatter source from the
UMR to lethargy u<sub>n</sub> is composed of elastic and inelastic
contributions from the transition range between [u<sub>L</sub>,0]; and
contributions from the “<em>high</em>” energy range from lethargies below
u<sub>L</sub>. The high contribution comes from inelastic and hydrogen
elastic reactions in the energy interval above the transition range.</p>
<p>The downscatter source at u<sub>n</sub> in the PW range can thus be
expressed as the sum of three distinct contributions — S<sub>HI</sub>,
S<sub>Tr</sub>, and S<sub>PW</sub> —, that correspond to scatter from the
high region of the UMR, the transition region of the UMR, and the PW
ranges, respectively. The source moments appearing in <a class="reference internal" href="#equation-eq7-4-32">(324)</a>  can thus be
expressed as:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-33">
<span class="eqno">(325)<a class="headerlink" href="#equation-eq7-4-33" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{aligned}
\mathrm{S}_{\mathrm{k}, \mathrm{n}}(\mathrm{r}) &amp;=\mathrm{S}_{\mathrm{k}, \mathrm{HI}}\left(\mathrm{r}, \mathrm{u}_{\mathrm{n}}\right)+\mathrm{S}_{\mathrm{k}, \mathrm{Tr}}\left(\mathrm{r}, \mathrm{u}_{\mathrm{n}}\right)+\mathrm{S}_{\mathrm{k}, \mathrm{PR}}\left(\mathrm{r}, \mathrm{u}_{\mathrm{n}}\right) \\
&amp;=\int_{-\infty}^{\mathrm{u}_{\mathrm{L}}} \mathrm{S}_{\mathrm{k}}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{d} \mathrm{u}^{\prime}+\int_{\mathrm{u}_{\mathrm{L}}}^{0} \mathrm{S}_{\mathrm{k}}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{du}^{\prime}+\int_{0}^{\mathrm{u}_{\mathrm{n}}} \mathrm{S}_{\mathrm{k}}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{du}^{\prime}
\end{aligned}\end{split}\]</div>
</div>
<div class="section" id="downscatter-source-from-high-region-of-the-umr-to-the-pw-range-shi">
<span id="id32"></span><h4><strong>Downscatter source from</strong> high <strong>region of the UMR to the PW range (SHI)</strong><a class="headerlink" href="#downscatter-source-from-high-region-of-the-umr-to-the-pw-range-shi" title="Permalink to this headline">¶</a></h4>
<p>The high region of the UMR corresponds to groups 1 through MGTOP-1. The
MG-to-PW scattering source (S<sub>HI</sub>) from high energy region
originates in the energy range above DEMAX/α<sub>L</sub>; i.e., lethargies
below u<sub>L</sub> (see <a class="reference internal" href="#fig7-4-2"><span class="std std-numref">Fig. 153</span></a>). In this region, inelastic
reactions may scatter neutrons to the PW range; but due to the
definition of u<sub>L</sub>, the only elastic reactions that scatter to
the PW range are due to hydrogen. Therefore in general, the MG matrices
describing scatter from groups in high region to groups in the PW range
correspond to discrete and continuum inelastic reactions, and elastic
scatter from hydrogen. If g′ is an arbitrary group in the UMR range
above the transition interval and g is a fixed group interval in the
PW range, then the rate that neutrons scatter from all groups g′ in the
high region to all energy points in g, for a given direction Ω, is
obtained from the usual expression for MG-to-MG transfers, and is equal
to</p>
<div class="math notranslate nohighlight">
\[\mathrm{S}_{\mathrm{g}}(\mathrm{r}, \Omega)=\sum_{\mathrm{k}} \frac{2+1}{2} \quad \mathrm{Y}_{\mathrm{k}}(\Omega) \mathrm{S}_{\mathrm{k}, \mathrm{g}}\]</div>
<p>where MGLO &gt; g &gt; MGHI, and the MG source moments are,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-34">
<span class="eqno">(326)<a class="headerlink" href="#equation-eq7-4-34" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}, \mathrm{g}}=\sum_{\mathrm{g}^{\prime}=1}^{\text {MGTOP-1 }} \Sigma_{, \mathrm{g}^{\prime} \rightarrow \mathrm{g}} \Psi_{\mathrm{k}, \mathrm{g}^{\prime}}\]</div>
<p>while <a class="reference internal" href="#equation-eq7-4-34">(326)</a> gives the moments of the overall scatter rate from all groups
in the high range into the <em>entire</em> PW group g, it is necessary to
determine how the group source should be distributed over the PW energy
mesh contained within the group; i.e., it is desired to extract the PW
source moments, from the group moments by applying some “intra-group”
distribution H<sub>ℓk,g</sub>(E) such that,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-35">
<span class="eqno">(327)<a class="headerlink" href="#equation-eq7-4-35" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}, \mathrm{HI}}(\mathrm{u})=\mathrm{S}_{\mathrm{k}, \mathrm{g}} \quad \mathrm{H}_{\mathrm{k}, \mathrm{g}}(\mathrm{E}), \quad \text { for } \mathrm{u}(\mathrm{E}) \varepsilon \operatorname{group} \mathrm{g}\]</div>
<p>The intra-group distribution has units of “per unit lethargy,” and its
integral over the group is normalized to unity. This form of the scatter
source preserves the MG moments S<sub>ℓk,g</sub>, whenever
S<sub>ℓk,HI</sub>(u) is integrated over group g, insuring that the
correct number of neutrons (as determined from the UMR calculation) will
always be transferred from the high range into the PW group. Only the
distribution within the group is approximate.</p>
<p>Recall that the scatter source of concern here is due only to elastic
scatter from hydrogen and inelastic scatter from all other materials. In
the case of <em>s</em>-wave elastic scatter from hydrogen, the P<sub>0</sub> and
P<sub>1</sub> moments per unit lethargy, respectively, can be rigorously
expressed in the form of <a class="reference internal" href="#equation-eq7-4-35">(327)</a> with</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-36">
<span class="eqno">(328)<a class="headerlink" href="#equation-eq7-4-36" title="Permalink to this equation">¶</a></span>\[  \begin{array}{lllll}
\mathrm{H}_{0} &amp; \propto \mathrm{E} &amp; , &amp; \text { and } &amp; \mathrm{H}_{1} &amp; \propto \mathrm{E}^{3 / 2}
\end{array}\]</div>
<p>These expressions can be inferred directly from the moments of the
scatter kernel in <a class="reference internal" href="#equation-eq7-4-16">(308)</a> . The higher order scatter moments for hydrogen
have a somewhat more complicated form containing sums of energy
functions; but since these moments are usually less important than the
first two moments, a less rigorous treatment of their intra-group
distribution is used. The intra-group distribution due to inelastic
scatter depends on the Q values for the individual levels, and these are
not available on the multigroup libraries. Fortunately, the scatter
source in the PW range is not very sensitive to the assumed intra-group
distribution for inelastic scatter, as long as the total inelastic
source for the group is computed correctly. As a reasonable trade-off
between rigor and complexity, the high energy component of the UMR-to-PW
scatter source is approximated using H<sub>0</sub> for the intra-group
distribution of all P<sub>0</sub> moments, and H<sub>1</sub> for all higher
order moments. This approximation produces the correct intra-group
variation for the lowest two moments of the hydrogen scatter source, but
the higher order moments of hydrogen and the inelastic scatter source
are not distributed exactly throughout the group. However, the
integrated source moments are correct in all cases. Again, it should be
emphasized that the approximations discussed here only apply to the
UMR-to-PW component designated as S<sub>HI</sub>, which comes from
reactions above the transition range (energies above
E<sub>HI</sub>/α<sub>L</sub>). This is often a small contribution to the
overall PW source term.</p>
</div>
<div class="section" id="scattering-sources-from-umr-transition-region-and-epithermal-pw-range">
<span id="id33"></span><h4><strong>Scattering sources from UMR</strong> transition <strong>region and epithermal PW range</strong><a class="headerlink" href="#scattering-sources-from-umr-transition-region-and-epithermal-pw-range" title="Permalink to this headline">¶</a></h4>
<p>Most coupling between the UMR and the PW range is due usually to elastic
scatter from energies immediately above DEMAX. The contribution to the
PW source due to downscatter source from this transition range has been
designated S<sub>Tr</sub>(u:sub:<cite>n</cite>). The other component of the PW
source, S<sub>PW</sub>(u<sub>n</sub>), accounts for the scattering source
coming from all lethargies lower than u<sub>n</sub> in the PW range. It is
convenient to combine the two sources together as the PW epithermal
source called “S<sub>Ep</sub>,” which has an lk<sub>th</sub> moment given by
<a class="reference internal" href="#equation-eq7-4-22">(314)</a>,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-37">
<span class="eqno">(329)<a class="headerlink" href="#equation-eq7-4-37" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{aligned}
S_{k, E p} &amp;=\int_{\mathrm{u}_{\mathrm{L}}}^{\mathrm{u}_{\mathrm{n}}} \mathrm{S}_{\mathrm{k}}\left(\mathrm{r}, \mathrm{u}^{\prime} \rightarrow \mathrm{u}\right) \mathrm{du}^{\prime} \\
&amp;=\sum_{\mathrm{j}} \sum_{\mathrm{K}=-} \mathrm{Z}_{, \mathrm{k}}^{(\mathrm{j})} \mathrm{h}_{\mathrm{K}}(\mathrm{E}) \int_{\mathrm{u}_{\mathrm{n}}-\varepsilon^{(\mathrm{j})}}^{\mathrm{u}_{\mathrm{k}}} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \quad \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right) \mathrm{du}^{\prime}
\end{aligned}\end{split}\]</div>
<p>This is done because CENTRM uses the submoment expansion technique to
compute both the PW-to-PW epithermal source from the PW range as well as
the MG-to-PW source from the transition range of the UMR. Note that
elastic scattering from the transition range only impacts the PW scatter
source at the initial mesh points in the PW range; i.e., those contained
in the interval 0 &lt; u<sub>n</sub> &lt;ε:sup:<cite>(j)</cite>, for nuclide j. Beyond
these mesh points the elastic scatter source is due only to PW-to-PW
scatter, as illustrated in <a class="reference internal" href="#fig7-4-2"><span class="std std-numref">Fig. 153</span></a>.</p>
<p>The epithermal elastic source at u<sub>n</sub>, coming from the range
u<sub>L</sub> to u<sub>n</sub>, is expressed as an integral over the
immediately preceding lethargy mesh interval from u<sub>n−1</sub> to
u<sub>n</sub> plus the integral over the remaining lethargy interval, as
illustrated in <a class="reference internal" href="#fig7-4-3"><span class="std std-numref">Fig. 154</span></a>. The former integral is designated as
I(u<sub>n−1</sub>,u<sub>n</sub>) and the latter as
I(u<sub>L</sub>,u<sub>n−1</sub>), so that</p>
<div class="math notranslate nohighlight">
\[\mathrm{S}_{\mathrm{k}, \mathrm{E}}\left(\mathrm{u}_{\mathrm{n}}\right)=\mathrm{I}\left(\mathrm{u}_{\mathrm{n}-1}, \mathrm{u}_{\mathrm{n}}\right)+\mathrm{I}\left(\mathrm{u}_{\mathrm{L}}, \mathrm{u}_{\mathrm{n}-1}\right)\]</div>
<div class="figure align-center" id="id74">
<span id="fig7-4-3"></span><a class="reference internal image-reference" href="_images/fig31.png"><img alt="_images/fig31.png" src="_images/fig31.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 154 </span><span class="caption-text">Definition of cumulative integral elements.</span><a class="headerlink" href="#id74" title="Permalink to this image">¶</a></p>
</div>
<p>The lethargy mesh in CENTRM is constrained such that the maximum
lethargy gain in an elastic reaction (ε<sup>(j)</sup>) is always greater
than the maximum mesh interval size, which insures that
I(u<sub>n−1</sub>,u<sub>n</sub>) always includes the full panel from
u<sub>n−1</sub> to u<sub>n</sub>. In the above and subsequent equations the
explicit dependence of S<sub>Ep</sub> on independent variables other than
lethargy is not shown for notational convenience. The integral
I(u<sub>n−1</sub>,u<sub>n</sub>) is evaluated approximately by applying the
trapezoidal rule, which leads to,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-38">
<span class="eqno">(330)<a class="headerlink" href="#equation-eq7-4-38" title="Permalink to this equation">¶</a></span>\[\mathrm{I}\left(\mathrm{u}_{\mathrm{n}}, \mathrm{u}_{\mathrm{n}-1}\right)=\int_{\mathrm{u}_{\mathrm{n}-1}}^{\mathrm{u}_{\mathrm{n}}} \mathrm{S}_{\mathrm{k}}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}_{\mathrm{n}}\right) \mathrm{du}^{\prime} \sim \frac{\left[\mathrm{S}_{\mathrm{k}}\left(\mathrm{u}_{\mathrm{n}} \rightarrow \mathrm{u}_{\mathrm{n}}\right)+\mathrm{S}_{\mathrm{k}}\left(\mathrm{u}_{\mathrm{n}-1} \rightarrow \mathrm{u}_{\mathrm{n}}\right)\right]}{2} \times\left(\mathrm{u}_{\mathrm{n}}-\mathrm{u}_{\mathrm{n}-1}\right)\]</div>
<p>Using the submoment expansion from <a class="reference internal" href="#equation-eq7-4-25">(317)</a>, <a class="reference internal" href="#equation-eq7-4-38">(330)</a> can be written for elastic scatter as</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-39">
<span class="eqno">(331)<a class="headerlink" href="#equation-eq7-4-39" title="Permalink to this equation">¶</a></span>\[\mathrm{I}\left(\mathrm{u}_{\mathrm{n}-1}, \mathrm{u}_{\mathrm{n}}\right)=\Sigma_{\mathrm{n} \rightarrow \mathrm{n}} \Psi_{\mathrm{k}, \mathrm{n}}+\sum_{\mathrm{K}} Z_{\mathrm{K}}^{(\mathrm{j})} \mathrm{h}_{\mathrm{K}}\left(\mathrm{E}_{\mathrm{n}}\right) \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{n}-1}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{n}-1}\right) \Psi_{\mathrm{k}, \mathrm{n}-1} \frac{\Delta \mathrm{u}_{\mathrm{n}-1}}{2} .\]</div>
<p>The first term on the right side of <a class="reference internal" href="#equation-eq7-4-39">(331)</a> corresponds to the
“within-point” component of elastic scatter from u<sub>n</sub> to
u<sub>n</sub>, which only occurs for straight ahead scatter
(μ<sub>0</sub>=1). The within-point cross section is defined as,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-40">
<span class="eqno">(332)<a class="headerlink" href="#equation-eq7-4-40" title="Permalink to this equation">¶</a></span>\[\Sigma_{\mathrm{n} \rightarrow \mathrm{n}}=\frac{\Delta \mathrm{u}_{\mathrm{n}-1}}{2} \sum_{\mathrm{j}} \frac{\Sigma_{\mathrm{n}}^{(\mathrm{j})}}{\left(1-\alpha^{(\mathrm{j})}\right)} .\]</div>
<p>In deriving this term the following relation has been used for each nuclide:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-41">
<span class="eqno">(333)<a class="headerlink" href="#equation-eq7-4-41" title="Permalink to this equation">¶</a></span>\[\sum_{\mathrm{K}} \mathrm{Z}_{\mathrm{K}}=\frac{1}{1-\alpha} .\]</div>
<p>The I(u<sub>L</sub>,u<sub>n−1</sub>) portion of the integral in <a class="reference internal" href="#equation-eq7-4-37">(329)</a> is
equal to</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-42">
<span class="eqno">(334)<a class="headerlink" href="#equation-eq7-4-42" title="Permalink to this equation">¶</a></span>\[\mathrm{I}\left(\mathrm{u}_{\mathrm{L}}, \mathrm{u}_{\mathrm{n}-1}\right)=\sum_{j} \sum_{K=-} \mathrm{Z}_{, \mathrm{K}}^{(\mathrm{j})} \mathrm{h}_{\mathrm{K}}\left(\mathrm{E}_{\mathrm{n}}\right) \int_{\mathrm{U}_{\mathrm{n}}-\varepsilon^{(j)}}^{\mathrm{u}_{\mathrm{n}-1}} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \quad \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime} .\]</div>
<p>Note that the lower lethargy limit of the integral is restricted to
u<sub>n</sub> − ε<sup>(j)</sup>, since this is the maximum limit of lethargy
that can scatter to u<sub>n</sub> in an elastic reaction. In terms of the
cumulative integral operator, the integral in <a class="reference internal" href="#equation-eq7-4-42">(334)</a>  over the interval
[u<sub>n</sub> − ε<sup>(j)</sup>, u<sub>n−1</sub>] is equal to</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-43">
<span class="eqno">(335)<a class="headerlink" href="#equation-eq7-4-43" title="Permalink to this equation">¶</a></span>\[\int_{\mathrm{u}_{\mathrm{n}}-\varepsilon(\mathrm{j})}^{\mathrm{u}_{\mathrm{n}}-1} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{h}_{\mathrm{K}}\left(\mathrm{E}^{\prime}\right)^{-1} \mathrm{du}^{\prime}=\left[\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}-1}\right)-\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}}-\varepsilon^{(\mathrm{j})}\right)\right]\]</div>
<p>where F<sub>ℓk,K</sub> has been defined in <a class="reference internal" href="#equation-eq7-4-26">(318)</a>. In order to evaluate <a class="reference internal" href="#equation-eq7-4-43">(335)</a>
it is necessary to determine the cumulative integral values at
u<sub>n−1</sub> and u<sub>n</sub> − ε<sup>(j)</sup>. The lethargy u<sub>n−1</sub>
will always correspond to a mesh point value, but in general
u<sub>n</sub> − ε<sup>(j)</sup> can fall between mesh points. Evaluation of
the cumulative integrals at an arbitrary limit such as
u<sub>n</sub> − ε<sup>(j)</sup> is performed in CENTRM by interpolation of
previously calculated values stored for all the mesh points below
u<sub>n</sub> during the transport calculation at lower lethargies. The
interpolated value of the cumulative integral at
u<sub>n</sub> − ε<sup>(j)</sup> that is subtracted in <a class="reference internal" href="#equation-eq7-4-43">(335)</a> is called the
“<em>excess integral</em>” in CENTRM. At each lethargy point, excess
integrals must be found as a function of space, nuclide, moment, and
submoment. Also note that for some initial mesh points
(i.e., u<sub>n</sub> &lt; ε<sup>(j)</sup>) the value u<sub>n</sub> − ε<sup>(j)</sup> can
be negative, indicating that a portion of the PW scatter source at
u<sub>n</sub> is due to elastic scattering from the negative lethargy
range above DEMAX. This means that cumulative integrals must be known
for mesh intervals in the transition as well as in the PW range. Values
of the cumulative integrals at all points within the transition range
are first computed from the results from the UMR calculation, prior to
the PW transport calculation (but after the UMR calculation). Additional
cumulative integrals are then calculated successively during the
PW transport solution at all mesh points and are stored as the
calculation proceeds from low to high lethargy. Thus in evaluating
S<sub>ℓk,Ep</sub>(u<sub>n</sub>), the cumulative integrals at every space
interval already will have been stored at all energy points up to (n−1),
in an array called CUM<sup>(j)</sup><sub>ℓk,K</sub>, for each nuclide j,
moment ℓk, and submoment K:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-44">
<span class="eqno">(336)<a class="headerlink" href="#equation-eq7-4-44" title="Permalink to this equation">¶</a></span>\[\mathrm{CUM}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})}=\left\{\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}^{\prime}}\right), \quad \mathrm{n}^{\prime}=1, \mathrm{n}-1\right\}\]</div>
<p>so that the excess integral values can be interpolated from the above
array. The first N<sub>Tr</sub> elements of the array
CUM<sup>(j)</sup><sub>ℓk,K</sub> correspond to lethargy points in the
transition range, and the remainder are in the PW range, where</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>N<sub>Tr</sub></p></th>
<th class="head"><p>=</p></th>
<th class="head"><p>G<sub>U</sub> −
g<sub>Tr</sub> + 1;</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>g<sub>Tr</sub></p></td>
<td><p>=</p></td>
<td><p>MGTOP, the highest
energy group in the
transition range;
(i.e., the group
whose high energy
boundary corresponds
to u<sub>L</sub>);</p></td>
</tr>
<tr class="row-odd"><td><p>G<sub>U</sub></p></td>
<td><p>=</p></td>
<td><p>Lowest energy group
in the transition
range.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Elastic cumulative integrals contained in array
CUM<sup>(j)</sup><sub>ℓk,K</sub> are calculated at each lethargy point
u<sub>n</sub> with the expression:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-45">
<span class="eqno">(337)<a class="headerlink" href="#equation-eq7-4-45" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{array}{l}
f\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}}\right)=\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}-1}\right)+\int_{\mathrm{u}_{\mathrm{n}-1}}^{\mathrm{u}_{\mathrm{n}}} \mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{d} u^{\prime} \\
=\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}-1}\right)+\int_{\mathrm{u}_{\mathrm{n}}-1}^{\mathrm{u}_{\mathrm{n}}} \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \quad \mathrm{h}_{\mathrm{K}}\left(\mathrm{E}^{\prime}\right)^{-1} \mathrm{du}^{\prime}
\end{array}\end{split}\]</div>
<p>After completing the calculation of PW angular fluxes and moments at
u<sub>n</sub> the integral over the most current lethargy panel
[u<sub>n−1</sub>,u<sub>n</sub>] is evaluated with the trapezoidal
approximation, resulting in an updated cumulative integral array
containing the value at lethargy u<sub>n</sub>:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-46">
<span class="eqno">(338)<a class="headerlink" href="#equation-eq7-4-46" title="Permalink to this equation">¶</a></span>\[\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}}\right) ; \quad \mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}-1}\right)+\Delta \mathrm{u}_{\mathrm{n}-1} \frac{\left[\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{n}-1}\right) \Sigma_{\mathrm{n}-1}^{(\mathrm{j})} \Psi_{\mathrm{k}, \mathrm{n}-1}+\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{n}}\right) \Sigma_{\mathrm{n}}^{(\mathrm{j})} \Psi_{\mathrm{k}, \mathrm{n}}\right]}{2} ,\]</div>
<p>where the cumulative integrals at the preceding mesh point are known
from the previous calculation, and the flux moments
Ψ<sub>ℓk</sub>(u<sub>n</sub>) are determined from the transport calculation
at the current lethargy point. Only a single panel of integration is
required to update the cumulative integrals, significantly reducing the
amount of computation compared to recomputing the entire summation again
at each new energy point. The integration is performed rapidly with the
trapezoidal approximation, which should be accurate since the energy
mesh is defined to reproduce the macroscopic cross sections linearly
between mesh points. In order to avoid loss of numerical significance,
the set of stored cumulative integrals is periodically “renormalized,”
by translating to a new reference lethargy point (recall that only the
<em>differences</em> of cumulative integrals is needed).</p>
<p>Elastic cumulative integrals for the transition range are calculated
with a slightly different expression, using MG flux moments obtained in
the UMR calculation. Because the transition interval is part of the UMR,
it is convenient to evaluate cumulative integrals at lethargy values
corresponding to group boundaries. This requires approximating the
energy distribution of the flux spectrum within each group in the
transition range. To evaluate the cumulative interval in the transition
range of some nuclide j, the scalar flux per energy (at a given space
location) within a transition group is approximated as:
Φ(E) = M<sup>(j)</sup>/E, where M<sup>(j)</sup> is a normalization constant
defined so that the MG outscatter rate (i.e., slowing-down density) from
the group is preserved. It can be shown that this normalization
condition requires that</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-47">
<span class="eqno">(339)<a class="headerlink" href="#equation-eq7-4-47" title="Permalink to this equation">¶</a></span>\[\mathbf{M}^{(j)}=\frac{\left[\Sigma_{t, g^{\prime}}^{(j)}-\Sigma_{a, g^{\prime}}^{(j)}-\Sigma_{g^{\prime}}^{(j)},\right] \Delta u_{g^{\prime}}}{\xi^{(j)} \Sigma_{s, g^{\prime}}^{(j)}} \times\left[\phi_{g^{\prime}} / \Delta u_{g^{\prime}}\right]\]</div>
<p>where ξ is the average lethargy gain in an elastic reaction and
Σ<sub>g′g′</sub>, is the within-group MG scatter cross section. Thus the
scalar flux per unit lethargy used to evaluate cumulative integrals of
nuclide j is:</p>
<div class="math notranslate nohighlight">
\[\phi\left(u^{\prime}\right)=M^{(j)} ; \quad \text { for } u^{\prime} \varepsilon g^{\prime}, \text { and } g^{\prime} \varepsilon \text { Transition region of } U M R\]</div>
<p>Within-group energy spectra for the higher order flux-moments could be
approximated in similar manner by preserving the higher order Legendre
moments of the slowing-down density, but CENTRM simply uses the same
form in <a class="reference internal" href="#equation-eq7-4-47">(339)</a> for all flux moments, so that in general the within-group
energy distribution for any ℓk<sub>th</sub> moment in the transition range
is approximated as,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-48">
<span class="eqno">(340)<a class="headerlink" href="#equation-eq7-4-48" title="Permalink to this equation">¶</a></span>\[\Psi_{k}\left(u^{\prime}\right)=\frac{\left[\sum_{t, g^{\prime}}^{(j)}-\Sigma_{a, g^{\prime}}^{(j)}-\Sigma_{g^{\prime}}^{(j)}\right] \Delta u_{g^{\prime}}}{\xi^{(j)} \sum_{s, g^{\prime}}^{(j)}} \times\left[\Psi_{k, g^{\prime}} / \Delta u_{g^{\prime}}\right]\]</div>
<p>for u′εg′, and g′ε transition region of UMR. Therefore the following
integrals can be evaluated:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-49">
<span class="eqno">(341)<a class="headerlink" href="#equation-eq7-4-49" title="Permalink to this equation">¶</a></span>\[\int_{\mathrm{ug}^{\prime}}^{\mathrm{u}_{\mathrm{g}^{\prime}+1}} \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right) \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \mathrm{du}^{\prime}=\frac{\Sigma_{\mathrm{r}, \mathrm{g}^{\prime}}^{(\mathrm{j})} \Delta \mathrm{u}_{\mathrm{g}^{\prime}}}{\xi^{(\mathrm{j})}} \frac{\Psi_{\mathrm{k}, \mathrm{g}^{\prime}}}{\Delta \mathrm{u}_{\mathrm{g}^{\prime}}} \int_{\mathrm{ug}^{\prime}}^{\mathrm{u}_{\mathrm{g}^{\prime}+1}} \mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}^{\prime}\right) \mathrm{du}^{\prime} .\]</div>
<p>Integration of the h<sub>k</sub><sup>−1</sup> function is performed
analytically to give the cumulative integral at any group boundary
u<sub>g</sub> in the transition range:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-50">
<span class="eqno">(342)<a class="headerlink" href="#equation-eq7-4-50" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{array}{l}
f\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{g}}\right) ; \sum_{\mathrm{g}^{\prime}=\mathrm{g}}^{\mathrm{G}_{\mathrm{U}}} \frac{\Sigma_{\mathrm{r}, \mathrm{g}^{\prime}}^{(\mathrm{j})}{\xi^{(\mathrm{j})}} \mathrm{g}_{\mathrm{g}^{\prime}}}{\frac{\Psi_{\mathrm{k}, \mathrm{g}^{\prime}}}{\Delta \mathrm{u}_{\mathrm{g}^{\prime}}} \times\left[\frac{2}{\mathrm{~K}+2}\right]}\left[\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{g}^{\prime}+1}\right)-\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{g}^{\prime}}\right)\right] \\
\mathrm{g}=\mathrm{g}_{\mathrm{Tr}}, \quad \mathrm{g}_{\mathrm{Tr}+1}, \quad \mathrm{G}_{\mathrm{U}}
\end{array}\end{split}\]</div>
<p><a class="reference internal" href="#equation-eq7-4-50">(342)</a> is used to obtain the initial N<sub>Tr</sub> values of the
cumulative integrals, corresponding to the transition range. If the
lower limit of the integral in <a class="reference internal" href="#equation-eq7-4-43">(335)</a> is negative, then the cumulative
integral at u<sub>n</sub> − ε<sup>(j)</sup> is interpolated from among the set
of N<sub>Tr</sub> tabulated values generated by <a class="reference internal" href="#equation-eq7-4-50">(342)</a>; otherwise it is
interpolated from the values that were computed with <a class="reference internal" href="#equation-eq7-4-46">(338)</a>. The following
algorithm is used to interpolate cumulative integrals for negative
lethargy arguments (i.e., in the transition range ):</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-51">
<span class="eqno">(343)<a class="headerlink" href="#equation-eq7-4-51" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{array}{l}
f\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}\right)=\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{g}}\right)+\frac{\mathrm{h}_{\mathrm{K}}^{-1}(\mathrm{E})-\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{g}}\right)}{\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{g}+1}\right)-\mathrm{h}_{\mathrm{K}}^{-1}\left(\mathrm{E}_{\mathrm{g}}\right)} \\
\times\left[\mathrm{f}\left(F_{k, K}^{(j)} ; u_{g+1}\right)-\mathrm{f}\left(F_{k, K}^{(j)} ; u_{g}\right)\right]
\end{array}\end{split}\]</div>
<p>.or u(E) ε g; and g ε transition range of UMR.</p>
<p>Because the energy mesh in the PW range is very fine, simple linear
interpolation of the cumulative integrals is used for positive lethargy
arguments.</p>
<p>The complete epithermal elastic scatter source S(r,Ω,u<sub>n</sub>)
appearing in <a class="reference internal" href="#equation-eq7-4-32">(324)</a> at any mesh point u<sub>n</sub> corresponds to a
spherical harmonic expansion using the previously derived moments of
S<sub>HI</sub> and S<sub>Ep</sub>. This angular scatter source is equal
to,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-52">
<span class="eqno">(344)<a class="headerlink" href="#equation-eq7-4-52" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{array}{l}
\mathrm{S}\left(\mathbf{r}, \Omega, \mathrm{u}_{\mathrm{n}}\right)=\Sigma_{\mathrm{n} \rightarrow \mathrm{n}} \Psi_{\mathrm{n}}(\mathbf{r}, \Omega) \\
+\sum_{\mathrm{k}} \frac{2+1}{2} \mathrm{Y}_{\mathrm{k}}(\Omega)\left\{\mathrm{H}\left(\mathrm{E}_{\mathrm{n}}\right) \sum_{\mathrm{g}^{\prime}=1}^{\mathrm{g}_{\mathrm{Tr}}-1} \sum_{, \mathrm{g}^{\prime} \rightarrow \mathrm{g}} \psi_{\mathrm{k}, \mathrm{g}^{\prime}}\right. \\
\left.+\sum_{j} \sum_{\mathrm{K}} Z_{\mathrm{K}}^{(\mathrm{j})} \mathrm{h}_{\mathrm{K}}\left(\mathrm{E}_{\mathrm{n}}\right)\left[0.5 \Delta \mathrm{u}_{\mathrm{n}-1} \mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{n}-1}\right)+\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}-1}\right)-\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{n}}-\varepsilon^{(\mathrm{j})}\right)\right]\right\}
\end{array}\end{split}\]</div>
<p>The above expression was written explicitly for the case of elastic
scatter; however, the discrete level inelastic PW source can be
incorporated with little modification. The only changes are that
additional cumulative integral terms corresponding to each inelastic
level will appear in <a class="reference internal" href="#equation-eq7-4-52">(344)</a>; the cumulative integrals for the inelastic
levels must be computed by integrating the more general expression in
<a class="reference internal" href="#equation-eq7-4-26">(318)</a>; and the lethargy arguments for the inelastic cumulative integrals
are the generalized lethargy limits u<sub>LO</sub> and u<sub>HI</sub>
defined in <a class="reference internal" href="#id23"><span class="std std-ref">Sub-moment expansion of the epithermal scattering source</span></a> and <a class="bibtex reference internal" href="#williams-submoment-2000" id="id34">[Wil00]</a>.</p>
<p>Note that <a class="reference internal" href="#equation-eq7-4-52">(344)</a> contains the term Σ<sub>n→n</sub> Ψ<sub>n</sub>(r,Ω) which
can be subtracted from both sides of the transport equation in Eq.  to
give a slightly altered form of the PW transport equation that contains
a modified scatter source and a modified total cross section. The
modified source component is identical to the expression in <a class="reference internal" href="#equation-eq7-4-52">(344)</a> with
the within-point term Σ<sub>n→n</sub> Ψ<sub>n</sub>(r,Ω) removed. The
modified total cross section, represented by <span class="math notranslate nohighlight">\(\Sigma_{\mathrm{t}, \mathrm{n}}\)</span> has the
appearance of a “transport‑corrected” cross section given below:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-53">
<span class="eqno">(345)<a class="headerlink" href="#equation-eq7-4-53" title="Permalink to this equation">¶</a></span>\[\Sigma_{\mathrm{t}, \mathrm{n}}=\Sigma_{\mathrm{t}, \mathrm{n}}-\Sigma_{\mathrm{n} \rightarrow \mathrm{n}}\]</div>
<p>An interesting and significant consequence of this operation is that the
right side of Eq.  no longer contains the unknown flux
Ψ<sub>n</sub>(r,Ω) since the within-point term is eliminated. The
resulting modified transport equation has the same form as a purely
absorbing medium with a known source term; and thus can be solved
without requiring scatter-source iterations in the epithermal range.
However, iterations may still be required for cell cases with two
reflected or albedo boundary conditions.</p>
</div>
<div class="section" id="pw-thermal-scatter-source">
<span id="id35"></span><h4>PW thermal scatter source<a class="headerlink" href="#pw-thermal-scatter-source" title="Permalink to this headline">¶</a></h4>
<p>There are significant differences in the CENTRM epithermal and thermal
PW transport solutions. In the epithermal range neutrons can only lose
energy in scattering reactions, so that a single sweep from high to low
energy (i.e., low to high lethargy) is required in the solution. On the
other hand, since low energy neutrons may gain as well as lose energy in
scattering reactions, outer iterations are required to converge the
thermal scattering source. Furthermore, the PW scatter kernels
Σ<sub>ℓ</sub>(u′→u) in the epithermal range represent two-body
interactions (such as elastic and discrete-level inelastic reactions)
between a neutron and a stationary nucleus. The simple kinematic
relations for these cases allow the efficient sub-moment expansion
method to be utilized in computing scattering source moments. Thermal
scattering reactions are not two body reactions, but rather represent an
effective average over the molecular velocity distribution; thus, there
is no simple kinematic relationship between neutron energy loss and the
angle of scatter relative to its initial direction. In solving the
transport equation for thermal neutrons, the scatter source at lethargy
u<sub>n</sub> is approximated as a summation over the “N” mesh points in
the thermal range,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-54">
<span class="eqno">(346)<a class="headerlink" href="#equation-eq7-4-54" title="Permalink to this equation">¶</a></span>\[\int_{\text {thermal }} \Sigma^{(\mathrm{j})}\left(\mathrm{u}^{\prime} \rightarrow \mathrm{u}_{\mathrm{n}}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}=\sum_{\mathrm{m}=1}^{\mathrm{N}} \mathrm{W}_{\mathrm{m}} \Sigma^{(j)}\left(\mathrm{u}_{\mathrm{m}} \rightarrow \mathrm{u}_{\mathrm{n}}\right) \Psi_{\mathrm{k}}\left(\mathrm{u}_{\mathrm{m}}\right)\]</div>
<p>where</p>
<blockquote>
<div><p>m = 1 is the thermal/epithermal boundary point;</p>
<p>m = N is the lowest thermal energy point; and</p>
<p>W<sub>m</sub> are standard quadrature weights for trapezoidal integration
with N-1 lethargy panels:</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathrm{W}_{\mathrm{m}}=&amp; 0.5 \times\left(\Delta \mathrm{u}_{\mathrm{m}}+\Delta \mathrm{u}_{\mathrm{m}+1}\right) \quad ; \quad \text { for } \mathrm{m}=2,3, \ldots \mathrm{N}-1 \\
&amp; 0.5 \times \Delta \mathrm{u}_{\mathrm{m}} \quad ; \quad \text { for } \mathrm{m}=1 \quad \text { or } \quad \mathrm{N}
\end{aligned}\end{split}\]</div>
<p>Point-to-point cross-section moments in the thermal range are computed
from the free-gas or bound kernels evaluated at the desired initial
(u<sub>m</sub>) and final (u<sub>n</sub>) lethargy mesh points. For a given
outer iteration, the summation in <a class="reference internal" href="#equation-eq7-4-54">(346)</a> is evaluated using the most
recently computed flux moments. In many instances the main purpose of
the CENTRM calculation will be to obtain a PW spectrum for resonance
self-shielding calculations. In these cases the thermal flux does not
have to be converged very tightly to obtain a reasonable thermal
spectrum for self-shielding low energy resonances, so that only a few
outer iterations are typically employed.</p>
<p>An additional complication in the thermal calculation is that inner
iterations are necessary to converge the “within-point” (no energy loss)
contribution of the thermal scattering source, due to the presence of
PW flux moments at lethargy point m = n. No inner iterations are
required to converge the within-point elastic scatter term in the
epithermal PW calculation because there can be no change in the neutron
direction if there is no energy loss, unlike the thermal range.</p>
<p>A space-dependent rebalance calculation for the entire thermal energy
band is performed between outer iterations in order to speed up
convergence of the solution. Reaction rates and leakage values appearing
in the thermal-band rebalance equation are obtained by integrating
PW values over the thermal range. Other acceleration techniques, such as
over-relaxation, extrapolation, and renormalization, are also employed.</p>
</div>
<div class="section" id="downscatter-source-from-the-epithermal-pw-range-to-the-lmr">
<span id="id36"></span><h4>Downscatter source from the epithermal PW range to the LMR<a class="headerlink" href="#downscatter-source-from-the-epithermal-pw-range-to-the-lmr" title="Permalink to this headline">¶</a></h4>
<p>MG transport calculations performed in the energy range below DEMIN,
which includes the thermal energy range, are coupled to the epithermal
PW range transport calculations by the slowing down source. The
epithermal PW-to-LMR scatter source represents the contribution to the
multigroup source in some fixed group g contained in the LMR, from
scatter reactions in the epithermal range above DEMIN. The lethargy
value corresponding to the energy DEMIN (i.e., the bottom energy of the
PW range) will be indicated as u<sub>PW</sub>, thus
u<sub>PW</sub> = ln(DEMAX/DEMIN); while the lethargy corresponding to the
thermal energy boundary will be designated as u<sub>TH</sub>. The cut-off
lethargy for the epithermal PW range will correspond to:
u<sub>cut</sub> = min(u<sub>PW</sub>,u<sub>TH</sub>). If there is no PW thermal
calculation in CENTRM, then u<sub>cut</sub> = u<sub>PW</sub>; otherwise,
u<sub>cut</sub> = u:sub:<cite>TH</cite>. For a given nuclide j, the lowest lethargy
in the epithermal PW range from which a neutron can scatter elastically
into the LMR is equal to (u:sub:<cite>cut</cite> − ε<sup>(j)</sup>). If the value of
(u − ε<sup>(j)</sup>) is greater than u<sub>cut</sub>, then an elastic
collision with nuclide j cannot moderate an epithermal neutron from the
PW range to u. Therefore in general for a given material zone, only a
limited number of nuclides (possibly none) and a limited portion of the
epithermal PW energy range may be able to scatter neutrons elastically
to any particular group in the LMR. Utilizing the elastic scatter kernel
and applying a sub-moment expansion to the resulting expression, the
source moment describing scatter from the PW epithermal range to a
lethargy u in the LMR is found to be</p>
<div class="math notranslate nohighlight">
\[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}(\mathrm{u})=\sum_{\mathrm{K}} Z_{\mathrm{K}}^{(\mathrm{j})} \quad \mathrm{h}_{\mathrm{K}}(\mathrm{E}) \int_{\mathrm{U}-\varepsilon^{-6}}^{\mathrm{u}_{\mathrm{Cut}}} \mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})}\left(\mathrm{u}^{\prime}\right) \mathrm{d} \mathrm{u}^{\prime}\]</div>
<p>where u in group g; and g ε LMR.</p>
<p>The integral in the above expression can be evaluated from cumulative
integrals stored during the epithermal PW transport calculation. Thus
the source moment per unit lethargy at u in the LMR range, due to
epithermal scattering from nuclide j, can be written as,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-55">
<span class="eqno">(347)<a class="headerlink" href="#equation-eq7-4-55" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}(\mathrm{u})=\sum_{\mathrm{K}} \mathrm{Z}_{\mathrm{K}}^{(\mathrm{j})} \quad \mathrm{h}_{\mathrm{K}}(\mathrm{E}) \quad\left[\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}_{\mathrm{cut}}\right)-\mathrm{f}\left(\mathrm{F}_{\mathrm{k}, \mathrm{K}}^{(\mathrm{j})} ; \mathrm{u}-\varepsilon^{(\mathrm{j})}\right)\right] ,\]</div>
<p>for uε group g and u−ε(j) &lt; u<sub>PW</sub>.</p>
<p>The source per unit lethargy in Eq.  is integrated over the “sink group”
g in the LMR to determine the desired MG scatter source moment due to
reactions in the epithermal PW range. The actual integral over group g
is performed numerically by introducing a three-point (two panel)
integration mesh within the group, as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\mathrm{u}_{\mathrm{I}} &amp;=\text { initial integration point in group } \mathrm{g}=\text { lethargy at top energy of group } \mathrm{g}=\mathrm{u}_{\mathrm{g}} \\
\mathrm{u}_{\mathrm{F}}^{(\mathrm{j})} &amp;=\text { final integration point in group } \mathrm{g} \\
&amp;=\operatorname{MIN}\left\{\mathrm{u}_{\mathrm{g}+1} ; \mathrm{u}_{\mathrm{cut}}+\varepsilon^{(j)}\right\}, \quad \text { where } \mathrm{u}_{\mathrm{g}+1}=\text { lethargy at bottom of energy of group } \mathrm{g} \\
\mathrm{u}_{\mathrm{A}}^{(\mathrm{j})} &amp;=\text { middle integration point in group } \mathrm{g}=0.5\left(\mathrm{u}_{\mathrm{F}}^{(\mathrm{j})}+\mathrm{u}_{\mathrm{I}}\right)
\end{aligned}\end{split}\]</div>
<p>Note that the final and middle points of integration
(i.e., u<sub>F</sub><sup>(j)</sup> and u:sub:<cite>A</cite><sup>(j)</sup>) may be nuclide
dependent; and if (u<sub>I</sub> − ε<sup>(j)</sup>) &gt; u<sub>cut</sub>, then
nuclide j does not contribute to the pointwise-to-LMR scatter source in
g. Applying the two-panel Simpson’s approximation for integration over
group g results in</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-56">
<span class="eqno">(348)<a class="headerlink" href="#equation-eq7-4-56" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{k}, \mathrm{g}}^{(\mathrm{)}}=\Delta^{(\mathrm{j})} / 3\left[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{I}}\right)+4 \mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{A}}^{(\mathrm{j})}\right)+\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{F}}^{(\mathrm{j})}\right)\right]\]</div>
<p>where Δ<sup>(j)</sup> = 0.5(u<sub>F</sub><sup>(j)</sup> − u<sub>I</sub>).</p>
<p>The values for S<sub>ℓk</sub><sup>(j)</sup>(u<sub>I</sub>),
S<sub>ℓk</sub><sup>(j)</sup>(u<sub>A</sub><sup>(j)</sup>), and
S<sub>ℓk</sub><sup>(j)</sup>(u<sub>F</sub><sup>(j)</sup>) in <a class="reference internal" href="#equation-eq7-4-56">(348)</a> are obtained
by evaluating <a class="reference internal" href="#equation-eq7-4-55">(347)</a> at the lethargy values u<sub>I</sub>,
u<sub>A</sub><sup>(j)</sup>, and u<sub>F</sub><sup>(j)</sup>, respectively. Use
of more than two panels for the group integration was found to have an
insignificant impact.</p>
<p>The complete epithermal PW-to-LMR source in group g is finally obtained
by summing <a class="reference internal" href="#equation-eq7-4-55">(347)</a> over all nuclides and then substituting the spherical
harmonic moments into the Legendre expansion of the MG scatter source,
resulting in</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-57">
<span class="eqno">(349)<a class="headerlink" href="#equation-eq7-4-57" title="Permalink to this equation">¶</a></span>\[\mathrm{S}_{\mathrm{PW} \rightarrow \mathrm{g}}=\sum_{\mathrm{k}} \frac{2+1}{2} \mathrm{Y}_{\mathrm{k}}(\Omega) \sum_{\mathrm{j}} \Delta^{(\mathrm{j})} / 3\left[\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{I}}\right)+4 \mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{A}}^{(\mathrm{j})}\right)+\mathrm{S}_{\mathrm{k}}^{(\mathrm{j})}\left(\mathrm{u}_{\mathrm{F}}^{(\mathrm{j})}\right)\right]\]</div>
</div>
<div class="section" id="thermal-scatter-sources-from-lmr-and-pw-range">
<span id="id37"></span><h4>Thermal scatter sources from LMR and PW range<a class="headerlink" href="#thermal-scatter-sources-from-lmr-and-pw-range" title="Permalink to this headline">¶</a></h4>
<p>If the value of DEMIN is specified to be below the thermal energy
boundary, the portion of the PW range between DEMIN and the thermal
cutoff, as well as the entire LMR, will be contained in the thermal
range. In this case thermal neutrons will downscatter from the thermal
PW range to the LMR, and upscatter from the LMR to the thermal PW range.</p>
<p>The latter thermal source (LMR-to-PW) is computed in exactly the same
manner as used to compute the UMR-to-PW source S<sub>HI</sub>, described
in <a class="reference internal" href="#id32"><span class="std std-ref">Downscatter source from high region of the UMR to the PW range (SHI)</span></a>. On the other hand, the scatter source from the
thermal PW to the LMR is computed with a similar approach as given in
the previous section for epithermal PW-to-LMR scatter. In this case <a class="reference internal" href="#equation-eq7-4-57">(349)</a>
is used as before, except the source moments are not obtained from the
submoment expansion in <a class="reference internal" href="#equation-eq7-4-55">(347)</a>, but rather by evaluating the PW thermal
scatter expression in <a class="reference internal" href="#equation-eq7-4-54">(346)</a>.</p>
<p>In performing the transport calculation for any group g in the LMR
range, the PW-to-MG source component in <a class="reference internal" href="#equation-eq7-4-57">(349)</a> is added to the MG-to-MG
scattering into g from all groups in the UMR and LMR ranges,
respectively, to obtain the total scatter source.</p>
</div>
</div>
<div class="section" id="determination-of-energy-mesh-for-pw-flux-calculation">
<span id="id38"></span><h3>Determination of energy mesh for PW flux calculation<a class="headerlink" href="#determination-of-energy-mesh-for-pw-flux-calculation" title="Permalink to this headline">¶</a></h3>
<p>The energy mesh for the PW flux computation is determined for a specific
problem as follows: (a) for each zone-composition, microscopic
cross-section data are interpolated (if necessary) to the desired
zone-temperature, and a union energy mesh is formed from the energy
meshes of PW total cross sections of all materials in that zone, plus
the MG boundaries; (b) macroscopic total cross sections are computed for
the union meshes in each zone; (c) union meshes for each zone are
thinned (i.e., some energy points eliminated) in a manner that allows
the zone macroscopic cross section to be interpolated linearly, within
some input error tolerance; (d) a union mesh is created from the thinned
energy meshes for each zone thus producing a “global” energy mesh;
(e) the global mesh is checked to insure that it still contains group
boundaries and midpoint-energies of the input MG library, and finally,
(f) still more points may be added to constrain the maximum interval
width between successive lethargy points to be less than some fraction
of the maximum lethargy gained by elastic scatter from a fictitious
nuclide having a mass of approximately 400. The fraction used in
limiting the maximum size of any lethargy interval can be set by the
input value of “FLET,” but is defaulted to a value of 1/3.</p>
<p>The mesh thinning procedure is effective in reducing the number of
energy points in the PW transport calculation, while preserving
essential features of the macroscopic cross-section data that affect the
flux spectrum; viz, the mesh is typically fine in energy regions
corresponding to important resonances, but coarser where there is little
variation in the macroscopic cross-section data. The default thinning
tolerance is 0.1%. A less stringent thinning tolerance may give a large
reduction in computation time, but also can affect the accuracy.</p>
</div>
<div class="section" id="centrm-cross-sections-and-fixed-sources">
<span id="id39"></span><h3>CENTRM cross sections and fixed sources<a class="headerlink" href="#centrm-cross-sections-and-fixed-sources" title="Permalink to this headline">¶</a></h3>
<div class="section" id="centrm-pw-cross-section-libraries">
<span id="id40"></span><h4>CENTRM PW cross-section libraries<a class="headerlink" href="#centrm-pw-cross-section-libraries" title="Permalink to this headline">¶</a></h4>
<p>SCALE includes CE nuclear data for all materials and all reaction types
available in ENDF/B, processed for several different temperatures. The
CE data, spanning the energy range from 10<sup>-5</sup> eV to 20 MeV, are
stored in separate files for individual nuclides, which can be used for
CENTRM as well as CE Monte Carlo calculations. The CRAWDAD module reads
these files and merges the data to form a single CENTRM formatted
library containing only the particular materials, cross section types,
temperatures, and energy range needed for a given calculation (see
<span class="xref std std-ref">8-1-5</span>). In general the CENTRM library includes CE data for the
unresolved, as well as the resolved, resonance range. Unresolved
resonance data typically have rather smooth variations, but in reality
the cross sections represent average values for very closely spaced
resonances that can not be measured individually.</p>
</div>
<div class="section" id="linearization-of-mg-cross-sections-and-fixed-sources">
<span id="id41"></span><h4>Linearization of MG cross sections and fixed sources<a class="headerlink" href="#linearization-of-mg-cross-sections-and-fixed-sources" title="Permalink to this headline">¶</a></h4>
<p>Shielded group cross sections from the input MG library are always
required for the UMR and LMR portions of the CENTRM calculation. Two
approaches are available to translate multigroup cross sections into
pseudo-PW data at energy points within a group. The first is a “step”
approximation in which σ(E<sub>n</sub>) = σ<sub>g</sub>, where E<sub>n</sub>
is any energy point contained in group g. This leads to a histogram
representation of σ(E) that is discontinuous at the group boundaries. If
the multigroup data show significant variation between adjacent groups,
then the histogram approach can introduce discontinuities and
oscillations into the pointwise flux. An alternative approach is to
“linearize” the multigroup cross sections, using a linear representation
that preserves the group-average values and is continuous at the group
boundaries. Although the resulting cross section is continuous and does
not cause distortions in the flux spectrum, the data does not
necessarily represent the actual energy variation of the cross section.</p>
<p>Input fixed source terms are treated in a similar manner. The multigroup
spectra that are input by the user may be converted either to a
discontinuous histogram function in lethargy; or may be linearized by
group. In the latter case the resulting groupwise-linear function is
evaluated at the energy mesh points to obtain the pointwise source term.</p>
</div>
</div>
</div>
<div class="section" id="available-methods-for-solving-transport-equation">
<span id="id42"></span><h2>Available Methods for Solving Transport Equation<a class="headerlink" href="#available-methods-for-solving-transport-equation" title="Permalink to this headline">¶</a></h2>
<p>CENTRM offers several calculation options for solving the Boltzmann
equation. Some of these are only available for either the MG or PW
calculations, respectively. In the case of the MG methods, the
calculation procedures are similar to those described in the XSDRNPM
documentation. The following sections briefly describe the PW transport
approximations available in CENTRM.</p>
<div class="section" id="discrete-ordinates">
<span id="id43"></span><h3>Discrete ordinates<a class="headerlink" href="#discrete-ordinates" title="Permalink to this headline">¶</a></h3>
<p>The discrete ordinates method can be used for both MG and PW solutions.
The main difference in the solution is the computation of the scattering
sources: the multigroup method uses group-to-group scatter matrices,
while the PW method uses the submoment expansion technique described
earlier. Also, as previously discussed, the pointwise discrete ordinates
equation has the same form as the transport equation for a purely
absorbing medium; so that inner iterations are not required to converge
the pointwise scattering source. The XSDRNPM documentation shows the
finite-difference form of the discrete ordinate equations, and includes
a discussion of S<sub>N</sub> quadratures, the weighted-difference model,
angular streaming coefficients, treatment of boundary conditions, and
other standard procedures used in the CENTRM 1-D discrete ordinates
solution.</p>
<div class="section" id="homogenized-infinite-medium">
<span id="id44"></span><h4>Homogenized infinite medium<a class="headerlink" href="#homogenized-infinite-medium" title="Permalink to this headline">¶</a></h4>
<p>A homogenized infinite medium calculation can be performed for either
the MG or the PW energy ranges. This method is essentially a
“zero-dimensional” model that has no spatial or angular variation in the
flux (only energy dependence). The materials contained in all zones are
“smeared” into a single homogenized mixture using volume weighting of
the number densities, and the effective external source is defined to be
the volume-weighted source density. The resulting homogenized
composition is then solved as an infinite medium, so that the PW scalar
flux is equal to,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-58">
<span class="eqno">(350)<a class="headerlink" href="#equation-eq7-4-58" title="Permalink to this equation">¶</a></span>\[\Phi\left(u_{n}\right)=\frac{\int \Sigma\left(u^{\prime} \rightarrow u_{n}\right) \Phi\left(u^{\prime}\right) d u^{\prime}+Q_{e x t}(E)}{\Sigma_{t}\left(u_{n}\right)}=\frac{S\left(u_{n}\right)+Q_{e x t}\left(u_{n}\right)}{\Sigma_{t}\left(u_{n}\right)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Sigma_{\mathrm{t}}, \mathrm{S}, \mathrm{Q}_{\mathrm{ext}},=\)</span> homogenized cross section, scatter source, and external
source, respectively.</p>
<p>The total cross section in the PW calculation is reduced by the value of
the “within-point” cross section, as discussed in <a class="reference internal" href="#id30"><span class="std std-ref">The Boltzmann equation within the PW range</span></a>. The PW
scattering source is computed from a P<sub>0</sub> submoment expansion
using cumulative integrals, as described in <a class="reference internal" href="#id23"><span class="std std-ref">Sub-moment expansion of the epithermal scattering source</span></a>. The scalar
flux at all space-intervals and the angular flux in all directions are
set to the above value, while higher order flux moments are equal to
zero.</p>
</div>
</div>
<div class="section" id="zonewise-infinite-medium">
<span id="id45"></span><h3>Zonewise infinite medium<a class="headerlink" href="#zonewise-infinite-medium" title="Permalink to this headline">¶</a></h3>
<p>The zonewise infinite medium solution is an option for the both PW and
MG calculations. This method is similar to the homogenized infinite
medium option, except each zone is treated independently as an infinite
medium, so that no spatial homogenization is required; i.e., Eq.  is
solved for each individual zone. The zonewise source corresponds to the
<em>input</em> external source within the respective zone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>THERE IS
NO COUPLING BETWEEN THE CALCULATIONS FOR EACH ZONE.</em></p>
</div>
<p>Hence, any zones
that do not contain an input external source will have zero fluxes,
since there is no leakage between zones in the zonewise infinite medium
model. To avoid this problem the user must either input a volumetric
source, or specify a fission source and add a minute amount of
fissionable material to generate a fission spectrum source.</p>
</div>
<div class="section" id="collision-probability-method">
<span id="id46"></span><h3>Collision probability method<a class="headerlink" href="#collision-probability-method" title="Permalink to this headline">¶</a></h3>
<p>A collision probability (CP) solution of the 1-D integral transport
equation is available in CENTRM as an alternative to the pointwise
discrete ordinates approach. This option is only available for the
pointwise solution, and has the following additional restrictions
compared to the pointwise S<sub>N</sub> method:</p>
<blockquote>
<div><p>(a) only 1-D cylindrical or slab geometry is treated (no spherical
geometry);</p>
<ol class="loweralpha simple" start="2">
<li><p>periodic boundary conditions have not been implemented;</p></li>
<li><p>interior surface sources cannot be treated;</p></li>
</ol>
<p>(d) P<sub>0</sub> scattering (isotropic <em>laboratory</em> scatter) is
assumed; no transport correction is applied to the pointwise
cross sections in CENTRM.</p>
<p>(e) due to assumption (d), computation of the angular flux is not
required in order to obtain the scalar flux; therefore, only the
P<sub>0</sub> flux moment (scalar flux) of the angular flux is
calculated.</p>
<ol class="loweralpha simple" start="6">
<li><p>PW thermal calculations are not supported for the CP method.</p></li>
</ol>
</div></blockquote>
<p><strong>This method has only had a limited amount of testing, and has not been
validated as extensively as the discrete ordinates and MoC options.</strong></p>
<p>The PW scattering source for the integral transport equation is similar
to that for the discrete ordinates method, except that only the
P<sub>0</sub> source moment is considered, and the “within point”
correction is not applied to the total cross section for the collision
probability method. Therefore only the spatial and directional treatment
is substantially different in the two transport approaches. In the
collision probability method the total interaction rate within a space
interval is expressed in terms of collision probabilities P<sub>i′→i</sub>
corresponding to the probability that neutrons born uniformly in
volume V<sub>i′</sub>, at lethargy u<sub>n</sub> will collide in interval i
with volume V<sub>i</sub>. The scalar flux in space interval “i,” at
lethargy point u<sub>n</sub> obeys the integral transport equation,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-59">
<span class="eqno">(351)<a class="headerlink" href="#equation-eq7-4-59" title="Permalink to this equation">¶</a></span>\[\Sigma_{\mathrm{i}}\left(\mathrm{u}_{\mathrm{n}}\right) \phi_{\mathrm{i}}\left(\mathrm{u}_{\mathrm{n}}\right) \mathrm{V}_{\mathrm{i}}=\sum_{\mathrm{i}^{\prime}} \mathrm{P}_{\mathrm{i}^{\prime} \rightarrow \mathrm{i}}\left(\mathrm{u}_{\mathrm{n}}\right)\left[\Sigma_{\mathrm{i}^{\prime} ; \mathrm{n} \rightarrow \mathrm{n}} \quad \Phi_{\mathrm{i}}\left(\mathrm{u}_{\mathrm{n}}\right)+\mathrm{Q}_{\mathrm{eff}, \mathrm{i}^{\prime}}\left(\mathrm{u}_{\mathrm{n}}\right)\right] \mathrm{V}_{\mathrm{i}^{\prime}}\]</div>
<p>where</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\sum_{\mathrm{i}^{\prime}, \mathrm{n} \rightarrow \mathrm{n}}\)</span> is the within-point cross section at i′, defined in <a class="reference internal" href="#equation-eq7-4-40">(332)</a>; and</p>
<p><span class="math notranslate nohighlight">\(\mathrm{Q}_{\text {eff }, \mathrm{i}^{\prime}}\)</span> is the external source (Q<sub>n</sub>) plus the
P<sub>0</sub> downscatter source in i′ and at u<sub>n</sub>, which is
computed in a similar manner as for the discrete ordinates solution.</p>
</div></blockquote>
<p>The boundary condition at the center of a cylinder is assumed to be
reflected; while the outer boundary condition can either be vacuum or
albedo. An albedo boundary condition returns a fraction of the outward
leakage, using a cosine distribution for the return-current. An albedo
of unity corresponds to a “white” boundary condition.</p>
<p>Unlike the integro-differential transport equation used by the discrete
ordinates method, the integral equation at space interval i, contains
the unknown fluxes at <em>all other</em> space intervals i′. This requires that
inner iterations be performed for the PW solution using the CP option.</p>
<p>Collision Probabilities (CP) in 1-D cylindrical geometry are computed
using the method developed by Carlvik <a class="bibtex reference internal" href="#carlvik-method-1964" id="id47">[Car64]</a>. The CPs for a vacuum outer
boundary condition are first computed. In this case the probability that
a neutron born in annular interval i with outer radius R<sub>i</sub>, will
have its next collision in annular interval j with outer radius
R<sub>j</sub> , is computed from the expression:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-60">
<span class="eqno">(352)<a class="headerlink" href="#equation-eq7-4-60" title="Permalink to this equation">¶</a></span>\[P_{i \rightarrow j}=\delta_{i j} \Sigma_{j} V_{j}+2\left(S_{i-1, j-1}-S_{i-1, j}-S_{i, j-1}-S_{i, j}\right)\]</div>
<p>where δ<sub>ij</sub> represents the Kronecker delta function and</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-61">
<span class="eqno">(353)<a class="headerlink" href="#equation-eq7-4-61" title="Permalink to this equation">¶</a></span>\[S_{i j}=\int_{0}^{R_{t}}\left[K i_{3}\left(\tau_{i j}^{+}\right)-K i_{3}\left(\tau_{i j}^{-}\right)\right] d y\]</div>
<p>In the above expression Ki<sub>3</sub> corresponds to a 3rd order Bickley
function, and <span class="math notranslate nohighlight">\(\tau_{i j}^{+} \text {and } \tau_{i j}^{-}\)</span> are,</p>
<div class="math notranslate nohighlight">
\[\tau_{i f}^{\pm}=\Sigma \times\left(\sqrt{R_{j}^{2}-y^{2}} \pm \sqrt{R_{i}^{2}-y^{2}}\right)\]</div>
<p>Integration of the Bickley functions is performed numerically using
Gauss-Jacobi quadrature.</p>
<p>The probability that a neutron born in interval “i” will escape
uncollided from a cell with a vacuum outer boundary is equal to one
minus the probability that it has a collision in any interval of the
cell, so that</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-62">
<span class="eqno">(354)<a class="headerlink" href="#equation-eq7-4-62" title="Permalink to this equation">¶</a></span>\[P_{e s c, i}=1-\sum_{j} P_{i \rightarrow j}\]</div>
<p>The “blackness” (Γ<sub>i</sub>) of interval i is defined to be the
probability that neutrons entering the cell with a cosine-current
angular distribution on the surface will collide within interval i. The
total blackness (Γ) is the probability that a neutron entering the outer
boundary will collide anywhere in the cell. The blackness is computed
from the escape probability:</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-63">
<span class="eqno">(355)<a class="headerlink" href="#equation-eq7-4-63" title="Permalink to this equation">¶</a></span>\[\Gamma_{i}=\frac{4 V_{i} \Sigma_{i}}{S} \times P_{e s c, i} \quad ; \quad \text { and } \quad \Gamma=\sum_{i} \Gamma_{i}\]</div>
<p>where S is the outer surface area of the cell.</p>
<p>The vacuum CPs can be modified to account for the effect of an albedo
condition on the outer surface. In these cases a fraction of the
neutrons reaching the outer boundary are returned isotropically back
into the cell, and “bounce” back and forth between the two boundaries,
with each traverse reducing the number of uncollided neutrons.
Mathematically this corresponds to a converging geometric series that
accounts for the cumulative effect of the “infinite” number of traverses
through the cell. Evaluating the geometric sum, the collision
probability (P<sup>A</sup>) for an albedo of α can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-64">
<span class="eqno">(356)<a class="headerlink" href="#equation-eq7-4-64" title="Permalink to this equation">¶</a></span>\[P_{i \rightarrow j}^{A}=P_{i \rightarrow j}+\frac{S}{4 V_{i} \Sigma_{i}} \times \frac{\alpha \Gamma_{i} \Gamma_{j}}{1-\alpha(1-\Gamma)}\]</div>
<p>In the case of a slab with two vacuum boundaries, the CP’s are expressed
in terms of transmission probabilities T<sub>i→j</sub>, corresponding to
the probability that a neutron born in volume i will reach surface j
without a collision. The transmission probability is equal to,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-65">
<span class="eqno">(357)<a class="headerlink" href="#equation-eq7-4-65" title="Permalink to this equation">¶</a></span>\[T_{i \rightarrow j}=\frac{E_{3}\left(\tau_{i j}\right)-E_{3}\left(\tau_{i j}+\tau_{i}\right)}{2 \tau_{i}}\]</div>
<p>where:</p>
<blockquote>
<div><p>τ<sub>ij</sub> is the optical distance between surface S<sub>j</sub> and the
surface volume V<sub>i</sub> that is closest to S<sub>j</sub>;</p>
<p>τ<sub>i</sub> is the optical thickness of volume V<sub>i</sub>; and</p>
<p>E<sub>3</sub> is the third order Exponential Function.</p>
</div></blockquote>
<p>In a slab with vacuum boundaries, the CP for a neutron born in
interval i to have its next collision in some interval j bounded by
surfaces S<sub>j</sub> and S<sub>j+1</sub>, is given by the expression,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-66">
<span class="eqno">(358)<a class="headerlink" href="#equation-eq7-4-66" title="Permalink to this equation">¶</a></span>\[P_{i \rightarrow j}=T_{i \rightarrow j}-T_{i \rightarrow j+1}\]</div>
<p>A slab with a specular-reflected boundary condition on one side and a
vacuum on the other can be represented as an “expanded” geometry with
two vacuum boundaries, simply by adding the cell’s mirror image at the
reflected boundary. Hence, collision probabilities for these cases can
also be obtained from the expressions for two vacuum boundaries. For
slabs with an albedo (or white) boundary on one side and a reflected
boundary on the other, the same expression in <a class="reference internal" href="#equation-eq7-4-64">(356)</a> presented earlier for
cylinders can also be used to obtain albedo-corrected collision
probabilities from the vacuum values. However, unlike cylindrical
geometry, a slab may have specular-reflected boundary conditions on both
sides, corresponding to an infinite array of repeating cells. In CENTRM
the collision probabilities for a doubly-reflected slab geometry are
obtained by explicitly including two reflected cells in addition to the
“primary” cell, and then applying a white boundary condition on the
outer surface of the expanded geometry. The resulting modified geometry,
consisting of three cells (i.e., the primary plus two reflected cells)
with a reflected center and outer albedo boundary, can be treated as
described previously.</p>
</div>
<div class="section" id="p1-diffusion-theory-method">
<span id="id48"></span><h3>P<sub>1</sub> (“Diffusion Theory”) method<a class="headerlink" href="#p1-diffusion-theory-method" title="Permalink to this headline">¶</a></h3>
<p>The CENTRM MG calculation has an option for a P<sub>1</sub> calculation;
however, this option is not available for the PW calculation. The method
is essentially identical to that used in XSDRNPM. The P<sub>1</sub> option
is called diffusion theory in both XSDRNPM and CENTRM input
descriptions; but since the P<sub>1</sub> component of the scatter source
is explicitly treated and since Fick’s Law is not assumed, the method is
actually more closely related to the P<sub>1</sub> spherical harmonic
solution approach. The P<sub>1</sub> method is also used in CENTRM to
generate a flux guess for the thermal flux distribution in an
S<sub>N</sub> calculation. Several outer iterations over the thermal
groups are always performed with P<sub>1</sub> theory, prior to beginning
the discrete ordinates calculation for the thermal range. In the case of
PW thermal calculations, the multigroup thermal flux guess is converted
in PW flux values by multiplying by the ratio of MG to PW cross-section
values at each lethargy point.</p>
</div>
<div class="section" id="two-region-2r-method">
<span id="id49"></span><h3>Two-region (2R) method<a class="headerlink" href="#two-region-2r-method" title="Permalink to this headline">¶</a></h3>
<p>A two-region (2R) calculation similar to the Nordheim method is also
available as a PW option in CENTRM. In general the PW S<sub>N</sub> or MoC
solutions provide a more rigorous approach to compute self-shielded
cross sections than the 2R method; however the 2R approximation gives
accurate results for a wide range of “conventional cases.” Verification
studies have shown that the 2R option produces eigenvalues comparable to
those obtained with the S<sub>N</sub> and MoC options for numerous cases
of interest, and the execution time is often significantly faster since
only the zone-averaged PW scalar flux is computed. Thus the CENTRM 2R
option is an adequate and attractive alternative for many applications.</p>
<p>The CENTRM 2R solution provides several advantages over the original
Nordheim method. CENTRM uses pre-processed PW nuclear data, rather than
the Nordheim approach of using input resonance parameters for a built-in
resonance formula (Breit-Wigner). This allows the CENTRM-2R calculation
to utilize PW cross sections processed from Reich-Moore resonance data
in ENDF/B, while the conventional Nordheim method is limited to
Breit-Wigner resonance formulae that do not treat level-level
interference. Other advantages of the CENTRM-2R calculation include a
rigorous treatment of resonance overlap from mixed absorbers, ability to
address mixtures of arbitrary moderators with energy dependent cross
sections, and capability to include inelastic and thermal scattering
effects in the flux calculation.</p>
<p>The 2R approximation, which is a simplified version of the general
collision probability method, represents the system by an interior
region containing the mixture of materials to be self-shielded, and an
exterior moderator region where the asympototic flux per lethargy is
approximated by a simple analytical expression (e.g., constant for
epithermal energies).</p>
<p>CENTRM performs a separate 2R calculation for each zone. For example, if
a problem consists of fuel and moderator zones, then two 2R calculations
are done: one has fuel as the interior region and moderator as the
exterior, and the other has moderator as interior and fuel as exterior.
In the case of lattices, multiple bodies composed of the same mixture
are addressed by introducing a Dancoff factor.</p>
<p>The 2R equation solved by CENTRM for interior region “I” is equal to,</p>
<div class="math notranslate nohighlight" id="equation-eq7-4-67">
<span class="eqno">(359)<a class="headerlink" href="#equation-eq7-4-67" title="Permalink to this equation">¶</a></span>\[\Sigma_{\mathrm{I}}\left(\mathrm{u}_{\mathrm{n}}\right) \phi_{\mathrm{I}}\left(\mathrm{u}_{\mathrm{n}}\right)=\left(1-\mathrm{P}_{\mathrm{I}}^{(e s c)}\left(\mathrm{u}_{\mathrm{n}}\right)\right)\left(\mathrm{S}_{\mathrm{I}}\left(\mathrm{u}_{\mathrm{n}}\right)+\mathrm{Q}_{\mathrm{I}}^{e x t}\left(\mathrm{u}_{\mathrm{n}}\right)\right)+\Sigma_{\mathrm{I}}\left(\mathrm{u}_{\mathrm{n}}\right) \mathrm{P}_{\mathrm{I}}^{(e s c)}\left(\mathrm{u}_{\mathrm{n}}\right) \varphi_{\mathrm{asy}}\left(\mathrm{u}_{\mathrm{n}}\right)\]</div>
<p>In the above equation, S<sub>I</sub> and Q<sub>I</sub> are the scatter and
fixed sources, respectively, for interior region “I”; and <span class="math notranslate nohighlight">\(\mathrm{P}_{\mathrm{I}}^{(e s c)}\)</span> is
the probability that a neutron born in the interior region will escape
and have its next collision in the external region. For an interior
region consisting of multiple bodies of the same composition separated
by an exterior region, the escape probability is equal to</p>
<div class="math notranslate nohighlight">
\[\mathrm{P}_{\mathrm{I}}^{(e s c)}\left(\mathrm{u}_{\mathrm{n}}\right)=\frac{\mathrm{P}_{0}^{(e s c)}\left(\mathrm{u}_{\mathrm{n}}\right)\left[1-C_{\mathrm{I}}\right]}{\left[1-C_{\mathrm{I}}\right]+C_{\mathrm{I}}^{-} \Sigma_{\mathrm{I}}\left(\mathrm{u}_{\mathrm{n}}\right) \mathrm{P}_{0}^{(e s c)}\left(\mathrm{u}_{\mathrm{n}}\right)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{P}_{0}^{(e s c)}\)</span> is the escape probability from a single, isolated body
in the interior region; <span class="math notranslate nohighlight">\(^{-}\text { I }\)</span> is the average chord length of bodies
in the interior region; and C<sub>I</sub> is the Dancoff factor,
corresponding to the probability that a neutron escaping one interior
body will pass through the exterior region and have its next collision
in another body of the interior region. Values for <span class="math notranslate nohighlight">\(:math:\)</span>mathrm{P}_{0}^{(e s c)}` are
computed internally by the code at each energy mesh point, but Dancoff
factors must be provided by input for each zone. In the standard XSProc
computational sequence, Dancoff values are automatically computed and
provided to CENTRM.</p>
<p>The asymptotic flux <span class="math notranslate nohighlight">\(\varphi_{\text {asy }}\)</span> for the exterior region is represented by
analytical expressions in the fast, epithermal, and thermal energy
ranges, respectively, as summarized in <a class="reference internal" href="#tab7-4-7"><span class="std std-numref">Table 246</span></a>. The
constants C<sub>1</sub>, C<sub>2</sub> and C<sub>3</sub> are defined to impose
continuity at the energy boundaries, and also include the overall
normalization condition that the PW asymptotic flux at DEMAX is equal to
the MG flux for group MGHI obtained from the UMR calculation.</p>
<span id="tab7-4-7"></span><table class="docutils align-default" id="id75">
<caption><span class="caption-number">Table 246 </span><span class="caption-text">Asymptotic flux representation.</span><a class="headerlink" href="#id75" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Upper
energy</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Distribution</strong></p>
<p><strong>(per unit
energy)</strong></p>
</th>
<th class="head"><p><strong>Distribution
(per unit
lethargy)</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>20 MeV</p></td>
<td><p>Fission
spectrum</p></td>
<td><p>C<sub>3</sub>E<sup>1/2</sup>
e<sup>−E/θ</sup>
(*)</p></td>
<td><p>C<sub>3</sub>E<sup>3/2</sup>
e<sup>−E/θ</sup>
(<em>*</em>)</p></td>
</tr>
<tr class="row-odd"><td><p>200 keV</p></td>
<td><p>Slowing-down</p></td>
<td><p>C<sub>2</sub>/E</p></td>
<td><p>C<sub>2</sub></p></td>
</tr>
<tr class="row-even"><td><p>5kT</p></td>
<td><p>Maxwellian</p></td>
<td><p>C<sub>1</sub>E
e<sup>−E/kT</sup></p></td>
<td><p>C<sub>1</sub>E<sup>2</sup>
e<sup>−E/kT</sup></p></td>
</tr>
<tr class="row-odd"><td><p>(<em>*</em>) θ=
fission
spectrum
“temperature” =
1 MeV.</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Equation <a class="reference internal" href="#equation-eq7-4-67">(359)</a> is solved similarly to the zonewise infinite medium equation;
the only difference being that the interior sources are multiplied by
(1-<span class="math notranslate nohighlight">\(\mathrm{P}_{0}^{(e s c)}\)</span>), and the presence of an inhomogeneous source term coming
from the exterior region. Like all CENTRM transport options, the
PW scattering source is computed using cumulative integrals as given in
<a class="reference internal" href="#equation-eq7-4-30">(322)</a> In the 2R option, only the P<sub>0</sub> scatter-source moment is
needed.</p>
</div>
<div class="section" id="method-of-characteristics-for-a-2d-unit-cell">
<span id="id50"></span><h3>Method of characteristics for a 2D unit cell<a class="headerlink" href="#method-of-characteristics-for-a-2d-unit-cell" title="Permalink to this headline">¶</a></h3>
<p>The 2D MoC option is available for square-lattice unit cell cases, with
both multigroup and pointwisecross sections. The geometry for the MoC
cell calculation consists of a number of concentric cylindrical zones
contained within a square outer surface with reflected boundary
conditions. The MoC calculation is not currently functional for
triangular lattices. A multiregion cell may be used in the MoC option,
but it must correspond to a similar geometry as a square lattice cell.
Because the 2D MoC solution is limited to 2D rectangular lattice cell
geometries, the code performs a number of internal checks to verify the
input geometry is permitted. The energy mesh generation, scattering
source calculation, etc. are performed in the same manner as for the
discrete ordinates option, except that only P<sub>0</sub> scatter is
treated. Unlike the CENTRM discrete ordinates method which solves the 1D
transport equation, the MoC option solves the 2D transport equation for
planar XY slice through a square-pitch lattice of cylindrical pins.
Because the the MoC calculation treats the outer rectangular boundary of
the unit cell correctly, it provides a more rigorous calculation than
using an equivalent 1D cylindrical Wigner-Seitz cell. The geometry input
for the MoC calculation is identical to the input for the 1D cylindrical
model— the code internally converts the input value for the equivalent
cylindrical radius into the outer rectangular cell dimension (pitch) by
preserving the total cell area. Thus the length (L) of a side of the
rectangular cell in the MoC calculation is computed form the relation
<span class="math notranslate nohighlight">\(L=\sqrt{\pi R_{e q}^{2}}\)</span>, where <em>Req</em> is the equivalent outer radius of the
Wigner-Seitz cell, given in the CENTRM input array of radial dimensions.
Due to symmetry conditions, the MoC calculation is performed for only
1/8 of the rectangular cell (i.e., a 45 degree sector) and for the
upward directions.</p>
<p>MoC uses a integrating factor to convert the divergence term in the
transport equation into a directional derivative along the direction of
neutron transport (Ω). For a given direction in the angular quadrature
set, the spatial domain is spanned by a set of parallel characteristic
rays originating at one boundary and terminating at the opposite
boundary. The default separation distance between the parallel rays is
0.02 cm. in CENTRM. The angular flux in given direction is computed by
integrating the directional derivative along the characteristic
direction. A reflected boundary condition is normally applied along the
rectangular outer surface of the unit cell. The default directional
quadrature, which defines the characterstic directions and is used for
integration, consists of 8 azimuthal angles for the 45 degree sector in
the X-Y plane and 3 postive polar angles relative to the Z-axis.</p>
<p>The spatial domain of the unit cell is defined by zones of uniform
mixtures (e.g., fuel, clad, moderator) in which the cross section at a
fixed energy point or group is constant. These uniform composition
regions may be further divided into sufficiently small “flat-source”
sub-divisons in which the sources (scattering and external) can be
approximated as being constant. The MoC computes the average flux in the
flat-source region by summing over all characteristics in the volume.</p>
<p><a class="bibtex reference internal" href="#kim-method-2012" id="id51">[KW12]</a> gives more information about the CENTRM MoC solution
method.</p>
</div>
</div>
<div class="section" id="centrm-input-data">
<span id="id52"></span><h2>CENTRM Input Data<a class="headerlink" href="#centrm-input-data" title="Permalink to this headline">¶</a></h2>
<p>The standard mode for executing CENTRM is through the XSProc
self-shielding module which automatically defines the CENTRM options,
mixing table, and geometry, and also prepares the necessary MG and PW
nuclear data files and passes the CENTRM PW flux results to the
downstream code PMC [see section describing XSProc]. However CENTRM can
also be executed in standalone using the FIDO input provided in this
section. When executed through XSProc, the user can set values for most
CENTRM input parameters given in this section by using keywords in the
CENTRM DATA block [see XSProc section]. Note that if CENTRM is run as a
standalone module, the input data files defined in <a class="reference internal" href="#tab7-4-8"><span class="std std-numref">Table 247</span></a> must be
provided, and the default values for some input parameters are
different.</p>
<p class="centered">
<strong>FIDO INPUT FOR STANDALONE CENTRM CALCULATIONS</strong></p><p>***** Title Card - (72 Characters)</p>
<blockquote>
<div><p>DATA BLOCK 1 : GENERAL PROBLEM DATA</p>
</div></blockquote>
<p><strong>1$$</strong> GENERAL PROBLEM DESCRIPTION (18 entries. Defaults shown in
parenthesis)</p>
<ol class="arabic simple">
<li><p>IGE = Problem Geometry:</p></li>
</ol>
<blockquote>
<div><p>0/1/2/3 = inf. hom. medium /plane/ cylinder/ sphere</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>IZM = Number of Zones</p></li>
<li><p>IM = Number of Spatial Intervals</p></li>
<li><p>IBL = Left Boundary Condition:</p></li>
</ol>
<p>0/1/2/3 = vacuum/reflected/periodic/albedo</p>
<ol class="arabic simple" start="5">
<li><p>IBR = Right Boundary Condition:</p></li>
</ol>
<blockquote>
<div><p>0/1/2/3 = vacuum/reflected/periodic/albedo</p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>MXX = Number of Mixtures</p></li>
<li><p>MS = Mixing Table Length</p></li>
<li><p>ISN = S<sub>N</sub> Quadrature Order</p></li>
<li><p>ISCT = Order of Elastic Scattering</p></li>
</ol>
<p>10. ISRC = Problem Type: 0/1/2 = fixed source/input fission source/both
(0)</p>
<blockquote>
<div><p>[see Note 1]</p>
</div></blockquote>
<ol class="arabic" start="11">
<li><p>IIM = Inner Iteration Maximum (10)</p></li>
<li><p>IUP = Upscatter Outer Iterations in Thermal Range (3) [see Note 2]</p></li>
<li><p>NFST = Multigroup Calculation Option in Upper MG Range [E&gt;DEMAX] (3)</p>
<blockquote>
<div><p>0/1/2/3/4/5/6 = S<sub>N</sub> / diffusion / homogenized infinite medium /</p>
<p>zonewise infinite medium/(option 5 deprecated)/2D MoC cell</p>
<p>[see Note 3]</p>
</div></blockquote>
</li>
<li><p>NTHR = Multigroup Calculation Option in Lower MG Range [E&lt;DEMIN] (3)</p>
<blockquote>
<div><p>0/1/2/3/4/5/6 = S<sub>N</sub> / diffusion / homogenized infinite medium /</p>
<p>zonewise infinite medium/(option 5 deprecated)/2D MoC cell</p>
<p>[see Note 3]</p>
</div></blockquote>
</li>
<li><p>NPXS = Calculation Option in PW Range [DEMIN&lt;E&lt;DEMAX] (4)</p>
<p>0/1/2/3/4/5/6 = none (do NFST multigroup calculation) / S<sub>N</sub> /
collision‑probability/homogenized infinite medium /zonewise infinite medium/ 2-region/</p>
<p>2D MoC cell method of characteristics (only for square lattice cells)</p>
<p>[see Note 3]</p>
</li>
<li><p>ISVAR = Multigroup Source &amp; Cross-Section Linearization Option (3)</p>
<p>0/1/2/3 = none /linearize MG source /linearize MG XS’s /both [see Note
4]</p>
</li>
<li><p>mocMesh = Mesh Options for MoC Calculation; npxs=6 only:</p>
<p>0/1/2 = coarse/regular/fine mesh/input by zone (0)</p>
</li>
<li><p>mocPol = Number of Polar Angles for MoC Quadrature; npxs=6 only:</p>
<p>2/3/4 = allowable values (3)</p>
</li>
<li><p>mocAzi = Number of Azimuthal Angles for MoC Quadrature; npxs=6 only:</p>
<p>1 -&gt; 16 = allowable values (8)</p>
</li>
<li><p>kern = Thermal Neutron Scattering Treatment:</p>
<p>0/1 = all free-gas kernels/use bound S(alpha, beta) data if available
(1)</p>
</li>
</ol>
<p>21. ISCTI = P<sub>N</sub> Order of Scattering for PW inelastic [&lt;= ISCT]
(1)</p>
<ol class="arabic" start="22">
<li><p>NMF6 = PW Inelastic Scatter Option (-1)</p>
<p>−1/0/1 = no inelastic/ discrete level inelastic/ discrete and continuum</p>
</li>
</ol>
<p><strong>2$$</strong> EDITING AND OTHER OPTIONS (12 entries. Defaults shown in
parenthesis)</p>
<ol class="arabic">
<li><p>IPRT = Mixture Cross-Section Print Option: (−3)</p>
<blockquote>
<div><p>−3/−2/−1/N = none / write PW macro cross sections to output file, in
tab1 format/</p>
<p>print 1-D MG cross sections /print P<sub>0</sub>→P<sub>N</sub> MG
scatter matrices</p>
</div></blockquote>
</li>
<li><p>ID1 = Flux Print/Punch Options (−1)</p>
<blockquote>
<div><p>−1/0/1/2/ = none / print MG flux / also print M.G moments</p>
<p>/save PW zone-average flux in ascii file</p>
</div></blockquote>
</li>
</ol>
<p>3. IPBT = Balance Tables Print Option (PW thermal B.T. edit not
functional) (0)</p>
<blockquote>
<div><p>0/1 = none / print balance tables</p>
</div></blockquote>
<ol class="arabic" start="4">
<li><p>IQM = Use Volumetric Sources: 0/N = No / Yes (0)</p></li>
<li><p>IPM = Use Boundary Source: 0/N = No / Yes (0)</p></li>
<li><p>IPN = Group Diffusion Coefficient Option (2)</p>
<blockquote>
<div><p>0/1/2 = [<em>see XSDRNPM input</em>]</p>
</div></blockquote>
</li>
<li><p>IDFM = Use Density Factors 0/1 = No / Yes (0)</p></li>
<li><p>IXPRT = Extra Print Option:</p></li>
</ol>
<p>0/1 = minimum print /regular print (0)</p>
<ol class="arabic" start="9">
<li><p>MLIM = Mass Value Restriction on Order of Scattering (100)</p>
<blockquote>
<div><p>0/M = no effect / restrict nuclides with mass ≥ M to have scatter</p>
<p>order ≤ NLIM</p>
</div></blockquote>
</li>
<li><p>NLIM = Restrictive Scatter Order (0)</p></li>
</ol>
<p><strong>3**</strong> CONVERGENCE CRITERIA AND OTHER CONSTANTS (9 entries. Defaults
in parenthesis)</p>
<ol class="arabic simple">
<li><p>EPS = Upscatter Integral Convergence Criterion (0.001)</p></li>
<li><p>PTC = Point Convergence Criterion (0.001) [see Note 5]</p></li>
<li><p>XNF = Source Normalization Factor (1.0) [see Note 1]</p></li>
<li><p>B2 = Material Buckling Value [units of cm<sup>−2</sup>] (0.0)</p></li>
<li><p>DEMIN = Lowest Energy of Pointwise Flux Calculation, in eV (0.001)</p></li>
<li><p>DEMAX = Highest Energy of Pointwise Flux Calculation, in eV (2.0E4)</p></li>
</ol>
<p>7. TOLE = Tolerance Used in Thinning Pointwise Cross Sections (0.001)
[see Note 7]</p>
<ol class="arabic simple" start="8">
<li><p>MOCRAY = Distance (cm) Between MoC Rays; only for npxs=6 (0.02)</p></li>
</ol>
<p>9. FLET = Lethargy-Gain Fraction For Determining Energy Mesh (0.1) [see
Note 7]</p>
<p>10. ALUMP = 0.0<span class="math notranslate nohighlight">\(\rightarrow\)</span>1.0, Criterion for Lumping of Materials by
Mass (0.0) [see Notes]</p>
<blockquote>
<div><p>T <em>[TERMINATE DATA BLOCK 1]</em></p>
<p>DATA BLOCK 2 : MIXING TABLE</p>
</div></blockquote>
<p><strong>12$$</strong> COMPOSITION NUMBERS [AS IN MG LIBRARY] (MS entries)</p>
<p><strong>13$$</strong> MIXTURE NUMBERS (MS entries)</p>
<p><strong>14$$</strong> NUCLIDE IDENTIFIERS [AS IN MG LIBRARY] (MS entries)</p>
<blockquote>
<div><p>[<em>Note on 14$$</em>: Negative entry excludes material from PW treatment;
i.e., MG data used]</p>
</div></blockquote>
<p><strong>15**</strong> NUCLIDE CONCENTRATIONS (MS entries)</p>
<blockquote>
<div><p>T <em>[TERMINATE DATA BLOCK 2]</em></p>
<p><strong>DATA BLOCK 3: SOURCE DATA</strong></p>
</div></blockquote>
<p><strong>30$$</strong> SOURCE NO. BY INTERVAL (IM entries, if IQM or IPM &gt; 0)</p>
<p><strong>31**</strong> VOLUMETRIC MULTIGROUP SOURCE SPECTRA (IQM*IGM entries, if IQM
&gt;0)</p>
<p><strong>32**</strong> MULTIGROUP BOUNDARY ANGULAR SOURCE SPECTRA (IPM*IGM*MM, if IPM
&gt;0)</p>
<p><strong>34**</strong> SPACE-DEPENDENT FISSION SOURCE (IM entries, if ISRC &gt; 0)</p>
<blockquote>
<div><blockquote>
<div><p>T <em>[ TERMINATE DATA BLOCK 3 ]</em></p>
</div></blockquote>
<p><strong>DATA BLOCK 4: OTHER INPUT ARRAYS</strong></p>
</div></blockquote>
<p><strong>35**</strong> INTERVAL BOUNDARIES (IM+1 entries)</p>
<p><strong>36$$</strong> ZONE NUMBER BY INTERVAL (IM entries)</p>
<p><strong>38**</strong> DENSITY FACTORS (IM entries, if IDFM&gt;0)</p>
<p><strong>39$$</strong> MIXTURE NUMBER BY ZONE (IZM entries)</p>
<p><strong>41**</strong> TEMPERATURE [kelvin] BY ZONE (IZM entries: Default = F300.0)</p>
<p><strong>47**</strong> RIGHT BOUNDARY ALBEDOS (IGM entries if IBR=3: Default = F1.0)</p>
<p><strong>48**</strong> LEFT BOUNDARY ALBEDOS (IGM entries if IBL=3: Default = F1.0)</p>
<p><strong>49**</strong> DANCOFF FACTOR BY ZONE (IZM entries: Default = 0.0)</p>
<blockquote>
<div><blockquote>
<div><p>T <em>[ TERMINATE DATA BLOCK 4 ]</em></p>
</div></blockquote>
<p>******* END OF CENTRM INPUT DATA *******</p>
</div></blockquote>
<div class="section" id="centrm-data-notes">
<span id="id53"></span><h3>CENTRM data notes<a class="headerlink" href="#centrm-data-notes" title="Permalink to this headline">¶</a></h3>
<p>1. If ISRC = 0, an external volumetric or boundary source is used, as
specified in the 30$$, 31**, and 32** arrays (these are similar to same
arrays in XSDRNPM). This option is only available for standalone CENTRM
calculations; it is not an option for XSProc execution. If ISRC=1, the
magnitude of the fission source density (neutrons/cm<sup>3</sup>-s) is input
in the 34** array, and the source energy spectrum is assumed to be χ(E)
for the interval (if no fissionable material is present in an interval,
then χ=0 regardless of value in 34** array). Both external and fission
sources may be used if ISRC = 2. The source normalization parameter XNF
in the 3* array applies to the combined sources specified in data
block 3.</p>
<p>2. If the value of DEMIN in the 3* array is set lower than the thermal
cutoff energy of the AMPX MG library, a PW thermal calculation is
performed over the energy range between DEMIN and the thermal cutoff. A
MG thermal calculation is performed over the remainder of the thermal
range. PW thermal calculations always start with ten outer iterations of
MG theory to obtain an initial flux guess. The value “IUP” indicates how
many <em>additional</em> outer iterations are to be performed.</p>
<p>3. The solutions in the upper and lower MG ranges, as well as the
PW solution, provide several calculational options in addition to the
default method. These are described in <a class="reference internal" href="#id42"><span class="std std-ref">Available Methods for Solving Transport Equation</span></a>.</p>
<p>4. The parameter ISVAR indicates how MG values for sources and
cross sections are mapped onto the PW energy mesh. See <a class="reference internal" href="#id39"><span class="std std-ref">CENTRM cross sections and fixed sources</span></a>.</p>
<p>5. “Point Convergence” refers to the worst convergence over all space
intervals, between successive iterations. It is applied to (a) inner
iterations for MG S<sub>N</sub> solution; (b) inner iterations of
doubly-reflected boundary conditions in PW S<sub>N</sub> solution; and
(c) outer iterations of MG and PW solution in thermal range.</p>
<p>6. The values for DEMAX and DEMIN determine the energy range of the
PW calculation. If the purpose of the CENTRM calculation is to obtain
PW fluxes for resonance self-shielding calculations with PMC, then the
PW energy range should at least span the resolved resonance ranges of
all materials for which self shielding is significant.</p>
<p>7. The energy mesh for the PW flux calculation is based on several
factors, as described in <a class="reference internal" href="#id38"><span class="std std-ref">Determination of energy mesh for PW flux calculation</span></a>.</p>
<p>8. If parameter alump &gt; 0, epithermal and thermal scattering sources for
individual nuclides with similar masses are combined into macroscopic
“lumps,” based on a fractional mass deviation of “alump.” For example,
alump=0.2 means that materials are combined into one or more lumps such
that their masses are within +/- 20% of the effective mass of the lump.
The effective mass of the lump is defined to preserve the macroscopic
slowing down power. Mass lumping up to 0.2 will often reduce execution
time with little impact on the results.</p>
</div>
<div class="section" id="centrm-i-o-files">
<span id="id54"></span><h3>CENTRM I/O files<a class="headerlink" href="#centrm-i-o-files" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#tab7-4-8"><span class="std std-numref">Table 247</span></a> shows filenames used by CENTRM. Some files are not required
for some calculations.</p>
<span id="tab7-4-8"></span><table class="docutils align-default" id="id76">
<caption><span class="caption-number">Table 247 </span><span class="caption-text">Default File Names</span><a class="headerlink" href="#id76" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>File Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ft04f001</p></td>
<td><p>Input MG library (only for standalone execution)</p></td>
</tr>
<tr class="row-odd"><td><p>ft81f001</p>
<p>lib_cen_kern</p>
<p>_centrm.pw.flux</p>
<p>_centrm.pw_macro_xs</p>
</td>
<td><p>Input PW cross-section library from Crawdad PW</p>
<p>Input PW thermal scatter kernels from Crawdad</p>
<p>Output PW flux by zone (only for standalone)</p>
<p>Output PW macro cross-section (optional)</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description-of-the-centrm-ce-cross-section-file">
<span id="id55"></span><h3>Description of the CENTRM CE cross section file<a class="headerlink" href="#description-of-the-centrm-ce-cross-section-file" title="Permalink to this headline">¶</a></h3>
<p>The CENTRM CE cross section library is typically created using the
CRAWDAD module. CRAWDAD is executed automatically during XSProc cases;
but when CENTRM run standalone, the CE library must be pre-generated
prior to the CENTRM calculation (e.g., by running CRAWDAD). CRAWDAD
reads the SCALE CE data files for individual nuclides, and creates a
combined CENTRM library in the binary format shown below.</p>
<table class="docutils align-center" id="id77">
<caption><span class="caption-number">Table 248 </span><span class="caption-text">Header Records.</span><a class="headerlink" href="#id77" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/header-records.svg"><img alt="_images/header-records.svg" src="_images/header-records.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="id78">
<caption><span class="caption-number">Table 249 </span><span class="caption-text">Nuclide Dependent Records (repeat for each nuclide)</span><a class="headerlink" href="#id78" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/nuclide-dependent-records.svg"><img alt="_images/nuclide-dependent-records.svg" src="_images/nuclide-dependent-records.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="description-of-the-centrm-output-pw-flux-file">
<span id="id56"></span><h3>Description of the CENTRM output PW flux file<a class="headerlink" href="#description-of-the-centrm-output-pw-flux-file" title="Permalink to this headline">¶</a></h3>
<p><em>[IZM Records Containing Zone-Averaged PW Fluxes and Moments]</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>DO 1 N = 1 , IZM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 PXJ( NTOTP , M), M=1, JT+1)</p></td>
</tr>
<tr class="row-odd"><td><p><em>(DP) DOUBLE PRECISION ARRAYS</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="example-case">
<span id="id57"></span><h2>Example Case<a class="headerlink" href="#example-case" title="Permalink to this headline">¶</a></h2>
<p>In this section an example standalone CENTRM calculation is demonstrated
for a 1-D slab geometry model of a highly enriched uranium solution with
an iron-56 reflector. To execute CENTRM in standalone mode, nuclear data
libraries must be provided for MG cross sections (file ft04f001), PW
cross sections (file ft81f001), and PW thermal scatter kernels
(lib_cen_kernel). The shell script (=shell) in front of the CENTRM input
is used to link the necessary nuclear data libraries to the CENTRM
calculation. Here it is assumed that the Crawdad module has been
previously run to produce the PW cross section and thermal kernel
libraries, which are located in the same directory from which that the
job is submitted, while the MG library is the 8 group test library from
the SCALE data directory.</p>
<div class="section" id="centrm-input-for-example-case">
<span id="id58"></span><h3>CENTRM input for example case<a class="headerlink" href="#centrm-input-for-example-case" title="Permalink to this headline">¶</a></h3>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=shell</span>
  <span class="err">ln</span> <span class="err">-sf</span> <span class="err">/scale/scale_data/test</span><span class="m">8</span><span class="err">g_v</span><span class="m">7</span><span class="err">.</span><span class="m">1</span> <span class="err">ft</span><span class="m">04</span><span class="err">f</span><span class="m">001</span>
  <span class="err">ln</span> <span class="err">-sf</span>  <span class="err">$RTNDIR/ft</span><span class="m">81</span><span class="err">f</span><span class="m">001</span> <span class="err">ft</span><span class="m">81</span><span class="err">f</span><span class="m">001</span>
  <span class="err">ln</span> <span class="err">-sf</span>  <span class="err">$RTNDIR/lib_cen_kernel</span> <span class="err">lib_cen_kernel</span>
<span class="n">end</span>

<span class="nf">=centrm</span>
<span class="err">centrm</span> <span class="err">standalone</span> <span class="err">example</span>
<span class="m">1</span><span class="err">$$</span> <span class="m">1</span> <span class="m">2</span> <span class="m">15</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span> <span class="m">5</span> <span class="err">e</span>  <span class="m">2</span><span class="err">$$</span>  <span class="err">-</span><span class="m">3</span> <span class="m">0</span> <span class="err">a</span><span class="m">8</span> <span class="m">1</span> <span class="err">e</span>
<span class="m">3</span><span class="err">**</span>  <span class="err">a</span><span class="m">5</span>  <span class="m">0</span><span class="err">.</span><span class="m">0001</span> <span class="m">4000</span><span class="err">.</span><span class="m">0</span> <span class="err">e</span>
<span class="err">t</span>
<span class="m">12</span><span class="err">$$</span>  <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">2</span>   <span class="m">13</span><span class="err">$$</span>  <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">2</span>
<span class="m">14</span><span class="err">$$</span>  <span class="m">92235</span> <span class="m">1001</span> <span class="m">8016</span> <span class="m">7014</span> <span class="m">26056</span>
<span class="m">15</span><span class="err">**</span>  <span class="m">0</span><span class="err">.</span><span class="m">003</span> <span class="m">0</span><span class="err">.</span><span class="m">06</span> <span class="m">0</span><span class="err">.</span><span class="m">04</span> <span class="m">0</span><span class="err">.</span><span class="m">018</span> <span class="m">0</span><span class="err">.</span><span class="m">08</span>
<span class="err">t</span>
<span class="m">34</span><span class="err">**</span>  <span class="err">f</span><span class="m">1</span><span class="err">.</span><span class="m">0</span>    <span class="err">t</span>
<span class="m">35</span><span class="err">**</span> <span class="m">9</span><span class="err">i</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>  <span class="m">4</span><span class="err">i</span> <span class="m">20</span><span class="err">.</span><span class="m">0</span> <span class="m">30</span><span class="err">.</span><span class="m">0</span>  <span class="m">36</span><span class="err">$$</span> <span class="m">10</span><span class="err">r</span><span class="m">1</span> <span class="m">5</span><span class="err">r</span><span class="m">2</span>  <span class="m">39</span><span class="err">$$</span> <span class="m">1</span> <span class="m">2</span>  <span class="m">41</span><span class="err">**</span> <span class="err">f</span><span class="m">300</span><span class="err">.</span><span class="m">0</span>
<span class="err">t</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="centrm-output-for-example-case">
<span id="id59"></span><h3>CENTRM output for example case<a class="headerlink" href="#centrm-output-for-example-case" title="Permalink to this headline">¶</a></h3>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">******************************************************************</span>


    <span class="err">module</span> <span class="err">shell</span> <span class="err">will</span> <span class="err">be</span> <span class="err">called</span> <span class="err">on</span> <span class="err">Tue</span> <span class="err">Mar</span> <span class="m">15</span> <span class="m">16</span><span class="err">:</span><span class="m">52</span><span class="err">:</span><span class="m">40</span> <span class="m">2016</span><span class="err">.</span>
    <span class="err">sequence</span> <span class="err">specification</span> <span class="err">record:=shell</span>

<span class="err">Input</span> <span class="err">Data:</span>
      <span class="err">ln</span> <span class="err">-sf</span> <span class="err">/scale/scale_dev_data/test</span><span class="m">8</span><span class="err">g_v</span><span class="m">7</span><span class="err">.</span><span class="m">1</span> <span class="err">ft</span><span class="m">04</span><span class="err">f</span><span class="m">001</span>
      <span class="err">ln</span> <span class="err">-sf</span> <span class="err">$RTNDIR/ft</span><span class="m">81</span><span class="err">f</span><span class="m">001</span> <span class="err">ft</span><span class="m">81</span><span class="err">f</span><span class="m">001</span>
      <span class="err">ln</span> <span class="err">-sf</span> <span class="err">$RTNDIR/lib_cen_kernel</span> <span class="err">lib_cen_kernel</span>
<span class="n">end</span>

<span class="err">module</span> <span class="err">shell</span> <span class="err">is</span> <span class="err">finished.</span> <span class="err">completion</span> <span class="err">code</span> <span class="m">0</span>

    <span class="err">module</span> <span class="err">centrm</span> <span class="err">will</span> <span class="err">be</span> <span class="err">called</span> <span class="err">on</span> <span class="err">Tue</span> <span class="err">Mar</span> <span class="m">15</span> <span class="m">16</span><span class="err">:</span><span class="m">52</span><span class="err">:</span><span class="m">40</span> <span class="m">2016</span><span class="err">.</span>
    <span class="err">sequence</span> <span class="err">specification</span> <span class="err">record:=centrm</span>

<span class="err">Input</span> <span class="err">Data:</span>
      <span class="err">centrm</span> <span class="err">standalone</span> <span class="err">example</span>
      <span class="m">1</span><span class="err">$$</span> <span class="m">1</span> <span class="m">2</span> <span class="m">15</span> <span class="m">1</span> <span class="m">0</span> <span class="m">2</span> <span class="m">5</span> <span class="err">e</span>  <span class="m">2</span><span class="err">$$</span>  <span class="err">-</span><span class="m">3</span> <span class="m">0</span> <span class="err">a</span><span class="m">8</span> <span class="m">1</span> <span class="err">e</span>
      <span class="m">3</span><span class="err">**</span>  <span class="err">a</span><span class="m">5</span>  <span class="m">0</span><span class="err">.</span><span class="m">0001</span> <span class="m">4000</span><span class="err">.</span><span class="m">0</span> <span class="err">e</span>
      <span class="err">t</span>
      <span class="m">12</span><span class="err">$$</span>  <span class="err">f</span><span class="m">0</span>
      <span class="m">13</span><span class="err">$$</span>  <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">2</span>
      <span class="m">14</span><span class="err">$$</span>  <span class="m">92235</span> <span class="m">1001</span> <span class="m">8016</span> <span class="m">7014</span> <span class="m">26056</span>
      <span class="m">15</span><span class="err">**</span>  <span class="m">0</span><span class="err">.</span><span class="m">003</span> <span class="m">0</span><span class="err">.</span><span class="m">06</span> <span class="m">0</span><span class="err">.</span><span class="m">04</span> <span class="m">0</span><span class="err">.</span><span class="m">018</span> <span class="m">0</span><span class="err">.</span><span class="m">08</span>
      <span class="err">t</span>
      <span class="m">34</span><span class="err">**</span>  <span class="err">f</span><span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="err">t</span>
      <span class="m">35</span><span class="err">**</span> <span class="m">9</span><span class="err">i</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>  <span class="m">4</span><span class="err">i</span> <span class="m">20</span><span class="err">.</span><span class="m">0</span> <span class="m">30</span><span class="err">.</span><span class="m">0</span>
      <span class="m">36</span><span class="err">$$</span> <span class="m">10</span><span class="err">r</span><span class="m">1</span> <span class="m">5</span><span class="err">r</span><span class="m">2</span>  <span class="m">39</span><span class="err">$$</span> <span class="m">1</span> <span class="m">2</span>  <span class="m">41</span><span class="err">**</span> <span class="err">f</span><span class="m">300</span><span class="err">.</span><span class="m">0</span>
      <span class="err">t</span>
<span class="n">end</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="m">1</span><span class="err">$</span> <span class="err">array</span>     <span class="m">18</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">2</span><span class="err">$</span> <span class="err">array</span>     <span class="m">12</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">3</span><span class="err">*</span> <span class="err">array</span>      <span class="m">9</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">0</span><span class="err">t</span>

    <span class="m">12</span><span class="err">$</span> <span class="err">array</span>      <span class="m">5</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">13</span><span class="err">$</span> <span class="err">array</span>      <span class="m">5</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">14</span><span class="err">$</span> <span class="err">array</span>      <span class="m">5</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">15</span><span class="err">*</span> <span class="err">array</span>      <span class="m">5</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">0</span><span class="err">t</span>

    <span class="m">34</span><span class="err">*</span> <span class="err">array</span>     <span class="m">15</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">0</span><span class="err">t</span>

    <span class="m">35</span><span class="err">*</span> <span class="err">array</span>     <span class="m">16</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">36</span><span class="err">$</span> <span class="err">array</span>     <span class="m">15</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">39</span><span class="err">$</span> <span class="err">array</span>      <span class="m">2</span> <span class="err">entries</span> <span class="n">read</span>

    <span class="m">41</span><span class="err">*</span> <span class="err">array</span>      <span class="m">2</span> <span class="err">entries</span> <span class="n">read</span>

     <span class="m">0</span><span class="err">t</span>

     <span class="err">CENTRM</span> <span class="err">MATERIALS</span>

        <span class="err">nuclides</span> <span class="err">on</span>                                                   <span class="err">Mixing</span> <span class="err">Table</span>
        <span class="err">multi-grp</span> <span class="err">lib.</span>  <span class="err">composition</span>                <span class="err">mixture</span>   <span class="err">component</span>   <span class="err">atom</span> <span class="err">density</span>      <span class="err">small</span>
     <span class="m">1</span>     <span class="m">92235</span>            <span class="m">0</span>                         <span class="m">1</span>        <span class="m">92235</span>     <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">03</span>         <span class="m">1</span>
     <span class="m">2</span>      <span class="m">1001</span>            <span class="m">0</span>                         <span class="m">1</span>         <span class="m">1001</span>     <span class="m">6</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">02</span>         <span class="m">1</span>
     <span class="m">3</span>      <span class="m">8016</span>            <span class="m">0</span>                         <span class="m">1</span>         <span class="m">8016</span>     <span class="m">4</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">02</span>         <span class="m">1</span>
     <span class="m">4</span>      <span class="m">7014</span>            <span class="m">0</span>                         <span class="m">1</span>         <span class="m">7014</span>     <span class="m">1</span><span class="err">.</span><span class="m">80000</span><span class="err">E-</span><span class="m">02</span>         <span class="m">1</span>
     <span class="m">5</span>     <span class="m">26056</span>            <span class="m">0</span>                         <span class="m">2</span>        <span class="m">26056</span>     <span class="m">8</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">02</span>         <span class="m">1</span>

   <span class="err">elapsed</span> <span class="err">time</span> <span class="err">.</span><span class="m">00</span> <span class="err">min.</span>
   <span class="err">=time</span> <span class="err">after</span> <span class="err">return</span> <span class="err">from</span> <span class="err">setup_centrm.</span>

     <span class="err">ft</span><span class="m">81</span><span class="err">f</span><span class="m">001</span>            <span class="err">=</span>   <span class="err">pointwise</span> <span class="err">XS</span> <span class="err">library</span> <span class="err">from</span> <span class="err">Crawdad</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">MULTIGROUP</span> <span class="err">STRUCTURE</span>

<span class="err">igm</span>      <span class="err">=</span>        <span class="m">8</span>      <span class="err">number</span> <span class="err">of</span> <span class="err">energy</span> <span class="err">groups</span>
<span class="err">mmt</span>      <span class="err">=</span>        <span class="m">8</span>      <span class="err">number</span> <span class="err">of</span> <span class="err">neutron</span> <span class="err">groups</span>
<span class="err">mcr</span>      <span class="err">=</span>        <span class="m">0</span>      <span class="err">number</span> <span class="err">of</span> <span class="err">gamma</span> <span class="err">groups</span>
<span class="err">iftg</span>     <span class="err">=</span>        <span class="m">5</span>      <span class="err">first</span> <span class="err">thermal</span> <span class="err">group</span> <span class="err">number</span>


<span class="err">GENERAL</span> <span class="err">PROBLEM</span> <span class="err">DATA</span>

<span class="err">ige</span>      <span class="err">=</span>        <span class="m">1</span>     <span class="err">problem</span> <span class="err">geometry</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span> <span class="err">=</span> <span class="err">inf.</span> <span class="err">hom.</span> <span class="err">medium/plane/cylinder/sphere</span>
<span class="err">izm</span>      <span class="err">=</span>        <span class="m">2</span>     <span class="err">number</span> <span class="err">of</span> <span class="err">zones</span>
<span class="err">im</span>       <span class="err">=</span>       <span class="m">15</span>     <span class="err">number</span> <span class="err">of</span> <span class="err">spatial</span> <span class="err">intervals</span>
<span class="err">ibl</span>      <span class="err">=</span>        <span class="m">1</span>     <span class="err">left</span> <span class="err">boundary</span> <span class="err">condition:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span> <span class="err">=</span> <span class="err">vacuum/reflected/periodic/albedo</span>
<span class="err">ibr</span>      <span class="err">=</span>        <span class="m">0</span>     <span class="err">right</span> <span class="err">boundary</span> <span class="err">condition:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span> <span class="err">=</span> <span class="err">vacuum/reflected/periodic/albedo</span>
<span class="err">mxx</span>      <span class="err">=</span>        <span class="m">2</span>     <span class="err">number</span> <span class="err">of</span> <span class="err">mixtures</span>
<span class="err">ms</span>       <span class="err">=</span>        <span class="m">5</span>     <span class="err">mixing</span> <span class="err">table</span> <span class="err">length</span>
<span class="err">isn</span>      <span class="err">=</span>        <span class="m">8</span>     <span class="err">SN</span> <span class="err">quadrature</span> <span class="err">order</span> <span class="err">(not</span> <span class="err">used</span> <span class="err">for</span> <span class="err">npxs=</span><span class="m">6</span><span class="err">)</span>
<span class="err">isct</span>     <span class="err">=</span>        <span class="m">3</span>     <span class="err">order</span> <span class="err">of</span> <span class="err">elastic</span> <span class="err">scattering</span>
<span class="err">isrc</span>     <span class="err">=</span>        <span class="m">1</span>     <span class="err">type</span> <span class="err">of</span> <span class="err">source</span> <span class="err">spectrum:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span> <span class="err">=</span> <span class="err">multigroup</span> <span class="err">input</span> <span class="err">spectrum/fission</span> <span class="err">spectrum/both</span> <span class="err">(</span><span class="m">1</span><span class="err">)</span>
<span class="err">iim</span>      <span class="err">=</span>       <span class="m">20</span>     <span class="err">inner</span> <span class="err">iterations</span> <span class="err">maximum</span> <span class="err">(</span><span class="m">10</span><span class="err">)</span>
<span class="err">iup</span>      <span class="err">=</span>        <span class="m">3</span>     <span class="err">upscatter</span> <span class="err">outer</span> <span class="err">iterations</span> <span class="err">in</span> <span class="err">thermal</span> <span class="err">range</span> <span class="err">(</span><span class="m">3</span><span class="err">)</span>
<span class="err">nfst</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="err">multigroup</span> <span class="err">calculation</span> <span class="err">option</span> <span class="err">in</span> <span class="err">upper</span> <span class="err">energy</span> <span class="err">range</span> <span class="err">[option</span> <span class="err">nfst=</span><span class="m">5</span> <span class="err">is</span> <span class="err">deprecated]:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span><span class="err">/</span><span class="m">4</span><span class="err">/</span><span class="m">6</span> <span class="err">=</span> <span class="err">sn/diffusion/homogeneous/zonewise</span> <span class="err">homogeneous/BN/</span><span class="m">2</span><span class="err">D</span> <span class="err">MoC</span> <span class="err">cell</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">nthr</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="err">multigroup</span> <span class="err">calculation</span> <span class="err">option</span> <span class="err">in</span> <span class="err">lower</span> <span class="err">energy</span> <span class="err">range</span> <span class="err">[option</span> <span class="err">nthr=</span><span class="m">5</span> <span class="err">is</span> <span class="err">deprecated]:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span><span class="err">/</span><span class="m">4</span><span class="err">/</span><span class="m">6</span> <span class="err">=</span> <span class="err">sn/diffusion/homogeneous/zonewise</span> <span class="err">homogeneous/BN/</span><span class="m">2</span><span class="err">D</span> <span class="err">MoC</span> <span class="err">cell</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">npxs</span>     <span class="err">=</span>        <span class="m">1</span>     <span class="err">pointwise</span> <span class="err">calculation</span> <span class="err">option:</span>
                         <span class="err">&lt;=</span><span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span><span class="err">/</span><span class="m">4</span><span class="err">/</span><span class="m">5</span><span class="err">/</span><span class="m">6</span> <span class="err">=</span> <span class="err">no</span> <span class="err">pointwise:</span> <span class="err">do</span> <span class="err">multigroup</span> <span class="err">as</span> <span class="err">in</span> <span class="err">nfst/sn/coll.</span> <span class="err">prob./</span>
                           <span class="err">homogeneous/zonewise</span> <span class="err">homogeneous/zonewise</span> <span class="err">two-region/</span><span class="m">2</span><span class="err">D</span> <span class="err">MoC</span> <span class="err">cell</span> <span class="err">(</span><span class="m">1</span><span class="err">)</span>
<span class="err">isvar</span>    <span class="err">=</span>        <span class="m">3</span>     <span class="err">multigroup</span> <span class="err">source</span> <span class="err">&amp;</span> <span class="err">cross</span> <span class="err">section</span> <span class="err">linearization</span> <span class="err">option</span> <span class="err">:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span><span class="err">/</span><span class="m">3</span> <span class="err">=</span> <span class="err">none/linearize</span> <span class="err">source/linearize</span> <span class="err">group</span> <span class="err">cross</span> <span class="err">sections/both</span> <span class="err">(</span><span class="m">3</span><span class="err">)</span>
<span class="err">mocMesh</span>  <span class="err">=</span>    <span class="err">*****</span>     <span class="err">meshing</span> <span class="err">options</span> <span class="err">for</span> <span class="err">MoC</span> <span class="err">calculation;</span> <span class="err">npxs=</span><span class="m">6</span> <span class="err">only:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span>   <span class="err">=</span> <span class="err">coarse/regular/fine</span> <span class="err">mesh/input</span> <span class="err">by</span> <span class="err">zone</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">mocPol</span>   <span class="err">=</span>        <span class="m">0</span>     <span class="err">number</span> <span class="err">of</span> <span class="err">polar</span> <span class="err">angles</span> <span class="err">for</span> <span class="err">MoC</span> <span class="err">quadrature;</span> <span class="err">npxs=</span><span class="m">6</span> <span class="err">only:</span>
                         <span class="m">2</span><span class="err">/</span><span class="m">3</span><span class="err">/</span><span class="m">4</span> <span class="err">=</span> <span class="err">allowable</span> <span class="err">values</span>        <span class="err">(</span><span class="m">3</span><span class="err">)</span>
<span class="err">mocAzi</span>   <span class="err">=</span>        <span class="m">0</span>     <span class="err">number</span> <span class="err">of</span> <span class="err">azimuthal</span> <span class="err">angles</span> <span class="err">for</span> <span class="err">MoC</span> <span class="err">quadrature;</span> <span class="err">npxs=</span><span class="m">6</span> <span class="err">only:</span>
                         <span class="m">1</span> <span class="err">-&gt;</span> <span class="m">16</span> <span class="err">=</span> <span class="err">allowable</span> <span class="err">values</span>      <span class="err">(</span><span class="m">8</span><span class="err">)</span>
<span class="err">kern</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="err">thermal</span> <span class="err">neutron</span> <span class="err">scattering</span> <span class="err">treatment:</span>
                         <span class="m">0</span><span class="err">/</span><span class="m">1</span> <span class="err">=</span> <span class="err">all</span> <span class="err">free-gas</span> <span class="err">thermal</span> <span class="err">kernels/use</span> <span class="err">bound</span> <span class="err">S(alpha,</span> <span class="err">beta)</span> <span class="err">data</span> <span class="err">if</span> <span class="err">available</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">iscti</span>    <span class="err">=</span>        <span class="m">1</span>     <span class="err">inelastic</span> <span class="err">scattering</span> <span class="err">order</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">nmf</span><span class="m">6</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="err">inelastic</span> <span class="err">scattering</span> <span class="err">option:</span>
                         <span class="err">-</span><span class="m">1</span><span class="err">/</span><span class="m">0</span><span class="err">/</span><span class="m">1</span> <span class="err">=</span> <span class="err">no</span> <span class="err">inelastic/discrete</span> <span class="err">level</span> <span class="err">only/discrete+continuum</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">EDITTING</span> <span class="err">AND</span> <span class="err">OTHER</span> <span class="err">OPTIONS</span>

<span class="err">iprt</span>     <span class="err">=</span>       <span class="err">-</span><span class="m">3</span>     <span class="err">-</span><span class="m">3</span><span class="err">/-</span><span class="m">2</span><span class="err">/-</span><span class="m">1</span><span class="err">/n</span> <span class="err">=</span> <span class="err">mixture</span> <span class="err">cross</span> <span class="err">sections</span> <span class="err">print</span> <span class="err">options:</span>
                          <span class="err">none/write</span> <span class="err">P.W.</span> <span class="err">energy</span> <span class="err">&amp;</span> <span class="err">macro</span> <span class="err">x-sections</span> <span class="err">to</span> <span class="err">output</span> <span class="err">file/print</span> <span class="m">1</span><span class="err">-D</span> <span class="err">M.G.</span> <span class="err">x-sections</span>
                          <span class="err">/print</span> <span class="err">nth</span> <span class="err">p</span> <span class="err">(p</span><span class="m">0</span><span class="err">,p</span><span class="m">1</span><span class="err">..)</span> <span class="err">M.G.</span> <span class="err">x-section</span> <span class="err">matrix</span> <span class="err">(-</span><span class="m">3</span><span class="err">)</span>
<span class="err">id</span><span class="m">1</span>      <span class="err">=</span>        <span class="m">0</span>     <span class="err">-</span><span class="m">1</span><span class="err">/</span><span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span> <span class="err">=</span> <span class="err">flux</span> <span class="err">print</span> <span class="err">options:</span>
                           <span class="err">none/print</span> <span class="err">M.G</span> <span class="err">flux/also</span> <span class="err">print</span> <span class="err">M.G</span> <span class="err">moments/save</span> <span class="err">PW</span> <span class="err">zone</span> <span class="err">flux</span> <span class="err">in</span> <span class="err">ascii</span> <span class="err">file</span>
<span class="err">ipbt</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="m">0</span><span class="err">/</span><span class="m">1</span> <span class="err">=</span> <span class="err">none/group</span> <span class="err">summary</span> <span class="err">table</span> <span class="err">print</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">iqm</span>      <span class="err">=</span>        <span class="m">0</span>     <span class="err">input</span> <span class="err">multigrp</span> <span class="err">volumetric</span> <span class="err">sources</span> <span class="err">(</span><span class="m">0</span><span class="err">/n=no/yes)</span>
<span class="err">ipm</span>      <span class="err">=</span>        <span class="m">0</span>     <span class="err">input</span> <span class="err">multigrp</span> <span class="err">boundary</span> <span class="err">angular</span> <span class="err">sources</span> <span class="err">(</span><span class="m">0</span><span class="err">/n=no/yes)</span>
<span class="err">ipn</span>      <span class="err">=</span>        <span class="m">2</span>     <span class="m">0</span><span class="err">/</span><span class="m">1</span><span class="err">/</span><span class="m">2</span> <span class="err">diff.</span> <span class="err">coef.</span> <span class="err">param</span> <span class="err">(</span><span class="m">2</span><span class="err">)</span>
<span class="err">idfm</span>     <span class="err">=</span>        <span class="m">0</span>     <span class="m">0</span><span class="err">/</span><span class="m">1</span> <span class="err">=</span> <span class="err">none/density</span> <span class="err">factors</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">ixprt</span>    <span class="err">=</span>        <span class="m">1</span>     <span class="m">0</span><span class="err">/</span><span class="m">1</span> <span class="err">=</span> <span class="err">minimum</span> <span class="err">print/regular</span> <span class="err">print</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
<span class="err">mlim</span>     <span class="err">=</span>      <span class="m">100</span>     <span class="m">0</span><span class="err">/m</span> <span class="err">=</span> <span class="err">no</span> <span class="err">effect/restrict</span> <span class="err">nuclides</span> <span class="err">with</span> <span class="err">mass</span> <span class="err">&gt;=</span> <span class="err">m</span> <span class="err">to</span> <span class="err">have</span> <span class="err">PW</span> <span class="err">scatter</span> <span class="err">order</span> <span class="err">&lt;=</span> <span class="err">nlim</span>  <span class="err">(</span><span class="m">100</span><span class="err">)</span>
<span class="err">nlim</span>     <span class="err">=</span>        <span class="m">3</span>     <span class="err">restrictive</span> <span class="err">scatter</span> <span class="err">order</span> <span class="err">(</span><span class="m">1</span><span class="err">)</span>


<span class="err">FLOATING</span> <span class="err">POINT</span> <span class="err">VALUES</span>

<span class="err">eps</span>      <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E-</span><span class="m">03</span>    <span class="err">upscatter</span> <span class="err">integral</span> <span class="err">convergence</span> <span class="err">(</span><span class="m">0</span><span class="err">.</span><span class="m">001</span><span class="err">)</span>
<span class="err">ptc</span>      <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E-</span><span class="m">03</span>    <span class="err">inner</span> <span class="err">iteration</span> <span class="err">convergence</span> <span class="err">(</span><span class="m">0</span><span class="err">.</span><span class="m">001</span><span class="err">)</span>
<span class="err">xnf</span>      <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">01</span>    <span class="err">source</span> <span class="err">normalization</span> <span class="err">factor</span> <span class="err">(</span><span class="m">1</span><span class="err">.</span><span class="m">0</span><span class="err">)</span>
<span class="err">b</span><span class="m">2</span>       <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>    <span class="err">buckling</span> <span class="err">value</span> <span class="err">(</span> <span class="err">cm**(-</span><span class="m">2</span><span class="err">)</span> <span class="err">)</span>
<span class="err">demin</span>    <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E-</span><span class="m">03</span>    <span class="err">lowest</span> <span class="err">energy</span> <span class="err">of</span> <span class="err">pointwise</span> <span class="err">calculation</span> <span class="err">in</span> <span class="err">(eV)</span>
<span class="err">demax</span>    <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">40000</span><span class="err">E+</span><span class="m">04</span>    <span class="err">highest</span> <span class="err">energy</span> <span class="err">of</span> <span class="err">pointwise</span> <span class="err">calculation</span> <span class="err">in</span> <span class="err">(eV)</span>
<span class="err">tole</span>     <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E-</span><span class="m">02</span>    <span class="err">tolerance</span> <span class="err">used</span> <span class="err">in</span> <span class="err">thinning</span> <span class="err">the</span> <span class="err">pointwise</span> <span class="err">cross</span> <span class="err">sections</span> <span class="err">(</span><span class="m">0</span><span class="err">.</span><span class="m">001</span><span class="err">)</span>
<span class="err">mocRay</span>   <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>    <span class="err">distance</span> <span class="err">between</span> <span class="err">MoC</span> <span class="err">rays;</span> <span class="err">npxs=</span><span class="m">6</span> <span class="err">only.</span> <span class="err">(</span><span class="m">0</span><span class="err">.</span><span class="m">02</span><span class="err">)</span>
<span class="err">flet</span>     <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">00</span>    <span class="err">fractional</span> <span class="err">lethargy</span> <span class="err">used</span> <span class="err">in</span> <span class="err">construction</span> <span class="err">of</span> <span class="err">flux</span> <span class="err">energy</span> <span class="err">mesh</span> <span class="err">(</span><span class="m">0</span><span class="err">.</span><span class="m">1</span><span class="err">)</span>
<span class="err">alump</span>    <span class="err">=</span>     <span class="m">0</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>    <span class="err">mass-lumping</span> <span class="err">criterion</span> <span class="err">(</span><span class="m">0</span><span class="err">)</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">.........................................................................................................</span>

  <span class="err">Input</span> <span class="err">DEMIN</span> <span class="err">and</span> <span class="err">DEMAX</span> <span class="err">values</span> <span class="err">may</span> <span class="err">be</span> <span class="err">modified</span> <span class="err">to</span> <span class="err">lie</span> <span class="err">on</span> <span class="err">multigroup</span> <span class="err">boundaries.</span>
    <span class="err">Min</span> <span class="err">and</span> <span class="err">Max</span> <span class="err">energies</span> <span class="err">(eV)</span> <span class="err">defining</span> <span class="err">range</span> <span class="err">for</span> <span class="err">pointwise</span> <span class="err">flux</span> <span class="err">calculation</span>  <span class="err">=</span>     <span class="m">4</span><span class="err">.</span><span class="m">000</span><span class="err">E-</span><span class="m">02    2.000E+04</span>
 <span class="err">.........................................................................................................</span>
<span class="m">1</span>
                             <span class="err">POINTWISE</span> <span class="err">MATERIALS</span> <span class="err">USED</span> <span class="err">IN</span> <span class="err">THIS</span> <span class="err">PROBLEM</span>

         <span class="err">****</span> <span class="err">ZONE</span> <span class="err">NO.</span>   <span class="m">1</span>
              <span class="err">Nuclide</span> <span class="err">ID</span>     <span class="err">No.</span> <span class="err">of</span> <span class="err">Micro</span> <span class="err">XS</span> <span class="err">Energy</span> <span class="err">Points</span> <span class="err">in</span> <span class="err">Energy</span> <span class="err">Range</span>           <span class="m">0</span><span class="err">.</span><span class="m">040</span> <span class="err">to</span>        <span class="m">20000</span><span class="err">.</span><span class="m">000</span>
                   <span class="m">1001</span>              <span class="m">260</span>
                   <span class="m">7014</span>              <span class="m">604</span>
                   <span class="m">8016</span>              <span class="m">448</span>
                  <span class="m">92235</span>           <span class="m">118346</span>
                             <span class="err">No.</span> <span class="err">of</span> <span class="err">Macro</span> <span class="err">XS</span> <span class="err">Energy</span> <span class="err">Points</span> <span class="err">for</span> <span class="err">Zone</span> <span class="err">(After</span> <span class="err">Thinning):</span>    <span class="m">7133</span>

         <span class="err">****</span> <span class="err">ZONE</span> <span class="err">NO.</span>   <span class="m">2</span>
              <span class="err">Nuclide</span> <span class="err">ID</span>     <span class="err">No.</span> <span class="err">of</span> <span class="err">Micro</span> <span class="err">XS</span> <span class="err">Energy</span> <span class="err">Points</span> <span class="err">in</span> <span class="err">Energy</span> <span class="err">Range</span>           <span class="m">0</span><span class="err">.</span><span class="m">040</span> <span class="err">to</span>        <span class="m">20000</span><span class="err">.</span><span class="m">000</span>
                  <span class="m">26056</span>             <span class="m">1379</span>
                             <span class="err">No.</span> <span class="err">of</span> <span class="err">Macro</span> <span class="err">XS</span> <span class="err">Energy</span> <span class="err">Points</span> <span class="err">for</span> <span class="err">Zone</span> <span class="err">(After</span> <span class="err">Thinning):</span>     <span class="m">363</span>


                             <span class="err">NUMBER</span> <span class="err">OF</span> <span class="err">POINTS</span> <span class="err">IN</span> <span class="err">FINAL</span> <span class="err">ENERGY</span> <span class="err">MESH</span> <span class="err">FOR</span> <span class="err">FLUX</span> <span class="err">CALCULATION</span>     <span class="m">12687</span>
                             <span class="err">NUMBER</span> <span class="err">OF</span> <span class="err">POINTS</span> <span class="err">IN</span> <span class="err">PW</span> <span class="err">THERMAL</span> <span class="err">RANGE</span>                             <span class="m">458</span>


          <span class="err">No</span> <span class="err">unit</span> <span class="err">supplied</span> <span class="err">for</span> <span class="err">PW</span> <span class="err">kinematics</span> <span class="err">data.</span>
          <span class="err">All</span> <span class="err">PW</span> <span class="err">thermal</span> <span class="err">scatter</span> <span class="err">kernels</span> <span class="err">are</span> <span class="err">treated</span> <span class="err">as</span> <span class="err">Free</span> <span class="err">Gas</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">NEUTRON</span> <span class="err">MULTIGROUP</span> <span class="err">PARAMETERS</span>


    <span class="err">gp</span>    <span class="err">energy</span>      <span class="err">lethargy</span>      <span class="err">mid</span> <span class="err">pt</span>      <span class="err">pointwise</span>      <span class="err">calc</span>                      <span class="err">right</span>        <span class="err">left</span>
        <span class="err">boundaries</span>   <span class="err">boundaries</span>   <span class="err">velocities</span>     <span class="err">flx</span> <span class="err">pts</span>       <span class="err">type</span>                     <span class="err">albedo</span>       <span class="err">albedo</span>
     <span class="m">1</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">07</span> <span class="err">-</span><span class="m">6</span><span class="err">.</span><span class="m">93147</span><span class="err">E-</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">51321</span><span class="err">E+</span><span class="m">09</span>         <span class="m">0</span>            <span class="m">0</span>
     <span class="m">2</span>  <span class="m">8</span><span class="err">.</span><span class="m">20000</span><span class="err">E+</span><span class="m">05</span>  <span class="m">2</span><span class="err">.</span><span class="m">50104</span><span class="err">E+</span><span class="m">00</span>  <span class="m">4</span><span class="err">.</span><span class="m">31276</span><span class="err">E+</span><span class="m">08</span>         <span class="m">0</span>            <span class="m">0</span>
     <span class="m">3</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">04</span>  <span class="m">6</span><span class="err">.</span><span class="m">21461</span><span class="err">E+</span><span class="m">00</span>  <span class="m">4</span><span class="err">.</span><span class="m">01867</span><span class="err">E+</span><span class="m">07</span>      <span class="m">8332</span>            <span class="m">1</span>
     <span class="m">4</span>  <span class="m">1</span><span class="err">.</span><span class="m">05000</span><span class="err">E+</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">14641</span><span class="err">E+</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">03421</span><span class="err">E+</span><span class="m">06</span>      <span class="m">3893</span>            <span class="m">1</span>
     <span class="m">5</span>  <span class="m">5</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">1</span><span class="err">.</span><span class="m">45087</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">78251</span><span class="err">E+</span><span class="m">06</span>       <span class="m">238</span>            <span class="m">1</span>
     <span class="m">6</span>  <span class="m">6</span><span class="err">.</span><span class="m">50000</span><span class="err">E-</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">65489</span><span class="err">E+</span><span class="m">01</span>  <span class="m">5</span><span class="err">.</span><span class="m">78908</span><span class="err">E+</span><span class="m">05</span>       <span class="m">134</span>            <span class="m">1</span>
     <span class="m">7</span>  <span class="m">1</span><span class="err">.</span><span class="m">50000</span><span class="err">E-</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">80152</span><span class="err">E+</span><span class="m">01</span>  <span class="m">3</span><span class="err">.</span><span class="m">45722</span><span class="err">E+</span><span class="m">05</span>        <span class="m">85</span>            <span class="m">1</span>
     <span class="m">8</span>  <span class="m">4</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">93370</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">55701</span><span class="err">E+</span><span class="m">05</span>         <span class="m">0</span>            <span class="m">0</span>
     <span class="m">9</span>  <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E-</span><span class="m">05  2.76310E+01</span>


               <span class="err">DESCRIPTION</span> <span class="err">OF</span> <span class="err">ZONES</span>

          <span class="err">mixture</span>   <span class="err">temperature</span>  <span class="err">Dancoff</span> <span class="err">factr</span>
          <span class="err">by</span> <span class="err">zone</span>     <span class="err">by</span> <span class="err">zone</span>       <span class="err">by</span> <span class="err">zone</span>
     <span class="m">1</span>         <span class="m">1</span>     <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">02</span>       <span class="m">0</span>
     <span class="m">2</span>         <span class="m">2</span>     <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">02</span>       <span class="m">0</span>


                     <span class="err">SN</span> <span class="err">QUADRATURE</span> <span class="err">CONSTANTS</span>

          <span class="err">weights</span>    <span class="err">directions</span>   <span class="err">refl</span> <span class="err">direc</span>    <span class="err">wt</span> <span class="err">x</span> <span class="err">cos</span>
     <span class="m">1</span>       <span class="m">0</span>      <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">9</span>          <span class="m">0</span>
     <span class="m">2</span>  <span class="m">8</span><span class="err">.</span><span class="m">69637</span><span class="err">E-</span><span class="m">02</span> <span class="err">-</span><span class="m">9</span><span class="err">.</span><span class="m">30568</span><span class="err">E-</span><span class="m">01</span>         <span class="m">9    -8.09257E-02</span>
     <span class="m">3</span>  <span class="m">1</span><span class="err">.</span><span class="m">63036</span><span class="err">E-</span><span class="m">01</span> <span class="err">-</span><span class="m">6</span><span class="err">.</span><span class="m">69991</span><span class="err">E-</span><span class="m">01</span>         <span class="m">8    -1.09233E-01</span>
     <span class="m">4</span>  <span class="m">1</span><span class="err">.</span><span class="m">63036</span><span class="err">E-</span><span class="m">01</span> <span class="err">-</span><span class="m">3</span><span class="err">.</span><span class="m">30009</span><span class="err">E-</span><span class="m">01</span>         <span class="m">7    -5.38035E-02</span>
     <span class="m">5</span>  <span class="m">8</span><span class="err">.</span><span class="m">69637</span><span class="err">E-</span><span class="m">02</span> <span class="err">-</span><span class="m">6</span><span class="err">.</span><span class="m">94318</span><span class="err">E-</span><span class="m">02</span>         <span class="m">6    -6.03805E-03</span>
     <span class="m">6</span>  <span class="m">8</span><span class="err">.</span><span class="m">69637</span><span class="err">E-</span><span class="m">02</span>  <span class="m">6</span><span class="err">.</span><span class="m">94318</span><span class="err">E-</span><span class="m">02</span>         <span class="m">5     6.03805E-03</span>
     <span class="m">7</span>  <span class="m">1</span><span class="err">.</span><span class="m">63036</span><span class="err">E-</span><span class="m">01</span>  <span class="m">3</span><span class="err">.</span><span class="m">30009</span><span class="err">E-</span><span class="m">01</span>         <span class="m">4     5.38035E-02</span>
     <span class="m">8</span>  <span class="m">1</span><span class="err">.</span><span class="m">63036</span><span class="err">E-</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">69991</span><span class="err">E-</span><span class="m">01</span>         <span class="m">3     1.09233E-01</span>
     <span class="m">9</span>  <span class="m">8</span><span class="err">.</span><span class="m">69637</span><span class="err">E-</span><span class="m">02</span>  <span class="m">9</span><span class="err">.</span><span class="m">30568</span><span class="err">E-</span><span class="m">01</span>         <span class="m">2     8.09257E-02</span>

 <span class="err">CONSTANTS</span> <span class="err">FOR</span> <span class="err">P(</span> <span class="m">3</span><span class="err">)</span> <span class="err">SCATTERING</span> <span class="err">IN</span> <span class="err">SN</span> <span class="err">CALCULATION</span>

 <span class="err">angl</span>    <span class="err">set</span>  <span class="m">1</span>       <span class="err">set</span>  <span class="m">2</span>       <span class="err">set</span>  <span class="m">3</span>
     <span class="m">1</span>   <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">000</span><span class="err">E+</span><span class="m">00</span>    <span class="m">1</span><span class="err">.</span><span class="m">000</span><span class="err">E+</span><span class="m">00   -1.000E+00</span>
     <span class="m">2</span>   <span class="err">-</span><span class="m">9</span><span class="err">.</span><span class="m">306</span><span class="err">E-</span><span class="m">01</span>    <span class="m">7</span><span class="err">.</span><span class="m">989</span><span class="err">E-</span><span class="m">01   -6.187E-01</span>
     <span class="m">3</span>   <span class="err">-</span><span class="m">6</span><span class="err">.</span><span class="m">700</span><span class="err">E-</span><span class="m">01</span>    <span class="m">1</span><span class="err">.</span><span class="m">733</span><span class="err">E-</span><span class="m">01    2.531E-01</span>
     <span class="m">4</span>   <span class="err">-</span><span class="m">3</span><span class="err">.</span><span class="m">300</span><span class="err">E-</span><span class="m">01</span>   <span class="err">-</span><span class="m">3</span><span class="err">.</span><span class="m">366</span><span class="err">E-</span><span class="m">01    4.052E-01</span>
     <span class="m">5</span>   <span class="err">-</span><span class="m">6</span><span class="err">.</span><span class="m">943</span><span class="err">E-</span><span class="m">02</span>   <span class="err">-</span><span class="m">4</span><span class="err">.</span><span class="m">928</span><span class="err">E-</span><span class="m">01    1.033E-01</span>
     <span class="m">6</span>    <span class="m">6</span><span class="err">.</span><span class="m">943</span><span class="err">E-</span><span class="m">02</span>   <span class="err">-</span><span class="m">4</span><span class="err">.</span><span class="m">928</span><span class="err">E-</span><span class="m">01   -1.033E-01</span>
     <span class="m">7</span>    <span class="m">3</span><span class="err">.</span><span class="m">300</span><span class="err">E-</span><span class="m">01</span>   <span class="err">-</span><span class="m">3</span><span class="err">.</span><span class="m">366</span><span class="err">E-</span><span class="m">01   -4.052E-01</span>
     <span class="m">8</span>    <span class="m">6</span><span class="err">.</span><span class="m">700</span><span class="err">E-</span><span class="m">01</span>    <span class="m">1</span><span class="err">.</span><span class="m">733</span><span class="err">E-</span><span class="m">01   -2.531E-01</span>
     <span class="m">9</span>    <span class="m">9</span><span class="err">.</span><span class="m">306</span><span class="err">E-</span><span class="m">01</span>    <span class="m">7</span><span class="err">.</span><span class="m">989</span><span class="err">E-</span><span class="m">01    6.187E-01</span>

   <span class="err">elapsed</span> <span class="err">time</span> <span class="err">.</span><span class="m">02</span> <span class="err">min.</span>
   <span class="err">=time</span> <span class="err">at</span> <span class="err">after</span> <span class="err">return</span> <span class="err">from</span> <span class="err">drtran...</span> <span class="err">calling</span> <span class="err">calc.</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">GEOMETRY</span> <span class="err">DESCRIPTION</span>

<span class="m">1</span>  <span class="err">int</span>     <span class="err">radii</span>       <span class="err">mid</span> <span class="err">pts</span>     <span class="err">zone</span> <span class="err">no.</span>       <span class="err">areas</span>       <span class="err">volumes</span>     <span class="err">dens</span> <span class="err">fact</span>
<span class="m">1</span>       <span class="m">0</span>       <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">2</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">3</span>  <span class="m">4</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">5</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">4</span>  <span class="m">6</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">7</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">5</span>  <span class="m">8</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">9</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">6</span>  <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">7</span>  <span class="m">1</span><span class="err">.</span><span class="m">20000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">30000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">8</span>  <span class="m">1</span><span class="err">.</span><span class="m">40000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">50000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">9</span>  <span class="m">1</span><span class="err">.</span><span class="m">60000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">70000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">10</span>  <span class="m">1</span><span class="err">.</span><span class="m">80000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">90000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">1</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">11</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">2</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">12</span>  <span class="m">2</span><span class="err">.</span><span class="m">20000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">30000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">2</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">13</span>  <span class="m">2</span><span class="err">.</span><span class="m">40000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">50000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">2</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">14</span>  <span class="m">2</span><span class="err">.</span><span class="m">60000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">70000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">2</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">15</span>  <span class="m">2</span><span class="err">.</span><span class="m">80000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">90000</span><span class="err">E+</span><span class="m">01</span>         <span class="m">2</span>     <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00  2.00000E+00</span>
<span class="m">16</span>  <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">01                            1.00000E+00</span>
<span class="m">1</span>

<span class="err">EXTERNAL</span> <span class="err">AND</span> <span class="err">FISSION</span> <span class="err">SOURCE</span> <span class="err">DATA</span>

<span class="err">int</span>     <span class="err">radii</span>       <span class="err">mid</span> <span class="err">pts</span>   <span class="err">fixd</span> <span class="err">src</span> <span class="err">spec</span>          <span class="err">normalized</span> <span class="err">fiss</span> <span class="err">src</span>
<span class="m">1</span>       <span class="m">0</span>       <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00                            5.00000E-02</span>
<span class="m">2</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">3</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00                            5.00000E-02</span>
<span class="m">3</span>  <span class="m">4</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">5</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00                            5.00000E-02</span>
<span class="m">4</span>  <span class="m">6</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">7</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00                            5.00000E-02</span>
<span class="m">5</span>  <span class="m">8</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00</span>  <span class="m">9</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">00                            5.00000E-02</span>
<span class="m">6</span>  <span class="m">1</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">01                            5.00000E-02</span>
<span class="m">7</span>  <span class="m">1</span><span class="err">.</span><span class="m">20000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">30000</span><span class="err">E+</span><span class="m">01                            5.00000E-02</span>
<span class="m">8</span>  <span class="m">1</span><span class="err">.</span><span class="m">40000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">50000</span><span class="err">E+</span><span class="m">01                            5.00000E-02</span>
<span class="m">9</span>  <span class="m">1</span><span class="err">.</span><span class="m">60000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">70000</span><span class="err">E+</span><span class="m">01                            5.00000E-02</span>
<span class="m">10</span>  <span class="m">1</span><span class="err">.</span><span class="m">80000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">90000</span><span class="err">E+</span><span class="m">01                            5.00000E-02</span>
<span class="m">11</span>  <span class="m">2</span><span class="err">.</span><span class="m">00000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">10000</span><span class="err">E+</span><span class="m">01</span>                                 <span class="m">0</span>
<span class="m">12</span>  <span class="m">2</span><span class="err">.</span><span class="m">20000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">30000</span><span class="err">E+</span><span class="m">01</span>                                 <span class="m">0</span>
<span class="m">13</span>  <span class="m">2</span><span class="err">.</span><span class="m">40000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">50000</span><span class="err">E+</span><span class="m">01</span>                                 <span class="m">0</span>
<span class="m">14</span>  <span class="m">2</span><span class="err">.</span><span class="m">60000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">70000</span><span class="err">E+</span><span class="m">01</span>                                 <span class="m">0</span>
<span class="m">15</span>  <span class="m">2</span><span class="err">.</span><span class="m">80000</span><span class="err">E+</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">90000</span><span class="err">E+</span><span class="m">01</span>                                 <span class="m">0</span>
<span class="m">16  3.00000E+01</span>
<span class="m">1</span>
</pre></div>
</div>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">MULTIGROUP</span> <span class="err">SCALAR</span> <span class="err">FLUX</span> <span class="err">(P</span><span class="m">0</span> <span class="err">MOMENT)</span>

  <span class="err">int.</span>   <span class="err">grp.</span>  <span class="m">1</span>      <span class="err">grp.</span>  <span class="m">2</span>      <span class="err">grp.</span>  <span class="m">3</span>      <span class="err">grp.</span>  <span class="m">4</span>      <span class="err">grp.</span>  <span class="m">5</span>      <span class="err">grp.</span>  <span class="m">6</span>      <span class="err">grp.</span>  <span class="m">7</span>      <span class="err">grp.</span>  <span class="m">8</span>
     <span class="m">1</span>  <span class="m">1</span><span class="err">.</span><span class="m">49464</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">16136</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">97417</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">40893</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">79816</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">46041</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">93163</span><span class="err">E-</span><span class="m">03  4.53285E-03</span>
     <span class="m">2</span>  <span class="m">1</span><span class="err">.</span><span class="m">49408</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">16093</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">97385</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">40770</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">79734</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">46035</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">98650</span><span class="err">E-</span><span class="m">03  4.79191E-03</span>
     <span class="m">3</span>  <span class="m">1</span><span class="err">.</span><span class="m">49422</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">15720</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">97300</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">40356</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">79569</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">45962</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">95732</span><span class="err">E-</span><span class="m">03  4.61562E-03</span>
     <span class="m">4</span>  <span class="m">1</span><span class="err">.</span><span class="m">49164</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">15343</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">97118</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">39612</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">79044</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">45759</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">95761</span><span class="err">E-</span><span class="m">03  4.72210E-03</span>
     <span class="m">5</span>  <span class="m">1</span><span class="err">.</span><span class="m">49106</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">13917</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">96726</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">37835</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">78199</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">45410</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">94751</span><span class="err">E-</span><span class="m">03  4.64476E-03</span>
     <span class="m">6</span>  <span class="m">1</span><span class="err">.</span><span class="m">48182</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">11713</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">95901</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">33956</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">75685</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">44420</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">89064</span><span class="err">E-</span><span class="m">03  4.64109E-03</span>
     <span class="m">7</span>  <span class="m">1</span><span class="err">.</span><span class="m">47512</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">05913</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">93957</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">24791</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">71327</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">42704</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">84992</span><span class="err">E-</span><span class="m">03  4.59489E-03</span>
     <span class="m">8</span>  <span class="m">1</span><span class="err">.</span><span class="m">43892</span><span class="err">E-</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">93993</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">89432</span><span class="err">E-</span><span class="m">01</span>  <span class="m">7</span><span class="err">.</span><span class="m">09230</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">61956</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">39005</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">64907</span><span class="err">E-</span><span class="m">03  4.43077E-03</span>
     <span class="m">9</span>  <span class="m">1</span><span class="err">.</span><span class="m">38788</span><span class="err">E-</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">61071</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">82365</span><span class="err">E-</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">80018</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">47040</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">33102</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">46977</span><span class="err">E-</span><span class="m">03  4.33076E-03</span>
    <span class="m">10</span>  <span class="m">1</span><span class="err">.</span><span class="m">14667</span><span class="err">E-</span><span class="m">01</span>  <span class="m">5</span><span class="err">.</span><span class="m">81119</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">75350</span><span class="err">E-</span><span class="m">01</span>  <span class="m">6</span><span class="err">.</span><span class="m">17556</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">03161</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">13955</span><span class="err">E-</span><span class="m">02</span>  <span class="m">4</span><span class="err">.</span><span class="m">57365</span><span class="err">E-</span><span class="m">03  3.58528E-03</span>
    <span class="m">11</span>  <span class="m">7</span><span class="err">.</span><span class="m">10033</span><span class="err">E-</span><span class="m">02</span>  <span class="m">4</span><span class="err">.</span><span class="m">72163</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">70191</span><span class="err">E-</span><span class="m">01</span>  <span class="m">5</span><span class="err">.</span><span class="m">14605</span><span class="err">E-</span><span class="m">02</span>  <span class="m">2</span><span class="err">.</span><span class="m">15414</span><span class="err">E-</span><span class="m">02</span>  <span class="m">7</span><span class="err">.</span><span class="m">71994</span><span class="err">E-</span><span class="m">03</span>  <span class="m">2</span><span class="err">.</span><span class="m">57498</span><span class="err">E-</span><span class="m">03  1.07163E-03</span>
    <span class="m">12</span>  <span class="m">4</span><span class="err">.</span><span class="m">41942</span><span class="err">E-</span><span class="m">02</span>  <span class="m">3</span><span class="err">.</span><span class="m">58651</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">47094</span><span class="err">E-</span><span class="m">01</span>  <span class="m">3</span><span class="err">.</span><span class="m">99690</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">38534</span><span class="err">E-</span><span class="m">02</span>  <span class="m">4</span><span class="err">.</span><span class="m">46652</span><span class="err">E-</span><span class="m">03</span>  <span class="m">1</span><span class="err">.</span><span class="m">23499</span><span class="err">E-</span><span class="m">03  1.02896E-04</span>
    <span class="m">13</span>  <span class="m">3</span><span class="err">.</span><span class="m">07018</span><span class="err">E-</span><span class="m">02</span>  <span class="m">2</span><span class="err">.</span><span class="m">56932</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">17584</span><span class="err">E-</span><span class="m">01</span>  <span class="m">2</span><span class="err">.</span><span class="m">91750</span><span class="err">E-</span><span class="m">02</span>  <span class="m">9</span><span class="err">.</span><span class="m">12693</span><span class="err">E-</span><span class="m">03</span>  <span class="m">2</span><span class="err">.</span><span class="m">42263</span><span class="err">E-</span><span class="m">03</span>  <span class="m">6</span><span class="err">.</span><span class="m">13347</span><span class="err">E-</span><span class="m">04  4.02885E-05</span>
    <span class="m">14</span>  <span class="m">2</span><span class="err">.</span><span class="m">00333</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">74870</span><span class="err">E-</span><span class="m">02</span>  <span class="m">8</span><span class="err">.</span><span class="m">62759</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">88824</span><span class="err">E-</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">53088</span><span class="err">E-</span><span class="m">03</span>  <span class="m">1</span><span class="err">.</span><span class="m">18988</span><span class="err">E-</span><span class="m">03</span>  <span class="m">2</span><span class="err">.</span><span class="m">76717</span><span class="err">E-</span><span class="m">04  1.54836E-05</span>
    <span class="m">15</span>  <span class="m">1</span><span class="err">.</span><span class="m">25992</span><span class="err">E-</span><span class="m">02</span>  <span class="m">9</span><span class="err">.</span><span class="m">76450</span><span class="err">E-</span><span class="m">03</span>  <span class="m">5</span><span class="err">.</span><span class="m">01845</span><span class="err">E-</span><span class="m">02</span>  <span class="m">8</span><span class="err">.</span><span class="m">56130</span><span class="err">E-</span><span class="m">03</span>  <span class="m">2</span><span class="err">.</span><span class="m">43234</span><span class="err">E-</span><span class="m">03</span>  <span class="m">4</span><span class="err">.</span><span class="m">58629</span><span class="err">E-</span><span class="m">04</span>  <span class="m">1</span><span class="err">.</span><span class="m">02719</span><span class="err">E-</span><span class="m">04  5.89663E-06</span>

   <span class="err">elapsed</span> <span class="err">time</span> <span class="err">.</span><span class="m">03</span> <span class="err">min.</span>
   <span class="err">=time</span> <span class="err">at</span> <span class="n">end</span><span class="err"> </span><span class="n">of</span><span class="err"> </span><span class="n">centrm</span><span class="err">_</span><span class="n">Execute</span><span class="err">.</span>

    <span class="err">module</span> <span class="err">centrm</span> <span class="err">used</span> <span class="m">2</span><span class="err">.</span><span class="m">34</span> <span class="err">seconds</span> <span class="err">cpu</span> <span class="err">time</span> <span class="err">for</span> <span class="err">the</span> <span class="err">current</span> <span class="err">pass.</span>

    <span class="err">module</span> <span class="err">centrm</span> <span class="err">is</span> <span class="err">finished.</span> <span class="err">completion</span> <span class="err">code</span>    <span class="m">0</span><span class="err">.</span> <span class="err">total</span> <span class="err">cpu</span> <span class="err">time</span> <span class="err">used</span> <span class="m">0</span> <span class="err">seconds.</span>

    <span class="err">SCALE</span> <span class="err">is</span> <span class="err">finished</span> <span class="err">on</span> <span class="err">Tue</span> <span class="err">Mar</span> <span class="m">15</span> <span class="m">16</span><span class="err">:</span><span class="m">52</span><span class="err">:</span><span class="m">42</span> <span class="m">2016</span><span class="err">.</span>

<span class="err">--------------------------</span> <span class="err">Summary</span> <span class="err">--------------------------</span>
<span class="err">shell</span> <span class="err">finished.</span> <span class="err">used</span> <span class="m">0</span><span class="err">.</span><span class="m">02</span> <span class="err">seconds.</span>
<span class="err">centrm</span> <span class="err">finished.</span> <span class="err">used</span> <span class="m">2</span><span class="err">.</span><span class="m">34</span> <span class="err">seconds.</span>
<span class="err">------------------------</span> <span class="err">End</span> <span class="err">Summary</span> <span class="err">------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="centrm-pw-library-and-flux-file-formats">
<span id="id60"></span><h2>CENTRM PW library and flux file formats<a class="headerlink" href="#centrm-pw-library-and-flux-file-formats" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#id61"><span class="std std-ref">Description of the CENTRM CE cross section file</span></a> below describes the format for the input CENTRM PW data
library (binary). The subsequent <a class="reference internal" href="#id63"><span class="std std-ref">Description of the CENTRM output PW flux file</span></a>, describes the format of
the output PW flux file (binary) produced by CENTRM, which is input to
the PMC code.</p>
<div class="section" id="id61">
<span id="id62"></span><h3>Description of the CENTRM CE cross section file<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h3>
<p>The CENTRM CE cross section library is typically created using the
CRAWDAD module in SCALE. CRAWDAD reads the SCALE CE data files for
individual nuclides, and creates the combined CENTRM library.</p>
<table class="docutils align-center" id="id79">
<caption><span class="caption-number">Table 250 </span><span class="caption-text">17 Header Records described below.</span><a class="headerlink" href="#id79" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/header-records-3.svg"><img alt="_images/header-records-3.svg" src="_images/header-records-3.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="id80">
<caption><span class="caption-number">Table 251 </span><span class="caption-text">[NUCLIDE DIRECTORY : 1 RECORD/NUCLIDE].</span><a class="headerlink" href="#id80" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/nuclide-dependent-records-2.svg"><img alt="_images/nuclide-dependent-records-2.svg" src="_images/nuclide-dependent-records-2.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id63">
<span id="id64"></span><h3>Description of the CENTRM output PW flux file<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-center" id="id81">
<caption><span class="caption-number">Table 252 </span><span class="caption-text">[3 Header Records Described Below].</span><a class="headerlink" href="#id81" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><a class="reference internal image-reference" href="_images/header-records-4.svg"><img alt="_images/header-records-4.svg" src="_images/header-records-4.svg" width="700" /></a>
</td>
</tr>
</tbody>
</table>
<p><em>[IZM Records Containing Zone-Averaged P.W. Fluxes and Moments,
Described Below]</em></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>DO 1 N = 1 , IZM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 PXJ( NTOTP , M), M=1, JT+1)</p></td>
</tr>
<tr class="row-odd"><td><p><em>(DP) DOUBLE PRECISION ARRAYS</em></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="centrm-error-messages">
<span id="id65"></span><h2>CENTRM Error Messages<a class="headerlink" href="#centrm-error-messages" title="Permalink to this headline">¶</a></h2>
<p>CENTRM prints several of the same error messages as the XSDRNPM code.
Users should refer to the XSDRNPM chapter for these. CENTRM also prints
the additional error messages shown below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>STATEMENT IN PRINTOUT</p></td>
<td></td>
<td><p>USER ACTION</p></td>
</tr>
<tr class="row-even"><td><p>ERROR. DEMIN exceeds
maximum energy in
working library</p>
<p>STOP 400</p>
</td>
<td></td>
<td><p>Reduce input value of
DEMIN</p></td>
</tr>
<tr class="row-odd"><td><p>ERROR. DEMAX exceeds
DEMIN</p>
<p>STOP 401</p>
</td>
<td></td>
<td><p>Check input values
for PW energy limits</p></td>
</tr>
<tr class="row-even"><td><p>***CALCULATION
TERMINATED.</p>
<p>No neutron groups in
working library</p>
</td>
<td></td>
<td><p>Check AMPX working
library</p></td>
</tr>
<tr class="row-odd"><td><p>WARNING: Thermal
Source is 0 in ACCEL
<strong>–OR-</strong></p>
<p>WARNING: Thermal
Absorption + Leakage
is 0 in ACCEL</p>
</td>
<td></td>
<td><p>Check input source
and thermal
cross-section data
(often caused by
using Zonewise
Infinite Medium
option with no source
in some zone)</p></td>
</tr>
<tr class="row-even"><td><p>Requests nuclide
<em>XXX</em> which is not on
your working library.</p></td>
<td></td>
<td><p>Check nuclide ID’s
and composition
numbers in mixing
table to make sure
they are on MG
library; Verify that
PW and MG</p>
<p>libraries are
consistent</p>
</td>
</tr>
</tbody>
</table>
<p id="bibtex-bibliography-CENTRM-0"><dl class="citation">
<dt class="bibtex label" id="bell-nuclear-1970"><span class="brackets">BG70</span><span class="fn-backref">(<a href="#id9">1</a>,<a href="#id16">2</a>)</span></dt>
<dd><p>George I. Bell and Samuel Glasstone. Nuclear reactor theory. Technical Report, US Atomic Energy Commission, Washington, DC (United States), 1970.</p>
</dd>
<dt class="bibtex label" id="carlvik-method-1964"><span class="brackets"><a class="fn-backref" href="#id47">Car64</a></span></dt>
<dd><p>Ingvar Carlvik. A method for calculating collision probabilities in general cylindrical geometry and applications to flux distributions and Dancoff factors. Technical Report, Aktiebolaget Atomenergi, Stockholm (Sweden), 1964.</p>
</dd>
<dt class="bibtex label" id="honeck-flange-ii-1971"><span class="brackets"><a class="fn-backref" href="#id20">HF71</a></span></dt>
<dd><p>H. C. Honeck and D. R. Finch. FLANGE-II, A Code to Process Thermal Neutron Data from an ENDF/B Tape. <em>Report DP-1278, Savannah River Lab</em>, 1971.</p>
</dd>
<dt class="bibtex label" id="kim-method-2012"><span class="brackets"><a class="fn-backref" href="#id51">KW12</a></span></dt>
<dd><p>Kang Seog Kim and Mark L. Williams. The Method of Characteristics for 2-D Multigroup and Pointwise Transport Calculations in SCALE/CENTRM. <em>PHYSOR 2012</em>, 2012.</p>
</dd>
<dt class="bibtex label" id="robinson-notes-1981"><span class="brackets">Rob81</span><span class="fn-backref">(<a href="#id19">1</a>,<a href="#id22">2</a>)</span></dt>
<dd><p>G. S. Robinson. Notes on the AAEC Version of XLACS-II. <em>Informal Memo (9/3/81)</em>, 1981.</p>
</dd>
<dt class="bibtex label" id="williams-submoment-2000"><span class="brackets">Wil00</span><span class="fn-backref">(<a href="#id13">1</a>,<a href="#id14">2</a>,<a href="#id21">3</a>,<a href="#id34">4</a>)</span></dt>
<dd><p>Mark L. Williams. Submoment expansion of neutron-scattering sources. <em>Nuclear science and engineering</em>, 134(2):218–226, 2000. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="williams-computation-1995"><span class="brackets"><a class="fn-backref" href="#id24">WA95</a></span></dt>
<dd><p>Mark L. Williams and Mehdi Asgari. Computation of continuous-energy neutron spectra with discrete ordinates transport theory. <em>Nuclear Science and Engineering</em>, 121(2):173–201, 1995. Publisher: Taylor &amp; Francis.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PMC.html" class="btn btn-neutral float-right" title="PMC: A Program to Produce Multigroup Cross Sections Using Pointwise Energy Spectra from CENTRM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="BONAMI.html" class="btn btn-neutral float-left" title="BONAMI: Resonance Self-Shielding by the Bondarenko Method" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, SCALE developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>