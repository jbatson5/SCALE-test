

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations &mdash; SCALE Manual 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MAVRIC Appendix A: CAAS Capability" href="CAAScapability.html" />
    <link rel="prev" title="Welcome to the SCALE manual!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SCALE Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Radiation Shielding</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cadis-methodology">CADIS Methodology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview-of-cadis">Overview of CADIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-sources-with-cadis">Multiple sources with CADIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-tallies-with-cadis">Multiple tallies with CADIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forward-weighted-cadis">Forward-weighted CADIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mavric-implementation-of-cadis">MAVRIC Implementation of CADIS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#denovo">Denovo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monaco">Monaco</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-mavric">Running MAVRIC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mavric-input">MAVRIC input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#composition-block">Composition block</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sggp-geometry-blocks">SGGP geometry blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-blocks-shared-with-monaco">Other blocks shared with Monaco</a></li>
<li class="toctree-l3"><a class="reference internal" href="#importance-map-block">Importance map block</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#constructing-a-mesh-for-the-sn-calculation">Constructing a mesh for the S<sub>N</sub> calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#macromaterials-for-sn-geometries">Macromaterials for S<sub>N</sub> geometries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#optimizing-source-detector-problems">Optimizing source/detector problems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-adjoint-sources">Multiple adjoint sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="#options-for-denovo-s-n-calculations">Options for Denovo <span class="math notranslate nohighlight">\(S_n\)</span> calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#starting-with-an-existing-adjoint-flux-file">Starting with an existing adjoint flux file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forward-weighting-the-adjoint-source">Forward-weighting the adjoint source</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forward-weighting-with-an-existing-forward-flux-file">Forward weighting with an existing forward flux file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-importance-map">Using the importance map</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-notes-on-importance-map-calculations">Other notes on importance map calculations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mavric-output">MAVRIC output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#main-text-output-file">Main text output file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-output-files">Additional output files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sample-problems">Sample problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#graphite-shielding-measurements-with-cadis">Graphite shielding measurements with CADIS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#input-file">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dose-rates-outside-of-a-simple-cask">Dose rates outside of a simple cask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#geometry-and-materials">Geometry and materials</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sources-and-responses">Sources and responses</a></li>
<li class="toctree-l4"><a class="reference internal" href="#analog-calculation">Analog calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sas4-calculations">SAS4 calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculations-using-cadis">Calculations using CADIS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mavric-input-files">MAVRIC input files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#neutron-source-neutron-response-results">Neutron source/neutron response results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#photon-source-photon-response-results">Photon source/photon response results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gamma-ray-litho-density-logging-tool-using-fw-cadis">Gamma-ray litho-density logging tool using FW-CADIS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id19">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20">Output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aos-100-using-fw-cadis-and-continuous-energy-transport">AOS-100 using FW-CADIS and continuous-energy transport</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id21">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-file">Output file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#independent-spent-fuel-storage-installation">Independent spent fuel storage installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#source-term">Source term</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">Output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tn24-p-spent-fuel-cask">TN24-P spent fuel cask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id25">Input file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26">Output</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CAAScapability.html">MAVRIC Appendix A: CAAS Capability</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixb.html">MAVRIC Appendix B: MAVRIC Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixc.html">MAVRIC Appendix C: Advanced Features</a></li>
</ul>
<p class="caption"><span class="caption-text">Monte Carlo Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Monte%20Carlo%20Transport%20Overview.html">Monte Carlo Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Monaco.html">Monaco: A Fixed-Source Monte Carlo Transport Code for Shielding Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Criticality Safety</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Criticality%20Safety%20Overview.html">Criticality Safety Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5.html">CSAS5:  Control Module For Enhanced Criticality Safety Analysis Sequences With KENO V.a</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5App.html">Additional Example Applications of CSAS5</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6.html">CSAS6:  Control Module for Enhanced Criticality Safety Analysis with KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6App.html">Additional Example Applications of CSAS6</a></li>
<li class="toctree-l1"><a class="reference internal" href="STARBUCS.html">STARBUCS: A Scale Control Module for Automated Criticality Safety Analyses Using Burnup Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sourcerer.html">Sourcerer: Deterministic Starting Source for Criticality Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DEVC.html">DEVC: Denovo EigenValue Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="KMART.html">KMART5 and KMART6: Postprocessors for KENO V.A and KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="K5C5.html">K5toK6 and C5toC6: Input File Conversion Programs for KENO and CSAS</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SCALE Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/MAVRIC.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mavric-monaco-with-automated-variance-reduction-using-importance-calculations">
<span id="mavric"></span><h1>MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations<a class="headerlink" href="#mavric-monaco-with-automated-variance-reduction-using-importance-calculations" title="Permalink to this headline">¶</a></h1>
<p><em>D. E. Peplow and C. Celik</em></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo particle transport calculations for deep penetration problems can require very long run
times in order to achieve an acceptable level of statistical uncertainty in the final answers.
Discrete-ordinates codes can be faster but have limitations relative to the discretization of space, energy,
and direction. Monte Carlo calculations can be modified (biased) to produce results with the same variance in
less time if an approximate answer or some other additional information is already known about the problem.
If importances can be assigned to different particles based on how much they will contribute to the final answer,
then more time can be spent on important particles, with less time devoted to unimportant particles. One of the best
ways to bias a Monte Carlo code for a particular tally is to form an importance map from the adjoint flux based on
that tally. Unfortunately, determining the exact adjoint flux could be just as difficult as computing the original
problem itself.  However, an approximate adjoint can still be very useful in biasing the Monte Carlo
solution <a class="bibtex reference internal" href="#wagner-acceleration-1997" id="id1">[Wag97]</a>. Discrete ordinates can be used to quickly compute that approximate adjoint. Together, Monte Carlo and discrete ordinates can be used to find solutions to thick shielding problems in reasonable times.</p>
<p>The MAVRIC (Monaco with Automated Variance Reduction using Importance Calculations) sequence is based on the
CADIS (Consistent Adjoint Driven Importance Sampling) and FW-CADIS (Forward-Weighted CADIS)
methodologies <a class="bibtex reference internal" href="#wagner-automated-1998" id="id2">[WH98]</a> <a class="bibtex reference internal" href="#wagner-automated-2002" id="id3">[Wag02]</a> <a class="bibtex reference internal" href="#haghighat-monte-2003" id="id4">[HW03]</a>
<a class="bibtex reference internal" href="#wagner-forward-weighted-2007" id="id5">[WBP07]</a> MAVRIC automatically performs a three-dimensional, discrete-ordinates
calculation using Denovo to compute the adjoint flux as a function of position and energy. This adjoint flux
information is then used to construct an importance map (i.e., target weights for weight windows) and a biased
source distribution that work together—particles are born with a weight matching the target weight of the cell
into which they are born. The fixed-source Monte Carlo radiation transport Monaco <a class="bibtex reference internal" href="#peplow-monte-2011" id="id6">[Pep11]</a>
then uses the importance map for biasing during particle transport, and it uses the biased source distribution
as its source. During transport, the particle weight is compared with the importance map after each particle
interaction and whenever a particle crosses into a new importance cell in the map.</p>
<p>For problems that do not require variance reduction to complete in a reasonable time,
execution of MAVRIC without the importance map calculation provides an easy way to run Monaco.
For problems that do require variance reduction to complete in a reasonable time, MAVRIC removes the burden of setting weight windows from the user and performs it automatically with a minimal amount of additional input. Note that the MAVRIC sequence can be used with the final Monaco calculation as either a multigroup (MG) or a continuous-energy (CE) calculation.</p>
<p>Monaco has a wide variety of tally options: it can calculate fluxes (by group) at a point in space,
over any geometrical region, or for a user-defined, three-dimensional, rectangular grid.
These tallies can also integrate the fluxes with either standard response functions from the cross
section library or user-defined response functions. All of these tallies are available in the MAVRIC sequence.</p>
<p>Although it was originally designed for CADIS, the MAVRIC sequence is also capable of
creating importance maps using both forward and adjoint deterministic estimates.
The FW-CADIS method <a class="bibtex reference internal" href="#wagner-fw-cadis-2014" id="id7">[WPM14]</a> can be used for optimizing several tallies at once,
a mesh tally over a large region, or a mesh tally over the entire problem. Several other methods for
producing importance maps are also available in MAVRIC and are explored in <a class="reference internal" href="appendixc.html#appendixc"><span class="std std-ref">MAVRIC Appendix C: Advanced Features</span></a>.</p>
</div>
<div class="section" id="cadis-methodology">
<h2>CADIS Methodology<a class="headerlink" href="#cadis-methodology" title="Permalink to this headline">¶</a></h2>
<p>MAVRIC is an implementation of CADIS (Consistent Adjoint Driven Importance Sampling) using the Denovo
SN and Monaco Monte Carlo functional modules. Source biasing and a mesh-based importance map, overlaying
the physical geometry, are the basic methods of variance reduction. To make the best use of an
importance map, the map must be made consistent with the source biasing. If the source biasing is inconsistent
with the weight windows that will be used during the transport process, then source particles will undergo Russian
roulette or splitting immediately, wasting computational time and negating the intent of the biasing.</p>
<div class="section" id="overview-of-cadis">
<h3>Overview of CADIS<a class="headerlink" href="#overview-of-cadis" title="Permalink to this headline">¶</a></h3>
<p>CADIS is well described in the literature, so only a
brief overview is given here. Consider a class source-detector problem
described by a unit source with emission probability distribution
function <span class="math notranslate nohighlight">\(q\left(\overrightarrow{r},E \right)\)</span> and a detector
response function <span class="math notranslate nohighlight">\(\sigma_{d}\left(\overrightarrow{r},E \right)\)</span>.
To determine the total detector response, <em>R</em>, the forward scalar flux
<span class="math notranslate nohighlight">\(\phi\left(\overrightarrow{r},E \right)\)</span> must be known. The
response is found by integrating the product of the detector response
function and the flux over the detector volume <span class="math notranslate nohighlight">\(V_{d}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-mavric-1">
<span class="eqno">(1)<a class="headerlink" href="#equation-mavric-1" title="Permalink to this equation">¶</a></span>\[R = \int_{V_{d}}^{}{\int_{E}^{}{\sigma_{d}\left( \overrightarrow{r},E \right)}}\phi\left(\overrightarrow{r},E \right)\textit{dE dV.}\]</div>
<p>Alternatively, if the adjoint scalar flux,
<span class="math notranslate nohighlight">\(\phi^{+}\left(\overrightarrow{r},E \right)\)</span>, is known from the
corresponding adjoint problem with adjoint source
<span class="math notranslate nohighlight">\(q^{+}\left(\overrightarrow{r},E \right) = \sigma_{d}\left(\overrightarrow{r},E \right)\)</span>,
then the total detector response could be found by integrating the
product of the forward source and the adjoint flux over the source
volume, <span class="math notranslate nohighlight">\(V_{s}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-mavric-2">
<span class="eqno">(2)<a class="headerlink" href="#equation-mavric-2" title="Permalink to this equation">¶</a></span>\[R = \int_{V_{s}}^{}{\int_{E}^{}{q\left(\overrightarrow{r},E \right)}}\phi^{+}\left( \overrightarrow{r},E \right)\textit{dE dV.}\]</div>
<p>Unfortunately, the exact adjoint flux may be just as difficult to
determine as the forward flux, but an approximation of the adjoint flux
can still be used to form an importance map and a biased source
distribution for use in the forward Monte Carlo calculation.</p>
<p>Wagner <a class="bibtex reference internal" href="#wagner-acceleration-1997" id="id8">[Wag97]</a> showed that if an estimate of the adjoint scalar flux
for the corresponding adjoint problem can be found, then an estimate
of the response <em>R</em> can be made using <a class="reference internal" href="#equation-mavric-2">(2)</a>. The adjoint source for the
adjoint problem is typically separable and corresponds to the detector
response and spatial area of the tally to be optimized:
<span class="math notranslate nohighlight">\(q^{+}\left(\overrightarrow{r},E \right) = \sigma_{d}\left(E \right)g\left( \overrightarrow{r} \right)\)</span>,
where <span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right)\)</span> is a flux-to-dose conversion
factor and <span class="math notranslate nohighlight">\(g\left( \overrightarrow{r} \right)\)</span> is 1 in the tally
volume and is 0 otherwise. Then, from the adjoint flux
<span class="math notranslate nohighlight">\(\phi^{+}\left( \overrightarrow{r},E \right)\)</span> and response
estimate <em>R</em>, a biased source distribution,
<span class="math notranslate nohighlight">\(\widehat{q}\left( \overrightarrow{r},E \right)\)</span>, for source
sampling of the form</p>
<div class="math notranslate nohighlight" id="equation-mavric-3">
<span class="eqno">(3)<a class="headerlink" href="#equation-mavric-3" title="Permalink to this equation">¶</a></span>\[\widehat{q}\left(\overrightarrow{r},E \right) = \frac{1}{R}q\left(\overrightarrow{r},E\right)\phi^{+}\left( \overrightarrow{r},E \right)\]</div>
<p>and weight window target values,
<span class="math notranslate nohighlight">\(\overline{w}\left( \overrightarrow{r},E \right)\)</span>, for particle
transport of the form</p>
<div class="math notranslate nohighlight" id="equation-mavric-4">
<span class="eqno">(4)<a class="headerlink" href="#equation-mavric-4" title="Permalink to this equation">¶</a></span>\[\overline{w}\left( \overrightarrow{r},E \right) = \frac{R}{\phi^{+}\left( \overrightarrow{r},E \right)}\]</div>
<p>can be constructed, which minimizes the variance in the forward Monte
Carlo calculation of <em>R</em>.</p>
<p>When a particle is sampled from the biased source distribution
<span class="math notranslate nohighlight">\(\widehat{q}\left( \overrightarrow{r},E \right)\)</span>, to preserve a
fair game, its initial weight is set to</p>
<div class="math notranslate nohighlight" id="equation-mavric-5">
<span class="eqno">(5)<a class="headerlink" href="#equation-mavric-5" title="Permalink to this equation">¶</a></span>\[w_{0}\left(\overrightarrow{r},E \right) = \frac{q\left(\overrightarrow{r},E \right)}{\widehat{q}\left( \overrightarrow{r},E \right)} = \frac{R}{\phi^{+}\left( \overrightarrow{r},E \right)}\,\]</div>
<p>which exactly matches the target weight for that particle’s position and
energy. This is the “consistent” part of CADIS—source particles are born
with a weight matching the weight window of the region/energy into which they are
born. The source biasing and the weight windows work together.</p>
<p>CADIS has been applied to many problems—including reactor ex-core
detectors, well-logging instruments, cask shielding studies, and
independent spent fuel storage facility models—and has demonstrated very
significant speed-ups in calculation time compared to analog
simulations.</p>
</div>
<div class="section" id="multiple-sources-with-cadis">
<h3>Multiple sources with CADIS<a class="headerlink" href="#multiple-sources-with-cadis" title="Permalink to this headline">¶</a></h3>
<p>For a typical Monte Carlo calculation with multiple sources—each with a
probability distribution function
<span class="math notranslate nohighlight">\(q_{i}\left( \overrightarrow{r},E \right)\)</span> and a strength
<span class="math notranslate nohighlight">\(S_{i}\)</span>, giving a total source strength of
<span class="math notranslate nohighlight">\(S = \sum_{}^{}S_{i}\)</span>—the source is sampled in two steps. First,
the specific source <em>i</em> is sampled with probability
<span class="math notranslate nohighlight">\(p\left( i \right) = \ S_{i}/S\)</span>, and then the particle is sampled
from the specific source distribution
<span class="math notranslate nohighlight">\(q_{i}\left( \overrightarrow{r},E \right)\)</span>.</p>
<p>The source sampling can be biased at both levels: from which source to sample
and how to sample each source. For example, the specific source can
be sampled using some arbitrary distribution,
<span class="math notranslate nohighlight">\(\widehat{p}\left( i \right)\)</span>, and then the individual sources can
be sampled using distributions
<span class="math notranslate nohighlight">\({\widehat{q}}_{i}\left( \overrightarrow{r},E \right)\)</span>. Particles
would then have a birth weight of</p>
<div class="math notranslate nohighlight" id="equation-mavric-6">
<span class="eqno">(6)<a class="headerlink" href="#equation-mavric-6" title="Permalink to this equation">¶</a></span>\[w_{0} \equiv \ \left(\frac{p\left( i \right)}{\widehat{p}\left( i \right)} \right)\left(\frac{q_{i}\left( \overrightarrow{r},E \right)}{{\widehat{q}}_{i}\left( \overrightarrow{r},E \right)} \right)\text{.}\]</div>
<p>For CADIS, a biased multiple source needs to be developed so that the
birth weights of sampled particles still match the target weights of the
importance map. For a problem with multiple sources—each with a
distribution <span class="math notranslate nohighlight">\(q_{i}\left( \overrightarrow{r},E \right)\)</span> and a
strength <span class="math notranslate nohighlight">\(S_{i}\)</span>—the goal of the Monte Carlo calculation is to
compute some response <span class="math notranslate nohighlight">\(R\)</span> for a response function
<span class="math notranslate nohighlight">\(\sigma_{d}\left( \overrightarrow{r},E \right)\)</span> at a given
detector,</p>
<div class="math notranslate nohighlight" id="equation-mavric-7">
<span class="eqno">(7)<a class="headerlink" href="#equation-mavric-7" title="Permalink to this equation">¶</a></span>\[R = \ \int_{V}^{}{\int_{E}^{}{\sigma_{d}\left( \overrightarrow{r},E \right)\phi \left( \overrightarrow{r},E \right)\textit{dE dV.}}}\]</div>
<p>Note that the flux <span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right)\)</span> has
contributions from each source. The response, <span class="math notranslate nohighlight">\(R_{i}\)</span>, from each
specific source (<span class="math notranslate nohighlight">\(S_{i}\)</span> with
<span class="math notranslate nohighlight">\(q_{i}\left( \overrightarrow{r},E \right)\)</span>) can be expressed using
just the flux from that source,
<span class="math notranslate nohighlight">\(\phi_{i}\left( \overrightarrow{r},E \right)\)</span>, as</p>
<div class="math notranslate nohighlight" id="equation-mavric-8">
<span class="eqno">(8)<a class="headerlink" href="#equation-mavric-8" title="Permalink to this equation">¶</a></span>\[R_{i} = \ \int_{V}^{}{\int_{E}^{}{\sigma_{d}\left(\overrightarrow{r},E \right)\ \phi_{i}\left(\overrightarrow{r},E \right)\textit{dE dV .}}}\]</div>
<p>The total response is then found as <span class="math notranslate nohighlight">\(R = \sum_{i}^{}R_{i}\)</span>.</p>
<p>For the adjoint problem, using the adjoint source of
<span class="math notranslate nohighlight">\(q^{+}\left( \overrightarrow{r},E \right) = \sigma_{d}\left( \overrightarrow{r},E \right)\)</span>,
the response <span class="math notranslate nohighlight">\(R\)</span> can also be calculated as</p>
<div class="math notranslate nohighlight" id="equation-mavric-9">
<span class="eqno">(9)<a class="headerlink" href="#equation-mavric-9" title="Permalink to this equation">¶</a></span>\[R = \ \int_{V}^{}{\int_{E}^{}{\left\lbrack \sum_{i}^{}{S_{i}q_{i}\left( \overrightarrow{r},E \right)} \right\rbrack\ \phi^{+}\left( \overrightarrow{r},E \right)\textit{dE dV}}},\]</div>
<p>with the response contribution from each specific source being</p>
<div class="math notranslate nohighlight" id="equation-mavric-10">
<span class="eqno">(10)<a class="headerlink" href="#equation-mavric-10" title="Permalink to this equation">¶</a></span>\[R_{i} = \ \int_{V}^{}{\int_{E}^{}{\ {S_{i}q_{i}\left( \overrightarrow{r},E \right)\phi^{+}}\left( \overrightarrow{r}, E \right)\textit{dE dV.}}}\]</div>
<p>The target weights
<span class="math notranslate nohighlight">\(\overline{w}\left( \overrightarrow{r},E \right)\)</span> of the
importance map are found using</p>
<div class="math notranslate nohighlight" id="equation-mavric-11">
<span class="eqno">(11)<a class="headerlink" href="#equation-mavric-11" title="Permalink to this equation">¶</a></span>\[\overline{w}\left( \overrightarrow{r},E \right) = \frac{R/S}{\phi^{+}\left( \overrightarrow{r},E \right)\ }.\]</div>
<p>Each biased source
<span class="math notranslate nohighlight">\({\widehat{q}}_{i}\left( \overrightarrow{r},E \right)\)</span> pdf is
found using</p>
<div class="math notranslate nohighlight" id="equation-mavric-12">
<span class="eqno">(12)<a class="headerlink" href="#equation-mavric-12" title="Permalink to this equation">¶</a></span>\[{\widehat{q}}_{i}\left(\overrightarrow{r},E \right) = \frac{S_{i}}{R_{i}}{q_{i}\left( \overrightarrow{r},E \right)\phi}^{+}\left( \overrightarrow{r},E \right)\ ,\]</div>
<p>and the biased distribution used to select an individual source is
<span class="math notranslate nohighlight">\(\widehat{p}\left( i \right) = \ R_{i}/\sum_{}^{}{R_{i} = R_{i}/R}\)</span>.</p>
<p>When using the biased distribution used to select an individual source,
<span class="math notranslate nohighlight">\(\widehat{p}\left( i \right)\)</span>, and the biased source distribution,
<span class="math notranslate nohighlight">\({\widehat{q}}_{i}\left( \overrightarrow{r},E \right)\)</span>, the birth
weight of the sampled particle will be</p>
<div class="math notranslate nohighlight" id="equation-mavric-13">
<span class="eqno">(13)<a class="headerlink" href="#equation-mavric-13" title="Permalink to this equation">¶</a></span>\[\begin{split} \begin{matrix}
    w_{0} &amp; \equiv &amp; \left( \frac{p\left( i \right)}{\widehat{p}\left( i \right)} \right)\left( \frac{q_{i}\left( \overrightarrow{r}, E \right)}{{\widehat{q}}_{i}\left(\overrightarrow{r},E \right)} \right) \\ &amp; = &amp; \ \left( \frac{\frac{S_{i}}{S}}{\frac{R_{i}}{R}} \right) \left( \frac{q_{i}\left( \overrightarrow{r},E \right)}{\frac{S_{i}}{R_{i}}{q_{i}\left( \overrightarrow{r},E \right)\phi^{+}}\left( \overrightarrow{r},E \right)} \right) \\
    &amp; = &amp; \frac{R/S}{{\phi}^{+}\left( \overrightarrow{r},E \right)\ }, \\
\end{matrix}\end{split}\]</div>
<p>which matches the target weight,
<span class="math notranslate nohighlight">\(\overline{w}\left( \overrightarrow{r},E \right)\)</span>.</p>
</div>
<div class="section" id="multiple-tallies-with-cadis">
<h3>Multiple tallies with CADIS<a class="headerlink" href="#multiple-tallies-with-cadis" title="Permalink to this headline">¶</a></h3>
<p>The CADIS methodology works quite well for classic source/detector problems.
The statistical uncertainty of the tally that serves as the adjoint source is greatly reduced since the
Monte Carlo transport is optimized to spend more simulation time on those particles that contribute to the
tally, at the expense of tracking particles in other parts of phase space. However, more recently,
Monte Carlo has been applied to problems in which multiple tallies need to all be found with low statistical
uncertainties. The extension of this idea is the mesh tally—where each voxel is a tally for which the user desires
low statistical uncertainties. For these problems, the user must accept a total simulation time that is controlled
by the tally with the slowest convergence and simulation results where the tallies have a wide range of relative
uncertainties.</p>
<p>The obvious way around this problem is to create a separate problem for each tally and use CADIS to optimize each.
Each simulation can then be run until the tally reaches the level of acceptable uncertainty.
For more than a few tallies, this approach becomes complicated and time-consuming for the user.
For large mesh tallies, this approach is not reasonable.</p>
<p>Another approach to treat several tallies, if they are in close proximity to each other,
or a mesh tally covering a small portion of the physical problem, is to use the CADIS methodology
with the adjoint source near the middle of the tallies to be optimized. Since particles in the
forward Monte Carlo simulation are optimized to reach the location of the adjoint source, all the
tallies surrounding that adjoint source should converge quickly. This approach requires the
difficult question of “how close.” If the tallies are too far apart, then certain energies or regions that are
needed for one tally may be of low importance for getting particles to the central adjoint source. This may
under-predict the flux or dose at the tally sites far from the adjoint source.</p>
<p>MAVRIC has the capability to have multiple adjoint sources with this problem in mind.
For several tallies that are far from each other, multiple adjoint sources could be used.
In the forward Monte Carlo, particles would be drawn to one of those adjoint sources.
The difficulty with this approach is that typically the tally that is closest to the true
physical source converges faster than the other tallies—–showing that the closest adjoint source
seems to attract more particles than the others. Assigning more strength to the adjoint
source further from the true physical source helps to address this issue, but finding the correct strengths so
that all of the tallies converge to the same relative uncertainty in one simulation is an iterative process for the user.</p>
</div>
<div class="section" id="forward-weighted-cadis">
<h3>Forward-weighted CADIS<a class="headerlink" href="#forward-weighted-cadis" title="Permalink to this headline">¶</a></h3>
<p>To converge several tallies to the same relative uncertainty in
one simulation, the adjoint source corresponding to each of those
tallies must be weighted inversely by the expected tally value. To calculate the
dose rate at two points—–say one near a reactor
and one far from a reactor—–in one simulation, then the total adjoint
source used to develop the weight windows and biased source must
have two parts. The adjoint source far from the reactor must have
more strength than the adjoint source near the reactor by a factor equal
to the ratio of the expected near dose rate to the expected far dose
rate.</p>
<p>This concept can be extended to mesh tallies, as well. Instead of using a
uniform adjoint source strength over the entire mesh tally volume, each
voxel of the adjoint source should be weighted inversely by the expected
forward tally value for that voxel. Areas of low flux or low dose rate
would have more adjoint source strength than areas of high flux or high
dose rate.</p>
<p>An estimate of the expected tally results can be found by using a quick
discrete-ordinates calculation. This leads to an extension of the CADIS
method: forward-weighted CADIS (FW-CADIS). First, a forward S<sub>N</sub> calculation is performed to
estimate the expected tally results. A total adjoint source is
constructed so that the adjoint source corresponding to each tally is
weighted inversely by those forward tally estimates. Then the standard
CADIS approach is used—an importance map (target weight windows) and a
biased source are made using the adjoint flux computed from the adjoint
S<sub>N</sub> calculation.</p>
<p>For example, if the goal is to calculate a detector response function
<span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right)\)</span> (such as dose rate using
flux-to-dose-rate conversion factors) over a volume (defined by
<span class="math notranslate nohighlight">\(g\left( \overrightarrow{r} \right)\)</span>) corresponding to mesh tally,
then instead of simply using
<span class="math notranslate nohighlight">\(q^{+}\left( \overrightarrow{r},E \right) = \sigma_{d}\left( E \right)\ g(\overrightarrow{r})\)</span>,
the adjoint source would be</p>
<div class="math notranslate nohighlight" id="equation-mavric-14">
<span class="eqno">(14)<a class="headerlink" href="#equation-mavric-14" title="Permalink to this equation">¶</a></span>\[ q^{+}\left( \overrightarrow{r},E \right) = \frac{\sigma_{d}\left( E \right)\text{g}\left( \overrightarrow{r} \right)}{\int_{}^{}{\sigma_{d}\left( E \right)\phi\left( \overrightarrow{r},E \right)}\textit{dE}}\ ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right)\)</span> is an estimate of
the forward flux, and the energy integral is over the voxel at <span class="math notranslate nohighlight">\(\overrightarrow{r}\)</span>.
The adjoint source is nonzero only where the mesh tally is defined
(<span class="math notranslate nohighlight">\(g\left( \overrightarrow{r} \right)\)</span>), and its strength is
inversely proportional to the forward estimate of dose rate.</p>
<p>The relative uncertainty of a tally is controlled by two components:
(1) the number of tracks contributing to the tally and (2) the
shape of the distribution of scores contributing to that tally. In the
Monte Carlo game, the number of simulated particles,
<span class="math notranslate nohighlight">\(m\left( \overrightarrow{r},E \right)\)</span>, can be related to the true
physical particle density, <span class="math notranslate nohighlight">\(n\left( \overrightarrow{r},E \right),\)</span>
by the average Monte Carlo weight of scoring particles,
<span class="math notranslate nohighlight">\(\overline{w}\left( \overrightarrow{r},E \right)\)</span>, by</p>
<div class="math notranslate nohighlight" id="equation-mavric-15">
<span class="eqno">(15)<a class="headerlink" href="#equation-mavric-15" title="Permalink to this equation">¶</a></span>\[n\left( \overrightarrow{r},E \right) = \ \overline{w}\left( \overrightarrow{r},E \right)\text{m}\left( \overrightarrow{r},E \right).\]</div>
<p>In a typical Monte Carlo calculation, tallies are made by adding some
score, multiplied by the current particle weight, to an accumulator. To
calculate a similar quantity related to the Monte Carlo particle density
would be very close to calculating any other quantity but without
including the particle weight. The goal of FW-CADIS is to make the Monte
Carlo particle density, <span class="math notranslate nohighlight">\(m\left( \overrightarrow{r},E \right)\)</span>,
uniform over the tally areas, so an importance map must be developed
that represents the importance of achieving uniform Monte Carlo particle
density. By attempting to keep the Monte Carlo particle density more
uniform, more uniform relative errors for the tallies should be
realized.</p>
<p>Two options for forward weighting are possible. For tallies over some
area where the entire group-wise flux is needed with low relative
uncertainties, the adjoint source should be weighted inversely by the
forward flux, <span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right)\)</span>. The other
option, for a tally in which only an energy-integrated quantity is desired,
is to weight the adjoint inversely by that energy-integrated
quantity,<span class="math notranslate nohighlight">\(\int_{}^{}{\sigma_{d}\left( E \right)\phi\left( \overrightarrow{r},E \right)}\text{\ dE}\)</span>.
For a tally in which the total flux is desired, then the response in the
adjoint source is simply <span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right) = 1\)</span>.</p>
<p>To optimize the forward Monte Carlo simulation for the calculation of
some quantity at multiple tally locations or across a mesh tally, the
adjoint source must be weighted by the estimate of that quantity.
For a tally defined by its spatial location
<span class="math notranslate nohighlight">\(g\left( \overrightarrow{r} \right)\)</span> and its optional response
<span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right)\)</span>, the standard adjoint source would be
<span class="math notranslate nohighlight">\(q^{+}\left( \overrightarrow{r},E \right) = \sigma_{d}\left( E \right)\text{g}\left( \overrightarrow{r} \right)\)</span>.
The forward-weighted adjoint source,
<span class="math notranslate nohighlight">\(q^{+}\left( \overrightarrow{r},E \right)\)</span>, depending on what
quantity is to be optimized, is listed below.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 29%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>For the calculation of</p></th>
<th class="head"></th>
<th class="head"><p>Adjoint source</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Energy and spatially dependent flux</p></td>
<td><p><span class="math notranslate nohighlight">\(\phi\left(\overrightarrow{r},E \right)\)</span></p></td>
<td><div class="math notranslate nohighlight">
\[\frac{g\left( \overrightarrow{r}\right)}{\phi\left(\overrightarrow{r},E \right)}\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Spatially dependent total flux</p></td>
<td><p><span class="math notranslate nohighlight">\(\int_{}^{}{\phi\left( \overrightarrow{r},E \right)}\textit{dE}\)</span></p></td>
<td><div class="math notranslate nohighlight">
\[\frac{g\left( \overrightarrow{r}\right)}{\int_{}^{}{\phi\left( \overrightarrow{r},E \right)}\textit{dE}}\]</div>
</td>
</tr>
<tr class="row-even"><td><p>Spatially dependent total response</p></td>
<td><p><span class="math notranslate nohighlight">\(\int_{}^{}{\sigma_{d}\left( E \right)\phi    \left(\overrightarrow{r},E\right)}\textit{dE}\)</span></p></td>
<td><div class="math notranslate nohighlight">
\[\frac{\sigma_{d}\left( E \right)\text{g}\left( \overrightarrow{r} \right)}{\int_{}^{}{\sigma_{d}\left( E \right)\phi    \left( \overrightarrow{r},E \right)}\textit{dE}}\]</div>
</td>
</tr>
</tbody>
</table>
<p>The bottom line of FW-CADIS is that in order to calculate a quantity at
multiple tally locations (or across a mesh tally) with more uniform
relative uncertainties, an adjoint source must be developed for an
objective function that keeps some non-physical quantity—related to the
Monte Carlo particle density and similar in form to the desired
quantity—constant. FW-CADIS uses the solution of a forward
discrete-ordinates calculation to properly weight the adjoint source.
After that, the standard CADIS approach is used.</p>
</div>
<div class="section" id="mavric-implementation-of-cadis">
<h3>MAVRIC Implementation of CADIS<a class="headerlink" href="#mavric-implementation-of-cadis" title="Permalink to this headline">¶</a></h3>
<p>With MAVRIC, as with other shielding codes, the user defines the problem as a set of
physical models—the material compositions, the geometry, the source, and the detectors
(locations and response functions)—as well as some mathematical parameters on how to solve
the problem (number of histories, etc.). For the variance reduction portion of MAVRIC, the
only additional inputs required are (1) the mesh planes to use in the discrete-ordinates
calculation(s) and (2) the adjoint source description—–basically the location and the response
of each tally to optimize in the forward Monte Carlo calculation. MAVRIC uses this information
to construct a Denovo adjoint problem. (The adjoint source is weighted by a Denovo forward flux
or response estimate for FW-CADIS applications.)  MAVRIC then uses the CADIS methodology: it combines
the adjoint flux from the Denovo calculation with the source description and creates the importance map
(weight window targets) and the mesh-based biased source. Monaco is then run using the CADIS biased source
distribution and the weight window targets.</p>
<div class="section" id="denovo">
<h4>Denovo<a class="headerlink" href="#denovo" title="Permalink to this headline">¶</a></h4>
<p>Denovo is a parallel three-dimensional SN code that is used to generate adjoint (and, for FW-CADIS, forward)
scalar fluxes for the CADIS methods in MAVRIC. For use in MAVRIC/CADIS, it is highly desirable that the SN code be fast,
positive, and robust. The phase-space shape of the forward and adjoint fluxes, as opposed to a highly accurate solution,
is the most important quality for Monte Carlo weight-window generation. Accordingly,
Denovo provides a step-characteristics spatial differencing option that produces positive scalar fluxes as
long as the source (volume plus in-scatter) is positive. Denovo uses an orthogonal, nonuniform mesh that is
ideal for CADIS applications because of the speed and robustness of calculations on this mesh type.</p>
<p>Denovo uses the highly robust GMRES (Generalized Minimum Residual) Krylov method to solve the SN equations in each group. GMRES has been shown to be more robust and efficient than traditional source (fixed-point) iteration. The in-group discrete SN equations are defined as</p>
<div class="math notranslate nohighlight" id="equation-mavric-16">
<span class="eqno">(16)<a class="headerlink" href="#equation-mavric-16" title="Permalink to this equation">¶</a></span>\[\mathbf{L}\psi = \mathbf{\text{MS}}\phi + q\]</div>
<p>where <strong>L</strong> is the differential transport operator, <strong>M</strong> is the
moment-to-discrete operator, <strong>S</strong> is the matrix of scattering
cross section moments, <em>q</em> is the external and in-scatter source,
<span class="math notranslate nohighlight">\(\phi\)</span> is the vector of angular flux moments, and <span class="math notranslate nohighlight">\(\psi\)</span> is
the vector of angular fluxes at discrete angles. Applying the operator
<strong>D</strong>, where <span class="math notranslate nohighlight">\(\phi = \mathbf{D}\psi\)</span>, and rearranging terms, casts
the in-group equations in the form of a traditional linear system,
<span class="math notranslate nohighlight">\(\mathbf{A}x = b\)</span>,</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-mavric-17">
<span class="eqno">(17)<a class="headerlink" href="#equation-mavric-17" title="Permalink to this equation">¶</a></span>\[\left( \mathbf{I} - \mathbf{D}\mathbf{L}^{- 1}\mathbf{\text{MS}} \right) = \mathbf{D}\mathbf{L}^{- 1}q .\]</div>
</div></blockquote>
<p>The operation <span class="math notranslate nohighlight">\(\mathbf{L}^{- 1}\nu\)</span>, where <span class="math notranslate nohighlight">\(\nu\)</span> is an
iteration vector, is performed using a traditional wave-front solve
(transport sweep). The parallel implementation of the Denovo wave-front
solver uses the well-known Koch-Baker-Alcouffe (KBA) algorithm, which is
a two-dimensional block‑spatial decomposition of a three-dimensional
orthogonal mesh <a class="bibtex reference internal" href="#baker-sn-1998" id="id9">[BK98]</a>. The Trilinos package is used for the GMRES
implementation <a class="bibtex reference internal" href="#willenbring-trilinos-2003" id="id10">[WH03]</a> Denovo stores the mesh-based scalar fluxes in a
double precision binary file (*.dff) called a <em>Denovo flux file</em>. Past
versions of SCALE/Denovo used the TORT <a class="bibtex reference internal" href="#rhoades-tort-1997" id="id11">[RS97]</a> *.varscl file format
(DOORS package <a class="bibtex reference internal" href="#rhoades-doors-1998" id="id12">[RC98]</a>), but this was limited to single precision. Since
the rest of the MAVRIC sequence has not yet been parallelized, Denovo is
currently used only in serial mode within MAVRIC.</p>
</div>
<div class="section" id="monaco">
<h4>Monaco<a class="headerlink" href="#monaco" title="Permalink to this headline">¶</a></h4>
<p>The forward Monte Carlo transport is performed using Monaco, a
fixed-source shielding code that uses the SCALE General Geometry
Package (SGGP, the same as used by the criticality code KENO-VI) and the
standard SCALE material information processor. Monaco can use either MG
or CE cross section libraries. Monaco was originally based on the MORSE
Monte Carlo code but has been extensively modified to modernize the
coding, incorporate more flexibility in terms of sources/tallies, and
read a user-friendly block/keyword style input.</p>
<p>Much of the input to MAVRIC is the same as Monaco. More details can be
found in the Monaco chapter of the SCALE manual (SECTIONREFERENCE).</p>
</div>
<div class="section" id="running-mavric">
<h4>Running MAVRIC<a class="headerlink" href="#running-mavric" title="Permalink to this headline">¶</a></h4>
<p>The objective of a SCALE sequence is to execute several codes, passing
the output from one to the input of the next, in order to perform some
analysis—–tasks that users typically had to do in the past. MAVRIC does
this for difficult shielding problems by running approximate
discrete-ordinates calculations, constructing an importance map and
biased source for one or more tallies that the user wants to optimize in
the Monte Carlo calculation, and then using those in a forward Monaco
Monte Carlo calculation. MAVRIC also prepares the forward and adjoint
cross sections when needed. The steps of a MAVRIC sequence are listed in
<a class="reference internal" href="#mavric-sequence"><span class="std std-numref">Table 1</span></a>. The user can instruct MAVRIC to run this whole sequence of
steps or just some subset of the steps to verify the
intermediate steps or to reuse previously calculated quantities in a new
analyses.</p>
<p>The MAVRIC sequence can be stopped after key points by using the
“parm= <em>parameter</em> ” operator on the “=mavric” command line, which is
the first line of the input file. The various parameters are listed in
Table <a class="reference internal" href="#mavric-param"><span class="std std-numref">Table 2</span></a>. These parameters allow the user to perform checks and make
changes to the importance map calculation before the actual Monte Carlo
calculation in Monaco.</p>
<p>MAVRIC also allows the sequence to start at several different points. If
an importance map and biased source have already been computed, they can then
be used directly. If the adjoint scalar fluxes are known, they can
quickly be used to create the importance map and biased source and then
begin the forward Monte Carlo calculation. All of the different combinations of
starting MAVRIC with some previously calculated quantities are listed in
the following section detailing the input options.</p>
<p>When using MG cross section libraries that do not have flux-to-dose-rate
conversion factors, use “parm=nodose” to prevent the cross section
processing codes from trying to move these values into the working
library.</p>
<p>MAVRIC creates many files that use the base problem name from the output
file. For an output file called “c:path1path2\<em>outputName</em>.out” or
“/home/path1/path2/ <em>outputName</em>.inp”, spaces in the output name will
cause trouble and should not be used.</p>
<table class="colwidths-given docutils align-center" id="mavric-sequence">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Steps in the MAVRIC sequence</span><a class="headerlink" href="#mavric-sequence" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Cross section calculation</strong></p></td>
<td><p>XSProc is used to calculate the forward cross sections for Monaco</p></td>
</tr>
<tr class="row-even"><td><p><strong>Forward Denovo (optional)</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Cross section calculation</p></td>
<td><p>XSProc is used to calculate the forward cross sections for Denovo</p></td>
</tr>
<tr class="row-even"><td><p>Forward flux calculation</p></td>
<td><p>Denovo calculates the estimate of the forward flux</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Adjoint Denovo (optional)</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Cross section calculation</p></td>
<td><p>XSProc is used to calculate the adjoint cross sections for Denovo</p></td>
</tr>
<tr class="row-odd"><td><p>Adjoint flux calculation</p></td>
<td><p>Denovo calculates the estimate of the adjoint flux</p></td>
</tr>
<tr class="row-even"><td><p><strong>CADIS (optional)</strong></p></td>
<td><p>The scalar flux file from Denovo is then used to create the biased source distribution and transport weight windows</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Monte Carlo calculation</strong></p></td>
<td><p>Monaco uses the biased source distribution and transport weight windows to calculate the various tallies</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-center" id="mavric-param">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Parameters for the MAVRIC command line (“parm=…”)</span><a class="headerlink" href="#mavric-param" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>MAVRIC will stop after</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>check</p></td>
<td><p>input checking</p></td>
</tr>
<tr class="row-odd"><td><p>forinp</p></td>
<td><p>Forward Denovo input construction (makes <code class="docutils literal notranslate"><span class="pre">xkba_b.inp</span></code> in the tmp area)</p></td>
</tr>
<tr class="row-even"><td><p>forward</p></td>
<td><p>The forward Denovo calculation</p></td>
</tr>
<tr class="row-odd"><td><p>adjinp</p></td>
<td><p>Adjoint Denovo input construction (makes <code class="docutils literal notranslate"><span class="pre">xkba_b.inp</span></code> in the tmp area)</p></td>
</tr>
<tr class="row-even"><td><p>adjoint</p></td>
<td><p>The adjoint Denovo calculation</p></td>
</tr>
<tr class="row-odd"><td><p>impmap</p></td>
<td><p>Calculation of importance map and biased source</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="mavric-input">
<h2>MAVRIC input<a class="headerlink" href="#mavric-input" title="Permalink to this headline">¶</a></h2>
<p>The input file for MAVRIC consists of three lines of text (“=mavric”
command line with optional parameters, the problem title, and SCALE
cross section library name) and then several blocks, with each block
starting with “read xxxx” and ending with “end xxxx”. There are three
required blocks and nine optional blocks. Material and geometry blocks
must be listed first and in the specified order. Other blocks may be
listed in any order.</p>
<p>Blocks (must be in this order):</p>
<ul class="simple">
<li><p>Composition – (required) SCALE standard composition, list of materials used in the problem</p></li>
<li><p>Celldata – SCALE resonance self-shielding</p></li>
<li><p>Geometry – (required) SCALE general geometry description</p></li>
<li><p>Array – optional addition to the above geometry description</p></li>
<li><p>Volume – optional calculation or listing of region volumes</p></li>
<li><p>Plot – create 2D slices of the SGGP geometry</p></li>
</ul>
<p>Other Blocks (in any order, following the blocks listed above):</p>
<ul class="simple">
<li><p>Definitions – defines locations, response functions, and grid geometries used by other blocks</p></li>
<li><p>Sources – (required) description of the particle source spatial, energy, and directional distributions</p></li>
<li><p>Tallies – description of what to calculate: point detector tallies, region tallies, or mesh tallies</p></li>
<li><p>Parameters – how to perform the simulation (random number seed, how many histories, etc.)</p></li>
<li><p>Biasing – data for reducing the variance of the simulation</p></li>
<li><p>ImportanceMap – instructions for creating an importance map based on a discrete-ordinates calculation</p></li>
</ul>
<p>The material blocks (Composition and Celldata) and the physical model
blocks (Geometry, Array, Volume, and Plot) follow the standard SCALE
format. See the other SCALE references as noted in the following
sections for details. The Biasing block and ImportanceMap block cannot
both be used.</p>
<p>For the other six blocks, scalar variables are set by “keyword=value”,
fixed-length arrays are set with “keyword value<sub>1</sub> …
value<sub>N</sub>”, variable-length arrays are set with “keyword
value<sub>1</sub> … value<sub>N</sub> end”, and some text and filenames
are read in as quoted strings. Single keywords to set options are also
used in some instances. The indention, comment lines, and
upper/lowercase shown in this document are not required— they are used
in the examples only for clarity. Except for strings in quotes (like
filenames), SCALE is case insensitive.</p>
<p>After all input blocks are listed, a single line with “end data” should be listed.
A final “end” should also be listed, to signify the end of all MAVRIC input.
Nine of the blocks are the same input blocks as those used by the functional module Monaco,
with a few extra keywords only for use with MAVRIC. These extra keywords are highlighted here, but
without relisting all of the standard Monaco keywords for those blocks.
See <a class="reference internal" href="#input-format"><span class="std std-numref">Table 3</span></a> for an overview of MAVRIC input file structure.</p>
<div class="section" id="composition-block">
<h3>Composition block<a class="headerlink" href="#composition-block" title="Permalink to this headline">¶</a></h3>
<p>Material information input follows the standard SCALE format for
material input. Basic materials known to the SCALE library may be used
as well as completely user-defined materials (using isotopes with known
cross sections). Input instructions are located in the XSProc chapter (SECTIONREFERENCE) in
the SCALE manual. The Standard Composition Library chapter (SECTIONREFERENCE) lists the
different cross section libraries and the names of standard materials.
An example is as follows:</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">composition</span>

    <span class="err">uo</span><span class="m">2</span> <span class="m">1</span> <span class="m">0</span><span class="err">.</span><span class="m">2</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="m">92234</span> <span class="m">0</span><span class="err">.</span><span class="m">0055</span> <span class="m">92235</span> <span class="m">3</span><span class="err">.</span><span class="m">5</span> <span class="m">92238</span> <span class="m">96</span><span class="err">.</span><span class="m">4945</span> <span class="n">end</span>

    <span class="err">orconcrete</span> <span class="m">2</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>

    <span class="err">ss</span><span class="m">304</span> <span class="m">3</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>

<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
</pre></div>
</div>
<p>Details on the cell data block are also included in the XSProc chapter (SECTIONREFERENCE).
When using different libraries for the importance map production (listed
at the top of the input) and the final Monte Carlo calculation (listed
in the parameters block, if different), make sure that the materials are
present in both libraries.</p>
<table class="colwidths-given docutils align-center" id="input-format">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Overall input format</span><a class="headerlink" href="#input-format" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>input file</p></th>
<th class="head"><p>Comment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">Some</span> <span class="err">title</span> <span class="err">for</span> <span class="err">this</span> <span class="err">problem</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
<span class="n">read</span><span class="err"> </span><span class="n">celldata</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">celldata</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
<span class="n">read</span><span class="err"> </span><span class="n">array</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">array</span>
<span class="n">read</span><span class="err"> </span><span class="n">volume</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">volume</span>
<span class="n">read</span><span class="err"> </span><span class="n">plot</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">plot</span>
<span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
<span class="n">read</span><span class="err"> </span><span class="n">sources</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
<span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>
<span class="n">read</span><span class="err"> </span><span class="n">biasing</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">biasing</span>
<span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
   <span class="err">...</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</td>
<td><div class="highlight-rest notranslate"><div class="highlight"><pre><span></span>name of sequence
title
cross section library name
SCALE material compositions
    [required block]

SCALE resonance self-shielding
    [optional block]

SCALE SGGP geometry
    [required block]

SCALE SGGP arrays
    [optional block]

SCALE SGGP volume calc
    [optional block]

SGGP Plots
    [optional block]

Definitions
    [possibly required]

Sources definition
    [required block]

Tally specifications
    [optional block]

Monte Carlo parameters
    [optional block]

Biasing information
    [optional block]

Importance map
    [optional block]

end of all blocks
end of MAVRIC input
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sggp-geometry-blocks">
<h3>SGGP geometry blocks<a class="headerlink" href="#sggp-geometry-blocks" title="Permalink to this headline">¶</a></h3>
<p>MAVRIC uses the functional module Monaco for the forward Monte Carlo calculation.
Monaco tracks particles through the physical geometry described by the SGGP input
blocks, as well as through the mesh importance map and any mesh tallies, which are
defined in the global coordinates and overlay the physical geometry. Because Monaco
must track through all of these geometries at the same time, users should not use the
reflective boundary capability in the SGGP geometry.</p>
<p>For more details on each SGGP geometry block, see the following sections of the KENO-VI chapter (SECTIONREFERENCE) of the SCALE Manual.</p>
<blockquote>
<div><p>Geometry – <em>Geometry Data</em></p>
<p>Array – <em>Array Data</em></p>
<p>Volume – <em>Volume Data</em></p>
<p>Plot – <em>Plot Data</em></p>
</div></blockquote>
</div>
<div class="section" id="other-blocks-shared-with-monaco">
<h3>Other blocks shared with Monaco<a class="headerlink" href="#other-blocks-shared-with-monaco" title="Permalink to this headline">¶</a></h3>
<p>The definitions, sources, tallies, and biasing blocks are all the same
as Monaco. They are all fully described in the Monaco chapter (SECTIONREFERENCE) of the
SCALE Manual.</p>
<blockquote>
<div><p>Definitions – <em>Definitions Block</em></p>
<p>Sources – <em>Sources Block</em></p>
<p>Tallies – <em>Tallies Block</em></p>
<p>Biasing – <em>Biasing Block</em></p>
</div></blockquote>
<p>The parameters block includes several keywords that are not included in
Monaco (see the <em>Parameter Block</em> section of the Monaco chapter (SECTIONREFERENCE)) which
are used when the cross section library used in the importance
calculations differs from the library used in the final forward
Monaco Monte Carlo calculation. The library listed at the beginning of
the MAVRIC input file will be used for the importance calculations
(forward and adjoint Denovo calculation, formation of the importance
map, and biased sources). To use a different MG library in the final
Monaco simulation, use the keyword “library=” with the cross section
library name in quotes. A cross section library for Monaco will be made
using csas-mg. If there are any extra parameters to use (“parm=” in the
“=csas-mg” line of the csas-mg input), they can be passed along using
the keyword “parmString=” with the extra information in quotes. For
example, the following input file would use a coarse-group library for
the importance calculations and a fine-group library for the final
Monaco, each with CENTRM processing.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric parm=centrm</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>
<span class="err">…</span>

<span class="n">read</span><span class="err"> </span><span class="n">parameters</span>

    <span class="err">library=”v</span><span class="m">7</span><span class="err">-</span><span class="m">200</span><span class="err">n</span><span class="m">47</span><span class="err">g”</span> <span class="err">parmString=”centrm”</span>

    <span class="err">…</span>

<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>

<span class="err">…</span>

<span class="n">end</span><span class="err"> </span><span class="n">data</span>

<span class="n">end</span>
</pre></div>
</div>
<p>To use a CE cross section in the final Monaco step, use the keyword “ceLibrary=” with the cross section
library name in quotes. When the “library=” or “ceLibrary=” keywords are used, they should precede the “neutron”, “photon”,
“noNeutron”, and “noPhoton” keywords. <a class="reference internal" href="#extra-keywords"><span class="std std-numref">Table 4</span></a> summarizes all of the keywords in the MAVRIC parameter block.</p>
<p>When using two different cross section libraries, be sure that the responses and distributions are
defined in ways that do not depend on the cross section library. For example, any response that is
just a list of n values (corresponding to a cross section library of n groups) needs to have the
group energies specifically listed so that it can be evaluated properly on the other group structure.</p>
<table class="docutils align-center" id="extra-keywords">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Extra keywords for the parameters block</span><a class="headerlink" href="#extra-keywords" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/table4.4.png" src="_images/table4.4.png" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="importance-map-block">
<h3>Importance map block<a class="headerlink" href="#importance-map-block" title="Permalink to this headline">¶</a></h3>
<p>The importance map block is the “heart and soul” of MAVRIC. This block lists the parameters for creating an
importance map and biased source from one (adjoint) or two (forward, followed by adjoint) Denovo
discrete-ordinates calculations. Without an importance map block, MAVRIC can be used to run Monaco
and use its conventional types of variance reduction. If both the importance map and biasing blocks
are specified, then only the importance map block will be used. The various ways to use the importance map block
are explained in the subsections below. Keywords for this block are summarized at the end of this section, in
<a class="reference internal" href="#keywords-importance"><span class="std std-numref">Table 5</span></a>.</p>
<div class="section" id="constructing-a-mesh-for-the-sn-calculation">
<h4>Constructing a mesh for the S<sub>N</sub> calculation<a class="headerlink" href="#constructing-a-mesh-for-the-sn-calculation" title="Permalink to this headline">¶</a></h4>
<p>All uses of the importance map block that run the
discrete-ordinates code require the use of a grid geometry that overlays
the physical geometry. Grid geometries are defined in the definitions
block of the MAVRIC input. The extent and level of detail needed in a
grid geometry are discussed in the following paragraphs.</p>
<p>When using S<sub>N</sub> methods alone for solving radiation transport in
shielding problems, a good rule of thumb is to use mesh cell sizes on
the order of a meanfree path of the particle. In complex shielding
problems, this could lead to an extremely large number of mesh cells,
especially when considering the size of the meanfree path of the lowest
energy neutrons and photons in common shielding materials.</p>
<p>In MAVRIC, the goal is to use the S<sub>N</sub> calculation for a quick
approximate solution. Accuracy is not paramount—just getting an idea of
the overall shape of the true importance map will help accelerate the
convergence of the forward Monte Carlo calculation. The more accurate
the importance map, the better the forward Monte Carlo acceleration will
be. At some point there is a time trade-off when the computational time
for calculating the importance map followed by the time to perform the Monte Carlo
calculation exceeds that of a standard analog Monte Carlo calculation.
Large numbers of mesh cells that result from using very small mesh sizes
for S<sub>N</sub> calculations also use a great deal of computer memory.</p>
<p>Because the deterministic solution(s) for CADIS and FW-CADIS can have
moderate fidelity and still provide variance reduction parameters that
substantially accelerate the Monte Carlo solution, mesh cell sizes in
MAVRIC applications can be larger than what most S<sub>N</sub> practioners
would typically use. The use of relatively coarse mesh reduces memory
requirements and the run time of the deterministic solution(s). Some
general guidelines to keep in mind when creating a mesh for the
importance map/biased source are as follows:</p>
<ul class="simple">
<li><p>The true source regions should be included in the mesh with mesh
planes at their boundaries.</p></li>
<li><p>Place point or very small sources in the center of a mesh cell, not on the mesh planes.</p></li>
<li><p>Any region of the geometry where particles could eventually
contribute to the tallies (the “important” areas) should be included
in the mesh.</p></li>
<li><p>Point adjoint sources (corresponding to point detector locations) in
standard CADIS calculations do not have to be included inside the
mesh. For FW-CADIS, they must be in the mesh and should be located at
a mesh cell center, not on any of the mesh planes.</p></li>
<li><p>Volumetric adjoint sources should be included in the mesh with mesh
planes at their boundaries.</p></li>
<li><p>Mesh planes should be placed at significant material boundaries.</p></li>
<li><p>Neighboring cell sizes should not be drastically different.</p></li>
<li><p>Smaller cell sizes should be used where the adjoint flux is changing
rapidly, such as toward the surfaces of adjoint sources and
shields (rather than in their interiors).</p></li>
</ul>
<p>Another aspect to keep in mind is that the source in the forward Monaco
Monte Carlo calculation will be a biased mesh-based source. Source
particles will be selected by first sampling which mesh cell to use and
then sampling a position uniformly within that mesh cell that meets the
user criteria of “unit=”, “region=”, or “mixture=” if specified. The
mesh should have enough resolution that the mesh source will be an
accurate representation of the true source.</p>
<p>The geometry for the Denovo calculation is specified using the keyword
“gridGeometryID=” and the identification number of a grid geometry that
was defined in the definitions block. The material assigned to each voxel of the mesh is determined by
testing the center point in the SGGP geometry (unless the macro-material option is used—see below).</p>
</div>
<div class="section" id="macromaterials-for-sn-geometries">
<span id="macromaterials"></span><h4>Macromaterials for S<sub>N</sub> geometries<a class="headerlink" href="#macromaterials-for-sn-geometries" title="Permalink to this headline">¶</a></h4>
<p>Part of the advantage of the CADIS method is that the adjoint
discrete-ordinates calculation only needs to be approximate in order to
form a reasonable importance map and biased source. This usually means
that the mesh used is much coarser than the mesh that would be used if
the problem were to be solved only with a discrete-ordinates code. This
coarse mesh may miss significant details (especially curves) in the
geometry and produce a less-than-optimal importance map.</p>
<p>To get more accurate solutions from a coarse-mesh
discrete-ordinates calculation, Denovo can represent the material in
each voxel of the mesh as a volume-weighted mixture of the real
materials, called <em>macromaterials</em>, in the problem. When constructing the
Denovo input, the Denovo EigenValue Calculation (DEVC, see section SECTIONREFERENCE)
sequence can estimate the volume fraction occupied by using each real
material in each voxel by a sampling method. The user can specify
parameters for how to sample the geometry. Note that finer sampling
makes more accurate estimates of the material fraction but requires more
setup time to create the Denovo input. Users should understand how the
macromaterials are sampled and should consider this when constructing a mesh
grid. This is especially important for geometries that contain arrays.
Careful consideration should be given when overlaying a mesh on a
geometry that contains arrays of arrays.</p>
<p>Because the list of macromaterials could become large, the user can also
specify a tolerance for how close two different macromaterials can be in order to
be considered the same, thereby reducing the total number of
macromaterials. The macromaterial tolerance, “<code class="docutils literal notranslate"><span class="pre">mmTolerance=</span></code>”, is used for
creating a different macromaterial from the those already created by
looking at the infinity norm between two macromaterials.
The number of macromaterials does not appreciably impact Denovo run time
or memory requirements.</p>
<p>Two different sampling methods are available—point testing <a class="bibtex reference internal" href="#ibrahim-improving-2009" id="id13">[IPE+09]</a> with
the keyword <code class="docutils literal notranslate"><span class="pre">mmPointTest</span></code> and ray tracing <a class="bibtex reference internal" href="#johnson-fast-2013" id="id14">[Joh13]</a> with the keyword
<code class="docutils literal notranslate"><span class="pre">mmRayTest</span></code>.</p>
<div class="section" id="ray-tracing">
<h5>Ray Tracing<a class="headerlink" href="#ray-tracing" title="Permalink to this headline">¶</a></h5>
<p>This method estimates the volume of different materials in the Denovo mesh grid elements by
tracing rays through the SGGP geometry and computing the average track lengths through each material.
Rays are traced in all three dimensions to better estimate the volume fractions of materials within each voxel.
The mmSubCell parameter controls how many rays will be traced in each voxel in each dimension. For example, if mmSubCell= n,
then when tracing rays in the z dimension, each column of voxels uses a set of n×n rays
starting uniformly spaced in the x  and y  dimensions. With rays being cast from all three orthogonal directions,
a total of 3n2 rays are used to sample each voxel. One can think of subcells as an equally spaced sub-mesh with a
single ray positioned at each center. The number of subcells in each direction, and hence the number of rays, can
be explicitly given with mmSubCells ny nz nx nz nx ny end keyword for rays parallel to the x axis, y axis, and z axis.
<a class="reference internal" href="#ray-positions"><span class="std std-numref">Fig. 1</span></a> shows different subcell configurations (in two dimensions) for a given voxel.</p>
<div class="figure align-center" id="id27">
<span id="ray-positions"></span><a class="reference internal image-reference" href="_images/fig4.1.01_rayTrace6.png"><img alt="_images/fig4.1.01_rayTrace6.png" src="_images/fig4.1.01_rayTrace6.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Ray positions within a voxel with different mmSubCells parameters.</span><a class="headerlink" href="#id27" title="Permalink to this image">¶</a></p>
</div>
<p>Ray tracing is a more robust method compared to the simple point testing
method used in previous versions of SCALE/MAVRIC; however, it requires
more memory than point testing. Ray tracing gives more accurate
estimates of volume fractions because track lengths across a voxel give
more information than a series of test points. Ray tracing is also much
faster than point testing because the particle tracking routines are
optimized to quickly determine lists of materials and distance along
a given ray.</p>
<p>Ray tracing operates on the grid geometry supplied by the user and
shoots rays in all three directions, starting from the lower bounds of
the mesh grid. An example of an arbitrary assembly geometry is shown in
<a class="reference internal" href="#geom-model"><span class="std std-numref">Fig. 2</span></a>. A ray consists of a number of steps that each correspond
to crossing a material boundary along the path of the ray. Ratios of
each step’s length to the voxel length in the ray’s direction determine
the material volume fraction of that step in that voxel, and summation
of the same material volume fractions gives the material volume fraction
of that material in that voxel. Ray tracing through a single voxel that
contains a fuel pin is illustrated in <a class="reference internal" href="#ray-vox"><span class="std std-numref">Fig. 3</span></a>.</p>
<div class="figure align-center" id="id28">
<span id="geom-model"></span><a class="reference internal image-reference" href="_images/fig4.1.02_kenoDenovo.png"><img alt="_images/fig4.1.02_kenoDenovo.png" src="_images/fig4.1.02_kenoDenovo.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Geometry model (left) and the Denovo representation (right) of an assembly using macromaterials determined by ray tracing.</span><a class="headerlink" href="#id28" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id29">
<span id="ray-vox"></span><a class="reference internal image-reference" href="_images/fig4.1.03_rayTrace.png"><img alt="_images/fig4.1.03_rayTrace.png" src="_images/fig4.1.03_rayTrace.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Ray tracing (in two dimensions) through a voxel.</span><a class="headerlink" href="#id29" title="Permalink to this image">¶</a></p>
</div>
<p>The final constructed macromaterials for this model are also shown in
<a class="reference internal" href="#geom-model"><span class="std std-numref">Fig. 2</span></a>. Voxels that contain only a single material are assigned
the original material number in the constructed macromaterials. For the
voxels that contain a fuel pin with three different materials, the
result is a new macromaterial consisting of the volume weighted
fractions of each original material.</p>
<p>After the rays are shot in all three directions, the material volume
fractions are updated, and macromaterials are created by using these
material volume fractions. Material volume fraction calculations for a
single voxel, as shown in <a class="reference internal" href="#ray-vox"><span class="std std-numref">Fig. 3</span></a>, are given by</p>
<div class="math notranslate nohighlight" id="equation-mavric-18">
<span class="eqno">(18)<a class="headerlink" href="#equation-mavric-18" title="Permalink to this equation">¶</a></span>\[\begin{split} F_{m} = \ \sum_{d = x,y,z}^{}{\sum_{r = 1}^{N_{r}}{\sum_{s = 1}^{N_{s}}\left\{ \begin{matrix}
 \frac{L_{d,r,s}}{L_{d}},\ \ \ &amp; m_{s} = m \\
 0,\ \ \ &amp; \mathrm{\text{otherwise}} \\
 \end{matrix} \right.\ }} \ \ \ \ \ \ \ and \ \ \ \ \ \ \ \ \ V_{m} = \frac{F_{m}}{\sum_{n = 1}^{N_{m}}F_{n}}\ ,\end{split}\]</div>
<p>where <em>Fm</em> = sampled fraction of material <em>m</em> in the voxel,</p>
<p><em>d</em> = direction of the rays (<em>x, y, z</em>),</p>
<p><em>r</em> = ray number,</p>
<p><span class="math notranslate nohighlight">\(N_r\)</span> = total number of rays in the voxel for direction of <em>d</em>,</p>
<p><em>s</em> = step number,</p>
<p><span class="math notranslate nohighlight">\(N_s\)</span> = total number of steps for ray r in the voxel for direction of
<em>d</em>,</p>
<p><span class="math notranslate nohighlight">\(L_{d,r,s}\)</span> = length of the steps s for ray r in the voxel for direction
of <em>d</em>,</p>
<p><span class="math notranslate nohighlight">\(L_d\)</span> = length of the voxel along direction of <em>d</em>,</p>
<p><span class="math notranslate nohighlight">\(m_s\)</span> = material of step <em>s</em>,</p>
<p><em>m</em> = material number,</p>
<p><span class="math notranslate nohighlight">\(N_m\)</span> = total number of materials in the voxel, and</p>
<p><span class="math notranslate nohighlight">\(V_m\)</span> = volume fraction of material m in the voxel.</p>
</div>
<div class="section" id="point-testing">
<h5>Point Testing<a class="headerlink" href="#point-testing" title="Permalink to this headline">¶</a></h5>
<p>The recursive bisection method is utilized in point testing and uses a
series of point tests to determine the macromaterial fractions. For a
given voxel, the material at the center is compared to the material at
the eight corners. If they are all the same, then the entire volume is
considered to be made of that material. If they are different, then the volume is
divided into two in each dimension. Each subvolume is tested, and the
method is then applied to the subvolumes that are not of a single
material. When the ratio of the volume of the tested region to the
original voxel becomes less than a user-specified tolerance (in the
range of 10-1 to 10-4), then further subdivision and testing are
stopped. This is illustrated in <a class="reference internal" href="#rec-macro"><span class="std std-numref">Fig. 4</span></a>.</p>
<div class="figure align-default" id="rec-macro">
<a class="reference internal image-reference" href="_images/rec-macro.png"><img alt="_images/rec-macro.png" src="_images/rec-macro.png" style="width: 99%;" /></a>
</div>
<p class="centered">
<strong><em>Fig. 4 Successive steps in the recursive macromaterial method</em></strong></p><p>In point testing, the keyword “mmTolerance=f” is interpreted to be where <em>f</em> is the smallest
fraction of the voxel volume that can be achieved by bisection method and hence the limiting
factor for dividing the voxel. This same tolerance <em>f</em> is also used to limit the number of macromaterials.
Before a new macromaterial is created, if one already exists where the fraction of each actual
material matches to within the given tolerance, then the existing material will be used. If
using only a single point at the center of each voxel, then use “mmTolerance=1”.
The mmSubCell keyword is not used in point testing.</p>
</div>
<div class="section" id="example">
<h5>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h5>
<p><a class="reference internal" href="#cask-geom"><span class="std std-numref">Fig. 5</span></a> shows an example of a cask geometry with two types of spent fuel (yellows),
steel (blue), resin (green), and other metals (gray). When the Denovo geometry is set up by
testing only the center of each mesh cell, the curved surfaces are not well represented (upper right).
By applying the ray-tracing method and defining a new material made of partial fractions of the original materials,
an improved Denovo model can be made. In the lower left of the figure, the Denovo
model was constructed using one ray (in each dimension) per voxel and a tolerance of 0.1.
This gives 20 new materials that are a mixture of the original 13 actual materials and void.
With mmSubCells=3 and an mmTolerance=0.01, 139 macromaterials are created.</p>
<p>A macromaterial table listing the fractions of each macromaterial is saved to a file called “outputName.mmt”,
where outputName is the name the user chose for his or her output file. This file can be used by the Mesh File
Viewer to display the macromaterials as mixtures of the actual materials, as seen in the lower row of <a class="reference internal" href="#cask-geom"><span class="std std-numref">Fig. 5</span></a>.
See the Mesh File Viewer help pages for more information on how to use colormap files and macromaterial tables.</p>
<div class="figure align-default" id="id30">
<span id="cask-geom"></span><img alt="_images/cask-geom.png" src="_images/cask-geom.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Cask geometry model (upper left) and the Denovo representation using cell center testing (upper right). Representations using macromaterials determined by ray tracing are shown for mmSubCell=1/mmTolerance=0.1 (lower left) and mmSubCell=3/mmTolerance=0.01 (lower right).*</span><a class="headerlink" href="#id30" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="optimizing-source-detector-problems">
<h4>Optimizing source/detector problems<a class="headerlink" href="#optimizing-source-detector-problems" title="Permalink to this headline">¶</a></h4>
<p>For standard source/detector problems in which one tally is to be optimized
in the forward Monte Carlo calculation, an adjoint source based on that
tally must be constructed. An adjoint source requires a unique and
positive identification number, a physical location, and an energy
spectrum. The adjoint source location can be specified either by (1) a
point location (“locationID=” keyword) or (2) a volume described by a
box (“boundingBox” array). A bounding box is specified by maximum and
minimum extent in each dimension—<span class="math notranslate nohighlight">\(x_{max}\)</span> <span class="math notranslate nohighlight">\(x_{min}\)</span> <span class="math notranslate nohighlight">\(y_{max}\)</span> <span class="math notranslate nohighlight">\(y_{min}\)</span> <span class="math notranslate nohighlight">\(z_{max}\)</span>
<span class="math notranslate nohighlight">\(z_{min}\)</span>—in global coordinates. The boundingBox should not be degenerate
(should have volume&gt;0) but can be optionally limited to areas matching a
given unit number (“unit=”), a given region number (“region=”), or a
given material mixture number (“mixture=”). A mixture and a region
cannot both be specified, since that would either be redundant or
mutually exclusive. The energy spectrum of an adjoint source is a
response function (“responseID=”) listing one of the ID numbers of the
responses defined in the definitions block. An optional weight can be
assigned to each adjoint source using the “weight=” keyword. If not
given, the default weight is 1.0.</p>
<p>For example, to optimize a region tally, the user would construct an
adjoint source located in the same place as the tally, with an adjoint
source spectrum equal to the response function that the tally is
computing. Note that the grid geometry 1 and response function 3 must
already be defined in the definitions block.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
   <span class="err">gridGeometryID=</span><span class="m">1</span>
   <span class="err">adjointSource</span> <span class="m">24</span>
       <span class="err">boundingBox</span> <span class="m">12</span><span class="err">.</span><span class="m">0</span> <span class="m">10</span><span class="err">.</span><span class="m">0</span>  <span class="m">5</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">5</span><span class="err">.</span><span class="m">0</span>  <span class="m">10</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">10</span><span class="err">.</span><span class="m">0</span>
       <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">5</span>
       <span class="err">responseID=</span><span class="m">3</span>
   <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>For optimizing a point detector for the calculation of total photon flux,
the importance map block would look like the following:</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
   <span class="err">adjointSource</span> <span class="m">21</span>
       <span class="err">locationID=</span><span class="m">4</span>
       <span class="err">responseID=</span><span class="m">1</span>
   <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
   <span class="err">gridGeometryID=</span><span class="m">1</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>where location 4 is the same location used by the point detector. To calculate total photon flux, response function 1 must be defined in the definitions block similar to this response:</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">1</span>
         <span class="err">values</span> <span class="m">27</span><span class="err">r</span><span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">19</span><span class="err">r</span><span class="m">1</span><span class="err">.</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">…</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>This response is used for computing total photon flux for the 27 neutron/19 photon group coupled cross section library or like this response</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">1</span>
         <span class="err">photon</span>
         <span class="err">bounds</span> <span class="m">1000</span><span class="err">.</span><span class="m">0</span> <span class="m">2</span><span class="err">.</span><span class="m">0</span><span class="err">e</span><span class="m">7</span> <span class="n">end</span>
         <span class="err">values</span>  <span class="m">1</span><span class="err">.</span><span class="m">0</span>   <span class="m">1</span><span class="err">.</span><span class="m">0</span>   <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">…</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>which is independent of the cross section library.</p>
</div>
<div class="section" id="multiple-adjoint-sources">
<h4>Multiple adjoint sources<a class="headerlink" href="#multiple-adjoint-sources" title="Permalink to this headline">¶</a></h4>
<p>If there are several tallies in very close proximity and/or several different responses being calculated by the tallies, multiple adjoint sources can be used.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
   <span class="err">gridGeometryID=</span><span class="m">1</span>
   <span class="err">adjointSource</span> <span class="m">1</span>
       <span class="err">locationID=</span><span class="m">4</span>  <span class="err">responseID=</span><span class="m">20</span>
   <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
   <span class="err">adjointSource</span> <span class="m">2</span>
       <span class="err">locationID=</span><span class="m">5</span>  <span class="err">responseID=</span><span class="m">21</span>
       <span class="err">weight=</span><span class="m">2</span><span class="err">.</span><span class="m">0</span>
   <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>Note that adjoint sources using point locations can be mixed with volumetric adjoint sources (using bounding boxes).</p>
</div>
<div class="section" id="options-for-denovo-s-n-calculations">
<h4>Options for Denovo <span class="math notranslate nohighlight">\(S_n\)</span> calculations<a class="headerlink" href="#options-for-denovo-s-n-calculations" title="Permalink to this headline">¶</a></h4>
<p>While the default values for various calculational parameters and settings used by Denovo for
the MAVRIC sequence should cover most applications, they can be changed if desired.
The two most basic parameters are the quadrature set used for the discrete ordinates and
the order of the Legendre polynomials used in describing the angular scattering.
The default quadrature order that MAVRIC uses is a level symmetric <span class="math notranslate nohighlight">\(S_8\)</span> set, and the
default scattering order is <span class="math notranslate nohighlight">\(P_3\)</span> (or the maximum number of coefficients contained in the
cross-section library if less than 3). <span class="math notranslate nohighlight">\(S_8\)</span>/ <span class="math notranslate nohighlight">\(P_3\)</span> is an adequate choice for many applications,
but the user is free to changes these. For complex ducts or transport over large distances at small angles,
<span class="math notranslate nohighlight">\(S_{12}\)</span> may be required. <span class="math notranslate nohighlight">\(S_4\)</span>/ <span class="math notranslate nohighlight">\(P_1\)</span> or even <span class="math notranslate nohighlight">\(S_2\)</span>/ <span class="math notranslate nohighlight">\(P_0\)</span> would be useful in doing a very cursory run to confirm that the
problem was input correctly, but this would likely be inadequate for weight window generation in a problem
that is complex enough to require advanced variance reduction.</p>
<p>These and other Denovo options are applied to both
the forward and the adjoint calculations that are required from the
inputs given in the importance map block.</p>
<p>In problems with small sources or media that are not highly scattering,
discrete ordinates can suffer from “ray effects” <a class="bibtex reference internal" href="#lathrop-ray-1968" id="id15">[Lat68]</a><a class="bibtex reference internal" href="#lathrop-remedies-1971" id="id16">[Lat71]</a>
where artifacts of the discrete quadrature directions can be seen in the
computed fluxes. Denovo has a
first-collision capability to help alleviate ray effects. This method
computes the uncollided flux in each mesh cell from a point source. The
uncollided fluxes are then used as a distributed source in the main
discrete-ordinates solution. At the end of the main calculation, the
uncollided fluxes are added to the fluxes computed with the first
collision source, forming the total flux. While this helps reduce ray
effects in many problems, the first-collision capability can take a
significant amount of time to compute on a mesh with many cells or for
many point sources.</p>
<p>Adjoint sources that use point locations will automatically use the
Denovo first-collision capability. Volumetric adjoint sources (that use
a boundingBox) will be treated without the first-collision capability.
The keywords “firstCollision” and “noFirstCollision” will be ignored by
MAVRIC for adjoint calculations. Keywords for Denovo options in the
importance map block are summarized at the end of this section, in
<a class="reference internal" href="#denovo-op"><span class="std std-numref">Table 6</span></a>.</p>
</div>
<div class="section" id="starting-with-an-existing-adjoint-flux-file">
<h4>Starting with an existing adjoint flux file<a class="headerlink" href="#starting-with-an-existing-adjoint-flux-file" title="Permalink to this headline">¶</a></h4>
<p>An importance map can be made from an existing Denovo flux file by using
the keyword “adjointFluxes=” with the appropriate file name in quotes.
The file must be a binary file using the *.dff file format, and the
number of groups must match the number of groups in the MAVRIC cross
section library (i.e., the library entered on the third line of the
MAVRIC input file). Instead of performing an adjoint calculation, the
fluxes read from the file will be used to create both the mesh-based
importance map and the biased mesh source.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">adjointFluxes=”c:\mydocu~</span><span class="m">1</span><span class="err">\previousRun.adjoint.dff”</span>
    <span class="err">gridGeometry=</span><span class="m">7</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>If the “adjointFluxes=” keyword is used and any adjoint sources are defined, an error will result. If a forward flux file is supplied for forward-weighting the adjoint source (see below), then an adjoint flux file cannot be specified.</p>
<p>The grid geometry is not required when using a pre-existing flux file. If grid geometry is not supplied, one will be created from the mesh planes that are contained in the Denovo flux file (which were used to compute the fluxes in that file).</p>
</div>
<div class="section" id="forward-weighting-the-adjoint-source">
<h4>Forward-weighting the adjoint source<a class="headerlink" href="#forward-weighting-the-adjoint-source" title="Permalink to this headline">¶</a></h4>
<p>To optimize a mesh tally or multiple region tallies/point detector
tallies over a large region, instead of a uniform weighting of the
adjoint source, a weighting based on the inverse of the forward response
can be performed. This requires an extra discrete-ordinates calculation but
can help the forward Monte Carlo calculation compute the mesh tally or
group of tallies with more uniform statistical uncertainties.</p>
<p>The same grid geometry will be used in both the forward calculation and
the adjoint calculation, so the user must ensure that the mesh
covers all of the forward sources and all of the adjoint sources, even
if they are point sources.</p>
<p>To use forward-weighted CADIS, specify either of the keywords –
“respWeighting” or “fluxWeighting”. For either, MAVRIC will run Denovo
to create an estimate of the forward flux,
<span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right)\)</span>. For response weighting
(“respWeighting”), each adjoint source is inversely weighted by the
integral of the product of the response function used in that adjoint
source and the estimate of the forward flux. For an adjoint source
described by the geometric function <span class="math notranslate nohighlight">\(g(\overrightarrow{r})\)</span> and
the response function <span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right)\)</span> (note that
<span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right) = 1\)</span> for computing total fluxes), the
forward-weighted adjoint source becomes</p>
<div class="math notranslate nohighlight" id="equation-mavric-19">
<span class="eqno">(19)<a class="headerlink" href="#equation-mavric-19" title="Permalink to this equation">¶</a></span>\[ q_{i}^{+}\left( \overrightarrow{r},E \right) = \frac{\sigma_{d}\left( E \right)g(\overrightarrow{r})}{\int_{}^{}{\sigma_{d}\left( E \right)\ \phi\left( \overrightarrow{r},E \right)}\ \text{dE}} \ \ .\]</div>
<p>Response weighting will calculate more uniform relative uncertainties of
the integral quantities of the tallies in the final Monte Carlo
calculation.</p>
<p>To optimize the calculation of the entire group-wise flux with more
uniform relative uncertainties in each group, the adjoint source should
be weighted inversely by the forward flux,
<span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right),\)</span> using the
“fluxWeighting” keyword. For an adjoint source described by the
geometric function <span class="math notranslate nohighlight">\(g(\overrightarrow{r})\)</span> and the response
function <span class="math notranslate nohighlight">\(\sigma_{d}\left( E \right) = 1\)</span>, the forward-weighted
adjoint source becomes</p>
<div class="math notranslate nohighlight" id="equation-mavric-20">
<span class="eqno">(20)<a class="headerlink" href="#equation-mavric-20" title="Permalink to this equation">¶</a></span>\[q_{i}^{+}\left( \overrightarrow{r},E \right) = \frac{\sigma_{d}\left( E \right)g(\overrightarrow{r})}{\phi\left( \overrightarrow{r},E \right)}\ .\]</div>
<p>For example, consider a problem with a single source and two detectors,
one near the source that measures flux and one far from the source that
measures some response. In a standard Monte Carlo calculation, it is
expected that since more Monte Carlo particles cross the near detector,
it will have a much lower relative uncertainty than the far detector.
Standard CADIS could be used to optimize the calculation of each in
separate simulations:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>To optimize the flux in the near detector</p></td>
<td><p>To optimize the response in the far detector</p></td>
</tr>
<tr class="row-even"><td><div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="err">x</span><span class="m">1</span> <span class="err">x</span><span class="m">2</span> <span class="err">y</span><span class="m">1</span> <span class="err">y</span><span class="m">2</span> <span class="err">z</span><span class="m">1</span> <span class="err">z</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
</td>
<td><div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>
    <span class="err">adjointSource</span> <span class="m">2</span>
        <span class="err">boundingBox</span> <span class="err">u</span><span class="m">1</span> <span class="err">u</span><span class="m">2</span> <span class="err">v</span><span class="m">1</span> <span class="err">v</span><span class="m">2</span> <span class="err">w</span><span class="m">1</span> <span class="err">w</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">6</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>where response 1 was defined as <span class="math notranslate nohighlight">\(\sigma_{1}\left( E \right) = 1\)</span>
and response 6 was defined as <span class="math notranslate nohighlight">\(\sigma_{6}\left( E \right) =\)</span>
flux-to-response conversion factors. The two options for
forward weighting allow the tallies for both detectors to be calculated
in the same MAVRIC simulation. Using “fluxWeighting”, the importance map
and biased source will be made to help distribute Monte Carlo particles
evenly through each energy group and every voxel in both detectors,
making the relative uncertainties close to uniform. With
“respWeighting”, the importance map and biased source will optimize the
total integrated response of each tally.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>To optimize <span class="math notranslate nohighlight">\(\phi\left( \overrightarrow{r},E \right)\)</span> in each detector</p></td>
<td><p>To optimize a total response <span class="math notranslate nohighlight">\(\int_{}^{}{\sigma_{d}\left ( E \right) \phi \left( \overrightarrow{r},E \right)} dE\)</span> (either total flux or total dose)</p></td>
</tr>
<tr class="row-even"><td><div class="highlight-scale notranslate"><div class="highlight"><pre><span></span>  <span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>
<span class="err">‘</span>   <span class="err">near</span> <span class="err">detector</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="err">x</span><span class="m">1</span> <span class="err">x</span><span class="m">2</span> <span class="err">y</span><span class="m">1</span> <span class="err">y</span><span class="m">2</span> <span class="err">z</span><span class="m">1</span> <span class="err">z</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="err">‘</span>   <span class="err">far</span> <span class="err">detector</span>
    <span class="err">adjointSource</span> <span class="m">2</span>
        <span class="err">boundingBox</span> <span class="err">u</span><span class="m">1</span> <span class="err">u</span><span class="m">2</span> <span class="err">v</span><span class="m">1</span> <span class="err">v</span><span class="m">2</span> <span class="err">w</span><span class="m">1</span> <span class="err">w</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">6</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">fluxWeighting</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
</td>
<td><div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>
<span class="err">‘</span>   <span class="err">near</span> <span class="err">detector</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="err">x</span><span class="m">1</span> <span class="err">x</span><span class="m">2</span> <span class="err">y</span><span class="m">1</span> <span class="err">y</span><span class="m">2</span> <span class="err">z</span><span class="m">1</span> <span class="err">z</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
<span class="err">‘</span>   <span class="err">far</span> <span class="err">detector</span>
    <span class="err">adjointSource</span> <span class="m">2</span>
        <span class="err">boundingBox</span> <span class="err">u</span><span class="m">1</span> <span class="err">u</span><span class="m">2</span> <span class="err">v</span><span class="m">1</span> <span class="err">v</span><span class="m">2</span> <span class="err">w</span><span class="m">1</span> <span class="err">w</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">6</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">respWeighting</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Using flux weighting, the adjoint source will be</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-mavric-21">
<span class="eqno">(21)<a class="headerlink" href="#equation-mavric-21" title="Permalink to this equation">¶</a></span>\[q^{+}\left( \overrightarrow{r},E \right) = \frac{\sigma_{1}\left( E \right)g_{\mathrm{\text{near}}}(\overrightarrow{r})}{\phi\left( \overrightarrow{r},E \right)} + \frac{\sigma_{6}\left( E \right)g_{\mathrm{\text{far}}}(\overrightarrow{r})}{\phi\left( \overrightarrow{r},E \right)}\ ,\]</div>
</div></blockquote>
<p>or using response weighting, the adjoint source will be</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-mavric-22">
<span class="eqno">(22)<a class="headerlink" href="#equation-mavric-22" title="Permalink to this equation">¶</a></span>\[q^{+}\left( \overrightarrow{r},E \right) = \frac{\sigma_{1}\left( E \right)g_{1}(\overrightarrow{r})}{\int_{}^{}{\sigma_{1}\left( E \right)\phi \left(\overrightarrow{r},E \right)}\ dE} + \frac{\sigma_{6}\left( E \right)g_{2}(\overrightarrow{r})}{\int_{}^{}{\sigma_{6}\left(E \right)\phi \left( \overrightarrow{r},E \right)}\ dE} \ .\]</div>
</div></blockquote>
<p>This implementation is slightly different from the original MAVRIC in
SCALE 6. The current approach is simpler for the user and allows the
importance parameters to optimize the final Monte Carlo calculation for
the calculation of two different responses in two different areas.</p>
<p>If the number of mesh cells containing the true source is less than 10,
then MAVRIC will convert these source voxels to point sources and Denovo
will automatically use its first-collision capability to help reduce ray
effects in the forward calculation. The user can easily override the
MAVRIC defaults—to force the calculation of a first-collision source no
matter how many voxels contain source; this can be done by using the keyword
“firstCollision”. To prevent the calculation of a first-collision
source, the keyword “noFirstCollision” can be used. If the keywords
“firstCollision” or “noFirstCollision” are used, then they will only apply to
the forward calculation, not the subsequent adjoint calculation.</p>
<p>The keyword “saveExtraMaps” will save extra files that can be viewed by
the Mesh File Viewer. The source used by the forward Denovo calculation
is stored in “<em>outputName.</em>dofs.3dmap”, where <em>outputName</em> is the
name the user chose for his output file.</p>
</div>
<div class="section" id="forward-weighting-with-an-existing-forward-flux-file">
<h4>Forward weighting with an existing forward flux file<a class="headerlink" href="#forward-weighting-with-an-existing-forward-flux-file" title="Permalink to this headline">¶</a></h4>
<p>Similar to the capability of using pre-existing adjoint flux files,
MAVRIC can use a pre-existing forward flux file to create a
forward-weighted adjoint source without performing the forward Denovo
calculation. The user may specify the *.dff file containing the forward
fluxes using the keyword “forwardFluxes=”. The filename should be
enclosed in quotes, and the file must be a binary file using the Denovo
flux file format. The number of groups must match the number of groups
in the MAVRIC cross section library (i.e., the library entered on the
third line of the MAVRIC input file).</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
     <span class="err">forwardFluxes=”c:\mydocu~</span><span class="m">1</span><span class="err">\previousRun.forward.dff”</span>
     <span class="err">gridGeometry=</span><span class="m">7</span>
     <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">...</span>
     <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
     <span class="err">respWeighting</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>When using a pre-existing forward flux file, either “respWeighting” or “fluxWeighting” must still be specified.</p>
</div>
<div class="section" id="using-the-importance-map">
<h4>Using the importance map<a class="headerlink" href="#using-the-importance-map" title="Permalink to this headline">¶</a></h4>
<p>An importance map produced by the importance map block consists of the target
weight values as a function of position and energy. The upper weight window used
for splitting and the lower weight window used for Russian roulette are set by the
window ratio. The window ratio is simply the ratio of the weight window’s upper bound to
the weight window lower bound, with the target weight being the average of the upper and lower bounds.</p>
<p>The keyword “windowRatio=” can be used within the importance map block to specify what
window ratio will be used with the importance map that is passed to the Monaco forward
Monte Carlo calculation. For a windowRatio of <span class="math notranslate nohighlight">\(r\)</span>, the upper weights for
splitting, <span class="math notranslate nohighlight">\(w_{max}\)</span>, and the lower weights for Russian roulette, <span class="math notranslate nohighlight">\(w_{min}\)</span>, are set as</p>
<div class="math notranslate nohighlight" id="equation-mavric-23">
<span class="eqno">(23)<a class="headerlink" href="#equation-mavric-23" title="Permalink to this equation">¶</a></span>\[w_{\mathrm{\min}} = \frac{2}{r + 1}\overline{w}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-mavric-24">
<span class="eqno">(24)<a class="headerlink" href="#equation-mavric-24" title="Permalink to this equation">¶</a></span>\[w_{\mathrm{\max}} = \frac{2r}{r + 1}\overline{w}\]</div>
<p>for the target weight <span class="math notranslate nohighlight">\(\overline{w}\)</span> in each mesh cell and for
each energy of the importance map. The default value for the windowRatio
is 5.0.</p>
</div>
<div class="section" id="other-notes-on-importance-map-calculations">
<h4>Other notes on importance map calculations<a class="headerlink" href="#other-notes-on-importance-map-calculations" title="Permalink to this headline">¶</a></h4>
<p>Since the importance map calculations all take place using mesh
geometry, one of the first steps that occurs is to create a mesh
representation of the true source (the forward source) on the same grid.
This procedure uses the same two methods as the Monaco mesh source saver
routine. Mesh cells can be subdivided and tested to see if they are
within the defined source, or a set number of points can be sampled from
the source. The keywords “subCells=” and “sourceTrials=” are used in the
importance map block to change the default settings for constructing the
mesh representation of the forward source.</p>
<p>If macromaterials are used (“mmTolerance&lt;1”) and the adjoint source is
limited to a particular material, then the amount of adjoint source in a mesh
voxel will be weighted by the material amount in that voxel.</p>
<p>In SCALE/MAVRIC, Denovo is called as a fixed-source S<sub>N</sub> solver
and cannot model multiplying media. Neither forward nor adjoint neutron
calculations from Denovo will be accurate when neutron multiplication is
a major source component. If neutron multiplication is not turned off in
the parameters block of the MAVRIC input (using “fissionMult=0”), a
warning will be generated to remind the user of this limitation.</p>
<p>By default, MAVRIC instructs Denovo not to perform outer iterations for
neutron problems if the cross section library contains upscatter groups.
This is because the time required calculating the fluxes using upscatter
can be significantly longer than without. For problems in which thermal
neutrons are an important part of the transport or tallies, the user
should specify the keyword “upScatter=1” in the importance map block.
This will instruct Denovo to perform the outer iterations for the
upscatter groups, giving more accurate results but taking a much longer
time for the discrete-ordinates calculation.</p>
<p>When performing a MAVRIC calculation using a coarse-group energy structure
for Denovo (for example with the 27/19 library) but a fine-group energy
structure (with the 200/47 library) for the final Monaco calculation,
the source biasing parameters are determined on the coarse-group
structure. The importance map (<em>.mim) file and the biased mesh source
(</em>.msm) files all use the coarse-group structure. The source biasing
information is then applied to fine-group mesh versions of the sources,
resulting in the *.sampling.*.msm files. This way, the biased sources
used in the final Monaco calculation retain their fine-group resolution.
This can be especially important in representing the high-energy portion
of the fission neutron distribution for example. When using CE-Monaco,
the source sampling routines first use the *.msm files to determine the
source particle’s voxel and energy group. From that voxel and energy
group, the user-given source distributions are used to sample the
specific starting location and specific energy of the source particle.
This way, the CE-Monaco calculation samples the true CE distributions.</p>
<table class="docutils align-center" id="keywords-importance">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Keywords for the importance map block</span><a class="headerlink" href="#keywords-importance" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/table4-5.png" src="_images/table4-5.png" />
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="denovo-op">
<caption><span class="caption-number">Table 6 </span><span class="caption-text">Denovo options for the importance map block</span><a class="headerlink" href="#denovo-op" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/table4-6.png" src="_images/table4-6.png" />
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="mavric-output">
<h2>MAVRIC output<a class="headerlink" href="#mavric-output" title="Permalink to this headline">¶</a></h2>
<div class="section" id="main-text-output-file">
<h3>Main text output file<a class="headerlink" href="#main-text-output-file" title="Permalink to this headline">¶</a></h3>
<p>Similar to other SCALE sequences, MAVRIC returns a text output file
containing the output from the SCALE driver, the sequence itself, and
all of the functional modules called. The SCALE driver output first
displays the problem input file, and then the first reading of the input file
by the MAVRIC sequence is shown (which includes some material processing
information). If there are any errors or warnings about the input file,
they will be shown next. Next in the output file are the different
passes through the MAVRIC sequence—up to 10 parts. If any errors or
warning messages (such as lack of memory) are generated during
processing, they will be displayed here. Finally, the output files from
each functional module are concatenated to the above output and shows
the files returned to the user.</p>
<p>First, the Monaco section of output first reviews the input it received. First
the geometry is reviewed, showing which materials are used in each
region and the volume of that region, if input or calculated. Then a
detailed list of other Monaco input is reviewed: cross section parameters, data
definitions, the source description, the tallies, the Monte Carlo
parameters, and the biasing parameters. For MAVRIC calculations, if an
importance map is used, then its summary is also given. The “Mesh
Importance Map Characterization” shows where the importance map may be
changing too rapidly and may require more refinement.</p>
<p>For each Monaco batch, the output file lists the batch time and the
starting random number for the next batch, which may be useful in
rerunning only a portion of a problem. Once all of the batches are
completed, a list of the various tally files that have been created is
given. Finally, the tallies are summarized in a section entitled “Final
Tally Results Summary.” For each point detector, the total neutron and
photon fluxes (uncollided and total) are given as well as the final
response values for each response function. For each region tally, the
total neutron and photon fluxes (both track-length and collision density
estimates) are listed, followed by the final response values for each
response function. Group‑by‑group details are saved to separate files
for each tally.</p>
</div>
<div class="section" id="additional-output-files">
<h3>Additional output files<a class="headerlink" href="#additional-output-files" title="Permalink to this headline">¶</a></h3>
<p>In addition to the generous amount of data contained in the MAVRIC text
output file, many other files are created containing the intermediate
data used by the sequence and the final tally data. Many of the files
produced can be viewed using the Mesh File Viewer or the Interactive
Plotter capabilities of Fulcrum, which is distributed with SCALE. (Note
that most of the images in this document were taken from the Mesh File
Viewer from SCALE 6.1.) <a class="reference internal" href="#output-files"><span class="std std-numref">Table 7</span></a> lists the other output files, based
on the name of the main output file (here called <em>outputName)</em>, that are
available to the user. These files will be copied back to the directory
where the input file was located. Many of the files come from Monaco and
are discussed in the Monaco chapter of the SCALE manual (SECTIONREFERENCE).</p>
<p>Other files that the user may be interested in are listed in
<a class="reference internal" href="#intermediate-files"><span class="std std-numref">Table 8</span></a>. These files are kept in the temporary directory where SCALE
executes and are not copied back to the directory where the input file
was located, unless specifically requested using a SCALE “<code class="docutils literal notranslate"><span class="pre">shell</span></code>”
command. Curious users may also be interested in viewing the various
input files (i_*) that the MAVRIC sequence writes in order to run the
SCALE functional modules.</p>
<span id="output-files"></span><table class="docutils align-default" id="id31">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Output files that are copied back to user’s area when the sequence finishes<sup>a</sup></span><a class="headerlink" href="#id31" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 6%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Filename</p></th>
<th class="head"><p>Viewer</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Output Summary</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.out</p></td>
<td></td>
<td><p>main text output file, contains results summary</p></td>
</tr>
<tr class="row-even"><td><p>Diagnostic files</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.respid.chart</p></td>
<td><p>P</p></td>
<td><p>response input and MG representation for response <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.gridid.3dmap</p></td>
<td><p>V</p></td>
<td><p>mesh version of geometry using grid geometry <em>id</em></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.cylid.3dmap</p></td>
<td><p>V</p></td>
<td><p>mesh version of geometry using cylindrical geometry <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.distid.chart</p></td>
<td><p>P</p></td>
<td><p>distribution input and sampling test for distribution <em>id</em></p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Mesh Source Saver</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><em>filename</em>.msm</p></td>
<td><p>V</p></td>
<td><p>mesh representation of a single source or total source</p></td>
</tr>
<tr class="row-even"><td><p><em>filename</em>.id.msm</p></td>
<td><p>V</p></td>
<td><p>mesh representation of multiple sources</p></td>
</tr>
<tr class="row-odd"><td><p><em>filename</em>.sampling.msm</p></td>
<td><p>V</p></td>
<td><p>biased representation of a single source or total source</p></td>
</tr>
<tr class="row-even"><td><p><em>filename</em>.sampling.id.msm</p></td>
<td><p>V</p></td>
<td><p>biased representation of multiple sources</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Importance Map Generation</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.geometry.3dmap</p></td>
<td><p>V</p></td>
<td><p>voxelized geometry (cell-center testing only)</p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.forward.dff</p></td>
<td><p>V</p></td>
<td><p>scalar forward flux estimate,  <span class="math notranslate nohighlight">\(\phi\left(x,y,z,E \right)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.adjoint.dff</p></td>
<td><p>V</p></td>
<td><p>scalar adjoint flux estimate,  <span class="math notranslate nohighlight">\(\phi^{+} \left( x,y,z,E \right)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.mim</p></td>
<td><p>V</p></td>
<td><p>Monaco mesh importance map, <span class="math notranslate nohighlight">\(\overline{w}\left(x,y,z,E \right)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.msm</p></td>
<td><p>V</p></td>
<td><p>Monaco mesh source, <span class="math notranslate nohighlight">\(\widehat{q}\left(x,y,z,E \right)\)</span></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.mmt</p></td>
<td><p>V</p></td>
<td><p>macro-material table</p></td>
</tr>
<tr class="row-odd"><td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Tally Files</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.pdid.txt</p></td>
<td></td>
<td><p>detailed results for point detector tally <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.pdid.chart</p></td>
<td><p>P</p></td>
<td><p>batch convergence data for point detector tally <em>id</em></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.rtid.txt</p></td>
<td></td>
<td><p>detailed results for region tally <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.rtid.chart</p></td>
<td><p>P</p></td>
<td><p>batch convergence data for region tally <em>id</em></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.mtid.3dmap</p></td>
<td><p>V</p></td>
<td><p>mesh tally for meshTally <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.mtid.respxx.3dmap</p></td>
<td><p>V</p></td>
<td><p>mesh tally of response by group for meshTally <em>id</em> response xx</p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.mtid.flux.txt</p></td>
<td></td>
<td><p>detailed results for the group-wise flux of meshTally <em>id</em></p></td>
</tr>
<tr class="row-even"><td><p><em>outputName</em>.mtid.tfluxtxt</p></td>
<td></td>
<td><p>detailed results for total flux of meshTally <em>id</em></p></td>
</tr>
<tr class="row-odd"><td><p><em>outputName</em>.mtid.respxx.txt</p></td>
<td></td>
<td><p>detailed results for response xx of meshTally <em>id</em></p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><sup>a</sup> V – can be displayed with the Mesh File Viewer capabilities of Fulcrum. <em>P</em> – can be displayed with the 2D plotting capabilities of Fulcrum.</p>
<span id="intermediate-files"></span><table class="docutils align-default" id="id32">
<caption><span class="caption-number">Table 8 </span><span class="caption-text">Other intermediate files—available in the temporary directory (may be useful for testing and debugging)</span><a class="headerlink" href="#id32" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Filename</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ft02f001</p></td>
<td><p>AMPX formatted cross
sections for Denovo</p></td>
</tr>
<tr class="row-odd"><td><p>fort.51</p></td>
<td><p>text file, listings
of the mixing table
for Monaco</p></td>
</tr>
<tr class="row-even"><td><p>fort.52</p></td>
<td><p>text file, review of
MAVRIC sequence input
variables</p></td>
</tr>
<tr class="row-odd"><td><p>fort.54</p></td>
<td><p>energy bin boundaries
for the current cross
section library</p></td>
</tr>
<tr class="row-even"><td><p>xkba_b.inp</p></td>
<td><p>binary input file for
Denovo – rename to
have</p>
<p>a *.dsi extension
(Denovo simple input)
to be viewed via Mesh
File Viewer</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="sample-problems">
<h2>Sample problems<a class="headerlink" href="#sample-problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="graphite-shielding-measurements-with-cadis">
<h3>Graphite shielding measurements with CADIS<a class="headerlink" href="#graphite-shielding-measurements-with-cadis" title="Permalink to this headline">¶</a></h3>
<p>As shown in the Monaco sample problem for simulating the Ueki shielding experiments
(Monaco chapter Graphite Shielding Measurements) (SECTIONREFERENCE),
as the amount of shielding material between a source and detector increases,
the time required to reach a certain level of relative uncertainty increases quickly.
This example will use the MAVRIC automated variance reduction capability to optimize the
calculation of the dose rate at the detector location by specifying an importance map block
with an adjoint source made from the detector response function and the detector location.</p>
<div class="section" id="input-file">
<h4>Input file<a class="headerlink" href="#input-file" title="Permalink to this headline">¶</a></h4>
<p>The following is a listing of the file <code class="docutils literal notranslate"><span class="pre">mavric.graphiteCADIS.inp</span></code> located
in the SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory. This calculation will use the
coarse-group shielding library (27n19g) for all of the importance map
calculations and the fine-group library (200n47g) for the final Monaco
step. Additions, compared to the file <code class="docutils literal notranslate"><span class="pre">monaco.graphite.inp</span></code>, include a
grid geometry for the Denovo computational mesh, a mesh tally to better
visualize the particle flow, and the importance map block to optimize
the Monte Carlo calculation of the point detector.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">Monaco/MAVRIC</span> <span class="err">Training</span> <span class="err">-</span> <span class="err">Exercise</span> <span class="m">3</span><span class="err">.</span> <span class="err">Graphite</span> <span class="err">Shielding</span> <span class="err">Measurements</span> <span class="err">Revisited</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Composition Block - standard SCALE input</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">para(h</span><span class="m">2</span><span class="err">o)</span>    <span class="m">1</span>         <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">carbon</span>       <span class="m">2</span> <span class="err">den=</span><span class="m">1</span><span class="err">.</span><span class="m">7</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">300</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Geometry Block - SCALE standard geometry package (SGGP)</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
    <span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
        <span class="err">cuboid</span>  <span class="m">1</span>   <span class="m">25</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">25</span><span class="err">.</span><span class="m">0</span>  <span class="m">25</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">25</span><span class="err">.</span><span class="m">0</span>   <span class="m">25</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">25</span><span class="err">.</span><span class="m">0</span>
        <span class="err">cone</span>    <span class="m">2</span>  <span class="m">10</span><span class="err">.</span><span class="m">35948</span>  <span class="m">25</span><span class="err">.</span><span class="m">01</span>   <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>   <span class="err">rotate</span>  <span class="err">a</span><span class="m">1</span><span class="err">=-</span><span class="m">90</span> <span class="err">a</span><span class="m">2</span><span class="err">=-</span><span class="m">90</span> <span class="err">a</span><span class="m">3</span><span class="err">=</span><span class="m">0</span>
        <span class="err">cuboid</span>  <span class="m">3</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">70</span><span class="err">.</span><span class="m">0</span>  <span class="m">40</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">0</span>   <span class="m">40</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">0</span>
        <span class="err">cuboid</span> <span class="m">99</span>  <span class="m">120</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">30</span><span class="err">.</span><span class="m">0</span>  <span class="m">50</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">0</span>   <span class="m">50</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">0</span>
        <span class="err">media</span> <span class="m">1</span> <span class="m">1</span>  <span class="m">1</span> <span class="err">-</span><span class="m">2</span>
        <span class="err">media</span> <span class="m">0</span> <span class="m">1</span>  <span class="m">2</span>
        <span class="err">media</span> <span class="m">2</span> <span class="m">1</span>  <span class="m">3</span>
        <span class="err">media</span> <span class="m">0</span> <span class="m">1</span>  <span class="m">99</span> <span class="err">-</span><span class="m">1</span>  <span class="err">-</span><span class="m">2</span> <span class="err">-</span><span class="m">3</span>
    <span class="err">boundary</span> <span class="m">99</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Definitions Block</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">location</span> <span class="m">1</span>
        <span class="err">position</span> <span class="m">110</span> <span class="m">0</span> <span class="m">0</span>
    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">response</span> <span class="m">5</span>
        <span class="err">title=</span><span class="s">&quot;ANSI standard (1977) neutron flux-to-dose-rate factors&quot;</span>
        <span class="err">specialDose=</span><span class="m">9029</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">distribution</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;Cf-252 neutrons, Watt spectrum a=1.025 MeV and b=2.926/MeV&quot;</span>
        <span class="err">special=</span><span class="s">&quot;wattSpectrum&quot;</span>
        <span class="err">parameters</span> <span class="m">1</span><span class="err">.</span><span class="m">025</span> <span class="m">2</span><span class="err">.</span><span class="m">926</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
    <span class="err">gridGeometry</span> <span class="m">7</span>
        <span class="err">title=</span><span class="s">&quot;large meshes in paraffin, 5 cm mesh for shield thicknesses&quot;</span>
        <span class="err">xLinear</span> <span class="m">5</span> <span class="err">-</span><span class="m">25</span> <span class="m">25</span>
        <span class="err">xLinear</span> <span class="m">12</span> <span class="m">30</span> <span class="m">90</span>
        <span class="err">xplanes</span> <span class="m">100</span> <span class="m">110</span> <span class="m">120</span> <span class="err">-</span><span class="m">30</span> <span class="n">end</span>
        <span class="err">yplanes</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">40</span> <span class="m">40</span> <span class="m">50</span> <span class="n">end</span>
        <span class="err">yLinear</span> <span class="m">7</span> <span class="err">-</span><span class="m">35</span> <span class="m">35</span>
        <span class="err">zplanes</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">40</span> <span class="m">40</span> <span class="m">50</span> <span class="n">end</span>
        <span class="err">zLinear</span> <span class="m">7</span> <span class="err">-</span><span class="m">35</span> <span class="m">35</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Sources Block</span>
<span class="c">&#39;   Cf-252 neutrons, Watt fission spectrum model</span>
<span class="c">&#39;   with a=1.025 MeV and  b=2.926/MeV</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;Cf-252 neutrons, Watt fission spectrum model&quot;</span>
        <span class="err">strength</span><span class="m">=4.05E+07</span>
        <span class="err">cuboid</span>  <span class="m">0</span><span class="err">.</span><span class="m">01</span> <span class="m">0</span><span class="err">.</span><span class="m">01</span>  <span class="m">0</span> <span class="m">0</span>  <span class="m">0</span> <span class="m">0</span>
        <span class="err">neutrons</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Tallies Block</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
    <span class="err">pointDetector</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;center of detector&quot;</span>
        <span class="err">locationID=</span><span class="m">1</span>
        <span class="err">responseID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">meshTally</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;example mesh tally&quot;</span>
        <span class="err">gridGeometryID=</span><span class="m">7</span>
        <span class="err">responseID=</span><span class="m">5</span>
        <span class="err">noGroupFluxes</span>
    <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Parameters Block</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
    <span class="err">randomSeed=</span><span class="m">00003</span><span class="err">ecd</span><span class="m">7</span><span class="err">b</span><span class="m">4</span><span class="err">e</span><span class="m">3</span><span class="err">e</span><span class="m">8</span><span class="err">b</span>
    <span class="err">library=</span><span class="s">&quot;v7-200n47g&quot;</span>
    <span class="err">perBatch=</span><span class="m">10000</span> <span class="err">batches=</span><span class="m">10</span>
    <span class="err">fissionMult=</span><span class="m">0</span>   <span class="err">noPhotons</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Importance Map Block</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">locationID=</span><span class="m">1</span>
        <span class="err">responseID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">gridGeometryID=</span><span class="m">7</span>
            <span class="err">macromaterial</span>
        <span class="err">mmTolerance=</span><span class="m">0</span><span class="err">.</span><span class="m">01</span>
    <span class="n">end</span><span class="err"> </span><span class="n">macromaterial</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>

<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="output">
<h4>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h4>
<p>MAVRIC results for the point detector response for the 20 cm case are shown below and in <a class="reference internal" href="#mesh-tally"><span class="std std-numref">Fig. 6</span></a>.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">Neutron</span> <span class="err">Point</span> <span class="err">Detector</span> <span class="m">1</span><span class="err">.</span> <span class="err">center</span> <span class="err">of</span> <span class="err">detector</span>
                         <span class="err">average</span>      <span class="err">standard</span>     <span class="err">relat</span>      <span class="err">FOM</span>    <span class="err">stat</span> <span class="err">checks</span>
    <span class="err">tally/quantity</span>        <span class="err">value</span>       <span class="err">deviation</span>    <span class="err">uncert</span>   <span class="err">(/min)</span>   <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span>
    <span class="err">------------------</span>  <span class="err">-----------</span>  <span class="err">-----------</span>  <span class="err">-------</span>  <span class="err">--------</span>  <span class="err">-----------</span>
    <span class="err">uncollided</span> <span class="err">flux</span>     <span class="m">1</span><span class="err">.</span><span class="m">06384</span><span class="err">E+</span><span class="m">01</span>  <span class="m">1</span><span class="err">.</span><span class="m">88744</span><span class="err">E-</span><span class="m">02</span>  <span class="m">0</span><span class="err">.</span><span class="m">00177</span>
    <span class="err">total</span> <span class="err">flux</span>          <span class="m">2</span><span class="err">.</span><span class="m">36367</span><span class="err">E+</span><span class="m">02</span>  <span class="m">5</span><span class="err">.</span><span class="m">47276</span><span class="err">E+</span><span class="m">00</span>  <span class="m">0</span><span class="err">.</span><span class="m">02315</span>  <span class="m">8</span><span class="err">.</span><span class="m">10</span><span class="err">E+</span><span class="m">02</span>  <span class="err">X</span> <span class="err">-</span> <span class="err">X</span> <span class="err">-</span> <span class="err">X</span> <span class="err">-</span>
    <span class="err">response</span> <span class="m">5</span>          <span class="m">1</span><span class="err">.</span><span class="m">28632</span><span class="err">E-</span><span class="m">02</span>  <span class="m">1</span><span class="err">.</span><span class="m">74351</span><span class="err">E-</span><span class="m">04</span>  <span class="m">0</span><span class="err">.</span><span class="m">01355</span>  <span class="m">2</span><span class="err">.</span><span class="m">36</span><span class="err">E+</span><span class="m">03</span>  <span class="err">X</span> <span class="err">X</span> <span class="err">X</span> <span class="err">X</span> <span class="err">X</span> <span class="err">X</span>
    <span class="err">------------------</span>  <span class="err">-----------</span>  <span class="err">-----------</span>  <span class="err">-------</span>  <span class="err">--------</span>  <span class="err">-----------</span>
</pre></div>
</div>
<p>This problem took only ~2.5 minutes (0.2 in Denovo and 2.3 minutes in
Monaco) on the same processor as the 20 minute analog case. (The figure
of merit [FOM] is 15 times higher than the analog.) Note that the point
detector dose rate is the same as the Monaco analog sample problem, but
the relative uncertainty is smaller with less computation time. CADIS
has optimized the calculation by focusing on neutrons that contribute to
the dose rate at the detector location at the expense of neutrons in
the paraffin block. This is demonstrated by the mesh tally of dose rates
where the values for the dose rate are lower in the paraffin block and
the relative uncertainties are higher. Since the calculation was
optimized for the position of the detector, dose rates in other parts of
the problem are underestimated and should not be believed.</p>
<p>The mesh tally shows that the CADIS calculation did not follow as many
particles deep into the paraffin block, so the uncertainties are greater
there, but that is what this problem was supposed to do—reduce the
uncertainty at the point detector at the expense of the other portions
of the problem.</p>
<div class="figure align-default" id="id33">
<span id="mesh-tally"></span><img alt="_images/mesh-tally.png" src="_images/mesh-tally.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Mesh tally showing neutron dose rate (rem/hr) and uncertainties for the analog case and the CADIS case.</span><a class="headerlink" href="#id33" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="dose-rates-outside-of-a-simple-cask">
<h3>Dose rates outside of a simple cask<a class="headerlink" href="#dose-rates-outside-of-a-simple-cask" title="Permalink to this headline">¶</a></h3>
<p>This example problem is a full-size cylindrical cask model, which consists of an inner steel liner,
a thick section of concrete, and an outer steel cover. This problem is intended to be used as a tool to
teach users how to build MAVRIC input files. This is not a completely realistic shipping cask; it has been
simplified greatly for this purpose. The goal of this example it to show how to quickly calculate neutron
and photon does rates at six points outside of the cask, including in front of the vent port.</p>
<div class="section" id="geometry-and-materials">
<h4>Geometry and materials<a class="headerlink" href="#geometry-and-materials" title="Permalink to this headline">¶</a></h4>
<p>The simple model of a cask is shown in <a class="reference internal" href="#cask-geom2"><span class="std std-numref">Fig. 7</span></a>.
Vent ports at the top and bottom of the cask are modeled as void all of the way around the cask.
The interior of the cask was modeled using materials from about 20 typical pressurized water reactor
(PWR) fuel assemblies (including the UO2, Zr, Fe, Ni, Cr, Sn, and other constituents),
homogenized over the interior volume. The total mass of the fuel/assembly hardware in this
region is 10.6 metric tonnes. Separate end regions of the assemblies are not modeled in this
simple example. Also note that the fuel material is based on fresh fuel, not spent fuel with
its hundreds of fission products.</p>
<div class="figure align-center" id="id34">
<span id="cask-geom2"></span><img alt="_images/cask-geom2.png" src="_images/cask-geom2.png" />
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Cask geometry and detector locations.</span><a class="headerlink" href="#id34" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="sources-and-responses">
<h4>Sources and responses<a class="headerlink" href="#sources-and-responses" title="Permalink to this headline">¶</a></h4>
<p>Spent fuel from a typical mid-sized PWR was used to determine the source
term. ORIGEN was used to deplete a full core (46.1 metric tonnes of
uranium, 4.2% enriched, with O, Zr, Fe, Ni, Cr, Sn, and other
constituents) to 55,000 MWdays/MTU. The contents of the modeled fuel
represent typical values for PWR fuel. ORIGEN then computed the neutron
and photon spectra in 27-group and 19-group energy structures for the
fuel following a 10-year cooling period after the last irradiation. The
total neutron source strength for the cask (1/6 of a full core, or about
20 assemblies) was 8.577×10<sup>9</sup> neutrons/s. The total photon
source strength was 7.155 × 10<sup>16</sup> photons/s.</p>
<p>Two cases will be done for this example: one for calculating the neutron
dose rates from the spent fuel neutrons and the other for calculating
the photon dose rates from the spent fuel photons. The source spectra
and response functions are shown in <a class="reference internal" href="#spent-neutron"><span class="std std-numref">Fig. 8</span></a> through <a class="reference internal" href="#ansi-photon"><span class="std std-numref">Fig. 11</span></a>
and listed in <a class="reference internal" href="#source-and-response"><span class="std std-numref">Table 9</span></a>. Note that in this example, the neutron source
shown in <a class="reference internal" href="#spent-neutron"><span class="std std-numref">Fig. 8</span></a> and <a class="reference internal" href="#source-and-response"><span class="std std-numref">Table 9</span></a> is considered the final neutron
source: no further neutron multiplication is considered.</p>
<div class="figure align-center" id="id35">
<span id="spent-neutron"></span><img alt="_images/fig4.1.08_caskSrcRespn.dist1.png" src="_images/fig4.1.08_caskSrcRespn.dist1.png" />
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">Spent fuel neutron source spectrum with strength 8.577 × 10<sup>9</sup>/second.</span><a class="headerlink" href="#id35" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id36">
<span id="ansi-neutron"></span><img alt="_images/fig4.1.09_caskSrcRespn.resp1.png" src="_images/fig4.1.09_caskSrcRespn.resp1.png" />
<p class="caption"><span class="caption-number">Fig. 9 </span><span class="caption-text">ANSI-1977/ flux-to-dose-rate factors (rem/hr)/(neutrons/cm <sup>2</sup>/sec).</span><a class="headerlink" href="#id36" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id37">
<span id="spent-photon"></span><img alt="_images/fig4.1.10_caskSrcRespp.dist1.png" src="_images/fig4.1.10_caskSrcRespp.dist1.png" />
<p class="caption"><span class="caption-number">Fig. 10 </span><span class="caption-text">Spent fuel photon source spectrum with strength 7.155×10<sup>16</sup>/second</span><a class="headerlink" href="#id37" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id38">
<span id="ansi-photon"></span><img alt="_images/fig4.1.11_caskSrcRespp.resp1.png" src="_images/fig4.1.11_caskSrcRespp.resp1.png" />
<p class="caption"><span class="caption-number">Fig. 11 </span><span class="caption-text">ANSI-1977 photon flux-to-dose-rate factors (rem/hr)/(photons/cm <sup>2</sup>/sec)</span><a class="headerlink" href="#id38" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-default" id="source-and-response">
<caption><span class="caption-number">Table 9 </span><span class="caption-text">Source and response data using the SCALE 27-group energy structure for neutrons and the 19-group energy structure for photons</span><a class="headerlink" href="#source-and-response" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab9.png" src="_images/tab9.png" />
</td>
</tr>
</tbody>
</table>
<p>Energies listed are the bin upper energies. Source units are
particles/s normalized to a total of 1 particle/s. Response units are
(rem/hr)/(particle/cm<sup>2</sup>/s).</p>
</div>
<div class="section" id="analog-calculation">
<h4>Analog calculation<a class="headerlink" href="#analog-calculation" title="Permalink to this headline">¶</a></h4>
<p>The analog model for this problem starts with the problem title and the cross section library name,
which in this example is the ENDF/B-VII.0 27 neutron group / 19 photon group library.
This is in the SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory as <code class="docutils literal notranslate"><span class="pre">mavric.caskAnalogn.inp</span></code> and <code class="docutils literal notranslate"><span class="pre">mavric.caskAnalogp.inp</span></code>.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">Simplified</span> <span class="err">cask</span> <span class="err">model</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>
</pre></div>
</div>
<p>Then the material compositions are listed for fresh fuel, concrete, and steel.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">wtptFuel</span>   <span class="m">1</span> <span class="m">0</span><span class="err">.</span><span class="m">913717475</span> <span class="m">18</span>         <span class="m">6000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00939719</span>    <span class="m">7014</span>  <span class="m">0</span><span class="err">.</span><span class="m">00528993</span>
                    <span class="m">8016</span>  <span class="m">9</span><span class="err">.</span><span class="m">73397641</span>   <span class="m">13000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00715715</span>   <span class="m">14000</span>  <span class="m">0</span><span class="err">.</span><span class="m">01031670</span>
                   <span class="m">15000</span>  <span class="m">0</span><span class="err">.</span><span class="m">02227505</span>   <span class="m">22000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00780567</span>   <span class="m">24000</span>  <span class="m">0</span><span class="err">.</span><span class="m">36655141</span>
                   <span class="m">25000</span>  <span class="m">0</span><span class="err">.</span><span class="m">01716839</span>   <span class="m">26000</span>  <span class="m">0</span><span class="err">.</span><span class="m">72041451</span>   <span class="m">27000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00523824</span>
                   <span class="m">28000</span>  <span class="m">0</span><span class="err">.</span><span class="m">68955526</span>   <span class="m">40000</span> <span class="m">15</span><span class="err">.</span><span class="m">78990702</span>   <span class="m">41000</span>  <span class="m">0</span><span class="err">.</span><span class="m">05130153</span>
                   <span class="m">42000</span>  <span class="m">0</span><span class="err">.</span><span class="m">02844690</span>   <span class="m">50118</span>  <span class="m">0</span><span class="err">.</span><span class="m">25877903</span>   <span class="m">92235</span>  <span class="m">3</span><span class="err">.</span><span class="m">03560962</span>
                   <span class="m">92238</span> <span class="m">69</span><span class="err">.</span><span class="m">24080999</span>
                 <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">orconcrete</span> <span class="m">2</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">ss</span><span class="m">304</span>      <span class="m">3</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
</pre></div>
</div>
<p>Then the SGGP geometry is listed, with the origin of the coordinate system at the center of the cask.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
    <span class="err">global</span> <span class="err">unit</span>  <span class="m">1</span>
        <span class="err">zcylinder</span>  <span class="m">1</span>   <span class="m">95</span><span class="err">.</span><span class="m">0</span>  <span class="m">228</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">228</span><span class="err">.</span><span class="m">6</span>
        <span class="err">zcylinder</span>  <span class="m">2</span>  <span class="m">170</span><span class="err">.</span><span class="m">0</span>  <span class="m">255</span><span class="err">.</span><span class="m">2</span> <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">2</span>
        <span class="err">zcylinder</span>  <span class="m">3</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">240</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">240</span><span class="err">.</span><span class="m">6</span>
        <span class="err">zcylinder</span>  <span class="m">4</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
        <span class="err">zcylinder</span>  <span class="m">5</span>  <span class="m">170</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
        <span class="err">zcylinder</span>  <span class="m">6</span>  <span class="m">170</span><span class="err">.</span><span class="m">0</span>  <span class="m">285</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">285</span><span class="err">.</span><span class="m">6</span>
        <span class="err">zcylinder</span>  <span class="m">7</span>   <span class="m">95</span><span class="err">.</span><span class="m">0</span>  <span class="m">255</span><span class="err">.</span><span class="m">2</span> <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">2</span>
        <span class="err">zcylinder</span>  <span class="m">8</span>  <span class="m">100</span><span class="err">.</span><span class="m">0</span>  <span class="m">255</span><span class="err">.</span><span class="m">2</span> <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">2</span>
        <span class="err">zcylinder</span>  <span class="m">9</span>  <span class="m">168</span><span class="err">.</span><span class="m">0</span>  <span class="m">255</span><span class="err">.</span><span class="m">2</span> <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">2</span>
        <span class="err">sphere</span>    <span class="m">10</span>  <span class="m">999</span><span class="err">.</span><span class="m">0</span>
        <span class="err">media</span>  <span class="m">1</span> <span class="m">1</span>   <span class="m">1</span>          <span class="err">vol</span><span class="m">=1.29629E+07</span>
        <span class="err">media</span>  <span class="m">3</span> <span class="m">1</span>   <span class="m">8</span> <span class="err">-</span><span class="m">7</span>       <span class="err">vol</span><span class="m">=1.56338E+06</span>
        <span class="err">media</span>  <span class="m">2</span> <span class="m">1</span>   <span class="m">9</span> <span class="err">-</span><span class="m">8</span>       <span class="err">vol</span><span class="m">=2.92216E+07</span>
        <span class="err">media</span>  <span class="m">3</span> <span class="m">1</span>   <span class="m">2</span> <span class="err">-</span><span class="m">9</span>       <span class="err">vol</span><span class="m">=1.08394E+06</span>
        <span class="err">media</span>  <span class="m">3</span> <span class="m">1</span>   <span class="m">3</span> <span class="err">-</span><span class="m">1</span>       <span class="err">vol</span><span class="m">=6.10726E+05</span>
        <span class="err">media</span>  <span class="m">2</span> <span class="m">1</span>   <span class="m">4</span> <span class="err">-</span><span class="m">3</span>       <span class="err">vol</span><span class="m">=2.03575E+06</span>
        <span class="err">media</span>  <span class="m">3</span> <span class="m">1</span>   <span class="m">6</span> <span class="err">-</span><span class="m">5</span>       <span class="err">vol</span><span class="m">=9.07920E+05</span>
        <span class="err">media</span>  <span class="m">0</span> <span class="m">1</span>   <span class="m">5</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">2</span>    <span class="err">vol</span><span class="m">=3.31953E+06</span>
        <span class="err">media</span>  <span class="m">0</span> <span class="m">1</span>   <span class="m">7</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">1</span>    <span class="err">vol</span><span class="m">=1.54598E+05</span>
        <span class="err">media</span>  <span class="m">0</span> <span class="m">1</span>   <span class="m">10</span> <span class="err">-</span><span class="m">6</span>      <span class="err">vol</span><span class="m">=4.12429E+09</span>
    <span class="err">boundary</span> <span class="m">10</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
</pre></div>
</div>
<p>The definitions block contains locations, response functions, grid geometries, and a distribution used by the source input block. For the neutron source/neutron dose problem, the definitions block is listed below.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">location</span> <span class="m">1</span>   <span class="err">position</span> <span class="m">180</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>   <span class="m">0</span><span class="err">.</span><span class="m">0</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">location</span> <span class="m">2</span>   <span class="err">position</span>   <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">295</span><span class="err">.</span><span class="m">6</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">location</span> <span class="m">3</span>   <span class="err">position</span> <span class="m">180</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">267</span><span class="err">.</span><span class="m">9</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">location</span> <span class="m">4</span>   <span class="err">position</span> <span class="m">270</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>   <span class="m">0</span><span class="err">.</span><span class="m">0</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">location</span> <span class="m">5</span>   <span class="err">position</span>   <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">385</span><span class="err">.</span><span class="m">6</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">location</span> <span class="m">6</span>   <span class="err">position</span> <span class="m">270</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">385</span><span class="err">.</span><span class="m">6</span>    <span class="n">end</span><span class="err"> </span><span class="n">location</span>
    <span class="err">response</span> <span class="m">1</span>  <span class="err">specialDose=</span><span class="m">9029</span>  <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">distribution</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;kewaunee core, 3 cycles and then 10 years&quot;</span>
        <span class="err">neutronGroups</span>
        <span class="err">truePDF</span>  <span class="m">2</span><span class="err">.</span><span class="m">040</span><span class="err">E-</span><span class="m">02</span> <span class="m">2</span><span class="err">.</span><span class="m">147</span><span class="err">E-</span><span class="m">01</span> <span class="m">2</span><span class="err">.</span><span class="m">365</span><span class="err">E-</span><span class="m">01</span> <span class="m">1</span><span class="err">.</span><span class="m">267</span><span class="err">E-</span><span class="m">01 1.586E-01</span>
                 <span class="m">1</span><span class="err">.</span><span class="m">587</span><span class="err">E-</span><span class="m">01</span> <span class="m">7</span><span class="err">.</span><span class="m">281</span><span class="err">E-</span><span class="m">02</span> <span class="m">1</span><span class="err">.</span><span class="m">073</span><span class="err">E-</span><span class="m">02</span> <span class="m">7</span><span class="err">.</span><span class="m">688</span><span class="err">E-</span><span class="m">04 5.694E-05</span>
                 <span class="m">4</span><span class="err">.</span><span class="m">479</span><span class="err">E-</span><span class="m">06</span> <span class="m">3</span><span class="err">.</span><span class="m">148</span><span class="err">E-</span><span class="m">07</span> <span class="m">4</span><span class="err">.</span><span class="m">983</span><span class="err">E-</span><span class="m">08</span> <span class="m">9</span><span class="err">.</span><span class="m">864</span><span class="err">E-</span><span class="m">09 1.117E-09</span>
                 <span class="m">3</span><span class="err">.</span><span class="m">286</span><span class="err">E-</span><span class="m">10</span> <span class="m">1</span><span class="err">.</span><span class="m">060</span><span class="err">E-</span><span class="m">10</span> <span class="m">9</span><span class="err">.</span><span class="m">203</span><span class="err">E-</span><span class="m">11</span> <span class="m">9</span><span class="err">.</span><span class="m">135</span><span class="err">E-</span><span class="m">11 1.755E-10</span>
                 <span class="m">2</span><span class="err">.</span><span class="m">590</span><span class="err">E-</span><span class="m">11</span> <span class="m">3</span><span class="err">.</span><span class="m">024</span><span class="err">E-</span><span class="m">11</span> <span class="m">3</span><span class="err">.</span><span class="m">451</span><span class="err">E-</span><span class="m">11</span> <span class="m">3</span><span class="err">.</span><span class="m">269</span><span class="err">E-</span><span class="m">12 5.447E-12</span>
                 <span class="m">4</span><span class="err">.</span><span class="m">089</span><span class="err">E-</span><span class="m">14</span> <span class="m">4</span><span class="err">.</span><span class="m">916</span><span class="err">E-</span><span class="m">14</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>The neutron source from the spent fuel is then listed.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;1/6 of kewaunee core, ~ 0.25 Ci&quot;</span>
        <span class="err">strength</span><span class="m">=8.577E+09</span>
        <span class="err">neutrons</span>
        <span class="err">zCylinder</span> <span class="m">95</span><span class="err">.</span><span class="m">0</span>  <span class="m">228</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">228</span><span class="err">.</span><span class="m">6</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>Six point detectors are used to evaluate dose rates radially, axially, and near the vent port.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
    <span class="err">pointDetector</span> <span class="m">1</span>  <span class="err">locationID=</span><span class="m">1</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">pointDetector</span> <span class="m">2</span>  <span class="err">locationID=</span><span class="m">2</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">pointDetector</span> <span class="m">3</span>  <span class="err">locationID=</span><span class="m">3</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">pointDetector</span> <span class="m">4</span>  <span class="err">locationID=</span><span class="m">4</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">pointDetector</span> <span class="m">5</span>  <span class="err">locationID=</span><span class="m">5</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
    <span class="err">pointDetector</span> <span class="m">6</span>  <span class="err">locationID=</span><span class="m">6</span>  <span class="err">responseID=</span><span class="m">1</span>  <span class="n">end</span><span class="err"> </span><span class="n">pointDetector</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>
</pre></div>
</div>
<p>The Monte Carlo parameters were tailored for the neutron problem to be 1-minute batches
on a 2 GHz Linux computer. For the photon problem, the number per batch would be 91,000 for 1-minute batches.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
    <span class="err">randomSeed=</span><span class="m">8655745280030001</span>
    <span class="err">perBatch=</span><span class="m">25400</span> <span class="err">batches=</span><span class="m">600</span>
    <span class="err">fissionMult=</span><span class="m">0</span>    <span class="err">noPhotons</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>
</pre></div>
</div>
<p>No biasing is specified, which will use the default weight window target value of 1 for every energy
group in every region. To allow the neutrons to penetrate into the cask wall before being rouletted,
a larger window ratio is used, making the lower weight window bound 0.01.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">biasing</span>
    <span class="err">windowRatio=</span><span class="m">199</span><span class="err">.</span><span class="m">0</span>
<span class="n">end</span><span class="err"> </span><span class="n">biasing</span>
</pre></div>
</div>
<p>The Monaco input is then ended.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
<p>For the photon source/photon dose rate problem, the definitions block would instead contain a photon flux-to-dose-rate response function and the energy distribution for the source.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">1</span>
        <span class="err">specialDose=</span><span class="m">9504</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">…</span>
    <span class="err">distribution</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;kewaunee core, 3 cycles and then 10 years&quot;</span>
        <span class="err">photonGroups</span>
        <span class="err">truePDF</span> <span class="m">1</span><span class="err">.</span><span class="m">320</span><span class="err">E-</span><span class="m">12</span> <span class="m">7</span><span class="err">.</span><span class="m">185</span><span class="err">E-</span><span class="m">11</span> <span class="m">3</span><span class="err">.</span><span class="m">281</span><span class="err">E-</span><span class="m">10</span> <span class="m">1</span><span class="err">.</span><span class="m">672</span><span class="err">E-</span><span class="m">09 4.167E-09</span>
                <span class="m">8</span><span class="err">.</span><span class="m">086</span><span class="err">E-</span><span class="m">08</span> <span class="m">7</span><span class="err">.</span><span class="m">937</span><span class="err">E-</span><span class="m">07</span> <span class="m">1</span><span class="err">.</span><span class="m">164</span><span class="err">E-</span><span class="m">05</span> <span class="m">3</span><span class="err">.</span><span class="m">331</span><span class="err">E-</span><span class="m">05 8.160E-03</span>
                <span class="m">3</span><span class="err">.</span><span class="m">511</span><span class="err">E-</span><span class="m">02</span> <span class="m">2</span><span class="err">.</span><span class="m">478</span><span class="err">E-</span><span class="m">02</span> <span class="m">4</span><span class="err">.</span><span class="m">827</span><span class="err">E-</span><span class="m">01</span> <span class="m">4</span><span class="err">.</span><span class="m">641</span><span class="err">E-</span><span class="m">02 9.736E-03</span>
                <span class="m">1</span><span class="err">.</span><span class="m">514</span><span class="err">E-</span><span class="m">02</span> <span class="m">5</span><span class="err">.</span><span class="m">182</span><span class="err">E-</span><span class="m">02</span> <span class="m">7</span><span class="err">.</span><span class="m">015</span><span class="err">E-</span><span class="m">02</span> <span class="m">2</span><span class="err">.</span><span class="m">560</span><span class="err">E-</span><span class="m">01</span>       <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>The sources block would contain the photon source information.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;1/6 of kewaunee core, ~ 2e6 Ci&quot;</span>
        <span class="err">strength</span><span class="m">=7.155e+16</span>
        <span class="err">photons</span>
        <span class="err">zCylinder</span> <span class="m">95</span><span class="err">.</span><span class="m">0</span>  <span class="m">228</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">228</span><span class="err">.</span><span class="m">6</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>Each of the two analog problems in the <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory will run for
about 10 minutes. In this time, no meaningful results will be generated
due to the difficulty of the problem. Analog results for each case
running 110 hr are listed in <a class="reference internal" href="#analog-neutron"><span class="std std-numref">Table 10</span></a> for the neutron source/neutron
dose problem, while results for the photon problem are listed in
<a class="reference internal" href="#analog-photon"><span class="std std-numref">Table 11</span></a>. Note that after 110 hr, some of the relative uncertainties
in the point detector tallies are still quite high, and only one of the
six tallies in each problem passed all of the statistical checks.
<a class="reference internal" href="#neutron-dose-plot"><span class="std std-numref">Fig. 12</span></a> is the convergence plot for the neutron dose rate at point
detector 1, showing that the tally is not well converged and that some
batches contain rare events that change the tally value a great deal.</p>
<table class="docutils align-center" id="analog-neutron">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Analog Monaco results for the simplified cask model—neutron source/neutron dose rate.</span><a class="headerlink" href="#analog-neutron" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab101.png" src="_images/tab101.png" />
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="analog-photon">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">Analog Monaco results for the simplified cask model—photon source/photon dose rate.</span><a class="headerlink" href="#analog-photon" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab11.png" src="_images/tab11.png" />
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id39">
<span id="neutron-dose-plot"></span><a class="reference internal image-reference" href="_images/fig4.1.12_mavric.caskAnalogn.pd1.png"><img alt="_images/fig4.1.12_mavric.caskAnalogn.pd1.png" src="_images/fig4.1.12_mavric.caskAnalogn.pd1.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 12 </span><span class="caption-text">Convergence plot for the neutron dose rate at point detector 1 (error bars show the 1-sigma tally uncertainties).</span><a class="headerlink" href="#id39" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="sas4-calculations">
<h4>SAS4 calculations<a class="headerlink" href="#sas4-calculations" title="Permalink to this headline">¶</a></h4>
<p>Calculations for these two problems were also done using the SAS4
sequence in SCALE 5.1. SAS4 was specifically designed for cask
geometries and used a one-dimensional discrete-ordinates calculation
(either radially or axially) to determine weight windows. Results for
the neutron problem are shown in <a class="reference internal" href="#neutron-problem"><span class="std std-numref">Table 12</span></a>, and results for the
photon problem are shown in <a class="reference internal" href="#photon-problem"><span class="std std-numref">Table 13</span></a>. Note that SAS4 using radial
biasing is only expected to do well for the two radial point detector
locations. Similarly, only the two axial point detectors are expected to
do well when using axial biasing. SAS4 was not intended to do well for
the points near the vent port, but the results using the axial biasing
seem reasonable.</p>
<table class="docutils align-center" id="neutron-problem">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">SAS4 results using radial biasing (361 minutes) and axial biasing (361 minutes), for the simplified cask model—neutron source/neutron dose rate</span><a class="headerlink" href="#neutron-problem" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab12.png" src="_images/tab12.png" />
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="photon-problem">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">SAS4 results using radial biasing (361 minutes) and axial biasing (361 minutes), for the simplified cask model—photon source/photon dose rate</span><a class="headerlink" href="#photon-problem" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab13.png" src="_images/tab13.png" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="calculations-using-cadis">
<h4>Calculations using CADIS<a class="headerlink" href="#calculations-using-cadis" title="Permalink to this headline">¶</a></h4>
<p>In the analog calculations, the dose rates at all six points could be
calculated at the same time. With MAVRIC and using CADIS, the importance
map will optimize the transport of particles towards only the selected
detector. Hence, each detector will have a separate calculation with an
importance map tailored to reduce the variance for only that detector.
Calculations for close detectors could be performed at the same time. For example, detectors 1
and 4 both need to push particles out of the cask in the positive
<em>x</em> direction, towards the <em>z</em>=0 plane. In this example, all six
detectors will use separate importance maps.</p>
<p>For the importance map, in the input, the user lists what planes to use
for the adjoint discrete-ordinates calculation. These planes define
cells, which are treated as homogenous parallelpipeds by Denovo, made of
a macro material corresponding to a mixture of materials that are in the
cell in the true geometry. Users should try to bound as many materials
as possible with their selection of mesh planes. More mesh planes should
be used where the importance (adjoint flux) varies quickly, such as
near the adjoint sources (the detector positions). It is also important
to have planes on the true source bounding box.</p>
<p>In this example problem, different sets of mesh planes will be used for
the different detector positions. For detector positions 1 and 4, the
mesh planes are shown in <a class="reference internal" href="#importance-1"><span class="std std-numref">Fig. 13</span></a> and <a class="reference internal" href="#importance-2"><span class="std std-numref">Fig. 14</span></a>. Note that
there are more planes closer to the detectors. Also note that in the
<em>z</em> dimension, it is quite easy to place mesh planes at every material
boundary, but it is a bit more difficult to do so in the <em>x</em> and <em>y</em> dimensions
due to the curved surfaces. Users need not worry about getting things
perfect—an approximate importance map can still reduce Monte Carlo
variances a great deal. The meshes used for detector positions 2/5 and
positions 3/6 are also shown in <a class="reference internal" href="#importance-1"><span class="std std-numref">Fig. 13</span></a> and <a class="reference internal" href="#importance-2"><span class="std std-numref">Fig. 14</span></a>. Mesh
parameters are listed in <a class="reference internal" href="#mesh-param-xyz"><span class="std std-numref">Table 14</span></a>, and the mesh planes are listed in
<a class="reference internal" href="#mesh-planes"><span class="std std-numref">Table 15</span></a>.</p>
<div class="figure align-center" id="id40">
<span id="importance-1"></span><a class="reference internal image-reference" href="_images/fig1.13.jpg"><img alt="_images/fig1.13.jpg" src="_images/fig1.13.jpg" style="width: 99%;" /></a>
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">Importance map mesh planes in the x and z dimensions for detector positions 1/4, 2/5, and 3/6.</span><a class="headerlink" href="#id40" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id41">
<span id="importance-2"></span><a class="reference internal image-reference" href="_images/fig1.14.jpg"><img alt="_images/fig1.14.jpg" src="_images/fig1.14.jpg" style="width: 99%;" /></a>
<p class="caption"><span class="caption-number">Fig. 14 </span><span class="caption-text">Importance map mesh planes in the x and y dimensions for detector positions 1/4, 2/5, and 3/6.</span><a class="headerlink" href="#id41" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-center" id="mesh-param-xyz">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Mesh parameters</span><a class="headerlink" href="#mesh-param-xyz" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Detector position</p></th>
<th class="head"><p>Number</p></th>
<th class="head"><p>of</p></th>
<th class="head"><p>cells</p></th>
<th class="head"><p>Total cells</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>x</p></td>
<td><p>y</p></td>
<td><p>z</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1/4</p></td>
<td><p>46</p></td>
<td><p>35</p></td>
<td><p>35</p></td>
<td><p>56350</p></td>
</tr>
<tr class="row-even"><td><p>2/5</p></td>
<td><p>35</p></td>
<td><p>35</p></td>
<td><p>49</p></td>
<td><p>60025</p></td>
</tr>
<tr class="row-odd"><td><p>3/6</p></td>
<td><p>46</p></td>
<td><p>35</p></td>
<td><p>49</p></td>
<td><p>78890</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="mesh-planes">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">List of the various sets of mesh planes used for the importance calculations for six different point detectors</span><a class="headerlink" href="#mesh-planes" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab15.png" src="_images/tab15.png" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mavric-input-files">
<h4>MAVRIC input files<a class="headerlink" href="#mavric-input-files" title="Permalink to this headline">¶</a></h4>
<p>With two sources and six detectors, this example problem will require 12
separate input files. Starting with the two input files for the analog
calculations, these 12 input files will share most of the same features
and will differ only in blocks related to the importance map calculation: the
location of the adjoint source and the planes used in the grid geometry.</p>
<p>To change the input for the neutron problem from an analog calculation
to one using CADIS, the user first adds the mesh planes for the
discrete-ordinates calculation as a grid geometry to the definitions
block. This set of planes is tailored for the vent port direction
toward detectors 3 and 6.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="err">gridGeometry</span> <span class="m">3</span>
        <span class="err">title=</span><span class="s">&quot;for importance map for detectors 3,6&quot;</span>
        <span class="err">xplanes</span> <span class="err">-</span><span class="m">170</span> <span class="err">-</span><span class="m">168</span> <span class="err">-</span><span class="m">146</span> <span class="err">-</span><span class="m">122</span> <span class="err">-</span><span class="m">100</span>
                <span class="err">-</span><span class="m">95</span> <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">60</span> <span class="err">-</span><span class="m">40</span> <span class="err">-</span><span class="m">20</span> <span class="err">-</span><span class="m">5</span>
                <span class="m">5</span> <span class="m">15</span> <span class="m">25</span> <span class="m">35</span> <span class="m">45</span> <span class="m">55</span> <span class="m">65</span> <span class="m">75</span> <span class="m">85</span> <span class="m">90</span> <span class="m">95</span> <span class="m">100</span>
                <span class="m">104</span> <span class="m">108</span> <span class="m">112</span> <span class="m">116</span> <span class="m">120</span> <span class="m">124</span> <span class="m">128</span> <span class="m">132</span> <span class="m">136</span> <span class="m">140</span> <span class="m">144</span> <span class="m">148</span> <span class="m">152</span>
                <span class="m">156</span> <span class="m">158</span> <span class="m">160</span> <span class="m">162</span>
                <span class="m">164</span> <span class="m">165</span> <span class="m">166</span> <span class="m">167</span>
                <span class="m">168</span> <span class="m">169</span> <span class="m">170</span>  <span class="n">end</span>
        <span class="err">yplanes</span> <span class="err">-</span><span class="m">170</span> <span class="err">-</span><span class="m">168</span> <span class="err">-</span><span class="m">155</span> <span class="err">-</span><span class="m">141</span> <span class="err">-</span><span class="m">127</span> <span class="err">-</span><span class="m">113</span> <span class="err">-</span><span class="m">100</span>
                <span class="err">-</span><span class="m">95</span> <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">85</span> <span class="err">-</span><span class="m">75</span> <span class="err">-</span><span class="m">65</span> <span class="err">-</span><span class="m">55</span> <span class="err">-</span><span class="m">45</span> <span class="err">-</span><span class="m">35</span> <span class="err">-</span><span class="m">25</span> <span class="err">-</span><span class="m">15</span> <span class="err">-</span><span class="m">5</span>
                <span class="m">5</span> <span class="m">15</span> <span class="m">25</span> <span class="m">35</span> <span class="m">45</span> <span class="m">55</span> <span class="m">65</span> <span class="m">75</span> <span class="m">85</span> <span class="m">90</span> <span class="m">95</span> <span class="m">100</span>
                <span class="m">113</span> <span class="m">127</span> <span class="m">141</span> <span class="m">155</span> <span class="m">168</span> <span class="m">170</span>  <span class="n">end</span>
        <span class="err">zplanes</span> <span class="err">-</span><span class="m">285</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">2</span> <span class="err">-</span><span class="m">240</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">228</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">210</span>
                <span class="err">-</span><span class="m">190</span> <span class="err">-</span><span class="m">170</span> <span class="err">-</span><span class="m">150</span> <span class="err">-</span><span class="m">130</span> <span class="err">-</span><span class="m">110</span> <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">70</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">10</span>
                <span class="m">10</span> <span class="m">30</span> <span class="m">50</span> <span class="m">70</span> <span class="m">90</span> <span class="m">110</span> <span class="m">130</span> <span class="m">150</span> <span class="m">170</span> <span class="m">190</span>
                <span class="m">210</span>    <span class="m">216</span><span class="err">.</span><span class="m">2</span> <span class="m">222</span><span class="err">.</span><span class="m">4</span>
                <span class="m">228</span><span class="err">.</span><span class="m">6</span>  <span class="m">232</span><span class="err">.</span><span class="m">6</span> <span class="m">236</span><span class="err">.</span><span class="m">6</span>
                <span class="m">240</span><span class="err">.</span><span class="m">6</span>  <span class="m">245</span><span class="err">.</span><span class="m">1</span> <span class="m">249</span><span class="err">.</span><span class="m">7</span> <span class="m">254</span><span class="err">.</span><span class="m">2</span>
                <span class="m">255</span><span class="err">.</span><span class="m">2</span>  <span class="m">256</span><span class="err">.</span><span class="m">2</span> <span class="m">260</span><span class="err">.</span><span class="m">1</span> <span class="m">264</span> <span class="m">267</span><span class="err">.</span><span class="m">9</span> <span class="m">271</span><span class="err">.</span><span class="m">8</span> <span class="m">275</span><span class="err">.</span><span class="m">7</span> <span class="m">279</span><span class="err">.</span><span class="m">6</span>
                <span class="m">280</span><span class="err">.</span><span class="m">6</span>  <span class="m">281</span><span class="err">.</span><span class="m">6</span> <span class="m">282</span><span class="err">.</span><span class="m">6</span> <span class="m">283</span><span class="err">.</span><span class="m">6</span> <span class="m">284</span><span class="err">.</span><span class="m">6</span> <span class="m">285</span><span class="err">.</span><span class="m">6</span>  <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
</pre></div>
</div>
<p>To help the mesh-based biased source represent the true source,
“mixture=1” can be added to the source definition. This will ensure that
particles sampled from the mesh source that are not in the fuel are
rejected. Then an importance map block replaces the standard biasing
block. In this case, the importance map will optimize the flow of
particles to location 3 (where point detector 3 is defined).</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">locationID=</span><span class="m">3</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">gridGeometryID=</span><span class="m">3</span>
    <span class="err">macromaterial</span>
        <span class="err">mmTolerance=</span><span class="m">0</span><span class="err">.</span><span class="m">01</span>
    <span class="n">end</span><span class="err"> </span><span class="n">macromaterial</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
<p>A mesh tally could be added with the following in the tallies block.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">meshTally</span> <span class="mi">1</span>
      <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Shows how importance map changes the transport of particles&quot;</span>
      <span class="n">gridGeometryID</span><span class="o">=</span><span class="mi">3</span>
      <span class="n">responseID</span><span class="o">=</span><span class="mi">1</span>
<span class="n">end</span> <span class="n">meshTally</span>
</pre></div>
</div>
<p>The above mesh tally uses the same grid geometry as the CADIS
calculations, but a different grid (or grids) could be used. The files
<code class="docutils literal notranslate"><span class="pre">mavric.caskCADISn.inp</span></code> and <code class="docutils literal notranslate"><span class="pre">mavric.caskCADISp.inp</span></code> are available in the
SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory. These are for calculating the dose rates
at detector position 3, but they can be modified for the other five positions
(by changing the geometry grid planes and the adjoint source location).</p>
</div>
<div class="section" id="neutron-source-neutron-response-results">
<h4>Neutron source/neutron response results<a class="headerlink" href="#neutron-source-neutron-response-results" title="Permalink to this headline">¶</a></h4>
<p>The above MAVRIC input file first performed the discrete-ordinates
calculation to determine the adjoint flux from detector position 3. The
adjoint Denovo flux file (*.adjoint.dff) produced can be viewed using
the Mesh File Viewer and is shown in <a class="reference internal" href="#adjoint-denovo"><span class="std std-numref">Fig. 15</span></a> for several of the
neutron energy groups.</p>
<p>MAVRIC then combined a mesh representation of the true source (space and
energy) with the adjoint fluxes to create the importance map and
mesh-based biased source. These are shown in <a class="reference internal" href="#fifth-neutron"><span class="std std-numref">Fig. 16</span></a> for the fifth
neutron group, covering the energy range of 0.9 to 1.4 MeV. Notice how
the most important region (lowest target weights) is right around the
vent port near detector position 3. This is something we know
qualitatively, but quantitative values for exactly how the importance
changes with space and energy are difficult to guess. Also notice the
“consistent” part of CADIS—–the source particles—are born with a weight
that matches the target weight for the position they are born into. The
biased source sampling distribution is depicted in <a class="reference internal" href="#biased-source"><span class="std std-numref">Fig. 17</span></a>, showing
how the source particles nearest to detector 3 will be sampled more
often.</p>
<p>The biased source distribution and the importance map are then used by
Monaco to compute the dose equivalent rate response at detector 3.</p>
<div class="figure align-center">
<img alt="_images/fig4.1.15g_caskn.adjoint.scale.png" src="_images/fig4.1.15g_caskn.adjoint.scale.png" />
</div>
<div class="figure align-center" id="id42">
<span id="adjoint-denovo"></span><a class="reference internal image-reference" href="_images/1.15.jpg"><img alt="_images/1.15.jpg" src="_images/1.15.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 15 </span><span class="caption-text">Adjoint neutron fluxes (/cm <sup>2</sup>/s) for groups 5 (0.9–1.4 MeV), 10 (0.58–3.0 keV), and 19 (0.8–1 eV) calculated by Denovo.</span><a class="headerlink" href="#id42" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center">
<img alt="_images/fig4.1.16e_caskn.targets.scale.png" src="_images/fig4.1.16e_caskn.targets.scale.png" />
</div>
<div class="figure align-center" id="id43">
<span id="fifth-neutron"></span><a class="reference internal image-reference" href="_images/1.16.jpg"><img alt="_images/1.16.jpg" src="_images/1.16.jpg" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 16 </span><span class="caption-text">Neutron target weights from the importance map and source weights (at birth) for neutron group 5 (0.9 to 1.4 MeV).</span><a class="headerlink" href="#id43" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center">
<img alt="_images/fig4.1.17g_caskn.prob.scale.png" src="_images/fig4.1.17g_caskn.prob.scale.png" />
</div>
<div class="figure align-center" id="id44">
<span id="biased-source"></span><a class="reference internal image-reference" href="_images/1.17.jpg"><img alt="_images/1.17.jpg" src="_images/1.17.jpg" style="width: 100%;" /></a>
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">Biased source sampling probability (neutrons/cm3) for neutron groups 5 (0.9‑1.4 MeV), 10 (0.58–3.0 keV), and 19 (0.8–1 eV).</span><a class="headerlink" href="#id44" title="Permalink to this image">¶</a></p>
</div>
<p>The results for all six neutron cases, each using their own importance
map and biased source, are shown in <a class="reference internal" href="#mavric-final"><span class="std std-numref">Table 16</span></a>.</p>
<p>This example shows that MAVRIC using CADIS obtains the
correct answer much faster than the analog calculations. This is shown
with a comparison to the results from the analog Monaco and SAS4
calculations, all of which are listed in <a class="reference internal" href="#mavric-cadis-results"><span class="std std-numref">Table 17</span></a>.</p>
<p>To account for the time it takes to achieve a given level of
uncertainties, the calculation figure-of-merit—FOM=1/time/(relative
uncertainty)<sup>2</sup>—can be calculated for each of the codes. The
ratios of each code FOM to the FOM of analog Monaco (speedup) are listed
in <a class="reference internal" href="#figure-of-merit"><span class="std std-numref">Table 18</span></a> to show how much faster MAVRIC and SAS4 are compared to
analog Monaco. The FOMs for MAVRIC include the Denovo calculation times.
The FOMs for analog Monaco and SAS4 were modified to account for
calculating all six detectors at once.</p>
<table class="docutils align-center" id="mavric-final">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Final MAVRIC results (rem/hr) for each point detector in the neutron source/neutron dose rate problem</span><a class="headerlink" href="#mavric-final" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab16.png" src="_images/tab16.png" />
</td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="mavric-cadis-results">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">Comparison of neutron dose rates (rem/hr) to other SCALE codes</span><a class="headerlink" href="#mavric-cadis-results" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td></td>
<td><p>Analog Monaco</p></td>
<td><p>SAS4 radial</p></td>
<td><p>SAS4 axial</p></td>
<td><p>MAVRIC</p></td>
</tr>
<tr class="row-even"><td><p>detector</p></td>
<td><p>6595 min</p></td>
<td><p>360 min</p></td>
<td><p>361 min</p></td>
<td><p>556 min</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>8.78E-04 ± 19%</p></td>
<td><p>7.67E-04 ± 0.8%</p></td>
<td><p>1.32E-05 ± 45%</p></td>
<td><p>7.65E-04 ± 0.8%</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>7.35E-03 ± 4.1%</p></td>
<td><p>2.67E-02 ± 86%</p></td>
<td><p>7.80E-03 ± 0.4%</p></td>
<td><p>7.83E-03 ± 0.3%</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>1.54E-02 ± 1.2%</p></td>
<td><p>1.27E-02 ± 14%</p></td>
<td><p>1.53E-02 ± 0.8%</p></td>
<td><p>1.54E-02 ± 0.3%</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>4.47E-04 ± 3.1%</p></td>
<td><p>4.54E-04 ± 0.8%</p></td>
<td><p>2.34E-04 ± 68%</p></td>
<td><p>4.57E-04 ± 0.3%</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>1.36E-02 ± 0.6%</p></td>
<td><p>1.43E-02 ± 13%</p></td>
<td><p>1.35E-02 ± 0.4%</p></td>
<td><p>1.36E-02 ± 0.3%</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>2.92E-03 ± 0.7%</p></td>
<td><p>2.81E-03 ± 12.7%</p></td>
<td><p>2.86E-03 ± 0.5%</p></td>
<td><p>2.93E-03 ± 0.2%</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-center" id="figure-of-merit">
<caption><span class="caption-number">Table 18 </span><span class="caption-text">Ratio of the figure-of-merit (speed-up) of MAVRIC and SAS4 compared to analog Monaco</span><a class="headerlink" href="#figure-of-merit" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab18.png" src="_images/tab18.png" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="photon-source-photon-response-results">
<h4>Photon source/photon response results<a class="headerlink" href="#photon-source-photon-response-results" title="Permalink to this headline">¶</a></h4>
<p>The results for the photon source/photon response are similar to the
results of the neutron source/neutron response. For the MAVRIC
calculation using the photon importance map made from an adjoint source
located at detector position 3, <a class="reference internal" href="#fig4-18"><span class="std std-numref">Fig. 18</span></a> details the adjoint photon
flux. <a class="reference internal" href="#fig4-19"><span class="std std-numref">Fig. 19</span></a> compares the target weights from the importance map
and the source birth weights. <a class="reference internal" href="#fig4-20"><span class="std std-numref">Fig. 20</span></a> shows the distribution of
the sampled source positions from the biased source.</p>
<p><a class="reference internal" href="#tab4-19"><span class="std std-numref">Table 19</span></a> shows the results from all six photon MAVRIC runs, each
using its own importance map and biased source.</p>
<p>The MAVRIC results of the photon problem compare well against SAS4 and
analog Monaco, as shown in <a class="reference internal" href="#tab4-20"><span class="std std-numref">Table 20</span></a> and <a class="reference internal" href="#tab4-21"><span class="std std-numref">Table 21</span></a>.</p>
<div class="figure align-center">
<img alt="_images/fig4.1.18g_caskp.adjoint.scale.png" src="_images/fig4.1.18g_caskp.adjoint.scale.png" />
</div>
<div class="figure align-center" id="id45">
<span id="fig4-18"></span><img alt="_images/4.18.jpg" src="_images/4.18.jpg" />
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Adjoint photon fluxes (/cm: sup:<cite>2</cite>/s) for groups 2 (8–10 MeV), 2 (0.8–1.0 MeV), and 18 (45–100 keV) calculated by Denovo.</span><a class="headerlink" href="#id45" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-center" id="tab4-19">
<caption><span class="caption-number">Table 19 </span><span class="caption-text">Final MAVRIC results (rem/hr) for each point detectorin the photon source/photon dose rate problem</span><a class="headerlink" href="#tab4-19" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab18.png" src="_images/tab18.png" />
</td>
</tr>
</tbody>
</table>
<div class="figure align-center">
<img alt="_images/fig4.1.19e_caskp.targets.scale.png" src="_images/fig4.1.19e_caskp.targets.scale.png" />
</div>
<div class="figure align-center" id="id46">
<span id="fig4-19"></span><a class="reference internal image-reference" href="_images/4.19.jpg"><img alt="_images/4.19.jpg" src="_images/4.19.jpg" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">Photon target weights from the importance map and source weights (at birth) for photon group 12 (0.8–1.0 MeV).</span><a class="headerlink" href="#id46" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-center" id="tab4-20">
<caption><span class="caption-number">Table 20 </span><span class="caption-text">Comparison of the photon dose rates (rem/hr) to other SCALE codes</span><a class="headerlink" href="#tab4-20" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab20.png" src="_images/tab20.png" />
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id47">
<span id="fig4-20"></span><img alt="_images/fig4-20.png" src="_images/fig4-20.png" />
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">Biased source sampling probability (photons/cm3) for groups 2 (8–10 MeV), 12 (0.8–1.0 MeV), and 18 (45–100 keV).</span><a class="headerlink" href="#id47" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-center" id="tab4-21">
<caption><span class="caption-number">Table 21 </span><span class="caption-text">Ratio of the FOM (speed-up) of MAVRIC and SAS4 compared to analog Monaco</span><a class="headerlink" href="#tab4-21" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab211.png" src="_images/tab211.png" />
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="gamma-ray-litho-density-logging-tool-using-fw-cadis">
<h3>Gamma-ray litho-density logging tool using FW-CADIS<a class="headerlink" href="#gamma-ray-litho-density-logging-tool-using-fw-cadis" title="Permalink to this headline">¶</a></h3>
<p>Consider a simple model of a gamma-ray litho-density
tool <a class="bibtex reference internal" href="#gardner-monte-1991" id="id17">[GV91]</a><a class="bibtex reference internal" href="#wagner-automated-1998" id="id18">[WH98]</a> used in well-logging studies, shown in
<a class="reference internal" href="#fig4-21"><span class="std std-numref">Fig. 21</span></a>. This model uses a 10 cm diameter tool made of iron (with
a tungsten density) in a 20 cm borehole filled with water. The near
detector is a 2 cm diameter cylinder, 2 cm in length, located 20 cm from
the source. The far detector is a 4 cm by 4 cm cylinder located 40 cm
from the source. Each detector is made of NaI and collimated to look out
into the formation. The source is contained in an angled collimator,
aiming upward and into the formation. The collimators are filled with
oxygen. The extent of the modeled formation is 100 × 100 × 140 cm. The
source is an isotropic <sup>137</sup>Cs source emitting
10<sup>11</sup> photons/s (661.7 keV). For these calculations, no response
function is used—the goal of this example is to calculate the total
photon flux within each detector volume.</p>
<div class="figure align-center" id="id48">
<span id="fig4-21"></span><a class="reference internal image-reference" href="_images/fig4.1.21_photonTool.bmp"><img alt="_images/fig4.1.21_photonTool.bmp" src="_images/fig4.1.21_photonTool.bmp" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 21 </span><span class="caption-text">Cutaway view of the litho-density tool in a rock formation.</span><a class="headerlink" href="#id48" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id49">
<span id="fig4-22"></span><a class="reference internal image-reference" href="_images/fig4.1.22_photFWmesh1.bmp"><img alt="_images/fig4.1.22_photFWmesh1.bmp" src="_images/fig4.1.22_photFWmesh1.bmp" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 22 </span><span class="caption-text">Denovo mesh, y=0 plane.</span><a class="headerlink" href="#id49" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id50">
<span id="fig4-23"></span><a class="reference internal image-reference" href="_images/fig4.1.23_photFWmesh2.bmp"><img alt="_images/fig4.1.23_photFWmesh2.bmp" src="_images/fig4.1.23_photFWmesh2.bmp" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 23 </span><span class="caption-text">Denovo mesh, z=20 plane (through near detector).</span><a class="headerlink" href="#id50" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id19">
<h4>Input file<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>The following input file represents the simple model of the litho-density tool.
It lists of the file <code class="docutils literal notranslate"><span class="pre">mavric.lithoFW.inp</span></code> located in the SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory.
The 27 neutron group/19 photon group library based on ENDF/B-VII.0 data was used for the discrete-ordinates
calculations, whereas the final Monte Carlo calculation used the 200 neutron group / 47 photon group library.</p>
<p>The input file starts with the problem title, the library for the importance calculations, and the materials.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">Photon</span> <span class="err">lithodensity</span> <span class="err">logging</span> <span class="err">tool</span> <span class="err">-</span> <span class="err">using</span> <span class="err">FW-CADIS</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>

<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">o</span>           <span class="m">1</span> <span class="err">den=</span><span class="m">1</span><span class="err">.</span><span class="m">0</span>               <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">wtptNaI</span>     <span class="m">2</span> <span class="m">3</span><span class="err">.</span><span class="m">67</span>  <span class="m">2</span> <span class="m">11000</span> <span class="m">15</span><span class="err">.</span><span class="m">337</span>
                          <span class="m">53129</span> <span class="m">84</span><span class="err">.</span><span class="m">663</span>  <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">iron</span>        <span class="m">3</span> <span class="err">den=</span><span class="m">19</span><span class="err">.</span><span class="m">3</span>              <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">h</span><span class="m">2</span><span class="err">o</span>         <span class="m">4</span>                       <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">wtptCaCO</span><span class="m">3</span>   <span class="m">5</span> <span class="m">2</span><span class="err">.</span><span class="m">36</span>  <span class="m">4</span>  <span class="m">1000</span>  <span class="m">1</span><span class="err">.</span><span class="m">0</span>
                           <span class="m">6000</span> <span class="m">11</span><span class="err">.</span><span class="m">0</span>
                           <span class="m">8016</span> <span class="m">51</span><span class="err">.</span><span class="m">4</span>
                          <span class="m">20000</span> <span class="m">36</span><span class="err">.</span><span class="m">6</span>    <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
</pre></div>
</div>
<p>The geometry is relatively simple. Volumes are only needed for the regions where tallies will be made.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
    <span class="err">global</span> <span class="err">unit</span>  <span class="m">1</span>
        <span class="err">zcylinder</span>  <span class="m">2</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">10</span><span class="err">.</span><span class="m">0</span>  <span class="m">0</span><span class="err">.</span><span class="m">0</span>  <span class="err">origin</span> <span class="err">x=</span><span class="m">5</span><span class="err">.</span><span class="m">0</span> <span class="err">rotate</span> <span class="err">a</span><span class="m">1</span><span class="err">=</span><span class="m">90</span> <span class="err">a</span><span class="m">2</span><span class="err">=</span><span class="m">45</span>
        <span class="err">zcylinder</span>  <span class="m">3</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">21</span><span class="err">.</span><span class="m">0</span> <span class="m">19</span><span class="err">.</span><span class="m">0</span>  <span class="err">origin</span> <span class="err">x=</span><span class="m">5</span><span class="err">.</span><span class="m">0</span>
        <span class="err">xcylinder</span>  <span class="m">4</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">10</span><span class="err">.</span><span class="m">0</span>  <span class="m">5</span><span class="err">.</span><span class="m">0</span>  <span class="err">origin</span> <span class="err">z=</span><span class="m">20</span><span class="err">.</span><span class="m">0</span>
        <span class="err">zcylinder</span>  <span class="m">5</span> <span class="m">2</span><span class="err">.</span><span class="m">0</span> <span class="m">42</span><span class="err">.</span><span class="m">0</span> <span class="m">38</span><span class="err">.</span><span class="m">0</span>  <span class="err">origin</span> <span class="err">x=</span><span class="m">5</span><span class="err">.</span><span class="m">0</span>
        <span class="err">xcylinder</span>  <span class="m">6</span> <span class="m">2</span><span class="err">.</span><span class="m">0</span> <span class="m">10</span><span class="err">.</span><span class="m">0</span>  <span class="m">5</span><span class="err">.</span><span class="m">0</span>  <span class="err">origin</span> <span class="err">z=</span><span class="m">40</span><span class="err">.</span><span class="m">0</span>

        <span class="err">zcylinder</span>  <span class="m">7</span>  <span class="m">5</span><span class="err">.</span><span class="m">0</span> <span class="m">100</span> <span class="err">-</span><span class="m">40</span> <span class="err">origin</span> <span class="err">x=</span><span class="m">5</span><span class="err">.</span><span class="m">0</span>
        <span class="err">zcylinder</span> <span class="m">11</span> <span class="m">10</span><span class="err">.</span><span class="m">0</span> <span class="m">100</span> <span class="err">-</span><span class="m">40</span>
        <span class="err">cuboid</span>    <span class="m">12</span> <span class="m">50</span> <span class="err">-</span><span class="m">50</span>  <span class="m">50</span> <span class="err">-</span><span class="m">50</span>   <span class="m">100</span> <span class="err">-</span><span class="m">40</span>

        <span class="err">media</span>   <span class="m">1</span> <span class="m">1</span>   <span class="m">2</span> <span class="m">7</span>
        <span class="err">media</span>   <span class="m">2</span> <span class="m">1</span>   <span class="m">3</span>          <span class="err">vol=</span><span class="m">6</span><span class="err">.</span><span class="m">2831853072</span>
        <span class="err">media</span>   <span class="m">1</span> <span class="m">1</span>   <span class="m">4</span> <span class="err">-</span><span class="m">3</span> <span class="m">7</span>
        <span class="err">media</span>   <span class="m">2</span> <span class="m">1</span>   <span class="m">5</span>          <span class="err">vol=</span><span class="m">50</span><span class="err">.</span><span class="m">265482456</span>
        <span class="err">media</span>   <span class="m">1</span> <span class="m">1</span>   <span class="m">6</span> <span class="err">-</span><span class="m">5</span> <span class="m">7</span>
        <span class="err">media</span>   <span class="m">3</span> <span class="m">1</span>   <span class="m">7</span> <span class="err">-</span><span class="m">2</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">5</span> <span class="err">-</span><span class="m">6</span>
        <span class="err">media</span>   <span class="m">4</span> <span class="m">1</span>   <span class="m">11</span> <span class="err">-</span><span class="m">7</span>
        <span class="err">media</span>   <span class="m">5</span> <span class="m">1</span>   <span class="m">12</span> <span class="err">-</span><span class="m">11</span>
    <span class="err">boundary</span> <span class="m">12</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
</pre></div>
</div>
<p>The definitions block lists the response (total photon flux) so
that it can be understood by both libraries used in the problem. The mesh
grid for the importance calculations used 49 × 43 × 59 = 124,313 mesh
cells, with particular emphasis on geometric representation of the
collimators to ensure accurate importance maps. This mesh grid is shown
in <a class="reference internal" href="#fig4-22"><span class="std std-numref">Fig. 22</span></a> and <a class="reference internal" href="#fig4-23"><span class="std std-numref">Fig. 23</span></a>. The source is represented by a
distribution in which the most probable bin is located right near the
661.7 keV line, which can be translated into one photon group in either
library (from 600 to 800 keV in the 27/19 library or from 600 to 700 keV
in the 200/47 library).</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;for computing total photon flux&quot;</span>
        <span class="err">photonBounds</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span><span class="err">e</span><span class="m">4</span> <span class="m">2</span><span class="err">.</span><span class="m">0</span><span class="err">e</span><span class="m">7</span> <span class="n">end</span>
        <span class="err">values</span>         <span class="m">1</span><span class="err">.</span><span class="m">0</span>   <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">gridgeometry</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;entire formation&quot;</span>
        <span class="err">xplanes</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">40</span> <span class="err">-</span><span class="m">35</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">25</span> <span class="err">-</span><span class="m">20</span> <span class="err">-</span><span class="m">15</span>
                <span class="err">-</span><span class="m">10</span> <span class="err">-</span><span class="m">9</span> <span class="err">-</span><span class="m">8</span> <span class="err">-</span><span class="m">7</span> <span class="err">-</span><span class="m">6</span> <span class="err">-</span><span class="m">5</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">2</span> <span class="err">-</span><span class="m">1</span>
                <span class="m">0</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">3</span><span class="err">.</span><span class="m">5</span> <span class="m">4</span> <span class="m">4</span><span class="err">.</span><span class="m">5</span> <span class="m">5</span> <span class="m">5</span><span class="err">.</span><span class="m">5</span> <span class="m">6</span> <span class="m">6</span><span class="err">.</span><span class="m">5</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span>
                <span class="m">10</span> <span class="m">11</span> <span class="m">12</span> <span class="m">13</span> <span class="m">14</span> <span class="m">15</span> <span class="m">16</span> <span class="m">17</span> <span class="m">18</span> <span class="m">19</span> <span class="m">20</span>
                <span class="m">22</span> <span class="m">24</span> <span class="m">26</span> <span class="m">28</span> <span class="m">30</span> <span class="m">35</span> <span class="m">40</span> <span class="m">50</span> <span class="n">end</span>
        <span class="err">yplanes</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">40</span> <span class="err">-</span><span class="m">35</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">25</span> <span class="err">-</span><span class="m">20</span> <span class="err">-</span><span class="m">18</span> <span class="err">-</span><span class="m">16</span> <span class="err">-</span><span class="m">14</span> <span class="err">-</span><span class="m">12</span>
                <span class="err">-</span><span class="m">10</span> <span class="err">-</span><span class="m">9</span> <span class="err">-</span><span class="m">8</span> <span class="err">-</span><span class="m">7</span> <span class="err">-</span><span class="m">6</span> <span class="err">-</span><span class="m">5</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">2</span> <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">5</span> <span class="err">-</span><span class="m">1</span> <span class="err">-</span><span class="m">0</span><span class="err">.</span><span class="m">5</span>
                <span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">5</span> <span class="m">1</span> <span class="m">1</span><span class="err">.</span><span class="m">5</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span>
                <span class="m">10</span> <span class="m">12</span> <span class="m">14</span> <span class="m">16</span> <span class="m">18</span> <span class="m">20</span> <span class="m">25</span> <span class="m">35</span> <span class="m">40</span> <span class="m">50</span> <span class="n">end</span>
        <span class="err">zplanes</span> <span class="err">-</span><span class="m">40</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">20</span> <span class="err">-</span><span class="m">15</span> <span class="err">-</span><span class="m">10</span> <span class="err">-</span><span class="m">5</span>
                <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">2</span> <span class="err">-</span><span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">10</span>
                <span class="m">12</span>   <span class="m">14</span> <span class="m">16</span> <span class="m">17</span> <span class="m">18</span> <span class="m">18</span><span class="err">.</span><span class="m">5</span>
                <span class="m">19</span>   <span class="m">19</span><span class="err">.</span><span class="m">5</span> <span class="m">20</span> <span class="m">20</span><span class="err">.</span><span class="m">5</span>
                <span class="m">21</span>   <span class="m">21</span><span class="err">.</span><span class="m">5</span> <span class="m">22</span> <span class="m">23</span> <span class="m">24</span> <span class="m">26</span> <span class="m">28</span> <span class="m">30</span> <span class="m">32</span> <span class="m">34</span> <span class="m">36</span> <span class="m">37</span>
                <span class="m">38</span>   <span class="m">39</span> <span class="m">40</span> <span class="m">41</span>
                <span class="m">42</span>   <span class="m">43</span> <span class="m">44</span> <span class="m">46</span> <span class="m">48</span> <span class="m">50</span> <span class="m">55</span> <span class="m">60</span> <span class="m">65</span> <span class="m">70</span> <span class="m">80</span> <span class="m">90</span> <span class="m">100</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridgeometry</span>
    <span class="err">gridgeometry</span> <span class="m">2</span>
        <span class="err">title=</span><span class="s">&quot;y=0 plane in detail&quot;</span>
        <span class="err">xLinear</span> <span class="m">100</span>  <span class="err">-</span><span class="m">50</span><span class="err">.</span><span class="m">0</span>  <span class="m">50</span><span class="err">.</span><span class="m">0</span>
        <span class="err">yLinear</span>   <span class="m">1</span>   <span class="err">-</span><span class="m">1</span><span class="err">.</span><span class="m">0</span>   <span class="m">1</span><span class="err">.</span><span class="m">0</span>
        <span class="err">zLinear</span> <span class="m">140</span>  <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">0</span> <span class="m">100</span><span class="err">.</span><span class="m">0</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridgeometry</span>
    <span class="err">distribution</span> <span class="m">1</span>
              <span class="err">title=</span><span class="s">&quot;cesium-137 gammas/decay&quot;</span>
        <span class="err">discrete</span> <span class="m">31817</span>  <span class="m">32194</span>  <span class="m">36304</span>   <span class="m">36378</span>   <span class="m">37255</span>   <span class="m">283500</span>    <span class="m">661657</span> <span class="n">end</span>
        <span class="err">truepdf</span>  <span class="m">0</span><span class="err">.</span><span class="m">0199</span> <span class="m">0</span><span class="err">.</span><span class="m">0364</span> <span class="m">0</span><span class="err">.</span><span class="m">00348</span> <span class="m">0</span><span class="err">.</span><span class="m">00672</span> <span class="m">0</span><span class="err">.</span><span class="m">00213</span> <span class="m">0</span><span class="err">.</span><span class="m">0000058</span> <span class="m">0</span><span class="err">.</span><span class="m">851</span>  <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>The source is a simple point source. For more realistic calculations,
the source strength could be modified so that the total energy emitted
is preserved,
<span class="math notranslate nohighlight">\(S' = S\left( \frac{661.7}{0.5}\left( 700 + 600 \right) \right)\)</span>,
which uses the ratio of the line energy to the energy at the center of
the group in the 200/47 library.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;Cs-137 Source: 661.7 keV&quot;</span>
        <span class="err">strength</span><span class="m">=1.0e11</span>
        <span class="err">photons</span>
        <span class="err">sphere</span>  <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="err">origin</span>  <span class="err">x=</span><span class="m">5</span><span class="err">.</span><span class="m">0</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>Each detector is represented by a region tally. A mesh tally is made for one slice in <em>y</em> for visualization.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
    <span class="err">regionTally</span> <span class="m">1</span>
        <span class="err">photon</span>  <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">2</span>
    <span class="n">end</span><span class="err"> </span><span class="n">regionTally</span>
    <span class="err">regionTally</span> <span class="m">2</span>
        <span class="err">photon</span>  <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">4</span>
    <span class="n">end</span><span class="err"> </span><span class="n">regionTally</span>
    <span class="err">meshTally</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;mesh tally in just the y=0 plane&quot;</span>
        <span class="err">photon</span>
        <span class="err">gridGeometryID=</span><span class="m">2</span>
        <span class="err">noGroupFluxes</span>
    <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
    <span class="err">library=</span><span class="s">&quot;v7-200n47g&quot;</span>
    <span class="err">randomSeed=</span><span class="m">00003</span><span class="err">ecd</span><span class="m">7</span><span class="err">b</span><span class="m">4</span><span class="err">e</span><span class="m">3</span><span class="err">e</span><span class="m">8</span><span class="err">b</span>
    <span class="err">perBatch=</span><span class="m">466000</span> <span class="err">batches=</span><span class="m">24</span>
    <span class="err">noNeutrons</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>
</pre></div>
</div>
<p>The importance map defines two adjoint sources that correspond to the two
tallies. Forward weighting, based on the response integrated over energy
(“respWeighting”), is used. Because the true source is a point source,
the subcell method of making a mesh source will fail, so the number of
source trials is input. This number is small since the source is a
monoenergetic point source. The Denovo calculations used the default
S<sub>8</sub> quadrature and the P<sub>3</sub> Legendre order.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>

<span class="c">&#39;   near detector</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="m">6</span> <span class="m">4</span>  <span class="m">1</span> <span class="err">-</span><span class="m">1</span>  <span class="m">21</span> <span class="m">19</span>
        <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">2</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>

<span class="c">&#39;   far detector</span>
    <span class="err">adjointSource</span> <span class="m">2</span>
        <span class="err">boundingBox</span> <span class="m">7</span> <span class="m">3</span>  <span class="m">2</span> <span class="err">-</span><span class="m">2</span>  <span class="m">42</span> <span class="m">38</span>
        <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">4</span>
        <span class="err">responseID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">respWeighting</span>
    <span class="err">sourceTrials=</span><span class="m">100</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>

<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h4>Output<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>The results for the two region tallies, the first for the near detector and the second for the far detector after 60 minutes of computations (3 forward Denovo, 4 adjoint Denovo and 52 Monaco), were as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Photon</span> <span class="n">Region</span> <span class="n">Tally</span> <span class="mf">1.</span>
                         <span class="n">average</span>      <span class="n">standard</span>     <span class="n">relat</span>      <span class="n">FOM</span>    <span class="n">stat</span> <span class="n">checks</span>
    <span class="n">tally</span><span class="o">/</span><span class="n">quantity</span>        <span class="n">value</span>       <span class="n">deviation</span>    <span class="n">uncert</span>   <span class="p">(</span><span class="o">/</span><span class="nb">min</span><span class="p">)</span>   <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
    <span class="o">------------------</span>  <span class="o">-----------</span>  <span class="o">-----------</span>  <span class="o">-------</span>  <span class="o">--------</span>  <span class="o">-----------</span>
    <span class="n">total</span> <span class="n">flux</span> <span class="p">(</span><span class="n">tl</span><span class="p">)</span>     <span class="mf">1.47918E+03</span>  <span class="mf">1.57461E+01</span>  <span class="mf">0.01065</span>  <span class="mf">1.70E+02</span>  <span class="n">X</span> <span class="o">-</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
    <span class="n">total</span> <span class="n">flux</span> <span class="p">(</span><span class="n">cd</span><span class="p">)</span>     <span class="mf">1.47936E+03</span>  <span class="mf">1.56963E+01</span>  <span class="mf">0.01061</span>  <span class="mf">1.71E+02</span>  <span class="n">X</span> <span class="o">-</span> <span class="n">X</span> <span class="o">-</span> <span class="n">X</span> <span class="n">X</span>
    <span class="o">------------------</span>  <span class="o">-----------</span>  <span class="o">-----------</span>  <span class="o">-------</span>  <span class="o">--------</span>  <span class="o">-----------</span>

 <span class="n">Photon</span> <span class="n">Region</span> <span class="n">Tally</span> <span class="mf">2.</span>
                         <span class="n">average</span>      <span class="n">standard</span>     <span class="n">relat</span>      <span class="n">FOM</span>    <span class="n">stat</span> <span class="n">checks</span>
    <span class="n">tally</span><span class="o">/</span><span class="n">quantity</span>        <span class="n">value</span>       <span class="n">deviation</span>    <span class="n">uncert</span>   <span class="p">(</span><span class="o">/</span><span class="nb">min</span><span class="p">)</span>   <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
    <span class="o">------------------</span>  <span class="o">-----------</span>  <span class="o">-----------</span>  <span class="o">-------</span>  <span class="o">--------</span>  <span class="o">-----------</span>
    <span class="n">total</span> <span class="n">flux</span> <span class="p">(</span><span class="n">tl</span><span class="p">)</span>     <span class="mf">4.57691E+01</span>  <span class="mf">2.81778E-01</span>  <span class="mf">0.00616</span>  <span class="mf">5.07E+02</span>  <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
    <span class="n">total</span> <span class="n">flux</span> <span class="p">(</span><span class="n">cd</span><span class="p">)</span>     <span class="mf">4.57825E+01</span>  <span class="mf">2.80714E-01</span>  <span class="mf">0.00613</span>  <span class="mf">5.11E+02</span>  <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span> <span class="n">X</span>
    <span class="o">------------------</span>  <span class="o">-----------</span>  <span class="o">-----------</span>  <span class="o">-------</span>  <span class="o">--------</span>  <span class="o">-----------</span>
</pre></div>
</div>
<p>Note that both detectors have similarly low relative uncertainties
(about 1%) even though the tally values differ by a factor of 30. These
results should be compared to analog results (no biasing at all) and
optimizations of each detector in separate input files, as shown in
<a class="reference internal" href="#tab4-22"><span class="std std-numref">Table 22</span></a>. The CADIS calculations for each detector (near or far) do
exactly what they were supposed to do—optimize the Monte Carlo
calculation for one tally or the other. The FOMs for the FW-CADIS
calculation were about half of the FOMs for the single-detector CADIS
calculations. Hence, for this two-detector problem, two CADIS
calculations are just as efficient as one FW-CADIS calculation. For
modern well-logging tools with up to a dozen detectors, a single
FW-CADIS would be much more efficient and manageable. Note that the near
detector still needs more time to pass the second (uncertainty fit) and
the fourth (VOV fit) statistical checks. Neither of the single-detector
CADIS calculations passed the fourth statistical check within an hour.</p>
<p><a class="reference internal" href="#fig4-24"><span class="std std-numref">Fig. 24</span></a> shows a mesh tally of total photon flux in the y=0 plane
for all four of the simulations: analog, CADIS for the near detector,
CADIS for the far detector, and the FW-CADIS calculation for both.</p>
<table class="docutils align-center" id="tab4-22">
<caption><span class="caption-number">Table 22 </span><span class="caption-text">Comparison of different CADIS techniques for the litho-density problem</span><a class="headerlink" href="#tab4-22" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><img alt="_images/tab22.png" src="_images/tab22.png" />
</td>
</tr>
</tbody>
</table>
<p>/</p>
<div class="figure align-center" id="id51">
<span id="fig4-24"></span><a class="reference internal image-reference" href="_images/4.22.png"><img alt="_images/4.22.png" src="_images/4.22.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 24 </span><span class="caption-text">Mesh tallies showing total photon flux in cm<sup>2</sup>/s (left column) and its relative error (right column) in the y=0 plane.</span><a class="headerlink" href="#id51" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="aos-100-using-fw-cadis-and-continuous-energy-transport">
<h3>AOS-100 using FW-CADIS and continuous-energy transport<a class="headerlink" href="#aos-100-using-fw-cadis-and-continuous-energy-transport" title="Permalink to this headline">¶</a></h3>
<p>The advanced variance reduction in MAVRIC can also be used when the
final Monaco Monte Carlo transport calculation is performed using a CE
cross section library. Simulations involving discrete-energy photon
sources are best handled with CE. Consider the AOS-100, one of several
radioactive material transport packaging systems developed by Alpha
Omega Services, Inc., and a <sup>60</sup>Co source. (International Isotopes
Inc. of Idaho Falls, Idaho, distributes the AOS Radioactive Material
Transport Packaging Systems.)</p>
<p>A simple model of the AOS-100 package,  which is constructed primarily of steel and tungsten, is shown in
<a class="reference internal" href="#fig4-25"><span class="std std-numref">Fig. 25</span></a>. The diameter is 71.12 cm, and the height is 91.44 cm.
The innermost cylinder (16.51 cm diameter and 50.8 cm height) typically contains the material to be transported,
but in this study, this region is simply modeled as an air region containing a uniform source of 1 Ci of <sup>60</sup>Co.
This is conservative—it assumes the radioactive material containing the cobalt provides no self-shielding.</p>
<div class="figure align-center" id="id52">
<span id="fig4-25"></span><a class="reference internal image-reference" href="_images/fig4.1.25_aos100geom.bmp"><img alt="_images/fig4.1.25_aos100geom.bmp" src="_images/fig4.1.25_aos100geom.bmp" style="width: 30%;" /></a>
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Simple AOS-100 cask geometry showing tungsten (brown) and steel (gray).</span><a class="headerlink" href="#id52" title="Permalink to this image">¶</a></p>
</div>
<p>The objective in this study is to compute the dose rates around the cask.
This can be done using a mesh tally. Note that the dose rates inside the package are not of
concern—only the dose rates outside the package are.</p>
<p>The results of a 15-hour analog calculation (using only implicit capture with a lower weight limit of 10<sup>-7</sup>)
are shown in <a class="reference internal" href="#fig4-26"><span class="std std-numref">Fig. 26</span></a>. This calculation does not show many photons that have escaped the package
into the air, which is similar to reality for this heavily shielded cask. To compute dose rates outside
the package, variance reduction is needed.</p>
<div class="figure align-center" id="id53">
<span id="fig4-26"></span><img alt="_images/4.26.png" src="_images/4.26.png" />
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Dose rates (mrem/hr/Ci) and relative uncertainties along the <em>y</em> = 0 midplane of the cask as calculated by an analog calculation.</span><a class="headerlink" href="#id53" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id21">
<h4>Input file<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>The sample problem file <code class="docutils literal notranslate"><span class="pre">mavric.aos100.inp</span></code> is located in the <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory.
For this demonstration, a very simplified geometry is used, with a few tungsten regions inside a steel
cylinder. The library given at the beginning of the input is the MG library for the importance calculations.
The final Monaco Monte Carlo calculation will use the CE library, which is specified in the parameters block.
About 1 meter of air is modeled around the cask.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">AOS-</span><span class="m">100</span><span class="err">:</span> <span class="err">Demonstrate</span> <span class="err">use</span> <span class="err">of</span> <span class="err">MG</span> <span class="err">importance</span> <span class="err">maps</span> <span class="err">with</span> <span class="err">final</span> <span class="err">MC</span> <span class="err">using</span> <span class="err">CE</span> <span class="err">transport</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">200</span><span class="err">n</span><span class="m">47</span><span class="err">g</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">ss</span><span class="m">304</span>           <span class="m">1</span>   <span class="n">end</span>
    <span class="err">wtptTungsten</span>    <span class="m">2</span>  <span class="m">17</span><span class="err">.</span><span class="m">8</span> <span class="m">4</span>  <span class="m">74182</span> <span class="m">26</span> <span class="m">74183</span> <span class="m">14</span> <span class="m">74184</span> <span class="m">31</span> <span class="m">74186</span> <span class="m">29</span> <span class="n">end</span>
    <span class="err">dry-air</span>         <span class="m">3</span>   <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>

<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
    <span class="err">global</span> <span class="err">unit</span> <span class="m">1</span>
        <span class="err">cylinder</span> <span class="m">1</span>  <span class="m">8</span><span class="err">.</span><span class="m">255</span>   <span class="m">25</span><span class="err">.</span><span class="m">40</span> <span class="err">-</span><span class="m">25</span><span class="err">.</span><span class="m">40</span>
        <span class="err">cylinder</span> <span class="m">2</span> <span class="m">10</span><span class="err">.</span><span class="m">795</span>   <span class="m">27</span><span class="err">.</span><span class="m">94</span> <span class="err">-</span><span class="m">27</span><span class="err">.</span><span class="m">94</span>
        <span class="err">cylinder</span> <span class="m">3</span> <span class="m">20</span><span class="err">.</span><span class="m">955</span>   <span class="m">27</span><span class="err">.</span><span class="m">94</span> <span class="err">-</span><span class="m">27</span><span class="err">.</span><span class="m">94</span>
        <span class="err">cylinder</span> <span class="m">4</span> <span class="m">13</span><span class="err">.</span><span class="m">335</span>   <span class="m">40</span><span class="err">.</span><span class="m">64</span>  <span class="m">30</span><span class="err">.</span><span class="m">48</span>
        <span class="err">cylinder</span> <span class="m">5</span> <span class="m">13</span><span class="err">.</span><span class="m">335</span>  <span class="err">-</span><span class="m">30</span><span class="err">.</span><span class="m">48</span> <span class="err">-</span><span class="m">40</span><span class="err">.</span><span class="m">64</span>
        <span class="err">cylinder</span> <span class="m">6</span> <span class="m">35</span><span class="err">.</span><span class="m">56</span>    <span class="m">45</span><span class="err">.</span><span class="m">72</span> <span class="err">-</span><span class="m">45</span><span class="err">.</span><span class="m">72</span>

        <span class="err">cuboid</span>  <span class="m">99</span>  <span class="m">139</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>   <span class="m">139</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>  <span class="m">152</span><span class="err">.</span><span class="m">4</span> <span class="err">-</span><span class="m">152</span><span class="err">.</span><span class="m">4</span>

        <span class="err">media</span> <span class="m">3</span> <span class="m">1</span>  <span class="m">1</span>
        <span class="err">media</span> <span class="m">1</span> <span class="m">1</span>  <span class="m">2</span> <span class="err">-</span><span class="m">1</span>
        <span class="err">media</span> <span class="m">2</span> <span class="m">1</span>  <span class="m">3</span> <span class="err">-</span><span class="m">2</span>
        <span class="err">media</span> <span class="m">2</span> <span class="m">1</span>  <span class="m">4</span>
        <span class="err">media</span> <span class="m">2</span> <span class="m">1</span>  <span class="m">5</span>
        <span class="err">media</span> <span class="m">1</span> <span class="m">1</span>  <span class="m">6</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">4</span> <span class="err">-</span><span class="m">5</span>

        <span class="err">media</span> <span class="m">3</span> <span class="m">1</span>  <span class="m">99</span> <span class="err">-</span><span class="m">6</span>
    <span class="err">boundary</span> <span class="m">99</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>
</pre></div>
</div>
<p>In the definitions block, the photon dose response function, the
cobalt-60 line spectrum, two grid geometries, and an energy boundaries
structure are all defined. The first grid geometry is used for the
deterministic calculation, the importance map, and the biased source. The
second grid geometry is for the high-resolution (1 in.) mesh tally. The
energyBounds defined here has a base structure of 30 bins that are 50
keV wide, with three bins that are 2 keV wide at the dominant cobalt
line energies and the 511-keV annihilation gamma energy.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">5</span>
        <span class="err">title=</span><span class="s">&quot;ANSI standard (1977) neutron flux-to-dose-rate factors&quot;</span>
        <span class="err">doseData=</span><span class="m">9504</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>

    <span class="err">distribution</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;cobalt-60 gammas/decay&quot;</span>
        <span class="err">discrete</span>   <span class="m">347140</span>   <span class="m">826100</span> <span class="m">1173228</span> <span class="m">1332492</span>  <span class="m">2158570</span>    <span class="m">2505692</span> <span class="n">end</span>
        <span class="err">truepdf</span>  <span class="m">0</span><span class="err">.</span><span class="m">000075</span> <span class="m">0</span><span class="err">.</span><span class="m">000076</span> <span class="m">0</span><span class="err">.</span><span class="m">9985</span> <span class="m">0</span><span class="err">.</span><span class="m">999826</span> <span class="m">0</span><span class="err">.</span><span class="m">000012</span> <span class="m">0</span><span class="err">.</span><span class="m">00000002</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>


    <span class="err">gridGeometry</span> <span class="m">7</span>
        <span class="err">title=</span><span class="s">&quot;mesh for discrete ordinates/importance map/biased source&quot;</span>
        <span class="err">xLinear</span> <span class="m">28</span>   <span class="err">-</span><span class="m">35</span><span class="err">.</span><span class="m">56</span>  <span class="m">35</span><span class="err">.</span><span class="m">56</span>
        <span class="err">yLinear</span> <span class="m">28</span>   <span class="err">-</span><span class="m">35</span><span class="err">.</span><span class="m">56</span>  <span class="m">35</span><span class="err">.</span><span class="m">56</span>
        <span class="err">zLinear</span> <span class="m">36</span>   <span class="err">-</span><span class="m">45</span><span class="err">.</span><span class="m">72</span>  <span class="m">45</span><span class="err">.</span><span class="m">72</span>

        <span class="err">xLinear</span> <span class="m">22</span>  <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>  <span class="m">139</span><span class="err">.</span><span class="m">7</span>
        <span class="err">yLinear</span> <span class="m">22</span>  <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>  <span class="m">139</span><span class="err">.</span><span class="m">7</span>
        <span class="err">zLinear</span> <span class="m">24</span>  <span class="err">-</span><span class="m">152</span><span class="err">.</span><span class="m">4</span>  <span class="m">152</span><span class="err">.</span><span class="m">4</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>

    <span class="err">gridGeometry</span> <span class="m">8</span>
        <span class="err">title=</span><span class="s">&quot;mesh for mesh tally - 1 inch voxels&quot;</span>
        <span class="err">xLinear</span>  <span class="m">110</span>  <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>   <span class="m">139</span><span class="err">.</span><span class="m">7</span>
        <span class="err">yLinear</span>  <span class="m">110</span>  <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>   <span class="m">139</span><span class="err">.</span><span class="m">7</span>
        <span class="err">zLinear</span>  <span class="m">120</span>  <span class="err">-</span><span class="m">152</span><span class="err">.</span><span class="m">4</span>   <span class="m">152</span><span class="err">.</span><span class="m">4</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>

    <span class="err">energyBounds</span> <span class="m">1</span>
        <span class="err">linear</span> <span class="m">30</span> <span class="m">0</span><span class="err">.</span><span class="m">00</span><span class="err">e</span><span class="m">6 1.50e6</span>
        <span class="err">bounds</span>  <span class="m">0</span><span class="err">.</span><span class="m">510</span><span class="err">e+</span><span class="m">6</span> <span class="m">0</span><span class="err">.</span><span class="m">512</span><span class="err">e+</span><span class="m">6</span>   <span class="m">1</span><span class="err">.</span><span class="m">172</span><span class="err">e</span><span class="m">6</span> <span class="m">1</span><span class="err">.</span><span class="m">174</span><span class="err">e</span><span class="m">6</span>   <span class="m">1</span><span class="err">.</span><span class="m">331</span><span class="err">e</span><span class="m">6</span> <span class="m">1</span><span class="err">.</span><span class="m">333</span><span class="err">e</span><span class="m">6</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">energyBounds</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>The source is modeled as a uniform volumetric source in the center
region of the cask. Because the distribution of cobalt gamma rays was
entered as gammas per decay, the keyword “useNormConst” will set the
source strength to be the total of the energy distribution—about 2
photons/decay. The “multiplier” keyword is used to multiply that
strength by 37e9 decays/sec to get 1 Ci.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;one Ci of cobalt-60&quot;</span>
        <span class="err">useNormConst</span>
        <span class="err">multiplier</span><span class="m">=37e9</span>
        <span class="err">cylinder</span>  <span class="m">8</span><span class="err">.</span><span class="m">255</span>   <span class="m">25</span><span class="err">.</span><span class="m">40</span> <span class="err">-</span><span class="m">25</span><span class="err">.</span><span class="m">40</span>
        <span class="err">photons</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>A single mesh tally is defined and is limited to the air region outside of the cask. A multiplier of 1,000 is
used to convert the response values from rem/hr to mrem/hr.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
    <span class="err">meshTally</span> <span class="m">1</span>
        <span class="err">photon</span>
        <span class="err">gridGeometryID=</span><span class="m">8</span>
        <span class="err">responseID=</span><span class="m">5</span>
        <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">7</span>
        <span class="err">energyBoundsID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>

    <span class="err">multiplier=</span><span class="m">1000</span><span class="err">.</span><span class="m">0</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>
</pre></div>
</div>
<p>In this problem, the importance calculations will use the 200/47 MG
library, which will transport all particles contained in the library by
default. The keyword “noNeutrons” is used to turn off neutron transport
during the Denovo calculations, thereby saving time. The final Monaco
calculation will use the CE library (“ceLibrary=”), which only
transports the particles specifically requested by the user (to avoid
loading large amounts of cross section from disk to memory). Thus, the
keyword “photons” is included to specifically tell the CE Monaco to
transport photons.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
    <span class="err">randomSeed=</span><span class="m">00003</span><span class="err">ecd</span><span class="m">7</span><span class="err">b</span><span class="m">4</span><span class="err">e</span><span class="m">3</span><span class="err">e</span><span class="m">8</span><span class="err">b</span>
    <span class="err">ceLibrary=</span><span class="s">&quot;ce_v7np_endf.xml&quot;</span>
    <span class="err">perBatch=</span><span class="m">2000000</span> <span class="err">batches=</span><span class="m">233</span>
    <span class="err">photons</span>   <span class="err">noNeutrons</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>
</pre></div>
</div>
<p>The importance map uses FW-CADIS to construct a map and biased source
that will optimize the photon dose rate in the air outside the cask.
Since photon scatter is typically forward peaked, an S<sub>12</sub>
quadrature and P<sub>5</sub> Legendre scattering expansion are used.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="m">139</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>   <span class="m">139</span><span class="err">.</span><span class="m">7</span> <span class="err">-</span><span class="m">139</span><span class="err">.</span><span class="m">7</span>  <span class="m">152</span><span class="err">.</span><span class="m">4</span> <span class="err">-</span><span class="m">152</span><span class="err">.</span><span class="m">4</span>
        <span class="err">unit=</span><span class="m">1</span> <span class="err">region=</span><span class="m">7</span>
        <span class="err">responseID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">respWeighting</span>

    <span class="err">gridGeometryID=</span><span class="m">7</span>
    <span class="err">macromaterial</span>
        <span class="err">mmTolerance=</span><span class="m">0</span><span class="err">.</span><span class="m">01</span>
    <span class="n">end</span><span class="err"> </span><span class="n">macromaterial</span>

    <span class="err">quadrature=</span><span class="m">12</span>
    <span class="err">legendre=</span><span class="m">5</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>
</pre></div>
</div>
</div>
<div class="section" id="output-file">
<h4>Output file<a class="headerlink" href="#output-file" title="Permalink to this headline">¶</a></h4>
<p>Results for the mesh tally after 958 minutes (27 forward Denovo, 31
adjoint Denovo, and 900 CE-Monaco) are shown in <a class="reference internal" href="#fig4-27"><span class="std std-numref">Fig. 27</span></a>.
Since dose rates inside the package are not of concern, that region was
excluded from the mesh tally. Due to the optimization that focused the
Monte Carlo calculation on dose rates outside the cask, values of the
dose rate inside the cask are underestimated and should not be used.
Also note that voxels along the outer cylindrical edge of the package
could show low dose rates, since the voxel value is an average and only
part of the voxel is actually outside the package. The resolution of the
mesh tally is 2.54 cm.</p>
<div class="figure align-center" id="id54">
<span id="fig4-27"></span><img alt="_images/4.27.png" src="_images/4.27.png" />
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Dose rates (mrem/hr/Ci) and relative uncertainties from the CE FW-CADIS calculation showing the midplane views of the cask (<em>z</em> = 0 above and <em>y</em> = 0 below).</span><a class="headerlink" href="#id54" title="Permalink to this image">¶</a></p>
</div>
<p>The flux using the user-defined energy bin boundaries for a point 10 cm above the top of the package
(along the axis) is shown in <a class="reference internal" href="#fig4-28"><span class="std std-numref">Fig. 28</span></a>. Note that since the importance map was made to optimize
the photon dose rate, some of the low-energy bins that do not contribute much to dose  may have
larger uncertainties.</p>
<div class="figure align-center" id="id55">
<span id="fig4-28"></span><a class="reference internal image-reference" href="_images/fig4.1.28_mavric.aos100.eflux.png"><img alt="_images/fig4.1.28_mavric.aos100.eflux.png" src="_images/fig4.1.28_mavric.aos100.eflux.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text">Flux 10 cm above the cask.</span><a class="headerlink" href="#id55" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#fig4-29"><span class="std std-numref">Fig. 29</span></a> and <a class="reference internal" href="#fig4-30"><span class="std std-numref">Fig. 30</span></a> show the ratios of the dose rates computed using a MG calculation to the
CE calculation. Dose rates inside the cask should not be compared because the importance map is focused on
dose outside the cask, so low-energy photons are not simulated inside. The 47-group MG calculation is fairly
close to the CE-calculation in dose rate (10% high axially, 20% high radially), but the 19-group MG dose rates
are much higher than the CE. Neither of the MG calculations shows the 1.17 and 1.33 MeV lines in the energy spectra.</p>
<div class="figure align-center" id="id56">
<span id="fig4-29"></span><img alt="_images/4.29.png" src="_images/4.29.png" />
<p class="caption"><span class="caption-number">Fig. 29 </span><span class="caption-text">Ratio of the 47-group MG computed dose rates to the CE dose rates (<em>y</em> = 0 left and <em>z</em> = 0 right).</span><a class="headerlink" href="#id56" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id57">
<span id="fig4-30"></span><img alt="_images/4.30.png" src="_images/4.30.png" />
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">Ratio of the 19-group MG computed dose rates to the CE dose rates (<em>y</em> = 0 left and <em>z</em> = 0 right).</span><a class="headerlink" href="#id57" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="independent-spent-fuel-storage-installation">
<h3>Independent spent fuel storage installation<a class="headerlink" href="#independent-spent-fuel-storage-installation" title="Permalink to this headline">¶</a></h3>
<p>A good example of a problem in which the dose rate needs to be known well
everywhere—–in low dose areas and high dose areas—–is an independent spent
fuel storage installation. The dose rates around these arrays of spent
fuel casks need to be evaluated over a large area of ground to
determine the boundary of the controlled area. This sample problem uses
a simplified model of a cask array, shown in <a class="reference internal" href="#fig4-31"><span class="std std-numref">Fig. 31</span></a> and
<a class="reference internal" href="#fig4-32"><span class="std std-numref">Fig. 32</span></a>, to demonstrate the FW-CADIS method for obtaining the dose
rates with reasonably low relative uncertainties over a mesh tally which
covers a very large area.</p>
<div class="figure align-center" id="id58">
<span id="fig4-31"></span><a class="reference internal image-reference" href="_images/fig4.1.31_isfsi.array.bmp"><img alt="_images/fig4.1.31_isfsi.array.bmp" src="_images/fig4.1.31_isfsi.array.bmp" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">Array of eight casks.</span><a class="headerlink" href="#id58" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id59">
<span id="fig4-32"></span><a class="reference internal image-reference" href="_images/fig4.1.32_isfsi.newcask07.bmp"><img alt="_images/fig4.1.32_isfsi.newcask07.bmp" src="_images/fig4.1.32_isfsi.newcask07.bmp" style="width: 30%;" /></a>
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">Cask detail.</span><a class="headerlink" href="#id59" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="source-term">
<h4>Source term<a class="headerlink" href="#source-term" title="Permalink to this headline">¶</a></h4>
<p>The calculation of the spent fuel source term using data from the
Kewaunee nuclear power plant is described in the cask example problem
and is modeled in the first part of <code class="docutils literal notranslate"><span class="pre">mavric.isfsi.inp</span></code> with ORIGEN. The
result of this calculation is a binary concentration (ft71f001) file.
This file also contains a list of the group-wise neutron source term
(“total neutron spectra, neutrons/sec/basis”) and photon source term
(“gamma spectra, photons/sec/basis”) for each time step. In this example
problem, the source term for the MAVRIC calculation will be read
directly from the binary concentration file. The file contains the
concentration and source-term data at each of 64 time steps. For this
analysis, the photon source at the last time step will be used.</p>
</div>
<div class="section" id="id22">
<h4>Input file<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>The following is a listing of the second part (the MAVRIC input) of the
file <code class="docutils literal notranslate"><span class="pre">mavric.isfsi.inp</span></code> located in the SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory. Note
that soil and air are included in the model to properly account for dose
near the ground. The mesh tally does not extend into the air above 2
meters since this problem is only concerned with the area near the ground where
people could be. For MAVRIC to read the ORIGEN binary concentration
file, it must be named as a Fortran unit file with a number matching the
distribution input. In this example, unit 71 is used in both the ORIGEN
input and MAVRIC input.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">ISFSI</span> <span class="err">-</span> <span class="err">forward-weighted</span> <span class="err">adjoint</span> <span class="err">using</span> <span class="err">photon</span> <span class="err">dose</span> <span class="err">response</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>
</pre></div>
</div>
<p>The materials include the fresh fuel (with a density representing homogenization), concrete, steel, air, and ordinary soil.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">wtptFuel</span>   <span class="m">1</span> <span class="m">0</span><span class="err">.</span><span class="m">913717475</span> <span class="m">18</span>         <span class="m">6000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00939719</span>    <span class="m">7014</span>  <span class="m">0</span><span class="err">.</span><span class="m">00528993</span>
                    <span class="m">8016</span>  <span class="m">9</span><span class="err">.</span><span class="m">73397641</span>   <span class="m">13000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00715715</span>   <span class="m">14000</span>  <span class="m">0</span><span class="err">.</span><span class="m">01031670</span>
                   <span class="m">15000</span>  <span class="m">0</span><span class="err">.</span><span class="m">02227505</span>   <span class="m">22000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00780567</span>   <span class="m">24000</span>  <span class="m">0</span><span class="err">.</span><span class="m">36655141</span>
                   <span class="m">25000</span>  <span class="m">0</span><span class="err">.</span><span class="m">01716839</span>   <span class="m">26000</span>  <span class="m">0</span><span class="err">.</span><span class="m">72041451</span>   <span class="m">27000</span>  <span class="m">0</span><span class="err">.</span><span class="m">00523824</span>
                   <span class="m">28000</span>  <span class="m">0</span><span class="err">.</span><span class="m">68955526</span>   <span class="m">40000</span> <span class="m">15</span><span class="err">.</span><span class="m">78990702</span>   <span class="m">41000</span>  <span class="m">0</span><span class="err">.</span><span class="m">05130153</span>
                   <span class="m">42000</span>  <span class="m">0</span><span class="err">.</span><span class="m">02844690</span>   <span class="m">50118</span>  <span class="m">0</span><span class="err">.</span><span class="m">25877903</span>   <span class="m">92235</span>  <span class="m">3</span><span class="err">.</span><span class="m">03560962</span>
                   <span class="m">92238</span> <span class="m">69</span><span class="err">.</span><span class="m">24080999</span>
                 <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">orconcrete</span> <span class="m">2</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">ss</span><span class="m">304</span>      <span class="m">3</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">dry-air</span>    <span class="m">4</span> <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
    <span class="err">wtptSoil</span>   <span class="m">5</span> <span class="m">1</span><span class="err">.</span><span class="m">685</span> <span class="m">12</span>  <span class="m">1000</span> <span class="m">3</span><span class="err">.</span><span class="m">498</span>   <span class="m">6000</span>  <span class="m">2</span><span class="err">.</span><span class="m">138</span>   <span class="m">8016</span> <span class="m">60</span><span class="err">.</span><span class="m">826</span>  <span class="m">11000</span> <span class="m">0</span><span class="err">.</span><span class="m">579</span>
                          <span class="m">13000</span> <span class="m">7</span><span class="err">.</span><span class="m">489</span>  <span class="m">14000</span> <span class="m">18</span><span class="err">.</span><span class="m">841</span>  <span class="m">17000</span>  <span class="m">0</span><span class="err">.</span><span class="m">026</span>  <span class="m">19000</span> <span class="m">0</span><span class="err">.</span><span class="m">582</span>
                          <span class="m">20000</span> <span class="m">0</span><span class="err">.</span><span class="m">896</span>  <span class="m">22000</span>  <span class="m">0</span><span class="err">.</span><span class="m">488</span>  <span class="m">25000</span>  <span class="m">0</span><span class="err">.</span><span class="m">097</span>  <span class="m">26000</span> <span class="m">4</span><span class="err">.</span><span class="m">540</span>
                 <span class="m">1</span><span class="err">.</span><span class="m">0</span> <span class="m">293</span><span class="err">.</span><span class="m">0</span> <span class="n">end</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>
</pre></div>
</div>
<p>The geometry models one cask and then repeats the cask model eight times using an array.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
  <span class="err">unit</span>  <span class="m">1</span>
    <span class="err">zcylinder</span>  <span class="m">1</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">228</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">228</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">2</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">240</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">240</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">3</span>   <span class="m">90</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">4</span>   <span class="m">95</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">5</span>  <span class="m">100</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">6</span>  <span class="m">168</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">7</span>  <span class="m">170</span><span class="err">.</span><span class="m">0</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">zcylinder</span>  <span class="m">8</span>  <span class="m">170</span><span class="err">.</span><span class="m">0</span>  <span class="m">285</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">285</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">11</span>  <span class="m">170</span>  <span class="m">90</span> <span class="m">30</span> <span class="err">-</span><span class="m">30</span>   <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="m">255</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">12</span>  <span class="m">30</span> <span class="err">-</span><span class="m">30</span> <span class="m">170</span> <span class="m">90</span>    <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="m">255</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">13</span>  <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">170</span> <span class="m">30</span> <span class="err">-</span><span class="m">30</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="m">255</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">14</span>  <span class="m">30</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">170</span>  <span class="m">280</span><span class="err">.</span><span class="m">6</span> <span class="m">255</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">21</span>  <span class="m">170</span>  <span class="m">90</span> <span class="m">30</span> <span class="err">-</span><span class="m">30</span>   <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">22</span>  <span class="m">30</span> <span class="err">-</span><span class="m">30</span> <span class="m">170</span> <span class="m">90</span>    <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">23</span>  <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">170</span> <span class="m">30</span> <span class="err">-</span><span class="m">30</span>  <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">24</span>  <span class="m">30</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">90</span> <span class="err">-</span><span class="m">170</span>  <span class="err">-</span><span class="m">255</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">280</span><span class="err">.</span><span class="m">6</span>
    <span class="err">cuboid</span>    <span class="m">99</span>  <span class="m">340</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">340</span><span class="err">.</span><span class="m">0</span>   <span class="m">340</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">340</span><span class="err">.</span><span class="m">0</span>   <span class="m">285</span><span class="err">.</span><span class="m">6</span> <span class="err">-</span><span class="m">285</span><span class="err">.</span><span class="m">6</span>

    <span class="err">media</span>  <span class="m">1</span>    <span class="m">1</span>   <span class="m">1</span>
    <span class="err">media</span>  <span class="m">3</span>    <span class="m">1</span>   <span class="m">2</span> <span class="err">-</span><span class="m">1</span>
    <span class="err">media</span>  <span class="m">2</span>    <span class="m">1</span>   <span class="m">3</span> <span class="err">-</span><span class="m">2</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">4</span> <span class="err">-</span><span class="m">3</span>
    <span class="err">media</span>  <span class="m">3</span>    <span class="m">1</span>   <span class="m">5</span> <span class="err">-</span><span class="m">4</span>  <span class="err">-</span><span class="m">11</span> <span class="err">-</span><span class="m">12</span> <span class="err">-</span><span class="m">13</span> <span class="err">-</span><span class="m">14</span>  <span class="err">-</span><span class="m">21</span> <span class="err">-</span><span class="m">22</span> <span class="err">-</span><span class="m">23</span> <span class="err">-</span><span class="m">24</span>
    <span class="err">media</span>  <span class="m">2</span>    <span class="m">1</span>   <span class="m">6</span> <span class="err">-</span><span class="m">5</span>  <span class="err">-</span><span class="m">11</span> <span class="err">-</span><span class="m">12</span> <span class="err">-</span><span class="m">13</span> <span class="err">-</span><span class="m">14</span>  <span class="err">-</span><span class="m">21</span> <span class="err">-</span><span class="m">22</span> <span class="err">-</span><span class="m">23</span> <span class="err">-</span><span class="m">24</span>
    <span class="err">media</span>  <span class="m">3</span>    <span class="m">1</span>   <span class="m">7</span> <span class="err">-</span><span class="m">6</span>  <span class="err">-</span><span class="m">11</span> <span class="err">-</span><span class="m">12</span> <span class="err">-</span><span class="m">13</span> <span class="err">-</span><span class="m">14</span>  <span class="err">-</span><span class="m">21</span> <span class="err">-</span><span class="m">22</span> <span class="err">-</span><span class="m">23</span> <span class="err">-</span><span class="m">24</span>
    <span class="err">media</span>  <span class="m">3</span>    <span class="m">1</span>   <span class="m">8</span> <span class="err">-</span><span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">11</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">12</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">13</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">14</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">21</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">22</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">23</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">24</span> <span class="err">-</span><span class="m">4</span> <span class="m">7</span>
    <span class="err">media</span>  <span class="m">4</span>    <span class="m">1</span>   <span class="m">99</span> <span class="err">-</span><span class="m">8</span>
  <span class="err">boundary</span> <span class="m">99</span>
  <span class="err">global</span> <span class="err">unit</span> <span class="m">2</span>
    <span class="err">cuboid</span> <span class="m">1</span>   <span class="m">1360</span> <span class="err">-</span><span class="m">1360</span>      <span class="m">680</span> <span class="err">-</span><span class="m">680</span>       <span class="m">571</span><span class="err">.</span><span class="m">2</span>    <span class="m">0</span><span class="err">.</span><span class="m">0</span>
    <span class="err">cuboid</span> <span class="m">2</span>   <span class="m">2040</span> <span class="err">-</span><span class="m">2040</span>     <span class="m">1360</span> <span class="err">-</span><span class="m">1360</span>        <span class="m">0</span><span class="err">.</span><span class="m">0</span>  <span class="err">-</span><span class="m">60</span><span class="err">.</span><span class="m">0</span>
    <span class="err">cuboid</span> <span class="m">3</span>  <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>   <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>       <span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">100</span><span class="err">.</span><span class="m">0</span>
    <span class="err">cuboid</span> <span class="m">4</span>  <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>   <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>   <span class="m">10000</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">100</span><span class="err">.</span><span class="m">0</span>
    <span class="err">array</span> <span class="m">10</span> <span class="m">1</span> <span class="err">place</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>  <span class="err">-</span><span class="m">1020</span> <span class="err">-</span><span class="m">340</span> <span class="m">285</span><span class="err">.</span><span class="m">6</span>
    <span class="err">media</span>  <span class="m">2</span>  <span class="m">1</span>   <span class="m">2</span>
    <span class="err">media</span>  <span class="m">5</span>  <span class="m">1</span>   <span class="m">3</span> <span class="err">-</span><span class="m">2</span>
    <span class="err">media</span>  <span class="m">4</span>  <span class="m">1</span>   <span class="m">4</span> <span class="err">-</span><span class="m">3</span> <span class="err">-</span><span class="m">1</span>
  <span class="err">boundary</span> <span class="m">4</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>

<span class="n">read</span><span class="err"> </span><span class="n">array</span>
    <span class="err">ara=</span><span class="m">10</span> <span class="err">nux=</span><span class="m">4</span> <span class="err">nuy=</span><span class="m">2</span> <span class="err">nuz=</span><span class="m">1</span>  <span class="err">fill</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>   <span class="m">1</span> <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>   <span class="n">end</span><span class="err"> </span><span class="n">fill</span>
<span class="n">end</span><span class="err"> </span><span class="n">array</span>
</pre></div>
</div>
<p>The definitions block contains the photon dose response, a mesh geometry for the discrete-ordinates calculations,
a uniform mesh for the mesh tally, and the photon energy distribution read from the binary concentration
file (located on unit 71, the last time step case 64).</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">6</span>
        <span class="err">specialDose=</span><span class="m">9504</span>
    <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">gridGeometry</span> <span class="m">3</span>
        <span class="err">title=</span><span class="s">&quot;exercise geometry 68x44x24 = 71808&quot;</span>
        <span class="err">xplanes</span> <span class="err">-</span><span class="m">12000</span> <span class="err">-</span><span class="m">10000</span> <span class="err">-</span><span class="m">8000</span> <span class="err">-</span><span class="m">6000</span> <span class="err">-</span><span class="m">4000</span> <span class="err">-</span><span class="m">3000</span>
                <span class="err">-</span><span class="m">2040</span> <span class="err">-</span><span class="m">1870</span> <span class="err">-</span><span class="m">1700</span> <span class="err">-</span><span class="m">1530</span>
                <span class="err">-</span><span class="m">1360</span> <span class="err">-</span><span class="m">1275</span> <span class="err">-</span><span class="m">1190</span> <span class="err">-</span><span class="m">1150</span> <span class="err">-</span><span class="m">1110</span> <span class="err">-</span><span class="m">1070</span> <span class="err">-</span><span class="m">1020</span> <span class="err">-</span><span class="m">970</span> <span class="err">-</span><span class="m">930</span> <span class="err">-</span><span class="m">890</span> <span class="err">-</span><span class="m">850</span> <span class="err">-</span><span class="m">765</span>
                <span class="err">-</span><span class="m">680</span> <span class="err">-</span><span class="m">595</span> <span class="err">-</span><span class="m">510</span> <span class="err">-</span><span class="m">470</span> <span class="err">-</span><span class="m">430</span> <span class="err">-</span><span class="m">390</span> <span class="err">-</span><span class="m">340</span> <span class="err">-</span><span class="m">290</span> <span class="err">-</span><span class="m">250</span> <span class="err">-</span><span class="m">210</span> <span class="err">-</span><span class="m">170</span> <span class="err">-</span><span class="m">85</span>
                <span class="m">0</span> <span class="m">85</span> <span class="m">170</span> <span class="m">210</span> <span class="m">250</span> <span class="m">290</span> <span class="m">340</span> <span class="m">390</span> <span class="m">430</span> <span class="m">470</span> <span class="m">510</span> <span class="m">595</span> <span class="m">680</span>
                <span class="m">765</span> <span class="m">850</span> <span class="m">890</span> <span class="m">930</span> <span class="m">970</span> <span class="m">1020</span> <span class="m">1070</span> <span class="m">1110</span> <span class="m">1150</span> <span class="m">1190</span> <span class="m">1275</span> <span class="m">1360</span>
                <span class="m">1530</span> <span class="m">1700</span> <span class="m">1870</span> <span class="m">2040</span>
                <span class="m">3000</span> <span class="m">4000</span> <span class="m">6000</span> <span class="m">8000</span> <span class="m">10000</span> <span class="m">12000</span> <span class="n">end</span>
        <span class="err">yplanes</span> <span class="err">-</span><span class="m">12000</span> <span class="err">-</span><span class="m">10000</span> <span class="err">-</span><span class="m">8000</span> <span class="err">-</span><span class="m">6000</span> <span class="err">-</span><span class="m">4000</span> <span class="err">-</span><span class="m">2000</span>
                <span class="err">-</span><span class="m">1360</span> <span class="err">-</span><span class="m">1190</span> <span class="err">-</span><span class="m">1020</span> <span class="err">-</span><span class="m">850</span>
                <span class="err">-</span><span class="m">680</span> <span class="err">-</span><span class="m">595</span> <span class="err">-</span><span class="m">510</span> <span class="err">-</span><span class="m">470</span> <span class="err">-</span><span class="m">430</span> <span class="err">-</span><span class="m">390</span> <span class="err">-</span><span class="m">340</span> <span class="err">-</span><span class="m">290</span> <span class="err">-</span><span class="m">250</span> <span class="err">-</span><span class="m">210</span> <span class="err">-</span><span class="m">170</span> <span class="err">-</span><span class="m">85</span>
                <span class="m">0</span> <span class="m">85</span> <span class="m">170</span> <span class="m">210</span> <span class="m">250</span> <span class="m">290</span> <span class="m">340</span> <span class="m">390</span> <span class="m">430</span> <span class="m">470</span> <span class="m">510</span> <span class="m">595</span> <span class="m">680</span>
                <span class="m">850</span> <span class="m">1020</span> <span class="m">1190</span> <span class="m">1360</span>
                <span class="m">2000</span> <span class="m">4000</span> <span class="m">6000</span> <span class="m">8000</span> <span class="m">10000</span> <span class="m">12000</span> <span class="n">end</span>
        <span class="err">zplanes</span> <span class="err">-</span><span class="m">100</span> <span class="err">-</span><span class="m">50</span> <span class="err">-</span><span class="m">30</span> <span class="err">-</span><span class="m">15</span> <span class="m">0</span> <span class="m">25</span> <span class="m">50</span> <span class="m">75</span> <span class="m">100</span> <span class="m">200</span> <span class="m">300</span> <span class="m">400</span> <span class="m">500</span> <span class="m">570</span> <span class="m">600</span> <span class="m">800</span>
                <span class="m">900</span> <span class="m">1000</span> <span class="m">1500</span> <span class="m">2000</span> <span class="m">3000</span> <span class="m">4000</span> <span class="m">6000</span> <span class="m">8000</span> <span class="m">10000</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
    <span class="err">gridGeometry</span> <span class="m">4</span>
        <span class="err">title=</span><span class="s">&quot;large voxels for mesh tally&quot;</span>
        <span class="err">xLinear</span> <span class="m">24</span> <span class="err">-</span><span class="m">12000</span><span class="err">.</span><span class="m">0</span> <span class="m">12000</span><span class="err">.</span><span class="m">0</span>
        <span class="err">yLinear</span> <span class="m">24</span> <span class="err">-</span><span class="m">12000</span><span class="err">.</span><span class="m">0</span> <span class="m">12000</span><span class="err">.</span><span class="m">0</span>
        <span class="err">zLinear</span>  <span class="m">1</span>      <span class="m">0</span><span class="err">.</span><span class="m">0</span>   <span class="m">200</span><span class="err">.</span><span class="m">0</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>

    <span class="err">distribution</span> <span class="m">1</span>
<span class="c">&#39;       use result from kewaunee.origen.inp, case 64, master photon library</span>
        <span class="err">special=</span><span class="s">&quot;origensBinaryConcentrationFile&quot;</span>
        <span class="err">filename=”ft</span><span class="m">71</span><span class="err">f</span><span class="m">001</span><span class="err">”</span>
        <span class="err">parameters</span> <span class="m">71</span> <span class="m">64</span> <span class="m">4</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>The source can be defined in two ways. Since there are eight casks, eight
sources could be defined, each over a cylinder with a strength of
7.155×10<sup>16</sup> photon/s. In this example of eight identical
sources, one source region can be defined and then limited to only exist
in the spent fuel material (the first material) but with a strength for
all the casks of 5.724×10<sup>17</sup> photon/s.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;each cask holds 1/6 of kewaunee core&quot;</span>
        <span class="err">strength</span><span class="m">=5.724e17</span>
        <span class="err">cuboid</span> <span class="err">-</span><span class="m">1115</span> <span class="m">1115</span>  <span class="m">435</span> <span class="err">-</span><span class="m">435</span>  <span class="m">514</span><span class="err">.</span><span class="m">2</span>  <span class="m">57</span>
        <span class="err">mixture=</span><span class="m">1</span>
        <span class="err">photons</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>The mesh tally covers only the first 2 meters above the ground since the dose rate above that would not impact a person.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
    <span class="err">meshTally</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;120m from cask array center&quot;</span>
        <span class="err">photon</span>
        <span class="err">gridGeometryID=</span><span class="m">4</span>
        <span class="err">responseID=</span><span class="m">6</span>
    <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>

<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="c">&#39; Parameters Block</span>
<span class="c">&#39;-------------------------------------------------------------------------------</span>
<span class="n">read</span><span class="err"> </span><span class="n">parameters</span>
    <span class="err">randomSeed=</span><span class="m">8655740521000041</span>
    <span class="err">perBatch=</span><span class="m">940000</span>  <span class="err">batches=</span><span class="m">60</span>
<span class="n">end</span><span class="err"> </span><span class="n">parameters</span>
</pre></div>
</div>
<p>The adjoint source is placed everywhere that the dose rate is desired—–near the ground but
not very close to or in between the casks (where people will not be).
The macro material option is used here to ensure that the discrete-ordinates calculation is more representative of the problem.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">3</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span> <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>   <span class="m">12000</span> <span class="err">-</span><span class="m">12000</span>  <span class="m">600</span><span class="err">.</span><span class="m">0</span> <span class="m">0</span><span class="err">.</span><span class="m">0</span>
        <span class="err">responseID=</span><span class="m">6</span>
        <span class="err">unit=</span><span class="m">2</span> <span class="err">region=</span><span class="m">3</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">respWeighting</span>
    <span class="err">macromaterial</span>
        <span class="err">mmTolerance=</span><span class="m">0</span><span class="err">.</span><span class="m">001</span>
    <span class="n">end</span><span class="err"> </span><span class="n">macromaterial</span>
    <span class="err">saveExtraMaps</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>

<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h4>Output<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>The MAVRIC calculational times were 3 minutes for the forward Denovo, 3.5 minutes for the adjoint Denovo,
and 60 minutes for the Monaco forward Monte Carlo. Results for the mesh tally of dose rates are shown in
<a class="reference internal" href="#fig4-33"><span class="std std-numref">Fig. 33</span></a>. For a longer Monaco calculation (64 hr), the mesh tally results are shown in <a class="reference internal" href="#fig4-34"><span class="std std-numref">Fig. 34</span></a>.
Note that the scale for the dose rate has been adjusted to only show the values outside of the cask array.</p>
<p>Using the Mesh File Viewer, the distribution of relative uncertainty in a mesh tally can be plotted.
For this 1 hr calculation, 50% of the voxels in the mesh tally had less than 20% relative uncertainty.
<a class="reference internal" href="#fig4-35"><span class="std std-numref">Fig. 35</span></a> shows how the distribution of relative errors changes with longer run times.
For the 64 hr run, 90% of the voxels had less than 10% relative uncertainty.</p>
<div class="figure align-center" id="id60">
<span id="fig4-33"></span><img alt="_images/4.33.png" src="_images/4.33.png" />
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Photon dose rate values in rem/hr (left) and the relative uncertainty (right) for the area around the cask array (1 hr Monaco).</span><a class="headerlink" href="#id60" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id61">
<span id="fig4-34"></span><img alt="_images/4.34.png" src="_images/4.34.png" />
<p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">Photon dose rate values in rem/hr (left) and the relative uncertainty (right) for the area around the cask array (64 hr Monaco). For the uncertainty plot, purple represents &lt;=5%.</span><a class="headerlink" href="#id61" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id62">
<span id="fig4-35"></span><img alt="_images/fig4.1.35_isfsiCompare.png" src="_images/fig4.1.35_isfsiCompare.png" />
<p class="caption"><span class="caption-number">Fig. 35 </span><span class="caption-text">Distribution of relative uncertainties for different run times of <code class="docutils literal notranslate"><span class="pre">mavric.isfsi.inp</span></code> showing the fraction of the mesh tally voxels that had less than a given amount of relative uncertainty.</span><a class="headerlink" href="#id62" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="tn24-p-spent-fuel-cask">
<h3>TN24-P spent fuel cask<a class="headerlink" href="#tn24-p-spent-fuel-cask" title="Permalink to this headline">¶</a></h3>
<p>For an example that uses multiple sources, user-defined distributions in
those sources, macromaterials for improved S<sub>N</sub> calculations, and
the automated variance reduction capabilities in MAVRIC, consider the
model for the TN-24P cask, as used in previous SCALE shielding
reports <a class="bibtex reference internal" href="#wiarda-development-2009" id="id24">[WDP+09]</a> and shown in <a class="reference internal" href="#fig4-36"><span class="std std-numref">Fig. 36</span></a>. This model contains two types
of PWR spent fuel assemblies (Types V and W, both Westinghouse 15×15
assemblies of different starting enrichments and burnups), each with
specified neutron and photon sources, in an aluminum/boron fuel basket.
The cask is made of forged steel for photon shielding with a resin layer
for neutron shielding. The model also includes three activated
hardware regions (bottom nozzle, top nozzle, and top plenum), which
consist of specified amounts of <sup>60</sup>Co (a photon source). The
task for this example is to calculate the total dose rate within 2
meters of the cask surface.</p>
<div class="figure align-center" id="id63">
<span id="fig4-36"></span><img alt="_images/4.36.png" src="_images/4.36.png" />
<p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">MAVRIC model of the TN24-P cask. Materials: spent fuel (light and dark yellow), steels (blues), resin (green), and other metals (gray).</span><a class="headerlink" href="#id63" title="Permalink to this image">¶</a></p>
</div>
<p>For MAVRIC, this means that the calculation of a dose rate mesh tally is calculated using
FW-CADIS to ensure that each voxel has low relative uncertainty,
independent of the dose rate. Without MAVRIC, the calculation of dose
rate everywhere in three dimensions would be too challenging. Most
likely, the dose rate would be evaluated with reasonable uncertainty at
only a few locations. In fact, with analog calculations, this example
would be a very difficult problem since most source particles never
leave the cask, just as in the real-life situation. This type of problem
really benefits from the CADIS-biased source distribution, in which
source particles deep inside the cask are sampled very rarely since they
do not contribute significantly to the response.</p>
<div class="section" id="id25">
<h4>Input file<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p>The following is a partial list of the file <code class="docutils literal notranslate"><span class="pre">mavric.tn24p.inp</span></code> located
in the SCALE <code class="docutils literal notranslate"><span class="pre">samples\input</span></code> directory. This calculation will use the
coarse-group shielding library for all of the importance map
calculations but then will use the fine-group library for the final Monaco
step. The full geometry and source distributions are not printed here
due to their length.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=mavric</span>
<span class="err">Monaco/MAVRIC</span> <span class="err">Training</span> <span class="err">-</span> <span class="err">Exercise</span> <span class="m">3</span><span class="err">.</span> <span class="err">Graphite</span> <span class="err">Shielding</span> <span class="err">Measurements</span> <span class="err">Revisited</span>
<span class="err">v</span><span class="m">7</span><span class="err">-</span><span class="m">27</span><span class="err">n</span><span class="m">19</span><span class="err">g</span>
<span class="n">read</span><span class="err"> </span><span class="n">composition</span>
    <span class="err">…</span>
<span class="n">end</span><span class="err"> </span><span class="n">composition</span>

<span class="n">read</span><span class="err"> </span><span class="n">geometry</span>
    <span class="err">…</span>
<span class="n">end</span><span class="err"> </span><span class="n">geometry</span>

<span class="n">read</span><span class="err"> </span><span class="n">array</span>
    <span class="err">…</span>
<span class="n">end</span><span class="err"> </span><span class="n">array</span>
</pre></div>
</div>
<p>The definitions block includes three responses (neutron, photon,
total), two grid geometries (one for the importance map calculations
and one for a mesh tally), one cylindrical mesh for a mesh tally,
five distributions for the energy spectra of the sources, and two
distributions for the spatial distributions of the fuel assembly
sources.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">definitions</span>
    <span class="err">response</span> <span class="m">1</span>  <span class="err">specialDose=</span><span class="m">9029</span>  <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">response</span> <span class="m">2</span>  <span class="err">specialDose=</span><span class="m">9504</span>  <span class="n">end</span><span class="err"> </span><span class="n">response</span>
    <span class="err">response</span> <span class="m">3</span>  <span class="err">specialDose=</span><span class="m">9729</span>  <span class="n">end</span><span class="err"> </span><span class="n">response</span>

    <span class="err">gridGeometry</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;for discrete ordinates calculations  48 x 48 x 61&quot;</span>
        <span class="err">…</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
    <span class="err">gridGeometry</span> <span class="m">2</span>
        <span class="err">title=</span><span class="s">&quot;for mesh tallies&quot;</span>
        <span class="err">xLinear</span> <span class="m">66</span> <span class="err">-</span><span class="m">330</span> <span class="m">330</span>
        <span class="err">yLinear</span> <span class="m">66</span> <span class="err">-</span><span class="m">330</span> <span class="m">330</span>
        <span class="err">zLinear</span> <span class="m">90</span> <span class="err">-</span><span class="m">435</span> <span class="m">465</span>
    <span class="n">end</span><span class="err"> </span><span class="n">gridGeometry</span>
    <span class="err">cylGeometry</span> <span class="m">3</span>
        <span class="err">radiusLinear</span> <span class="m">66</span> <span class="m">0</span> <span class="m">330</span>
        <span class="err">degreeLinear</span> <span class="m">72</span> <span class="m">0</span> <span class="m">360</span>
        <span class="err">zLinear</span> <span class="m">90</span> <span class="err">-</span><span class="m">435</span> <span class="m">465</span>
    <span class="n">end</span><span class="err"> </span><span class="n">cylGeometry</span>

    <span class="err">distribution</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;neutron energy distribution for W assembly&quot;</span>
        <span class="err">abscissa</span> <span class="err">…</span> <span class="n">end</span>
        <span class="err">truePDF</span> <span class="err">…</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
    <span class="err">distribution</span> <span class="m">2</span>
        <span class="err">title=</span><span class="s">&quot;photon energy distribution for W assembly&quot;</span>
        <span class="err">abscissa</span> <span class="err">…</span> <span class="n">end</span>
        <span class="err">truePDF</span> <span class="err">…</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>


    <span class="err">distribution</span> <span class="m">3</span>
        <span class="err">title=</span><span class="s">&quot;neutron energy distribution for V assembly&quot;</span>
        <span class="err">abscissa</span> <span class="err">…</span> <span class="n">end</span>
        <span class="err">truePDF</span> <span class="err">…</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
    <span class="err">distribution</span> <span class="m">4</span>
        <span class="err">title=</span><span class="s">&quot;photon energy distribution for V assembly&quot;</span>
        <span class="err">abscissa</span> <span class="err">…</span> <span class="n">end</span>
        <span class="err">truePDF</span> <span class="err">…</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
    <span class="err">distribution</span> <span class="m">5</span>
        <span class="err">title=</span><span class="s">&quot;cobalt-60 gammas/decay&quot;</span>
        <span class="err">special=</span><span class="s">&quot;origensDiscreteGammas&quot;</span>
        <span class="err">parameters</span> <span class="m">27</span> <span class="m">60</span> <span class="n">end</span>
    <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>

    <span class="err">distribution</span> <span class="m">101</span>  <span class="err">special=</span><span class="s">&quot;pwrNeutronAxialProfile&quot;</span>  <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>
    <span class="err">distribution</span> <span class="m">102</span>  <span class="err">special=</span><span class="s">&quot;pwrGammaAxialProfile&quot;</span>   <span class="n">end</span><span class="err"> </span><span class="n">distribution</span>

    <span class="err">runSampleTests</span>   <span class="err">makeCharts</span>
<span class="n">end</span><span class="err"> </span><span class="n">definitions</span>
</pre></div>
</div>
<p>Seven sources are defined—–a neutron and photon source for each type of fuel assembly, and three activated hardware regions.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">sources</span>
    <span class="err">src</span> <span class="m">1</span>
        <span class="err">title=</span><span class="s">&quot;W assembly, neutron source&quot;</span>
        <span class="err">neutrons</span>
        <span class="err">strength</span><span class="m">=1.6472e9</span>
        <span class="err">zCylinder</span> <span class="m">71</span><span class="err">.</span><span class="m">0</span>  <span class="m">182</span><span class="err">.</span><span class="m">9</span> <span class="err">-</span><span class="m">182</span><span class="err">.</span><span class="m">9</span>
        <span class="err">zDistributionID=</span><span class="m">101</span>  <span class="err">zScaleDist</span>
        <span class="err">mixture=</span><span class="m">2</span>
        <span class="err">eDistributionID=</span><span class="m">1</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
    <span class="err">src</span> <span class="m">2</span>
        <span class="err">title=</span><span class="s">&quot;W assembly, photon source&quot;</span>
        <span class="err">photons</span>
        <span class="err">strength</span><span class="m">=5.3638e16</span>
        <span class="err">zCylinder</span> <span class="m">71</span><span class="err">.</span><span class="m">0</span>  <span class="m">182</span><span class="err">.</span><span class="m">9</span> <span class="err">-</span><span class="m">182</span><span class="err">.</span><span class="m">9</span>
        <span class="err">zDistributionID=</span><span class="m">102</span>  <span class="err">zScaleDist</span>
        <span class="err">mixture=</span><span class="m">2</span>
        <span class="err">eDistributionID=</span><span class="m">2</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>

    <span class="err">src</span> <span class="m">3</span>
        <span class="err">title=</span><span class="s">&quot;V assembly, neutron source&quot;</span>
        <span class="err">neutrons</span>
        <span class="err">strength</span><span class="m">=7.1927e8</span>
        <span class="err">zCylinder</span> <span class="m">63</span><span class="err">.</span><span class="m">0</span>  <span class="m">182</span><span class="err">.</span><span class="m">9</span> <span class="err">-</span><span class="m">182</span><span class="err">.</span><span class="m">9</span>
        <span class="err">zDistributionID=</span><span class="m">101</span>  <span class="err">zScaleDist</span>
        <span class="err">mixture=</span><span class="m">12</span>
        <span class="err">eDistributionID=</span><span class="m">3</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
    <span class="err">src</span> <span class="m">4</span>
        <span class="err">title=</span><span class="s">&quot;V assembly, photon source&quot;</span>
        <span class="err">photons</span>
        <span class="err">strength</span><span class="m">=1.8234e16</span>
        <span class="err">zCylinder</span> <span class="m">63</span><span class="err">.</span><span class="m">0</span>  <span class="m">182</span><span class="err">.</span><span class="m">9</span> <span class="err">-</span><span class="m">182</span><span class="err">.</span><span class="m">9</span>
        <span class="err">zDistributionID=</span><span class="m">102</span>  <span class="err">zScaleDist</span>
        <span class="err">mixture=</span><span class="m">12</span>
        <span class="err">eDistributionID=</span><span class="m">4</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
     <span class="err">src</span> <span class="m">6</span>
        <span class="err">title=</span><span class="s">&quot;bottom nozzel Co-60 source&quot;</span>
        <span class="err">photons</span>
        <span class="err">strength</span><span class="m">=1.7960e14</span>
        <span class="err">zCylinder</span> <span class="m">71</span><span class="err">.</span><span class="m">0</span> <span class="err">-</span><span class="m">186</span> <span class="err">-</span><span class="m">193</span>
        <span class="err">mixture=</span><span class="m">9</span>
        <span class="err">eDistributionID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>

    <span class="err">src</span> <span class="m">7</span>
        <span class="err">title=</span><span class="s">&quot;top nozzle Co-60 source&quot;</span>
        <span class="err">photons</span>
        <span class="err">strength</span><span class="m">=1.0103e14</span>
        <span class="err">zCylinder</span> <span class="m">71</span><span class="err">.</span><span class="m">0</span> <span class="m">212</span><span class="err">.</span><span class="m">8</span> <span class="m">203</span><span class="err">.</span><span class="m">9</span>
        <span class="err">mixture=</span><span class="m">10</span>
        <span class="err">eDistributionID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>

    <span class="err">src</span> <span class="m">8</span>
        <span class="err">title=</span><span class="s">&quot;plenum Co-60 source&quot;</span>
        <span class="err">photons</span>
        <span class="err">strength</span><span class="m">=6.3137e13</span>
        <span class="err">zCylinder</span> <span class="m">71</span><span class="err">.</span><span class="m">0</span> <span class="m">201</span><span class="err">.</span><span class="m">0</span> <span class="m">182</span><span class="err">.</span><span class="m">9</span>
        <span class="err">mixture=</span><span class="m">11</span>
        <span class="err">eDistributionID=</span><span class="m">5</span>
    <span class="n">end</span><span class="err"> </span><span class="n">src</span>
<span class="n">end</span><span class="err"> </span><span class="n">sources</span>
</pre></div>
</div>
<p>Four mesh tallies are used to collect the neutron dose rate, the photon dose rate, and the total dose rate.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">tallies</span>
 <span class="err">meshTally</span> <span class="m">1</span>
     <span class="err">neutron</span>
     <span class="err">gridGeometryID=</span><span class="m">2</span>
     <span class="err">responseID=</span><span class="m">1</span>
     <span class="err">noGroupFluxes</span>
 <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
 <span class="err">meshTally</span> <span class="m">2</span>
     <span class="err">photon</span>
     <span class="err">gridGeometryID=</span><span class="m">2</span>
     <span class="err">responseID=</span><span class="m">2</span>
     <span class="err">noGroupFluxes</span>
 <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
 <span class="err">meshTally</span> <span class="m">11</span>
     <span class="err">neutron</span>
     <span class="err">cylGeometryID=</span><span class="m">3</span>
     <span class="err">responseID=</span><span class="m">1</span>
     <span class="err">noGroupFluxes</span>
 <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
 <span class="err">meshTally</span> <span class="m">12</span>
     <span class="err">photon</span>
     <span class="err">cylGeometryID=</span><span class="m">3</span>
     <span class="err">responseID=</span><span class="m">2</span>
     <span class="err">noGroupFluxes</span>
 <span class="n">end</span><span class="err"> </span><span class="n">meshTally</span>
<span class="n">end</span><span class="err"> </span><span class="n">tallies</span>
</pre></div>
</div>
<p>The goal of this example is to calculate the total dose outside the
cask. Therefore, the adjoint source uses the total dose rate response
function for its energy component, whereas for the spatial component, it
uses a large block around the cask. Note the “mixture=” keyword, which
restricts the adjoint source to only exist where the material is air
(13). There is no need to put adjoint source deep in the cask since the
dose rates inside the cask are not of interest. Response weighting is
used to put more adjoint source in the low dose areas outside the cask.
Note that since this area is air, not many interactions/scatter take
place, so a great balance in relative uncertainties
near and far from the cask should not be expected. Macromaterials are used to improve the
results from the discrete-ordinates calculations, which should improve
the FOM of the final Monaco calculation. The geometry images in <a class="reference internal" href="#macromaterials"><span class="std std-ref">Macromaterials for SN geometries</span></a> are taken from this problem.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="err"> </span><span class="n">importanceMap</span>
    <span class="err">gridGeometryID=</span><span class="m">1</span>
    <span class="err">adjointSource</span> <span class="m">1</span>
        <span class="err">boundingBox</span>  <span class="m">330</span> <span class="err">-</span><span class="m">330</span>   <span class="m">330</span> <span class="err">-</span><span class="m">330</span>  <span class="m">465</span> <span class="err">-</span><span class="m">435</span>
        <span class="err">responseID=</span><span class="m">3</span>
        <span class="err">mixture=</span><span class="m">13</span>
    <span class="n">end</span><span class="err"> </span><span class="n">adjointSource</span>
    <span class="err">respWeighting</span>
    <span class="err">reduce</span>
    <span class="err">subCells=</span><span class="m">3</span>
    <span class="err">macromaterial</span>
        <span class="err">mmTolerance=</span><span class="m">0</span><span class="err">.</span><span class="m">001</span>
    <span class="n">end</span><span class="err"> </span><span class="n">macromaterial</span>
<span class="n">end</span><span class="err"> </span><span class="n">importanceMap</span>

<span class="n">end</span><span class="err"> </span><span class="n">data</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="id26">
<h4>Output<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>The distributions used by the source descriptions of the TN24-P model
are shown in <a class="reference internal" href="#fig4-38"><span class="std std-numref">Fig. 38</span></a>, and the responses used in this problem are
shown in <a class="reference internal" href="#fig4-37"><span class="std std-numref">Fig. 37</span></a>. <a class="reference internal" href="#fig4-39"><span class="std std-numref">Fig. 39</span></a> and <a class="reference internal" href="#fig4-40"><span class="std std-numref">Fig. 40</span></a> show the total
(neutron + photon) dose rate outside the TN24-P cask, up to 2 meters
from each surface using rectilinear and cylindrical mesh tallies
with 10 cm voxels. Uncertainties in the computed dose rates were 3–4%
after this 16 hr calculation. The scale of the figure was adjusted to
only show the dose rate outside the cask; dose rates inside the cask
went as high as 6×10<sup>5</sup> rem/hr. Likewise, the scale of the
uncertainties ranged from 0 to 10% to highlight the uncertainties
outside the cask. Relative uncertainties inside the cask were much
higher (white areas) since those areas were deemed unimportant by the
chosen adjoint source. Obtaining dose rates on a 10 cm mesh would not be
achievable without the variance reduction capabilities of MAVRIC.</p>
<div class="figure align-center" id="id64">
<span id="fig4-37"></span><img alt="_images/4.37.png" src="_images/4.37.png" />
<p class="caption"><span class="caption-number">Fig. 37 </span><span class="caption-text">Neutron (left) and photon (right) dose rate response functions.</span><a class="headerlink" href="#id64" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id65">
<span id="fig4-38"></span><img alt="_images/4.38.png" src="_images/4.38.png" />
<p class="caption"><span class="caption-number">Fig. 38 </span><span class="caption-text">Distributions in the TN24-P model.</span><a class="headerlink" href="#id65" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id66">
<span id="fig4-39"></span><img alt="_images/4.39.png" src="_images/4.39.png" />
<p class="caption"><span class="caption-number">Fig. 39 </span><span class="caption-text">Rectilinear mesh tally of total dose rate (rem/hr) and its relative uncertainty along the x=0 plane.</span><a class="headerlink" href="#id66" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id67">
<span id="fig4-40"></span><img alt="_images/4.40.png" src="_images/4.40.png" />
<p class="caption"><span class="caption-number">Fig. 40 </span><span class="caption-text">Cylindrical mesh tally of total dose rate (rem/hr) and its relative uncertainty along the θ=0° plane.</span><a class="headerlink" href="#id67" title="Permalink to this image">¶</a></p>
</div>
<p id="bibtex-bibliography-MAVRIC-0"><dl class="citation">
<dt class="bibtex label" id="baker-sn-1998"><span class="brackets"><a class="fn-backref" href="#id9">BK98</a></span></dt>
<dd><p>Randal S. Baker and Kenneth R. Koch. An Sn algorithm for the massively parallel CM-200 computer. <em>Nuclear Science and Engineering</em>, 128(3):312–320, 1998. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="evans-denovo-2010"><span class="brackets">ESSC10</span></dt>
<dd><p>Thomas M. Evans, Alissa S. Stafford, Rachel N. Slaybaugh, and Kevin T. Clarno. Denovo: A New Three-Dimensional Parallel Discrete Ordinates Code in SCALE. <em>Nuclear Technology</em>, 171(2):171–200, August 2010. Publisher: Taylor &amp; Francis _eprint: https://doi.org/10.13182/NT171-171. URL: <a class="reference external" href="https://doi.org/10.13182/NT171-171">https://doi.org/10.13182/NT171-171</a>, <a class="reference external" href="https://doi.org/10.13182/NT171-171">doi:10.13182/NT171-171</a>.</p>
</dd>
<dt class="bibtex label" id="gardner-monte-1991"><span class="brackets"><a class="fn-backref" href="#id17">GV91</a></span></dt>
<dd><p>R. P. Gardner and K. Verghese. Monte Carlo nuclear well logging benchmark problems with preliminary intercomparison results. <em>Nuclear Geophysics</em>, 5(4):429–438, 1991.</p>
</dd>
<dt class="bibtex label" id="haghighat-monte-2003"><span class="brackets"><a class="fn-backref" href="#id4">HW03</a></span></dt>
<dd><p>Alireza Haghighat and John C. Wagner. Monte Carlo variance reduction with deterministic importance functions. <em>Progress in Nuclear Energy</em>, 42(1):25–53, 2003. Publisher: Elsevier.</p>
</dd>
<dt class="bibtex label" id="ibrahim-improving-2009"><span class="brackets"><a class="fn-backref" href="#id13">IPE+09</a></span></dt>
<dd><p>Ahmad M. Ibrahim, Douglas E. Peplow, Thomas M. Evans, John C. Wagner, and Paul PH Wilson. Improving the Mesh Generation Capabilities in the SCALE Hybrid Shielding Analysis Sequence. <em>Trans. Am. Nucl. Soc</em>, 100:302, 2009.</p>
</dd>
<dt class="bibtex label" id="johnson-fast-2013"><span class="brackets"><a class="fn-backref" href="#id14">Joh13</a></span></dt>
<dd><p>Seth R. Johnson. Fast mix table construction for material discretization. In <em>Proceedings of the 2013 International Conference on Mathematics and Computational Methods Applied to Nuclear Science and Engineering-M and C 2013</em>. 2013.</p>
</dd>
<dt class="bibtex label" id="lathrop-remedies-1971"><span class="brackets"><a class="fn-backref" href="#id16">Lat71</a></span></dt>
<dd><p>K. D. Lathrop. Remedies for ray effects. <em>Nuclear Science and Engineering</em>, 45(3):255–268, 1971. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="lathrop-ray-1968"><span class="brackets"><a class="fn-backref" href="#id15">Lat68</a></span></dt>
<dd><p>Kaye D. Lathrop. Ray effects in discrete ordinates equations. <em>Nuclear Science and Engineering</em>, 32(3):357–369, 1968. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="peplow-monte-2011"><span class="brackets"><a class="fn-backref" href="#id6">Pep11</a></span></dt>
<dd><p>Douglas E. Peplow. Monte Carlo shielding analysis capabilities with MAVRIC. <em>Nuclear Technology</em>, 174(2):289–313, 2011. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="rhoades-doors-1998"><span class="brackets"><a class="fn-backref" href="#id12">RC98</a></span></dt>
<dd><p>W. A. Rhoades and R. L. Childs. DOORS 3.2, one-, two-, three-dimensional discrete ordinates neutron/photon transport code system. <em>RSICC, Oak Ridge National Laboratory</em>, 300:650, 1998.</p>
</dd>
<dt class="bibtex label" id="rhoades-tort-1997"><span class="brackets"><a class="fn-backref" href="#id11">RS97</a></span></dt>
<dd><p>Wayne A. Rhoades and D. B. Simpson. The TORT three-dimensional discrete ordinates neutron/photon transport code (TORT version 3). Technical Report, Oak Ridge National Lab., TN (United States), 1997.</p>
</dd>
<dt class="bibtex label" id="wagner-acceleration-1997"><span class="brackets">Wag97</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id8">2</a>)</span></dt>
<dd><p>John C. Wagner. <em>Acceleration of Monte Carlo shielding calculations with an automated variance reduction technique and parallel processing</em>. PhD thesis, Pennsylvania State University, 1997.</p>
</dd>
<dt class="bibtex label" id="wagner-automated-2002"><span class="brackets"><a class="fn-backref" href="#id3">Wag02</a></span></dt>
<dd><p>John C. Wagner. An automated deterministic variance reduction generator for Monte Carlo shielding applications. In <em>Proceedings of the American Nuclear Society 12th Biennial RPSD Topical Meeting</em>, 14–18. Citeseer, 2002.</p>
</dd>
<dt class="bibtex label" id="wagner-forward-weighted-2007"><span class="brackets"><a class="fn-backref" href="#id5">WBP07</a></span></dt>
<dd><p>John C. Wagner, Edward D. Blakeman, and Douglas E. Peplow. Forward-weighted CADIS method for global variance reduction. <em>Transactions-American Nuclear Society</em>, 97:630, 2007. Publisher: American Nuclear Society.</p>
</dd>
<dt class="bibtex label" id="wagner-automated-1998"><span class="brackets">WH98</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id18">2</a>)</span></dt>
<dd><p>John C. Wagner and Alireza Haghighat. Automated variance reduction of Monte Carlo shielding calculations using the discrete ordinates adjoint function. <em>Nuclear Science and Engineering</em>, 128(2):186–208, 1998. Publisher: Taylor &amp; Francis.</p>
</dd>
<dt class="bibtex label" id="wagner-fw-cadis-2014"><span class="brackets"><a class="fn-backref" href="#id7">WPM14</a></span></dt>
<dd><p>John C. Wagner, Douglas E. Peplow, and Scott W. Mosher. FW-CADIS Method for Global and Regional Variance Reduction of Monte Carlo Radiation Transport Calculations. <em>Nuclear Science and Engineering</em>, 176(1):37–57, January 2014. URL: <a class="reference external" href="https://www.tandfonline.com/doi/full/10.13182/NSE12-33">https://www.tandfonline.com/doi/full/10.13182/NSE12-33</a>, <a class="reference external" href="https://doi.org/10.13182/NSE12-33">doi:10.13182/NSE12-33</a>.</p>
</dd>
<dt class="bibtex label" id="wiarda-development-2009"><span class="brackets"><a class="fn-backref" href="#id24">WDP+09</a></span></dt>
<dd><p>Dorothea Wiarda, Michael E. Dunn, Douglas E. Peplow, Thomas M. Miller, and Hatice Akkurt. Development and Testing of Endf/b-vi. 8 and Endf/b-vii. 0 Coupled Neutron-gamma Libraries for Scale 6. <em>ORNL/TM-2008/047 (in press, 2008)</em>, 2009.</p>
</dd>
<dt class="bibtex label" id="willenbring-trilinos-2003"><span class="brackets"><a class="fn-backref" href="#id10">WH03</a></span></dt>
<dd><p>James M. Willenbring and Michael Allen Heroux. Trilinos users guide. Technical Report SAND2003-2952, Sandia National Laboratories, 2003.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="CAAScapability.html" class="btn btn-neutral float-right" title="MAVRIC Appendix A: CAAS Capability" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to the SCALE manual!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, SCALE developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>