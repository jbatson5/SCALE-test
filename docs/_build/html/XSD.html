

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis &mdash; SCALE Manual 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="XSDRNPM Appendices A and B" href="XSDAppAB.html" />
    <link rel="prev" title="Deterministic Transport Overview" href="Deterministic%20Transport%20Intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SCALE Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Reactor Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="TRITON.html">TRITON: A Multipurpose Transport, Depletion, And Sensitivity and Uncertainty Analysis Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="TRITONAppABC.html">TRITON Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="Polaris.html">POLARIS - 2D Light Water Reactor Lattice Physics Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="PolarisA.html">SCALE 6.2 Polaris Input Format</a></li>
</ul>
<p class="caption"><span class="caption-text">Depletion, Activation, and Spent Fuel Source Terms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Depletion%2C%20Activation%2C%20and%20Spent%20Fuel%20Source%20Terms%20Overview.html">Depletion, Activation, and Spent Fuel Source Terms Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN.html">Origen: Neutron Activation, Actinide Transmutation, Fission Product Generation, and Radiation Source Term Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html">Origen Data Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#energy-resource">Energy Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#decay-resource-format">Decay Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#fission-yield-resource-format">Fission Yield Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#gamma-resource-format">Gamma Resource Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGEN-Data.html#origen-end7dec-nuclide-set">ORIGEN “end7dec” Nuclide Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="ORIGAMI.html">ORIGAMI: A Code for Computing Assembly Isotopics with ORIGEN</a></li>
<li class="toctree-l1"><a class="reference internal" href="SLIG.html">SCALE/Origen Library Generator (SLIG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Origenutil.html">ORIGEN Utility Programs</a></li>
</ul>
<p class="caption"><span class="caption-text">Sensitivity and Uncertainty Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Sensitivity%20and%20Uncertainty%20Analysis%20Overview.html">Snesitivity and Uncertainty Analysis Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d.html">TSUNAMI-1D:  Control Module for One-Dimensional Cross-Section Sensitivity and Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-1d-appA.html">XSDRNPM Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-3d.html">TSUNAMI-3D: Control Module for Three-Dimensional Cross Section Sensitivity and Uncertainty Analysis for Criticality</a></li>
<li class="toctree-l1"><a class="reference internal" href="sams.html">SAMS: Sensitivity Analysis Module for Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="sams-appA.html">Sensitivity Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsar.html">TSAR: Tool for Sensitivity Analysis of Reactivity Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip.html">TSUNAMI Utility Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsunami-ip-appAB.html">Data File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer.html">TSURFER: An Adjustment Code to Determine Biases and Uncertainties in Nuclear System Responses by Consolidating Differential Data and Benchmark Integral Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="tsurfer-appA.html">TSURFER Appendix A: Sensitivity/Uncertainty Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampler.html">Sampler: A Module for Statistical Uncertainty Analysis with Scale Sequences</a></li>
</ul>
<p class="caption"><span class="caption-text">Criticality Safety</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Criticality%20Safety%20Overview.html">Criticality Safety Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5.html">CSAS5:  Control Module For Enhanced Criticality Safety Analysis Sequences With KENO V.a</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS5App.html">Additional Example Applications of CSAS5</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6.html">CSAS6:  Control Module for Enhanced Criticality Safety Analysis with KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSAS6App.html">Additional Example Applications of CSAS6</a></li>
<li class="toctree-l1"><a class="reference internal" href="STARBUCS.html">STARBUCS: A Scale Control Module for Automated Criticality Safety Analyses Using Burnup Credit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sourcerer.html">Sourcerer: Deterministic Starting Source for Criticality Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="DEVC.html">DEVC: Denovo EigenValue Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="KMART.html">KMART5 and KMART6: Postprocessors for KENO V.A and KENO-VI</a></li>
<li class="toctree-l1"><a class="reference internal" href="K5C5.html">K5toK6 and C5toC6: Input File Conversion Programs for KENO and CSAS</a></li>
</ul>
<p class="caption"><span class="caption-text">Material Specification and Cross Section Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Material%20Specification%20and%20Cross%20Section%20Processing%20Overview.html">Material Specification and Cross Section Processing Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProc.html">XSPROC: The Material and Cross Section Processing Module for SCALE</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppA.html">XSProc: Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppB.html">XSProc Standard Composition Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSProcAppC.html">Examples of Complete XSProc Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="stdcmp.html">Standard Composition Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="BONAMI.html">BONAMI: Resonance Self-Shielding by the Bondarenko Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="CENTRM.html">CENTRM: A Neutron Transport Code for Computing Continuous-Energy Spectra in General One-Dimensional Geometries and Two-Dimensional Lattice Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="PMC.html">PMC: A Program to Produce Multigroup Cross Sections Using Pointwise Energy Spectra from CENTRM</a></li>
<li class="toctree-l1"><a class="reference internal" href="PMCAppAB.html">PMC Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHOPS.html">CHOPS: Module to Compute Pointwise Disadvantage Factors and Produce a Cell-Homogenized CENTRM Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRAWDAD.html">CRAWDAD: Module to Produce CENTRM-Formatted Continuous-Energy Nuclear Data Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="MCDancoff.html">MCDancoff Data Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAJUN.html">CAJUN: Module for Combining and Manipulating CENTRM Continuous-Energy Libraries</a></li>
</ul>
<p class="caption"><span class="caption-text">Monte Carlo Transport</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Monte%20Carlo%20Transport%20Overview.html">Monte Carlo Transport Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoA.html">Keno Appendix A: KENO V.a Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoB.html">Keno Appendix B: KENO VI Shape Descriptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="KenoC.html">Keno Appendix C: Sample problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Monaco.html">Monaco: A Fixed-Source Monte Carlo Transport Code for Shielding Applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Radiation Shielding</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="MAVRIC.html">MAVRIC: Monaco with Automated Variance Reduction using Importance Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="CAAScapability.html">MAVRIC Appendix A: CAAS Capability</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixb.html">MAVRIC Appendix B: MAVRIC Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendixc.html">MAVRIC Appendix C: Advanced Features</a></li>
</ul>
<p class="caption"><span class="caption-text">Deterministic Transport</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Deterministic%20Transport%20Intro.html">Deterministic Transport Overview</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#functions-performed">Functions performed</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#background-on-xsdrnpm">Background on XSDRNPM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#applications-in-scale">Applications in SCALE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#notes-on-the-use-of-various-spectral-calculational-options">Notes on the use of various spectral calculational options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#selection-of-output-cross-section-library-formats">Selection of output cross-section library formats</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#theory-and-procedures">Theory and Procedures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#one-dimensional-discrete-ordinates-theory">One-dimensional discrete-ordinates theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multigroup-one-dimensional-boltzmann-equation">Multigroup one-dimensional Boltzmann equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scattering-source-term">Scattering source term</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#slab-and-spherical-geometries">Slab and Spherical Geometries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cylindrical-geometry">Cylindrical Geometry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#discrete-ordinates-difference-equations">Discrete-ordinates difference equations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id24">Discrete-ordinates difference equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#discrete-ordinates-equation-for-a-slab">Discrete-ordinates equation for a slab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#discrete-ordinates-equations-for-sphere-and-cylinder">Discrete-ordinates equations for sphere and cylinder</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sn-quadratures-for-slabs"><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for slabs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sn-quadratures-for-spheres"><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for spheres</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sn-quadratures-for-cylinders"><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for cylinders</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#weighted-difference-formulation-for-discrete-ordinates-equations">Weighted-difference formulation for discrete-ordinates equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boundary-conditions">Boundary conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fixed-sources">Fixed sources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dimension-search-calculations">Dimension search calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id39">Dimension search calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zone-width-search-ievt-4">Zone-width search (IEVT = 4)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#outer-radius-search-ievt-5">Outer radius search (IEVT = 5)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#buckling-search-ievt-6">Buckling search (IEVT = 6)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-calculation-strategy">Search calculation strategy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#alpa-search">Alpa Search</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#alpha-search">Alpha search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#direct-buckling-search">Direct-buckling search</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#iteration-and-convergence-tests">Iteration and convergence tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#group-banding-scaling-rebalance">Group banding (scaling rebalance)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#buckling-correction">Buckling correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#void-streaming-correction">Void streaming correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-section-weighting">Cross-section weighting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cell-weighting">“Cell Weighting”</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zone-weighting">“Zone” weighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#region-weighting">“Region” weighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#inner-cell-weighting">“Inner-cell” weighting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multigroup-weighting-equations">Multigroup weighting equations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transfer-matrices">Transfer matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#weighting-of-bar-v">Weighting of <span class="math notranslate nohighlight">\(\bar{v}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#transport-cross-sections">Transport cross sections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adjoint-calculations">Adjoint calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generalized-adjoint-calculations">Generalized adjoint calculations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#coupled-neutron-photon-calculations">Coupled neutron-photon calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diffusion-theory-option">Diffusion theory option</a></li>
<li class="toctree-l3"><a class="reference internal" href="#infinite-medium-theory-option">Infinite-medium theory option</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bn-theory-option">B<sub>N</sub> theory option</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xsdrnpm-input-data">XSDRNPM Input Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abbreviated-xsdrnpm-input-description">Abbreviated XSDRNPM input description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#xsdrnpm-input-output-assignments">XSDRNPM Input/Output Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#xsdrn-sample-problem">XSDRN Sample Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-cross-sections">Output Cross Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-messages">Error messages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="XSDAppAB.html">XSDRNPM Appendices A and B</a></li>
<li class="toctree-l1"><a class="reference internal" href="NEWT.html">NEWT:  A New Transport Algorithm for Two-Dimensional Discrete-Ordinates Analysis in Non-Orthogonal Geometries</a></li>
</ul>
<p class="caption"><span class="caption-text">Nuclear Data Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Nuclear%20Data%20Libraries%20Overview.html">SCALE Nuclear Data Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="XSLib.html">SCALE Cross Section Libraries</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SCALE Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/XSD.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="xsdrnpm-a-one-dimensional-discrete-ordinates-code-for-transport-analysis">
<span id="id1"></span><h1>XSDRNPM: A One-Dimensional Discrete-Ordinates Code for Transport Analysis<a class="headerlink" href="#xsdrnpm-a-one-dimensional-discrete-ordinates-code-for-transport-analysis" title="Permalink to this headline">¶</a></h1>
<ol class="upperalpha simple" start="12">
<li><ol class="upperalpha simple" start="13">
<li><p>Petrie, N. M. Greene, <a class="footnote-reference brackets" href="#id87" id="id2">1</a> M. L. Williams</p></li>
</ol>
</li>
</ol>
<p>ABSTRACT</p>
<p>XSDRNPM is a discrete-ordinates code that solves the one-dimensional
Boltzmann equation in slab, cylindrical, or spherical coordinates.
Alternatively, the user can select <em>P</em><sub>1</sub> diffusion theory, infinite
medium theory, or <em>B</em><sub>n</sub> theory. A variety of calculational types is
available, including fixed source, eigenvalue, or “search” calculations.
In SCALE, XSDRNPM is used for several purposes: eigenvalue (k‑effective)
determination, cross-section collapsing, shielding analysis, computation
of fundamental-mode or generalized adjoint functions for sensitivity
analysis, and for producing bias factors for use in Monte Carlo
shielding calculations.</p>
<p>ACKNOWLEDGMENTS</p>
<p>W. W. Engle has been very generous with the use of his notes on Sn theory and on
discussing details of various procedures in XSDRNPM which were lifted directly
from his ANISN program.</p>
<p>The authors also wish to thank R. H. Odegaarden (the former technical monitor at
the U.S. Nuclear Regulatory Commission) who supplied the necessary incentives
for completing this report.</p>
<div class="section" id="introduction">
<span id="id3"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>XSDRNPM is a one-dimensional (1-D) discrete-ordinates transport code and
is the latest in a series of codes in the XSDRN <a class="bibtex reference internal" href="#greene-xsdrn-1969" id="id4">[GCJ69]</a> family. As such, it
contains several unique characteristics, as will be detailed in this
report, though a large portion of the theoretical bases and intended
uses of the program are the same for all versions.</p>
<div class="section" id="functions-performed">
<span id="id5"></span><h3>Functions performed<a class="headerlink" href="#functions-performed" title="Permalink to this headline">¶</a></h3>
<p>The function of XSDRNPM is twofold: (1) perform a 1-D discrete-ordinates
calculation in slab, cylindrical, or spherical geometry (optionally, a
1-D diffusion theory or infinite medium <span class="math notranslate nohighlight">\(B_n\)</span> calculation can be made),
and (2) use the fluxes determined from its spectral calculation to
collapse input cross sections and write these into one of several
formats.</p>
<p>A great deal of flexibility is allowed in describing a problem for
XSDRNPM. The number of spatial intervals, the number of energy groups,
the number of nuclides, the quadrature order, the order of fits to the
angular variation in basic cross sections are all arbitrary and are
limited only by computer and monetary resources.</p>
<p>The flux calculation can be performed according to several options,
including fixed source calculations, k-calculations, and dimension
search calculations.</p>
<p>A variety of weighting options are allowed, including zone, cell, or a
special “vein” weighting option which is described herein.</p>
<div class="section" id="background-on-xsdrnpm">
<span id="id6"></span><h4>Background on XSDRNPM<a class="headerlink" href="#background-on-xsdrnpm" title="Permalink to this headline">¶</a></h4>
<p>Development of the XSDRN1 program started in the mid-1960s. The goal was
to develop a program that would combine features from the GAM-II, <a class="bibtex reference internal" href="#joanou-gam-ii-1963" id="id7">[JD63]</a>
ANISN, <a class="bibtex reference internal" href="#engle-jr-users-nodate" id="id8">[EJ67]</a> and THERMOS <a class="bibtex reference internal" href="#honeck-thermos-1961" id="id9">[Hon61]</a> programs in a more unified and general way
than would be possible if one simply elected to use these codes
individually.</p>
<p>The salient features to be retained from the programs were as follows:</p>
<dl class="describe">
<dt>
<code class="sig-name descname">GAM-II</code></dt>
<dd><p>The Nordheim Integral Treatment was desired for resonance
self-shielding; the generality of including cross sections for an
arbitrary number of processes, along with the provisions for
truncating zero or impossible transfers in the scattering matrices,
was also a requirement.</p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">ANISN</code></dt>
<dd><p>One-dimensional discrete-ordinates or diffusion theory or
infinite-medium theory was to be available to generate a spectrum for
cross-section collapsing.</p>
</dd></dl>

<dl class="describe">
<dt>
<code class="sig-name descname">THERMOS</code></dt>
<dd><p>The ability to perform detailed 1-D spectral calculations,
including upscatter effects, was required for the thermal region.</p>
</dd></dl>

<p>The whole code was required to be dynamically dimensioned to allow
calculations for arbitrary group structures, spatial structures, angular
quadratures, etc.</p>
<p>The XSDRN program that embodied these features was released in 1969.</p>
<p>In the early 1970s, the Defense Nuclear Agency (DNA) initiated support
for the AMPX system, which was to be a total cross-section generation
system capable of performing all tasks necessary to take basic neutron
and gamma-ray cross-section data and process these data into the proper
form needed for weapons effects calculations. Since XSDRN already
encompassed many of the features needed, it was selected as a basis for
modules in the new system. In this case, experience gained in the
original construction of XSDRN served to suggest that a more modular
approach would have been better with independent tasks being done in
separate, smaller, easier-to-manage programs. Therefore, the code was
split into NITAWL-II (for resonance self-shielding and some basic
cross-section data manipulation) and XSDRNPM (for spectral calculations
and cross-section collapsing). In retrospect, if the AMPX development
were initiated today, XSDRN would have been split even further, into
perhaps as many as six or seven programs.</p>
<p>The XSDRNPM module differs from XSDRN in several respects:</p>
<ul class="simple">
<li><p>It will perform coupled neutron-gamma calculations.</p></li>
<li><p>It allows any mixture to be represented to an arbitrary order of
anisotropic representation, whereas XSDRN only allowed through order
3.</p></li>
<li><p>It will perform an adjoint calculation, whereas the option was never
provided in XSDRN. In 2010, a generalized adjoint solution was also
added.</p></li>
<li><p>It is considerably more efficient in the manner in which data storage
is used and, hence, will run much larger problems in less core
storage.</p></li>
<li><p>It employs improved thermal flux scaling techniques for better
problem convergence.</p></li>
<li><p>Input specifications have been reordered, and more defaults have been
provided to make the use of this module easier.</p></li>
<li><p>It will calculate <span class="math notranslate nohighlight">\(S_n\)</span> constants for any order for any of the three
1-D geometries available.</p></li>
<li><p>Mixture-dependent fission spectra are calculated and used in XSDRNPM,
which takes into account all fissionable nuclides in a problem.</p></li>
</ul>
<p>AMPX was released in 1976, about the same time as the U.S. Nuclear
Regulatory Commission (NRC) support for the SCALE system was initiated.
Although separate versions of XSDRNPM were initially maintained for AMPX
and SCALE, in recent years the same version is used for the two systems.</p>
</div>
</div>
<div class="section" id="applications-in-scale">
<span id="id10"></span><h3>Applications in SCALE<a class="headerlink" href="#applications-in-scale" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM is used in several places in SCALE. In SAS1, XSDOSE uses fluxes
from a 1-D shielding calculation to determine a dose rate. Within the
CSAS5 and CSAS6 control modules, XSDRNPM is used in the sequences to
perform eigenvalue calculations and cell weighting of cross sections.
TSUNAMI-1D uses XSDRN to compute forward and adjoint fluxes
(fundamental-mode and generalized adjoint) for sensitivity and
uncertainty analysis.</p>
<div class="section" id="notes-on-the-use-of-various-spectral-calculational-options">
<span id="id11"></span><h4>Notes on the use of various spectral calculational options<a class="headerlink" href="#notes-on-the-use-of-various-spectral-calculational-options" title="Permalink to this headline">¶</a></h4>
<p>As noted earlier, four options are available in XSDRNPM for calculating
fluxes, k-effectives, etc.:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(S_n\)</span> theory,</p></li>
<li><p>diffusion theory,</p></li>
<li><p>infinite medium theory, and</p></li>
<li><p><span class="math notranslate nohighlight">\(B_n\)</span> theory.</p></li>
</ol>
<p>However, XSDRNPM is primarily an <span class="math notranslate nohighlight">\(S_n\)</span> code. The latter three options
are provided for reasons of completeness and are not nearly as optimized
as they would be in other codes for which these are the primary spectral
calculation options.</p>
<p>Without a very detailed calculational study, it is perhaps impossible to
be able to quantify the degree of adequacy or inadequacy of any of these
methods for performing a particular problem. However, some general
comments can be made which may provide some guidance with their
selection.</p>
<p>First, <span class="math notranslate nohighlight">\(S_n\)</span> theory is the most correct of the options and will solve a
larger class of problems. It is the most complicated and time-consuming
of the four, but it still runs very fast for most cases. There are
problems for which it (or some alternative method based on a solution of
the Boltzmann equation) is the only one of the four methods which is
adequate. Many shielding applications fall in this class. In
deep-penetration problems, anisotropic effects can dominate, thus
requiring an accurate treatment of the anisotropy of both flux and
cross section. It is well known that diffusion theory is not very
accurate when used to calculate systems involving regions of very
dissimilar cross-section values, such as is the case when control rods
are interspersed in a reactor core. Because of the anisotropy involved
in gamma-ray problems, <span class="math notranslate nohighlight">\(S_n\)</span> theory should be used.</p>
<p>Diffusion theory, on the other hand, is certainly the most successful of
the four methods in terms of the amount of use it has for designing
reactors, etc. In cases involving reasonably large, homogeneous regions,
it is generally adequate, such as is the case for a large class of
“reactor” applications. For most problems, the diffusion theory option
should run appreciably faster than <span class="math notranslate nohighlight">\(S_n\)</span> theory, since it has
essentially one equation to solve, versus number-of-angles equations for
<span class="math notranslate nohighlight">\(S_n\)</span> theory. This equation also can be explicitly solved using a
matrix inversion procedure, whereas the <span class="math notranslate nohighlight">\(S_n\)</span> theory requires a more
time-consuming iterative procedure. However, in many cases with large
numbers of groups (200 to 300), the greater fraction of the
calculational time can be spent calculating the scattering source terms,
which tends to lessen the impact of time spent on a more correct theory.
(This same observation can also be made of the infinite medium and
<span class="math notranslate nohighlight">\(B_n\)</span> method.)</p>
<p>The infinite medium option is the fastest of the four methods and can be
used safely to perform calculations for large homogeneous regions,
wherein the spectrum may be needed to collapse cross sections. This
option only determines the first moment of the flux, and is, therefore,
quite suspect for many applications, such as calculating diffusion
coefficients.</p>
<p>The <span class="math notranslate nohighlight">\(B_n\)</span> option shares many of the same restrictions as the
infinite-medium method; however, this treatment does (as its name
implies) use a buckling approximation to account for leakage from the
large homogeneous region, thereby giving higher order flux moments that
can be used, for example, to determine diffusion coefficients.</p>
</div>
</div>
<div class="section" id="selection-of-output-cross-section-library-formats">
<span id="id12"></span><h3>Selection of output cross-section library formats<a class="headerlink" href="#selection-of-output-cross-section-library-formats" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM will, on option, collapse cross sections and write the collapsed
sets into four different formats:</p>
<ol class="arabic simple">
<li><p>ANISN3 BCD Library,</p></li>
<li><p>ANISN3 Binary Library,</p></li>
<li><p>CCCC <a class="bibtex reference internal" href="#carmichael-standard-1974" id="id13">[Car74]</a> ISOTXS Library, or</p></li>
<li><p>AMPX <a class="bibtex reference internal" href="#wiarda-ampx-2000-2015" id="id14">[WWCD15]</a> Working Library.</p></li>
</ol>
<p>The choice of the output cross-section format is determined by the
computer code that will use the data. XSDRNPM always produces an AMPX
working library when cross sections are collapsed, and all other formats
are produced by reformatting data from this library. Therefore, for
archival purposes, if a collapsed library is to be saved, the working
format is the best choice, because it is the most general of those
provided. AMPX working libraries are used by all multi-group transport
codes currently in SCALE, including DENOVO (3D orthogonal mesh discrete
ordinates code), NEWT (2D arbitrary mesh discrete ordinates code), and
KENO and MONOCO (multigroup Monte Carlo codes. Stand-alone modules exist
for converting AMPX working libraries to the other formats.</p>
<p>ANISN formats are used by older ORNL transport codes such as ANISN (a
1-D discrete-ordinates code), by DORT/TORT <a class="bibtex reference internal" href="#rhoades-dot-iv-1979" id="id15">[RSCEJ79]</a> [two-dimensional (2-D)
and three dimensional (3D) discrete-ordinates codes], and by MORSE <a class="bibtex reference internal" href="#emett-morse-1975" id="id16">[Eme75]</a>
(a multigroup Monte Carlo code). The formats are quite comprehensive and
can handle coupled neutron-gamma calculations, arbitrary orders of
anisotropy, upscattering, etc. The major shortcoming of the format is
its lack of internal documentation as to its structure
(e.g., no provisions exist for specifying where a particular kind of
cross section is located in the library or even if it is included).
ANISN libraries can be produced in a free-form card-image BCD format or
in a binary form.</p>
<p>The CCCC (Committee on Computer Code Coordination) ISOTXS file is a
format for neutron cross sections that is one of several “standard
interfaces” developed to facilitate the exchange of data between
different computer codes. It is a self-defined format, which has
provisions for identifying cross sections in the library. Scattering
matrices can be supplied for elastic, inelastic, and (n,2n) scattering.</p>
</div>
</div>
<div class="section" id="theory-and-procedures">
<span id="id17"></span><h2>Theory and Procedures<a class="headerlink" href="#theory-and-procedures" title="Permalink to this headline">¶</a></h2>
<p>This section describes the models and procedures which are employed in
XSDRNPM.</p>
<div class="section" id="one-dimensional-discrete-ordinates-theory">
<span id="id18"></span><h3>One-dimensional discrete-ordinates theory<a class="headerlink" href="#one-dimensional-discrete-ordinates-theory" title="Permalink to this headline">¶</a></h3>
<p>The time-independent Boltzmann transport equation can be written:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-1">
<span class="eqno">(433)<a class="headerlink" href="#equation-eq9-1-1" title="Permalink to this equation">¶</a></span>\[\overset{\rightharpoonup}{\Omega} \bullet \nabla \psi(\overset{\rightharpoonup}{r}, E, \overset{\rightharpoonup}{\Omega})+\sum_{i}(\overset{\rightharpoonup}{r}, E) \psi(E, \overset{\rightharpoonup}{r}, \overset{\rightharpoonup}{\Omega})=S(\overset{\rightharpoonup}{r}, E, \overset{\rightharpoonup}{\Omega})\]</div>
<p>This expression is a balance condition that states simply that losses
due to leakage (first term) and collisions (second term) must equal the
source of neutrons, at some point in space <span class="math notranslate nohighlight">\(r\)</span>  energy E, and in direction
<span class="math notranslate nohighlight">\(\Omega\)</span> per unit volume and energy and solid angle. Other terms in the
expression are <span class="math notranslate nohighlight">\(\sum_{t}(r, E)\)</span> the total macroscopic cross section of the medium, which
is typically assumed isotropic, and the flux, <span class="math notranslate nohighlight">\(\psi(r, E, \Omega)\)</span>.</p>
<p>The source term <span class="math notranslate nohighlight">\(S(r, E, \Omega)\)</span> has three components:</p>
<ol class="arabic simple">
<li><p>a scattering source, <span class="math notranslate nohighlight">\(S(r, E, \Omega)\)</span>,</p></li>
<li><p>a fission source, <span class="math notranslate nohighlight">\(F(r, E, \Omega)\)</span>, and</p></li>
<li><p>a fixed source, <span class="math notranslate nohighlight">\(Q(r, E, \Omega)\)</span>.</p></li>
</ol>
<p>The scattering source is given by:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-2">
<span class="eqno">(434)<a class="headerlink" href="#equation-eq9-1-2" title="Permalink to this equation">¶</a></span>\[\left.S(r, E, \Omega)=\int_{0}^{4 \pi} d \Omega^{\prime} \int_{0}^{\infty} d E^{\prime} \sum_{s}\left(r, E^{\prime} \rightarrow E, \Omega^{\prime} \rightarrow \Omega\right) \psi\left(r, E^{\prime}, \Omega^{\prime}\right)\right).\]</div>
<p>The fission source term, typically, is written</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-3">
<span class="eqno">(435)<a class="headerlink" href="#equation-eq9-1-3" title="Permalink to this equation">¶</a></span>\[F(r, E, \Omega)=\frac{1}{4 \pi k} \chi(r, E) \int_{0}^{4 \pi} d \Omega^{\prime} \int_{0}^{\infty} d E^{\prime} v\left(r, E^{\prime}\right) \Sigma_{f}\left(r, E^{\prime}\right) \psi\left(r, E^{\prime}, \Omega^{\prime}\right) ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\sum_{s}\left(r, E^{\prime} \rightarrow E, \Omega^{\prime} \rightarrow \Omega\right)\)</span>
is the macroscopic scattering cross section per unit energy for
scattering from energy <em>E’</em> to <em>E</em>, <span class="math notranslate nohighlight">\(\chi(r, E)\)</span> is the fraction of the fission
neutrons per unit energy produced at <em>r</em> and E, <span class="math notranslate nohighlight">\(\upsilon(r, E)\)</span> is the average number of
neutrons produced per fission, <span class="math notranslate nohighlight">\(\sum_{f}(r, E)\)</span> is the macroscopic fission cross section
and k is the “effective multiplication constant.” Note that, as in the
case of the total cross-section value, <em>χ</em>, <em>Σf</em>, and <em>υ</em> are assumed
to be isotropic. XSDRN computes a weighted-averaged fission spectrum
based on the fissionable materials at <em>r</em>.</p>
<p>Three common coordinate systems are shown in <a class="reference internal" href="#fig9-1-1"><span class="std std-numref">Fig. 280</span></a>. XSDRNPM is a
1-D code, which means that in the case of the slab, it is calculating at
points along one axis where the system is assumed to extend to infinity
along the other two axes. If we assume a calculation along the x-axis,
this says that there is no leakage in the y or z directions, and our
directions by angles referenced to the x-axis. In the case of the
cylinder, the length (z-axis) is infinite and the calculation is for
points (shells) located at distance r from the central axis. For the
sphere, the calculation is of shells located at radius, r, from the
center of the spherical system.</p>
<p><a class="reference internal" href="#fig9-1-2"><span class="std std-numref">Fig. 281</span></a> illustrates the 1-D coordinate systems for slabs,
cylinders, and spheres. Note that the directions are cones in the case
of the slab and sphere, whereas in the case of the cylinder, the same
simple symmetries do not hold (a cone around the radius does not strike
the next cylindrical shell at the same distance from a point on a
radius) and the directions must be specifically described. Symmetries in
the 1-D cylinder, however, allow one to only describe directions for one
quadrant of the direction sphere about a point as will be noted in
<a class="reference internal" href="#id19"><span class="std std-ref">Multigroup one-dimensional Boltzmann equation</span></a>.</p>
<p>The 1-D geometries allow considerable simplification to be made to Eq. <a class="reference internal" href="#equation-eq9-1-1">(433)</a> ,
especially in the leakage term It is traditional to calculate the
angular flux as a function of angles expressed in direction-cosine
units; i.e., <em>μ</em> = cos <em>φ</em> and η = cos <em>ξ</em>. This requires
<em>ψ</em>(<em>x</em>,<em>E</em>,<em>μ</em>) for slabs, <em>ψ</em>(<em>x</em>,<em>E</em>,<em>μ</em>,<em>η</em>) for
cylinders and <em>ψ</em>(<em>r</em>,<em>E</em>,<em>μ</em>) for spheres. <a class="reference internal" href="#tab9-1-1"><span class="std std-numref">Table 311</span></a> gives
leakage terms expressed in conservation form for the three geometries.</p>
<span id="tab9-1-1"></span><table class="docutils align-center" id="id89">
<caption><span class="caption-number">Table 311 </span><span class="caption-text">One-dimensional leakage terms.</span><a class="headerlink" href="#id89" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Geometry</p></td>
<td><p><span class="math notranslate nohighlight">\(\overset{\rightharpoonup}{\Omega} \bullet \nabla \psi\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Slab</p></td>
<td><p><span class="math notranslate nohighlight">\(\mu \frac{\partial \psi}{\partial x}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Cylinder</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\mu}{r} \frac{\partial(r \psi)}{\partial r}-\frac{1}{r} \frac{\partial(\eta \psi)}{\partial \phi}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Sphere</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{\mu}{r^{2}} \frac{\partial\left(r^{2} \psi\right)}{\partial r}+\frac{1}{r} \frac{\partial\left[\left(1-\mu^{2}\right) \psi\right]}{\partial \mu}\)</span></p></td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="id90">
<span id="fig9-1-1"></span><a class="reference internal image-reference" href="_images/fig127.png"><img alt="_images/fig127.png" src="_images/fig127.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 280 </span><span class="caption-text">Three common coordinate systems.</span><a class="headerlink" href="#id90" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id91">
<span id="fig9-1-2"></span><a class="reference internal image-reference" href="_images/fig218.png"><img alt="_images/fig218.png" src="_images/fig218.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 281 </span><span class="caption-text">Three 1-D coordinate systems.</span><a class="headerlink" href="#id91" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="multigroup-one-dimensional-boltzmann-equation">
<span id="id19"></span><h3>Multigroup one-dimensional Boltzmann equation<a class="headerlink" href="#multigroup-one-dimensional-boltzmann-equation" title="Permalink to this headline">¶</a></h3>
<p>In multigroup schemes, the continuous-energy (CE) balance equations are
converted to multigroup form by first selecting an energy structure and
then writing a multigroup equivalent of the point equation which
requires multigroup constants that tend to preserve the reaction rates
that would arise from integrating the CE equations by group. First we
define the following multigroup values for g,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-4">
<span class="eqno">(436)<a class="headerlink" href="#equation-eq9-1-4" title="Permalink to this equation">¶</a></span>\[\psi_{g}(x, \mu)=\int_{g} d E \psi(x, E, \mu)\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-5">
<span class="eqno">(437)<a class="headerlink" href="#equation-eq9-1-5" title="Permalink to this equation">¶</a></span>\[\psi_{g}(x)=\int_{-1}^{1} d \mu \psi_{g}(x, \mu)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\Sigma_{t g}(x)=\frac{\int_{g} d E \Sigma_{t g}(x, E) W(x, E)}{\int_{g} d E W(x, E)} ,\]</div>
<p>where <em>W(x.E)</em> is the weighting function used to compute the multigroup
cross sections at a particular location. To rigorously conserve reaction
rates, the weight function should be angle-dependent, but this causes
the multigroup cross section to vary with direction; therefore the usual
approach is to represent the weight function by an approximation to the
scalar flux spectrum. In energy ranges where the CE cross sections have
fine-structure due to resonances, the multigroup data must be
self-shielded prior to the multigroup transport calculations.</p>
<p>The following multi-group form of 1-D equation can be derived for the slab case:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-6">
<span class="eqno">(438)<a class="headerlink" href="#equation-eq9-1-6" title="Permalink to this equation">¶</a></span>\[\mu \frac{\partial \psi_{g}(x, \mu)}{\partial x}+\sum_{t g}(x) \psi_{g}(x, \mu)=S_{g}(x, \mu)+F_{g}(x, \mu)+Q_{g}(x, \mu) .\]</div>
<p>The equations for the cylinder and sphere are essentially the same, in this
notation, except for the differences in the leakage terms from <a class="reference internal" href="#tab9-1-1"><span class="std std-numref">Table 311</span></a>.</p>
<p>In Eq. <a class="reference internal" href="#equation-eq9-1-6">(438)</a> , <em>S</em><sub>g</sub>, <em>F</em><sub>g</sub>, and <em>Q</em><sub>g</sub> are the scattering, fission, and
fixed sources, respectively. The scattering term is discussed in
<a class="reference internal" href="#id20"><span class="std std-ref">Scattering source term</span></a>. The multigroup form of the fission source is</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-7">
<span class="eqno">(439)<a class="headerlink" href="#equation-eq9-1-7" title="Permalink to this equation">¶</a></span>\[F_{g}(x, \mu)=\frac{\chi_{g}}{2 \pi k} \sum_{g^{\prime}} \overline{v \sum_{f g^{\prime}}}(x) \psi_{g^{\prime}}(x) ,\]</div>
<p>where <em>χ</em><sub>g</sub> is the fraction of the fission neutrons that are produced
in group g, and is the average of the product of <em>υ</em>, the average number
of neutrons produced per fission and Σ<sub>f</sub>, the fission cross section.</p>
</div>
<div class="section" id="scattering-source-term">
<span id="id20"></span><h3>Scattering source term<a class="headerlink" href="#scattering-source-term" title="Permalink to this headline">¶</a></h3>
<p>In discrete-ordinates theory, one typically calculates the Legendre
moments of the flux, <em>ψ</em><span class="math notranslate nohighlight">\(_{g,l}\)</span>, defined for slab and spherical geometries
by</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-8">
<span class="eqno">(440)<a class="headerlink" href="#equation-eq9-1-8" title="Permalink to this equation">¶</a></span>\[\psi_{g, l}=\frac{1}{2} \int_{-1}^{1} d \mu \psi_{g}(\mu) P_{1}(\mu) .\]</div>
<p>Cylindrical geometry has a similar expression containing spherical
harmonic functions rather than Legendre polynomials, shown in the next
section.</p>
<p>The group-to-group scattering coefficients are, themselves, fit with
Legendre polynomials, such that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-9">
<span class="eqno">(441)<a class="headerlink" href="#equation-eq9-1-9" title="Permalink to this equation">¶</a></span>\[\sigma\left(g^{\prime} \rightarrow g, \mu\right)=\sum_{l=0}^{I S C T} \frac{2 l+1}{2} \sigma_{l}\left(g^{\prime} \rightarrow g\right) P_{l}(\mu) .\]</div>
<p>In this example, we have a fit of order ISCT.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AMPX
cross-section libraries contain the 2<em>l</em> + 1 factor in the
<span class="math notranslate nohighlight">\(\sigma_{t}\left(g^{\prime} \rightarrow g\right)\)</span> matrix.</p>
</div>
<div class="section" id="slab-and-spherical-geometries">
<span id="id21"></span><h4>Slab and Spherical Geometries<a class="headerlink" href="#slab-and-spherical-geometries" title="Permalink to this headline">¶</a></h4>
<p>Because of the symmetries in 1-D slabs and spheres, only one angle is needed to
describe a “direction.”  In the case of the slab, the angle is taken with
reference to the x-axis, while for the sphere; it is with reference to a radius
vector between the point and the center of the sphere.  This means that the flux
can be expanded in ordinary Legendre polynomials, such that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-10">
<span class="eqno">(442)<a class="headerlink" href="#equation-eq9-1-10" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{l}
\psi(r, E, \mu)=\sum_{l=0}^{\infty} \psi_{l}(r, E) P_{l}(\mu) \\
\psi_{l}(r, E)=\int_{-1}^{1} \frac{d \mu}{2} P_{l}(\mu) \psi(r, E, \mu)
\end{array} .\end{split}\]</div>
<p>When Eq. <a class="reference internal" href="#equation-eq9-1-10">(442)</a> and Eq. <a class="reference internal" href="#equation-eq9-1-9">(441)</a>  are introduced into Eq. <a class="reference internal" href="#equation-eq9-1-2">(434)</a>,  the following
expression is derived for the scattering source:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-11">
<span class="eqno">(443)<a class="headerlink" href="#equation-eq9-1-11" title="Permalink to this equation">¶</a></span>\[S(r, E, \mu)=2 \pi P_{l}(\mu) \int_{0}^{\infty} d E^{\prime} \int_{-1}^{1} d \mu^{\prime} \sum_{l=0}^{I S C T} \frac{2 l+1}{2} \sum_{s_{l}}\left(r, E^{\prime} \rightarrow E\right) P_{l}\left(\mu^{\prime}\right) \psi_{l}\left(r, E^{\prime}\right)\]</div>
<p>where <em>ISCT</em> is the order of fit to the fluxes and cross sections.</p>
</div>
<div class="section" id="cylindrical-geometry">
<span id="id22"></span><h4>Cylindrical Geometry<a class="headerlink" href="#cylindrical-geometry" title="Permalink to this headline">¶</a></h4>
<p>The situation is more complicated in the case of the 1-D cylinder where the flux
(and cross section) must be given as a function of two angles.  Consider
<a class="reference internal" href="#fig9-1-3"><span class="std std-numref">Fig. 282</span></a>.</p>
<div class="figure align-center" id="id92">
<span id="fig9-1-3"></span><a class="reference internal image-reference" href="_images/fig317.png"><img alt="_images/fig317.png" src="_images/fig317.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 282 </span><span class="caption-text">One-dimensional cylindrical scattering coordinates.</span><a class="headerlink" href="#id92" title="Permalink to this image">¶</a></p>
</div>
<p>The addition theorem for associated Legendre polynomials can be used to
transform from scattering angle coordinates to the real coordinates required in
the cylindrical case:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-12">
<span class="eqno">(444)<a class="headerlink" href="#equation-eq9-1-12" title="Permalink to this equation">¶</a></span>\[P_{l}\left(\mu_{0}\right)=\sum_{n=-1}^{1} \frac{(l-n) !}{(l+n) !} P_{l}^{n}(\mu) P_{l}^{n}\left(\mu^{\prime}\right) e^{i n\left(\zeta-\zeta^{\prime}\right)} ,\]</div>
<p>where <em>μ</em><sub>0</sub> =  cos<em>θ0</em> ; <em>μ *= cos *θ</em> and
<em>μ′</em> = cos <em>θ′</em>.</p>
<p>If we note that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\sigma_{s}\left(r, E^{\prime} \rightarrow E, \Omega^{\prime} \rightarrow \Omega\right) &amp;=\sigma_{s}\left(r, E^{\prime} \rightarrow E\right), P_{l}\left(\Omega^{\prime} \bullet \Omega\right) \\
&amp;=\sigma_{s}\left(r, E^{\prime} \rightarrow E\right), P_{l}\left(\mu_{0}\right)
\end{aligned}\end{split}\]</div>
<p>Eq. <a class="reference internal" href="#equation-eq9-1-12">(444)</a> can be introduced into Eq. <a class="reference internal" href="#equation-eq9-1-2">(434)</a> to yield</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-13">
<span class="eqno">(445)<a class="headerlink" href="#equation-eq9-1-13" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{c}
S(r, E, \mu)=\int_{0}^{\infty} d E^{\prime} \int_{-1}^{1} d \mu^{\prime} \int_{0}^{2 x} d \zeta \psi\left(r, E^{\prime}, \mu^{\prime}, \zeta^{\prime}\right) \sum_{l=0}^{I S C T} \frac{2 l+1}{2} \sigma_{s_{l}}\left(r, E^{\prime} \rightarrow E\right) \\
\times \sum_{n=-1}^{l} \frac{(l-n) !}{(l+n) !} P_{l}^{n}(\mu) P_{l}^{n}\left(\mu^{\prime}\right) e^{i n\left(\zeta-\zeta^{\prime}\right)}
\end{array} .\end{split}\]</div>
<p>Now it is convenient to recall that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-14">
<span class="eqno">(446)<a class="headerlink" href="#equation-eq9-1-14" title="Permalink to this equation">¶</a></span>\[\cos x=\frac{e^{+i x}+e^{-i x}}{2} ,\]</div>
<p>which can be introduced into Eq. <a class="reference internal" href="#equation-eq9-1-13">(445)</a> and rearranged to give</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-15">
<span class="eqno">(447)<a class="headerlink" href="#equation-eq9-1-15" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
S(r, E, \mu)=&amp; \sum_{l=0}^{I S C T} \frac{2 l+1}{2} \int_{0}^{\infty} d E^{\prime} \sigma_{s_{l}}\left(r, E^{\prime} \rightarrow E\right)\left[P_{l}(\mu) \int_{-1}^{1} d \mu^{\prime} \int_{0}^{2 \pi} d \zeta \psi\left(r, E^{\prime}, \mu^{\prime}, \zeta^{\prime}\right) P_{l}\left(\mu^{\prime}\right)\right] \\
&amp;+\sum_{n=1}^{l} 2 \frac{(l-n) !}{(l+n) !} P_{l}^{n}(\mu)\left[\int_{-1}^{1} d \mu^{\prime} \int_{0}^{2 \pi} d \zeta \psi\left(r, E^{\prime}, \mu^{\prime}, \zeta^{\prime}\right) P_{l}^{n}\left(\mu^{\prime}\right) \cos \left[n\left(\zeta-\zeta^{\prime}\right)\right]\right]
\end{aligned} .\end{split}\]</div>
<p>We now define moments of the flux, <em>ψl</em> by</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-16">
<span class="eqno">(448)<a class="headerlink" href="#equation-eq9-1-16" title="Permalink to this equation">¶</a></span>\[\phi_{l}(r, E)=\int_{-1}^{1} d \mu^{\prime} \int_{0}^{2 \pi} d \zeta \psi\left(r, E, \mu^{\prime}, \zeta^{\prime}\right) P_{1}\left(\mu^{\prime}\right)\]</div>
<p>It is also convenient to make use of the trigonometric relationship</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-17">
<span class="eqno">(449)<a class="headerlink" href="#equation-eq9-1-17" title="Permalink to this equation">¶</a></span>\[\cos \left[n\left(\zeta-\zeta^{\prime}\right)\right]=\cos n \zeta \cos n \zeta^{\prime}+\sin n \zeta \sin n \zeta^{\prime} ,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\psi_{l}^{n}(r, E)=\sqrt{2 \frac{(l-n) !}{(l+n) !} \int_{-1}^{1} d \mu^{\prime}} \int_{0}^{2 \pi} d \zeta \psi\left(r, E, \mu^{\prime}, \zeta^{\prime}\right) P_{l}^{n}\left(\mu^{\prime}\right) \sin n \zeta^{\prime}\]</div>
<p>With a 1-D cylinder, the flux is symmetric in <em>ζ</em>; therefore, it is an
even function, and the terms involving sin n <em>ζ</em> will vanish. This
fact yields the following expression for Eq. <a class="reference internal" href="#equation-eq9-1-15">(447)</a> :</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-18">
<span class="eqno">(450)<a class="headerlink" href="#equation-eq9-1-18" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{c}
S(r, E, \mu)=\sum_{l=0}^{I S C T} \frac{2 l+1}{2} \int_{0}^{\infty} d E^{\prime} \sigma_{s_{l}}\left(r, E^{\prime} \rightarrow E\right) \\
\left.P_{l}(\mu) \psi_{l}\left(r, E^{\prime}\right)+\sum_{n=l}^{l} \sqrt{2 \frac{(l-n) !}{(l+n) !}} P_{n}^{l}(\mu) \cos n \zeta \psi_{l}^{n}(r, E)\right]
\end{array}\end{split}\]</div>
<p>We observe further that for an even function in <em>ζ</em>, the odd <em>l</em> and odd
(<em>l</em>-n) moments must all vanish, such that the following moments are
nonzero for various orders of scattering:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ISCT</p></th>
<th class="head"><p>Nonzero flux moments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\psi_{0}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(\psi_{0}\)</span>, <span class="math notranslate nohighlight">\(\psi_{1}^{1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p><span class="math notranslate nohighlight">\(\psi_{0}, \psi_{1}^{1}, \psi_{2}, \psi_{2}^{2}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p><span class="math notranslate nohighlight">\(\psi_{0}, \psi_{1}^{1}, \psi_{2}, \psi_{2}^{2}, \psi_{3}^{1}, \psi_{3}^{3}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p><span class="math notranslate nohighlight">\(\psi_{0}, \psi_{1}^{1}, \psi_{2}, \psi_{2}^{2}, \psi_{3}^{1}, \psi_{3}^{3}, \psi_{4}, \psi_{4}^{2}, \psi_{4}^{4}\)</span></p></td>
</tr>
</tbody>
</table>
<p>In general, [ISCT(ISCT + 4)/4] + 1 flux moments are required.</p>
</div>
</div>
<div class="section" id="discrete-ordinates-difference-equations">
<span id="id23"></span><h3>Discrete-ordinates difference equations<a class="headerlink" href="#discrete-ordinates-difference-equations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id24">
<h4>Discrete-ordinates difference equations<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>In formulating the <span class="math notranslate nohighlight">\(S_n\)</span> equations, several symbols are defined which
relate to a flux in an energy group g, in a spatial interval i, and in
an angle m.</p>
<p>Typically, the flux is quoted as an integral of the flux in an energy
group g, whose upper and lower bounds are <span class="math notranslate nohighlight">\(E_{g}^{U}\)</span> and <span class="math notranslate nohighlight">\(E_{g}^{L}\)</span> respectively.</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-19">
<span class="eqno">(451)<a class="headerlink" href="#equation-eq9-1-19" title="Permalink to this equation">¶</a></span>\[\psi_{g}=\int_{E_{g}^{L}}^{E_{g}^{U}} d E \psi(E) .\]</div>
<p>A mechanical quadrature is taken in space, typically IM intervals with
IM + 1 boundaries. Likewise, an angular quadrature is picked compatible
with the particular 1-D geometry, typically MM angles with associated
directional coordinates and integration weights.</p>
<p>The different equations are formulated in a manner which involves
calculating so-called angular fluxes, <em>ψ</em><sub>g,i,m</sub>  at each of the
spatial interval boundaries, and also cell-centered fluxes,
<span class="math notranslate nohighlight">\(\psi_{g, i+1 / 2, m}\)</span> at the centers of the spatial intervals. The
centered fluxes are related to the angular boundary fluxes by “weighted
diamond difference” assumptions as will be described below.</p>
<p>Units on angular fluxes are per unit solid angle <em>w</em><sub>m</sub> and per unit
area. Units on the centered fluxes are track length per unit volume of
the interval. In both cases the fluxes are integrated in energy over the
group g.</p>
<p>The areas and volumes for the three geometries are listed in <a class="reference internal" href="#tab9-1-2"><span class="std std-numref">Table 312</span></a></p>
<span id="tab9-1-2"></span><table class="docutils align-center" id="id93">
<caption><span class="caption-number">Table 312 </span><span class="caption-text">One-dimensional areas and volumes.</span><a class="headerlink" href="#id93" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Geometry</p></th>
<th class="head"><p>Area</p></th>
<th class="head"><p>Volume</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Slab</p></td>
<td><p>1.0</p></td>
<td><p><span class="math notranslate nohighlight">\(x_{i+1}-x_{i}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Cylinder</p></td>
<td><p><span class="math notranslate nohighlight">\(2 \pi r_{i}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\pi \left(r_{i+1}^{2}-r_{i}^{2}\right)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Sphere</p></td>
<td><p><span class="math notranslate nohighlight">\(4 \pi r^{2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(4/3 \pi \left(r_{i+1}^{3}-r_{i}^{3}\right)\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="discrete-ordinates-equation-for-a-slab">
<span id="id25"></span><h4>Discrete-ordinates equation for a slab<a class="headerlink" href="#discrete-ordinates-equation-for-a-slab" title="Permalink to this headline">¶</a></h4>
<p>Consider a spatial cell bounded by <em>(xi,xi+1)</em> and write the loss term
for flow through the cell in direction <em>μ</em><sub>m</sub>. The net flow in the
x-direction out the right side is the product of the angular flux times
the area times the solid angle times the cosine of the angle:</p>
<div class="math notranslate nohighlight">
\[w_{m} \mu_{m} A_{i+1} \psi_{g, i+1, m} .\]</div>
<p>The net loss from the cell is the difference between the flow over both boundaries:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-20">
<span class="eqno">(452)<a class="headerlink" href="#equation-eq9-1-20" title="Permalink to this equation">¶</a></span>\[w_{m} \mu_{m}\left(A_{i+1} \psi_{g, i+1, m}-A_{i} \psi_{g, i, m}\right) .\]</div>
<p>The loss in the spatial cell due to collisions is given by the product of the
centered angular flux (in per unit volume units) times the total macroscopic
cross section times the solid angle times the volume:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-21">
<span class="eqno">(453)<a class="headerlink" href="#equation-eq9-1-21" title="Permalink to this equation">¶</a></span>\[w_{m} \sigma_{g, i+1 / 2} V_{i} \psi_{g, i+1 / 2}, m .\]</div>
<p>The sources in direction <em>μ</em><sub>m</sub> are given by the product of the solid
angle times the interval volume times the volume-averaged source (sum of
fixed, fission, and scattering) in the direction m:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-22">
<span class="eqno">(454)<a class="headerlink" href="#equation-eq9-1-22" title="Permalink to this equation">¶</a></span>\[w_{m} V_{i} S_{g, i+1 / 2}, m .\]</div>
<p>The slab equation is obtained by using Eqs. <a class="reference internal" href="#equation-eq9-1-20">(452)</a>, <a class="reference internal" href="#equation-eq9-1-21">(453)</a>, and <a class="reference internal" href="#equation-eq9-1-22">(454)</a> and
substituting proper values for area and volume:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-23">
<span class="eqno">(455)<a class="headerlink" href="#equation-eq9-1-23" title="Permalink to this equation">¶</a></span>\[w_{m} \mu_{m}\left(\psi_{g, i+l, m}-\psi_{g, i, m}\right)+w_{m} \sigma_{g, i+1 / 2} \psi_{g, i+1 / 2, m}\left(x_{i+l}-x_{i}\right)=w_{m} S_{g, i+1 / 2^{\prime} m}\left(x_{i+l}-x_{i}\right) .\]</div>
<p>In an MM angle quadrature set, there are MM of these equations and they are
coupled through the assumption on how the cell-centered flux relates to the
boundary angular fluxes, the sources, and the boundary conditions, as will be
discussed later.</p>
</div>
<div class="section" id="discrete-ordinates-equations-for-sphere-and-cylinder">
<span id="id26"></span><h4>Discrete-ordinates equations for sphere and cylinder<a class="headerlink" href="#discrete-ordinates-equations-for-sphere-and-cylinder" title="Permalink to this headline">¶</a></h4>
<p>The development of the equations for these geometries is analogous to that for
the slab except that the leakage terms are more complicated.  Consider
<a class="reference internal" href="#fig9-1-4"><span class="std std-numref">Fig. 283</span></a>.</p>
<div class="figure align-center" id="id94">
<span id="fig9-1-4"></span><a class="reference internal image-reference" href="_images/fig412.png"><img alt="_images/fig412.png" src="_images/fig412.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 283 </span><span class="caption-text">Angular redistribution in spherical geometry.</span><a class="headerlink" href="#id94" title="Permalink to this image">¶</a></p>
</div>
<p>Recall that the directions are taken with reference to the radius vector
for a sphere. A particle traveling in direction <em>μ</em><sub>m</sub> at <em>r</em><sub>i`s will
intersect the radius vector to the next point *r*:sub:`i</sub><sub>+1</sub> at a
different angle <span class="math notranslate nohighlight">\(\mu_{m}^{*}\)</span>. The same effect also exists for the cylinder, though in
this case the direction coordinates are more complicated. Because of the
effect, a loss term is included for the “angular redistribution.” It is
defined in a manner analogous to Eq. <a class="reference internal" href="#equation-eq9-1-20">(452)</a> as</p>
<dl>
<dt>,.. math::</dt><dd><dl class="field-list simple">
<dt class="field-odd">label</dt>
<dd class="field-odd"><p>eq9-1-24</p>
</dd>
</dl>
<p>alpha_{i+1 / 2}, m+1 / 2 quad psi_{g, i+1 / 2, m+1 / 2}-alpha_{i+1 / 2, m-1 / 2} psi_{g, i+1 / 2, m-1 / 2}</p>
</dd>
</dl>
<p>where the <em>α</em> coefficients are to be defined in such a manner as to
preserve particle balance. In this case one speaks of m+1 and m−½ as the
corresponding angles to <em>μ</em><sub>m</sub> on the I + lth and ith boundaries,
respectively. (See <a class="reference internal" href="#fig9-1-5"><span class="std std-numref">Fig. 284</span></a>) Here we are interested in an angle
<em>μm</em> at the center of interval i which redistributes to <em>μ</em><sub>m−½</sub> at
boundary i and to <em>μ</em><sub>m+½</sub> at boundary I + 1.</p>
<div class="figure align-center" id="id95">
<span id="fig9-1-5"></span><a class="reference internal image-reference" href="_images/fig59.png"><img alt="_images/fig59.png" src="_images/fig59.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 284 </span><span class="caption-text">Angular redistribution.</span><a class="headerlink" href="#id95" title="Permalink to this image">¶</a></p>
</div>
<p>Obviously, it is necessary that the net effect of all redistributing be zero, in
order to maintain particle balance.  This condition is met if</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-25">
<span class="eqno">(456)<a class="headerlink" href="#equation-eq9-1-25" title="Permalink to this equation">¶</a></span>\[\sum_{m=1}^{M M} \alpha_{m-1 / 2} \psi_{m-1 / 2}+\alpha_{m+1 / 2} \psi_{m+1 / 2}=\alpha_{1 / 2} \psi_{1 / 2}+\alpha_{M M+1 / 2} \psi_{M M+1 / 2}=0 ,\]</div>
<p>where we have dropped the group and interval indexes.</p>
<p>In order to develop an expression for determining the α’s consider an infinite
medium with a constant isotropic flux.  In this case, there is no leakage and
the transport equation reduces to</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-26">
<span class="eqno">(457)<a class="headerlink" href="#equation-eq9-1-26" title="Permalink to this equation">¶</a></span>\[\sum_{t} \phi=S .\]</div>
<p>This condition requires that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-27">
<span class="eqno">(458)<a class="headerlink" href="#equation-eq9-1-27" title="Permalink to this equation">¶</a></span>\[\mu_{m} w_{m}\left(A_{i+1} \psi_{g, i+1, m}-A_{i} \psi_{g, i, m}\right)+\alpha_{i+1 / 2}, m+1 / 2 \quad \psi_{g, i+1 / 2}, m+1 / 2-\alpha_{i+1 / 2, m-1 / 2} \psi_{g, i+1 / 2, m-1 / 2}=0 ,\]</div>
<p>which when we note that all the <em>ψ</em> terms in the infinite medium case are equal becomes</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-28">
<span class="eqno">(459)<a class="headerlink" href="#equation-eq9-1-28" title="Permalink to this equation">¶</a></span>\[\mu_{m} w_{m}\left(A_{i+1}-A_{i}\right)=-\alpha_{m+1 / 2}+\alpha_{m-1 / 2} ,\]</div>
<p>which is a recursion relationship for α.</p>
<p>From Eq. <a class="reference internal" href="#equation-eq9-1-25">(456)</a> we see that the conservation requirement can be met if</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-29">
<span class="eqno">(460)<a class="headerlink" href="#equation-eq9-1-29" title="Permalink to this equation">¶</a></span>\[\alpha_{1 / 2}=\alpha_{M M+1 / 2}=0\]</div>
<p>for any values of flux, and is, therefore, used to evaluate the α’s along with
Eq. eq:<cite>eq9-1-27</cite> or eq:<cite>eq9-1-28</cite>.  (Note that had we included the redistribution term in
the slab equation, Eq. eq:<cite>eq9-1-28</cite> would have given zeroes for the terms, which is
as one would expect for this geometry.)</p>
<p>The final discrete-ordinates expression for spheres and cylinders is then
derived by summing expressions Eqs. eq:<cite>eq9-1-20</cite>, eq:<cite>eq9-1-24</cite>, eq:<cite>eq9-1-21</cite> and setting it
equal to expression Eq. eq:<cite>eq9-1-22</cite>.</p>
</div>
<div class="section" id="sn-quadratures-for-slabs">
<span id="id27"></span><h4><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for slabs<a class="headerlink" href="#sn-quadratures-for-slabs" title="Permalink to this headline">¶</a></h4>
<p>XSDRNPM will automatically calculate quadrature sets for each of the 1-D
geometries, or a user can, if he wants, input a quadrature.</p>
<p>In the case of the 1-D slab, the quadrature is a double Gauss-Legendre set based
on recommendations from <a class="bibtex reference internal" href="NEWT.html#carlson-discrete-1965" id="id28">[CL65]</a>.</p>
<p>The ordering of the directions for a slab is shown in <a class="reference internal" href="#fig9-1-6"><span class="std std-numref">Fig. 285</span></a>.</p>
<div class="figure align-center" id="id96">
<span id="fig9-1-6"></span><a class="reference internal image-reference" href="_images/fig67.png"><img alt="_images/fig67.png" src="_images/fig67.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 285 </span><span class="caption-text">Ordering of <span class="math notranslate nohighlight">\(S_n\)</span> directions for slabs and spheres.</span><a class="headerlink" href="#id96" title="Permalink to this image">¶</a></p>
</div>
<p>Note that in referring to the quadratures for any of the geometries, we do not
attempt to define an explicit area on a unit sphere, but rather speak of
characteristic directions with associated weights.  In the case of the slab, it
is convenient to think of “directions” which are shaped like cones, because of
the azimuthal symmetry around the x-axis.</p>
<p>In an nth order quadrature, there are n +1 angles with the first angle being
taken at  μ = -1.0.  This first angle is not required for the slab, but is needed
for the curvilinear geometries because of the angular redistribution terms, as
will be noted later.  It is included in the slab case for reasons of uniformity
of programming, etc.</p>
<p>Several requirements are made regarding the angles and weights in the quadrature set.</p>
<p>The arguments relating to angular redistribution can be expected to show that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-30">
<span class="eqno">(461)<a class="headerlink" href="#equation-eq9-1-30" title="Permalink to this equation">¶</a></span>\[\sum_{m=1}^{M M} \mu_{m} w_{m}=0.0 .\]</div>
<p>This situation is ensured if the weight of the <em>μ</em> = −1.0 direction is
zero and the other directions and weights are symmetric about <em>μ</em> = 0.
(The <em>μ</em> = 0 direction is never included in the quadrature set because
of its singularity.)</p>
<p>Further, it is required that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-31">
<span class="eqno">(462)<a class="headerlink" href="#equation-eq9-1-31" title="Permalink to this equation">¶</a></span>\[\sum_{m=1}^{M M} w_{m}=1.0 .\]</div>
<p>Due to the above normalization of the quadrature weights, the discrete
ordinates angular flux is not “per steradian” but rather “per
direction-weight”. The calculated angular flux can be converted to
steradians by dividing by 4π.</p>
</div>
<div class="section" id="sn-quadratures-for-spheres">
<span id="id29"></span><h4><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for spheres<a class="headerlink" href="#sn-quadratures-for-spheres" title="Permalink to this headline">¶</a></h4>
<p>The quadratures generated for spheres are Gauss-Legendre coefficients as
recommended by <a class="bibtex reference internal" href="#emett-morse-1975" id="id30">[Eme75]</a>.</p>
<p>The ordering and symmetry requirements for spheres are the same as for
slabs.</p>
<p>In the case of the sphere, the initial (<em>μ</em> = −1.0) direction is
required, because the difference equations involve three unknown values
for each direction, <em>μ</em><sub>m</sub>:<em>ψ</em><sub>m</sub> and the fluxes at the two
“redistributed” angles <em>ψ</em><sub>m</sub><sub>−½</sub> and <em>ψ</em><sub>m</sub><sub>+½</sub>. It is
obvious that an angle along the radius will not involve the
redistribution; hence, the expression for this direction involves only
<em>ψ</em>(<em>μ</em> = −1.0) as unknowns. Angle 2 proceeds by assuming
<em>ψ</em><sub>2−½</sub> is given by <em>ψ</em><sub>1</sub> and also uses a weighted
diamond difference model to relate <em>ψ</em><sub>m</sub>,<em>ψ</em> <sub>m</sub><sub>−½</sub> and
<em>ψ</em><sub>m</sub><sub>+½</sub>, as will be described below. Subsequent angles will
then have values for <em>ψ</em><sub>m</sub><sub>−½</sub> calculated by the previous angle
equations.</p>
</div>
<div class="section" id="sn-quadratures-for-cylinders">
<span id="id31"></span><h4><span class="math notranslate nohighlight">\(S_n\)</span> quadratures for cylinders<a class="headerlink" href="#sn-quadratures-for-cylinders" title="Permalink to this headline">¶</a></h4>
<p>The quadrature sets for cylinders are more complicated (see
<a class="reference internal" href="#fig9-1-2"><span class="std std-numref">Fig. 281</span></a>) because the directions must be specified with two angles,
<em>ζ</em> and <em>η</em> where <em>α</em> ≡ sin <em>η</em> cos <em>ζ</em> and <em>β</em> ≡ cos <em>η</em>.</p>
<p>In this case, practice is to use n/2 levels of directions for an
n<em>th</em> order set. The levels correspond to fixed values of <em>η</em>. The
number of angles by level starts with three in level 1, five in level 2,
seven in level 3, etc. (Note that since cylindrical geometry is
curvilinear, each level will start with a <em>η</em> = <em>π</em> direction that has
zero weight for reasons analogous to those given for the spherical case.
<a class="reference internal" href="#fig9-1-7"><span class="std std-numref">Fig. 286</span></a> shows the ordering of the directions for an
<em>S</em><sub>6</sub> quadrature set. Angles 1, 4, and 9 are the starting directions
(zero weight) for the levels.</p>
<div class="figure align-center" id="id97">
<span id="fig9-1-7"></span><a class="reference internal image-reference" href="_images/fig75.png"><img alt="_images/fig75.png" src="_images/fig75.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 286 </span><span class="caption-text">Ordering of the directions for an S<sub>6</sub> cylindrical set.</span><a class="headerlink" href="#id97" title="Permalink to this image">¶</a></p>
</div>
<p>In general, an n<em>th</em> order quadrature will contain n(n + 4)/4 angles.
The cosines, <em>μ</em>, and the weights are stored in two arrays internally in
the code; and, since the weights for the 1<em>st</em>, 4<em>th</em>, and
9<em>th</em> angles are zero, the cosines for the corresponding levels are
placed in these locations in the arrays.</p>
<p>The cylindrical sets are based on Gauss-Tschebyscheff schemes as
recommended by <a class="bibtex reference internal" href="#emett-morse-1975" id="id32">[Eme75]</a> with Gaussian quadratures in <em>β</em> and Tschebyscheff
quadratures in α.</p>
</div>
</div>
<div class="section" id="weighted-difference-formulation-for-discrete-ordinates-equations">
<span id="id33"></span><h3>Weighted-difference formulation for discrete-ordinates equations<a class="headerlink" href="#weighted-difference-formulation-for-discrete-ordinates-equations" title="Permalink to this headline">¶</a></h3>
<p>In order to solve the discrete-ordinates equations, an assumption is required concerning the
relationship of the various flux terms:  <span class="math notranslate nohighlight">\(\psi_{i, m}, \psi_{i+1, m}, \psi_{i+1 / 2, m}, \psi_{i, m-1 / 2}, \psi_{i+1, m-1 / 2}\)</span>.</p>
<p>The solution of the equations involves three major loops:  an outer loop over
energy groups, a loop over angles, and a loop over the spatial mesh.  The
spatial loop is made either from the origin to the outside boundary or from the
outside to the origin, depending on whether the angle is directed outward or
inward, respectively.</p>
<p>Two models are widely used for expressing flux relationships:  (1) the step
model and (2) the diamond-difference linear model.</p>
<p>The “step model” is a histogram model whereby one sets the centered flux value
to the appropriate boundary value, depending on which way the mesh sweep is
going.  If, for example, the sweep is to the right in space, then</p>
<div class="math notranslate nohighlight">
\[\psi_{i+1 / 2, m}=\psi_{i, m}\]</div>
<p>or if to the left,</p>
<div class="math notranslate nohighlight">
\[\psi_{i+1 / 2}, m=\psi_{i+1, m} .\]</div>
<p>Likewise, in angle:</p>
<div class="math notranslate nohighlight">
\[\psi_{\mathrm{i}+1 / 2}, m=\psi_{i+1, m-1 / 2} .\]</div>
<p>The step model involves a very crude approximation, but has the marked advantage
of helping to ensure positivity of flux values as long as scattering sources are
positive.</p>
<p>In the “diamond-difference” model, the centered fluxes are assumed linear with
the edge values:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c}
\psi_{i+1 / 2}=0.5\left(\psi_{i}+\psi_{i+1}\right) \\
\psi_{m}=0.5\left(\psi_{m-1 / 2}+\psi_{m+1 / 2}\right)
\end{array}\end{split}\]</div>
<p>Unfortunately, though the linear model is clearly a better model than
the step model, care must be taken by selecting a fine spatial mesh, or
the linear extrapolation can lead to negative flux values. In some
cases, the situation is so severe that it is impractical to take enough
mesh points to eliminate the problems. Because of these difficulties
XSDRNPM uses a different approach, as described below.</p>
<p>The weighted diamond difference model <a class="bibtex reference internal" href="#rhoades-new-1977" id="id34">[REJ77]</a> was developed in an attempt
to take advantage of the “correctness” of the linear model, while
retaining the positive flux advantages of the step model.</p>
<p>A solution in some <span class="math notranslate nohighlight">\(S_n\)</span> codes is to use the linear model in all cases
where positive fluxes are obtained and to revert to step model
otherwise. Unfortunately, this method leads to artificial distortions in
the fluxes.</p>
<p>Note that if one writes</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-32">
<span class="eqno">(463)<a class="headerlink" href="#equation-eq9-1-32" title="Permalink to this equation">¶</a></span>\[\psi_{i+1 / 2}=a \psi_{i}+(1-a) \psi_{i+1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-33">
<span class="eqno">(464)<a class="headerlink" href="#equation-eq9-1-33" title="Permalink to this equation">¶</a></span>\[\psi_{m}=b \psi_{m-1 / 2}+(1-b) \psi_{m+1 / 2}\]</div>
<p>that the same expression can be used to express linear or step model
(e.g., <em>a = b =</em> ½ is equivalent to linear, while a = b = 1.0 can be
used for the step model).</p>
<p>In the weighted model, the intention is to use the linear model when
fluxes are positive but to select values for a and b in the range</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-34">
<span class="eqno">(465)<a class="headerlink" href="#equation-eq9-1-34" title="Permalink to this equation">¶</a></span>\[1 / 2 \leq a \text { or } b \leq 1.0\]</div>
<p>that ensure positivity, if the source is positive.</p>
<p>At this point, it is convenient to rewrite the discrete-ordinates
expression in a simplified notation, without the obvious subscripts on
energy group, angle, etc.</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-35">
<span class="eqno">(466)<a class="headerlink" href="#equation-eq9-1-35" title="Permalink to this equation">¶</a></span>\[w \mu\left(A_{i+1} \psi_{i+1}-A_{i} \psi_{i}\right)+\alpha_{m+1 / 2} \psi_{m+1 / 2}-\alpha_{m-1 / 2} \psi_{m-1 / 2}+w \sigma V \psi=w V S .\]</div>
<p>Combining Eqs. <a class="reference internal" href="#equation-eq9-1-35">(466)</a> and <a class="reference internal" href="#equation-eq9-1-32">(463)</a> or <a class="reference internal" href="#equation-eq9-1-33">(464)</a> yields the following expressions for
<em>ψ</em><sub>l+1</sub> and <em>ψm</em><sub>+½</sub>:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-36">
<span class="eqno">(467)<a class="headerlink" href="#equation-eq9-1-36" title="Permalink to this equation">¶</a></span>\[\psi_{i+1}=\frac{S V+C_{2} \psi_{m-1 / 2}+\left[\mu A_{i}-(1-a) D_{1}\right] \psi_{i}}{a D}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-37">
<span class="eqno">(468)<a class="headerlink" href="#equation-eq9-1-37" title="Permalink to this equation">¶</a></span>\[\psi_{m+1 / 2}=\frac{S V+C_{1} \psi_{i}+\left[\frac{\alpha_{m-1 / 2}}{w}-(1-b) D_{2}\right] \psi_{m-1 / 2}}{b D} ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-38">
<span class="eqno">(469)<a class="headerlink" href="#equation-eq9-1-38" title="Permalink to this equation">¶</a></span>\[C_{1}=\mu\left[A_{i}+A_{i+1}\left(\frac{1}{\alpha}-1\right)\right]\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-39">
<span class="eqno">(470)<a class="headerlink" href="#equation-eq9-1-39" title="Permalink to this equation">¶</a></span>\[C_{2}=\frac{\alpha_{m-1 / 2}}{w}+\frac{\alpha_{m+1 / 2}}{w}\left(\frac{1}{b}-1\right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-40">
<span class="eqno">(471)<a class="headerlink" href="#equation-eq9-1-40" title="Permalink to this equation">¶</a></span>\[D=\Sigma V_{i}+\frac{\mu A_{i+1}}{a}+\frac{\alpha_{m+1 / 2}}{w b}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-41">
<span class="eqno">(472)<a class="headerlink" href="#equation-eq9-1-41" title="Permalink to this equation">¶</a></span>\[D_{1}=D-\frac{\mu A_{i+1}}{a}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-42">
<span class="eqno">(473)<a class="headerlink" href="#equation-eq9-1-42" title="Permalink to this equation">¶</a></span>\[D_{2}=D-\frac{\alpha_{m+1 / 2}}{w b} .\]</div>
<p>In determining a and b, the “theta-weighted” model uses arbitrary
multipliers <em>θ</em><sub>s</sub> on SV and <em>θ</em><sub>n</sub> on the
<em>C</em><sub>2</sub>ψm<sub>−½</sub> or <em>C</em><sub>1</sub><em>ψ</em><sub>i</sub> terms in Eqs. <a class="reference internal" href="#equation-eq9-1-36">(467)</a>  and <a class="reference internal" href="#equation-eq9-1-37">(468)</a>.
(In <a class="bibtex reference internal" href="#tomlinson-flux-1980" id="id35">[TREJ80]</a>, a thorough discussion is given on the history of using
different choices of <em>θs</em> and <em>θn</em> and the advantages and
disadvantages of each method.) In XSDRNPM, a value of 0.9 is used for
<em>θs</em> and <em>θn</em> following the practice in the DOT-IV code.7</p>
<p>For <em>ψ</em><sub>i</sub><sub>+1</sub> in Eq. <a class="reference internal" href="#equation-eq9-1-36">(467)</a> to be positive, the numerator should be
positive, thereby requiring</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-43">
<span class="eqno">(474)<a class="headerlink" href="#equation-eq9-1-43" title="Permalink to this equation">¶</a></span>\[\left[\mu A_{i}-(1-a) D_{1}\right] \psi_{i}&lt;S V+C_{2} \psi_{m-1 / 2} ,\]</div>
<p>which in the <em>θ</em>-weighted case becomes</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-44">
<span class="eqno">(475)<a class="headerlink" href="#equation-eq9-1-44" title="Permalink to this equation">¶</a></span>\[\left[\mu A_{i}-(1-a) D_{1}\right] \psi_{i}&lt;S V \theta_{s}+C_{2} \psi_{m-1 / 2} \theta_{n} .\]</div>
<p>A similar expression can be written for b using Eq. <a class="reference internal" href="#equation-eq9-1-37">(468)</a>.</p>
<p>For reasons of accuracy, it is desirable to use a = b = ½. Therefore,
when a or b is determined to be less than ½ it is automatically set to
½.</p>
</div>
<div class="section" id="boundary-conditions">
<span id="id36"></span><h3>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM allows a boundary condition to be specified for each of the two “outside” boundaries of its
1-D geometries. The options are the following:</p>
<p>1. Vacuum boundary ─ all angular fluxes that are directed inward at the
boundary are set to zero (e.g., at the left-hand boundary of slab,
<em>ψ</em>(μ &gt; 0) = 0, etc.).</p>
<p>2. Reflected boundary ─ the incoming angular flux at a boundary is set
equal to the outgoing angular flux in the reflected direction
(e.g., at the left-hand boundary of a slab),</p>
<div class="math notranslate nohighlight">
\[\psi_{i n}(\mu)=\psi_{\text {out}}(-\mu)\]</div>
<p>3. Periodic boundary ─ the incoming angular flux at a boundary is set
equal to the outgoing angular flux in the same angle at the opposite
boundary.</p>
<p>4. White boundary ─ the angular fluxes of all incoming angles on a
boundary are set equal to a constant value such that the net flow across
the boundary is zero, that is,</p>
<div class="math notranslate nohighlight">
\[\psi_{i n}=\frac{\sum_{m}^{o u t} w_{m} \mu_{m} \psi_{m}}{\sum_{m}^{i n} w_{m}\left|\mu_{m}\right|}\]</div>
<blockquote>
<div><p>This boundary condition is generally used as an outer-boundary
condition for cell calculation of cylinders and spheres that occur in
lattice geometries.</p>
</div></blockquote>
<p>5. Albedo boundary ─ this option is for the white boundary condition
except that a user-supplied group-dependent albedo multiplies the
incoming angular fluxes. This option is rarely used, as it is difficult
to relate to most practical situations.</p>
</div>
<div class="section" id="fixed-sources">
<span id="id37"></span><h3>Fixed sources<a class="headerlink" href="#fixed-sources" title="Permalink to this headline">¶</a></h3>
<p>Two types of inhomogeneous or fixed sources can be specified in XSDRNPM.</p>
<p>In the first case, an isotropic group-dependent volumetric source can be
specified for any or all spatial intervals in a system.</p>
<p>In the second case, an angle- and group-dependent boundary source can be
specified for any or all boundaries between spatial intervals in a
system, excepting the left-most boundary. In this case, one specifies
not a source but a flux condition on the boundary. If one uses the
“track length” definition for flux, it is easy to show that the flux
condition is related to a source condition by</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-45">
<span class="eqno">(476)<a class="headerlink" href="#equation-eq9-1-45" title="Permalink to this equation">¶</a></span>\[\psi_{m}^{s}=\frac{S_{m}}{\mu_{m}} .\]</div>
<p>(This equation says that an isotropic source on a boundary would be input as a constant divided by the cosine
of the direction.)</p>
<p>In conventional fixed-source calculations, the total fixed source in the system
can be normalized to an input parameter, XNF.  In the volumetric source case,
the source values will be normalized such that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-46">
<span class="eqno">(477)<a class="headerlink" href="#equation-eq9-1-46" title="Permalink to this equation">¶</a></span>\[X N F=\sum_{g=1}^{I G M} \sum_{i=1}^{I M} Q_{g, i} V_{i} ,\]</div>
<p>and in the boundary source case,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-47">
<span class="eqno">(478)<a class="headerlink" href="#equation-eq9-1-47" title="Permalink to this equation">¶</a></span>\[X N F=\sum_{g=1}^{I G M} \sum_{i=1}^{I M} A_{i+1} \sum_{m=1}^{M M} \mu_{m} \psi_{m}^{s}(g, i) w_{m} .\]</div>
<p>In the case where both volumetric and boundary sources are specified, the two
sums are normalized to XNF.</p>
<p>The fixed source for a generalized adjoint calculation corresponds to a
particular response ratio of interest.  The generalized adjoint equation only
has a solution for responses that are ratios of linear functionals of the flux,
and in this case the source will contain both positive and negative components.
These types of sources are described in more detail in ref:<cite>9-1-2-15-1</cite> and in
the SAMS chapter, in <em>Generalized Perturbation Theory</em>.</p>
</div>
<div class="section" id="dimension-search-calculations">
<span id="id38"></span><h3>Dimension search calculations<a class="headerlink" href="#dimension-search-calculations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id39">
<h4>Dimension search calculations<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h4>
<p>XSDRNPM has three options for searching for dimensions such that the
system will produce a specified effective multiplication factor,
<em>k</em><sub>eff</sub>. The options are selected by a parameter IEVT in the 1$ array
and are as follows:</p>
<ol class="arabic simple">
<li><p>zone width search (IEVT = 4),</p></li>
<li><p>outer radius search (IEVT = 5),</p></li>
<li><p>buckling search (IEVT = 6).</p></li>
</ol>
<p>By default, the search is made to produce a <em>k</em><sub>eff</sub> value of unity. For
<em>k</em><sub>eff</sub>’s other than unity, IPVT (3$ array) is set to unity and the
desired <em>k</em><sub>eff</sub> is input as PV (5* array).</p>
<p>Other input parameters which apply specifically to all search
calculations are in the 5* array and are EV, the starting eigenvalue
guess, EVM, the eigenvalue modifier, EQL, the eigenvalue convergence,
and XNPM, the new parameter modifier. These parameters are discussed in
more detail below.</p>
</div>
<div class="section" id="zone-width-search-ievt-4">
<span id="id40"></span><h4>Zone-width search (IEVT = 4)<a class="headerlink" href="#zone-width-search-ievt-4" title="Permalink to this headline">¶</a></h4>
<p>With this option, one can vary the width of any or all zones in a case.  Note
that it is also possible to change zone widths at different rates.</p>
<p>This option requires the inputting of a zone width modifier array (41*) which is
used to specify the relative movements of the zones according to the following
expression:</p>
<div class="math notranslate nohighlight">
\[\Delta Z_{j}^{f}=\Delta Z_{j}^{i}\left(1+E V^{*} Z M_{j}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta Z_{j}^{i}, \Delta Z_{j}^{f}\)</span> are the initial and final widths of zone j, respectively, <em>ZM</em><sub>j</sub>
is the zone width modifier for the zone (as input in the 41* array), and
EV is the final “eigenvalue” for the problem. Note that a zero value for
ZM will specify a fixed zone width. Negative values for ZM are allowed.</p>
</div>
<div class="section" id="outer-radius-search-ievt-5">
<span id="id41"></span><h4>Outer radius search (IEVT = 5)<a class="headerlink" href="#outer-radius-search-ievt-5" title="Permalink to this headline">¶</a></h4>
<p>With this option, all zones are scaled uniformly in order to make the
system attain the specified <em>k</em><sub>eff</sub>. The final zone widths are found by
multiplying the initial values by the final “eigenvalue:”</p>
<div class="math notranslate nohighlight">
\[Z_{j}^{f}=E V\left(Z_{j}^{i} / Z_{p}^{i}\right) .\]</div>
</div>
<div class="section" id="buckling-search-ievt-6">
<span id="id42"></span><h4>Buckling search (IEVT = 6)<a class="headerlink" href="#buckling-search-ievt-6" title="Permalink to this headline">¶</a></h4>
<p>This option is used to search for “transverse” dimensions that will
yield a specified <em>k</em><sub>eff</sub> for a system. This means that the search is
for the height for a 1-D cylinder or the y- and/or z-dimensions in a
1-D slab.</p>
<p>For this option, the final dimensions are given by</p>
<blockquote>
<div><p>DY = <em>DY</em><sub>0</sub> × EV,</p>
</div></blockquote>
<p>and</p>
<blockquote>
<div><p>DZ = <em>DZ</em><sub>0</sub> × EV,</p>
</div></blockquote>
<p>where <em>DY</em><sub>0</sub> , <em>DZ</em><sub>0</sub> are the initial dimensions input in the 5* array.</p>
</div>
<div class="section" id="search-calculation-strategy">
<span id="id43"></span><h4>Search calculation strategy<a class="headerlink" href="#search-calculation-strategy" title="Permalink to this headline">¶</a></h4>
<p>All the “dimension searches” use the same simple strategy. The
calculations start by using the input eigenvalue (EV from the 5* array)
to determine initial dimensions for the system. These dimensions allow
the code to calculate a <em>k</em><sub>eff</sub> . The eigenvalue modifier (EVM in the
5* array) is then used to change the dimensions as follows:</p>
<p>IOPT = 4 (Zone width search)</p>
<div class="math notranslate nohighlight">
\[\Delta Z_{j}^{f}=\Delta Z_{j}^{i}\left[1+(E V M+E V)^{*} Z M_{j}\right]\]</div>
<p>IOPT = 5 (Outer radius search)</p>
<div class="math notranslate nohighlight">
\[\Delta Z_{j}^{f}=(E V M+E V)\left(\Delta Z_{j}^{i}\right)\]</div>
<p>IOPT = 6 (Buckling search)</p>
<blockquote>
<div><p>DY = <em>DY</em><sub>0</sub> (EV + EVM)</p>
<p>DZ = <em>DZ</em><sub>0</sub> (EV + EVM).</p>
</div></blockquote>
<p>The new dimensions are then used in a new calculation which determines a
second <em>k</em><sub>eff</sub> value.</p>
<p>XSDRNPM searches for a unity value of <em>k</em><sub>eff</sub> by default; however, when
IPVT = 1 (3$ array), a nonunity value can be specified in PV (5* array)
and the search will be made on this value.</p>
<p>Once the two <em>k</em><sub>eff</sub>’s are known, which are based on eigenvalues of
EV and EV + EVM, respectively, a linear fit is used to project to the
next value for EV. This yields an expression of the form</p>
<div class="math notranslate nohighlight">
\[E V_{\text {next}}=E V M \frac{\left(P V-k_{1}\right)}{\left(k_{2}-k_{1}\right)}+E V ,\]</div>
<p>where <em>k</em><sub>1</sub> and <em>k</em><sub>2</sub> are the first and second value of <em>keff ,</em>
respectively. After this iteration, the procedure is to fit a quadratic
to the three most recent <em>k</em><sub>eff</sub> values in order to obtain an estimate
for the next EV.</p>
<p>The procedure continues until a relative convergence of EQL (5* array)
or better is obtained on EV.</p>
<p>To prevent oscillations in the search, extrapolations are limited by
XNPM, the new parameter modifier from the 5* array.</p>
</div>
</div>
<div class="section" id="alpa-search">
<span id="id44"></span><h3>Alpa Search<a class="headerlink" href="#alpa-search" title="Permalink to this headline">¶</a></h3>
<p>It is possible to make some of the searches described in <a class="reference internal" href="#id38"><span class="std std-ref">Dimension search calculations</span></a> in a more
“direct” fashion than the strategy described in <a class="reference internal" href="#id43"><span class="std std-ref">Search calculation strategy</span></a>.  XSDRNPM has
two such options:  (1) the alpha search and (2) a direct buckling search.  These
are described below.</p>
<div class="section" id="alpha-search">
<span id="id45"></span><h4>Alpha search<a class="headerlink" href="#alpha-search" title="Permalink to this headline">¶</a></h4>
<p>The time-dependent form of the Boltzmann equation is identical with Eq. <a class="reference internal" href="#equation-eq9-1-1">(433)</a>,
except for the inclusion of a time-gradient term on the left-hand side:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\mathrm{v}} \frac{\partial \psi(r, E, \Omega, t)}{\partial t} .\]</div>
<p>All other flux terms in the expression also would include the time (t) argument.</p>
<p>In some analyses it is reasonable to assume that the time variation of the flux
is exponential, that is,</p>
<div class="math notranslate nohighlight">
\[\psi(r, E, \Omega, t)=\psi(r, E, \Omega) e^{a t} .\]</div>
<p>When this variation is introduced into the expanded form of Eq. <a class="reference internal" href="#equation-eq9-1-1">(433)</a>, the
exponential terms all cancel leaving a leading term:</p>
<div class="math notranslate nohighlight">
\[\frac{\alpha}{\mathrm{v}} \psi(r, E, \Omega)\]</div>
<p>which is in the same form as the <em>Σ</em><sub>t</sub><em>ψ</em> term.</p>
<p>If one considers integrating over energy, angle, and space, the following expression can be derived:</p>
<div class="math notranslate nohighlight">
\[P-A-L-\alpha V=0\]</div>
<p>where</p>
<p>where</p>
<blockquote>
<div><p>P ≡ production in the system,</p>
<p>A ≡ absorptions in the system,</p>
<p>L ≡ leakage from the system,</p>
<p>V ≡ <span class="math notranslate nohighlight">\(\int_{0}^{\infty} d E \int_{0}^{4 \pi} d \overset{\rightharpoonup}{\Omega} \int_{s y s t e m} d \overset{\rightharpoonup}{r} \frac{\psi(\overset{\rightharpoonup}{r}, E, \overset{\rightharpoonup}{\Omega})}{\mathrm{v}}\)</span></p>
</div></blockquote>
<p>Since all terms other than α can be determined from a calculation, it is
possible to determine α directly, thereby avoiding a scheme like that
used for dimension searches. In the balance expression, the fission
component of the production term is adjusted for the case of a non-unity
<em>k</em><sub>eff</sub> value (IPVT = 1 in the 3$ array).</p>
<p>An α-search has several practical applications. If, for example, a
subcritical assembly is pulsed by a source, the time-dependence of the
flux is expected to die off exponentially. Another way to interpret the
α-search is as that amount of 1/v absorber which could be added or taken
away from a system in order to achieve criticality. This number could be
of interest when certain control materials are used, such as
<sup>10</sup><em>B</em><sub>5</sub> , which is a “1/v” material.</p>
</div>
<div class="section" id="direct-buckling-search">
<span id="id46"></span><h4>Direct-buckling search<a class="headerlink" href="#direct-buckling-search" title="Permalink to this headline">¶</a></h4>
<p>A “direct”-buckling search can be made using a procedure analogous to that
described in <a class="reference internal" href="#id45"><span class="std std-ref">Alpha search</span></a>.  Recall that the buckling is introduced in order
to represent a transverse leakage through the use of a <em>DB</em><sup>2</sup><em>ψ</em> term.
This suggests that the foregoing balance
expression be written:</p>
<div class="math notranslate nohighlight">
\[P-A-L-\alpha D B^{2} X=0 ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[X \equiv \int_{0}^{\infty} d E \int_{0}^{4 \pi} d \Omega \int_{\text {system }} d r \psi(r, E, \Omega) .\]</div>
<p>In this case, the diffusion coefficients, <em>D</em><sub>g</sub>, are determined from</p>
<div class="math notranslate nohighlight">
\[D_{g}=\frac{1}{3 \Sigma_{t r_{g}}} ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\Sigma_{t r_{g}}=\Sigma_{t_{g}}-\Sigma_{1_{g}} ,\]</div>
<p>and <em>Σ</em><sub>1</sub> is the within-group term from the
<em>P</em><sub>1</sub> scattering matrixes:</p>
<div class="math notranslate nohighlight">
\[\Sigma_{1_{\mathrm{g}}}=\sum_{t}\left(\mathrm{~g} \rightarrow \mathrm{g}^{\prime}\right) .\]</div>
<p>The original <em>B</em><sup>2</sup> value is determined as specified in
<a class="reference internal" href="#id49"><span class="std std-ref">Buckling correction</span></a>, and the α is the square of the search parameter, that
one multiplies by the original <em>B</em><sup>2</sup> value in order to determine
the final buckling and, hence, the dimensions of the system.</p>
</div>
</div>
<div class="section" id="iteration-and-convergence-tests">
<span id="id47"></span><h3>Iteration and convergence tests<a class="headerlink" href="#iteration-and-convergence-tests" title="Permalink to this headline">¶</a></h3>
<p>Two parameters are used to specify the required levels of convergence on
an XSDRNPM calculation. These are EPS and PTC, both given in the
5* array. The flux calculations proceed through a series of iterations
until either convergence is achieved or the specified iteration limit is
exceeded.</p>
<p>The basic iteration strategy in XSDRNPM is now described. The
discrete-ordinates difference equation is solved for the first angle and
the first energy group. This sweep generally is made from the last
interval boundary to the center of the system, and it uses the flux
guess supplied as part of the input along with the boundary conditions.
The second angle is then calculated, etc., until all angles in the
quadrature are treated. At the end of this sweep, new scalar fluxes for
the midpoints of all intervals have been determined. The angular sweep
continues until either the point scalar fluxes are converged to within
PTC or until the code makes IIM inner iterations. An exception to this
“inner iteration” pattern occurs on the first outer (defined below)
iteration whenever a fission density guess is used, instead of the flux
guess. In this case, the program uses 1-D diffusion theory to determine
a scalar flux value for all intervals and the angular sweeps are not
made until the second outer iteration. After the first group is
completed, the calculation goes to the second group and repeats the
above procedure. This continues until all groups have been treated.</p>
<p>The pass through all groups, angles, and intervals is called an outer
iteration. Most of the convergence checks on the outer iteration have to
do with reaction rates involving all energy groups and are made against
the EPS parameter mentioned above. For a coupled neutron-gamma problem,
outer iterations are only performed for the neutron groups until
convergence is achieved, then the final converged pass is made over all
groups. In discussing these checks, it is convenient to define several
terms:</p>
<p>Q ≡ total fixed source in the system</p>
<p>F ≡ total fission source in the system</p>
<p>D ≡ total outscatter rate in the system</p>
<p>D ≡ <span class="math notranslate nohighlight">\(\sum_{i}^{intervals} \sum_{g}^{groups } \sum^{groups}_{\mathrm{g}^{\prime} \neq \mathrm{g}} \psi_{i, g} \sigma_{g \rightarrow g^{\prime}} \mathrm{V}_{\mathrm{i}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\psi_{i, g}\)</span> ≡ scalar flux in intervals i and group g</p>
<p><span class="math notranslate nohighlight">\(\sigma_{g \rightarrow g^{\prime}}\)</span> ≡ macroscopic scattering cross section from group g to group</p>
<p><span class="math notranslate nohighlight">\(\mathrm{V}_{\mathrm{i}}\)</span> ≡ volume of interval i</p>
<p>k ≡ outer iteration number</p>
<p>IGM ≡ total number of energy groups</p>
<p><span class="math notranslate nohighlight">\(\lambda_{k}\)</span> ≡ <span class="math notranslate nohighlight">\(\frac{Q+F_{k}}{Q+F_{k-1}}\)</span></p>
<p><span class="math notranslate nohighlight">\(G_{k}\)</span> ≡ <span class="math notranslate nohighlight">\(\frac{D_{k}}{Q+F_{k}}\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{k}^{\prime}\)</span> ≡ <span class="math notranslate nohighlight">\(\frac{G_{k-1}}{G_{k}}\)</span></p>
<p><span class="math notranslate nohighlight">\(U_{k}\)</span> ≡ total upscatter rate = <span class="math notranslate nohighlight">\(\sum_{i} \sum_{g} \sum_{g^{\prime}&lt;g} \psi_{i, g} \sigma_{g \rightarrow g^{\prime}} \mathrm{V}_{i}\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{k}^{\prime \prime}\)</span> ≡ <span class="math notranslate nohighlight">\(U_{K} / U_{k-1}, U_{k-1} \neq 0_{j}=1, U_{k-1}=0\)</span></p>
<p>An inner iteration in XSDRNPM consists of sweeping one time through the
entire spatial mesh for all the <em>S</em><sub>n</sub> angles for one energy group. When
the fluxes for a particular group are being calculated, inner iterations
(j) will continue until (a) the number of inner iterations for this
outer iteration exceeds IIM (the inner iteration maximum) or (b) until</p>
<ol class="arabic">
<li><div class="math notranslate nohighlight">
\[\max _{i}\left|\frac{\psi_{i, g}^{j}-\psi_{i, g}^{j-1}}{\psi_{i, g}^{j}}\right| \leq P T C\]</div>
</li>
</ol>
<p>At the end of an outer iteration, the following checks are made:</p>
<ol class="arabic" start="2">
<li><div class="math notranslate nohighlight">
\[\left|1.0-\lambda_{k}\right| \leq E P S\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[R\left|1.0-\lambda_{k}^{\prime}\right| \leq E P S\]</div>
</li>
<li><div class="math notranslate nohighlight">
\[R\left|1.0-\lambda_{k}^{\prime \prime}\right| \leq E P S\]</div>
</li>
</ol>
<p>R is a convergence relaxation factor and is set internally to 0.5 in XSDRNPM.
If all convergence criteria are met, if ICM (the outer iteration maximum) is
reached, or if ITMX (the maximum execution time) is exceeded, the problem will
be terminated with full output; otherwise, another outer iteration will be
started.</p>
</div>
<div class="section" id="group-banding-scaling-rebalance">
<span id="id48"></span><h3>Group banding (scaling rebalance)<a class="headerlink" href="#group-banding-scaling-rebalance" title="Permalink to this headline">¶</a></h3>
<p>As described above, the normal mode of operation in XSDRNPM is to do inner
iterations on a group until it converges, then go to the next group.  For groups
where there is no upscatter, the scattering source to a group depends only on
higher energy groups for which the fluxes have already been calculated.  A fixed
source problem with no fission and no upscattering can, therefore, be converged
in one outer iteration.  Since fission sources and upscattering sources are
calculated with fluxes from the previous outer iteration, multiple outer
iterations must be done to converge problems involving these kinds of sources.
For problems involving many fine thermal groups (groups with both upscatter and
downscatter), a special convergence problem arises.  Because the groups are
fine, within-group scattering is small and the flux calculation is dominated by
scattering sources from other groups.  This situation leads to a very slow
reduction in scattering source errors from one outer iteration to the next.
XSDRNPM has a special “group banding” option for treating this problem.  It
involves collecting several groups together into a band and doing one inner for
each group in the band while collecting particle balance information.  This
balance information is then used to solve for one set of flux rebalance factors
to apply to each group in the band.  Because the band is much wider than an
individual group, the scattering that remains within the band is a much larger
fraction of the total scattering source for the band.  This condition leads to
considerably faster convergence from one outer iteration to the next.  The group
banding option in XSDRNPM is triggered by the seventh entry in the 2$ array.
The absolute value of this entry indicates the number of bands to be used.  If
the number is negative, these bands are only for the thermal groups.  Normally
there is no need to band together groups other than the thermal groups.  An
entry of 1 indicates that all the thermal groups will be treated as one band.
This mode is one that is used successfully for many problems, but occasionally
will cause a problem to not converge.  For these problems using two or three
bands for the thermal groups has been successful.</p>
<p>The code generates a default banding structure, but this structure can be
overridden by inputting a 52$ array.</p>
</div>
<div class="section" id="buckling-correction">
<span id="id49"></span><h3>Buckling correction<a class="headerlink" href="#buckling-correction" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM allows “buckling” corrections to be made for the transverse
(non-calculated) dimensions in its 1-D slab and cylindrical geometries.  Three
input parameters-DY, DZ, and BF (5* array)-may be involved.</p>
<p>In the case of the 1-D slab, the height DY and the width DZ can be input.  The
buckling correction uses an expression based on asymptotic diffusion theory to
account for leakage in the transverse direction and is treated analogous to an
absorption cross section, that is,</p>
<blockquote>
<div><p>Transverse Leakage <span class="math notranslate nohighlight">\(=D B^{2} \psi\)</span></p>
</div></blockquote>
<p>where B is the geometric buckling and is given by</p>
<div class="math notranslate nohighlight">
\[B^{2}=\left(\frac{\pi}{Y}\right)^{2}+\left(\frac{\pi}{Z}\right)^{2}\]</div>
<p>and Y and Z are the height and width of the slab, respectively, and include extrapolation distances.</p>
<p>Recall that the “extrapolation distance” is defined as the linear
extrapolation distance such that if one extrapolated to a zero flux
value at this distance from the boundary, the interior flux shape in the
body would be correctly represented. The distance can be shown to occur
at 0.71 <em>λ</em><sub>tr</sub>, where <em>λ</em><sub>tr</sub> is the transport mean free path given
by 1/Σ<sub>tr</sub>. Note that for a slab, there are two extrapolation
distances to include (one on either side) for the height and width, such
that</p>
<div class="math notranslate nohighlight">
\[Y=D Y+1.42 \lambda_{t r} ,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\mathrm{Z}=\mathrm{DZ}+1.42 \lambda_{t r} .\]</div>
<p>The 1.42 factor (= 2 <em>X</em> 0.71) is input in the BF parameter of the
5* array.</p>
<p>In calculating <em>λ</em><sub>tr</sub>, a transport cross section, <em>Σ</em><sub>tr</sub>, is
determined from</p>
<div class="math notranslate nohighlight">
\[\Sigma_{t r}=\Sigma_{t}-\Sigma_{s 1}\]</div>
<p>which varies as a function of energy group and zone. The
Σ<sub>s1</sub> term is the within-group term from the
<em>P</em><sub>1</sub> scattering matrix.</p>
<p>In the case of the 1-D cylinder, the procedure is the same as for the slab
except that the buckling is determined from</p>
<div class="math notranslate nohighlight">
\[B^{2}=\left(\frac{\pi}{Y}\right)^{2} ,\]</div>
<p>since only one transverse dimension is needed.</p>
<p>The diffusion coefficient in the leakage term is determined from</p>
<div class="math notranslate nohighlight">
\[D=\frac{1}{3 \Sigma_{t r}}\]</div>
<p>Note that when comparing with codes or treatments using a fixed value of
buckling for every group, a user can force this situation in XSDRNPM by
inputting a zero value for BF and DZ and setting DY to determine the required
buckling value.</p>
</div>
<div class="section" id="void-streaming-correction">
<span id="id50"></span><h3>Void streaming correction<a class="headerlink" href="#void-streaming-correction" title="Permalink to this headline">¶</a></h3>
<p>In real slab and cylindrical geometries, void regions offer streaming
paths that are nonexistent in the 1-D cases with quadratures that do not
include a vertical angle. A correction for this effect has been
suggested by Olsen <a class="bibtex reference internal" href="#olsen-void-1965" id="id51">[Ols65]</a>, who uses an adjustment to the absorption
cross section to account for the transverse leakage.</p>
<p>If one considers a slab of height H, the void streaming correction is
introduced through an adjustment to the total cross section and is given
by</p>
<div class="math notranslate nohighlight">
\[\frac{\sqrt{1-\mu_{m}^{2}}}{H / 2} ,\]</div>
<p>where <em>μ</em><sub>m</sub> is the cosine of the direction.</p>
<p>In the case of a cylinder of height H, the adjustment is</p>
<div class="math notranslate nohighlight">
\[\frac{\mu_{m}}{H / 2} .\]</div>
<p>These streaming corrections are very approximate and do not properly
account for the fact that the streaming is enhanced near the ends of a
void channel; however, they are probably better than the alternative,
which is to make no correction at all.</p>
</div>
<div class="section" id="cross-section-weighting">
<span id="id52"></span><h3>Cross-section weighting<a class="headerlink" href="#cross-section-weighting" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM weights cross sections according to the following four options:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>“Cell” weighting,</p></li>
<li><p>“Zone” weighting,</p></li>
<li><p>“Region” or “vein” weighting, and</p></li>
<li><p>“Inner cell” weighting.</p></li>
</ol>
</div></blockquote>
<p>In all cases the “averaged” cross sections are defined in a manner that conserves reaction rates, that is,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-48">
<span class="eqno">(479)<a class="headerlink" href="#equation-eq9-1-48" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G} \int_{\text {space }} d r N_{D}(r) \int_{G} d E \psi(E, r)=\int_{\text {space }} d r N(r) \int_{G} d E \sigma(E, r) \psi(E, r) ,\]</div>
<p>where</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\bar{\sigma}_{G}\)</span> ≡ average cross section in group G,</p>
<p><span class="math notranslate nohighlight">\(N_{D}(r)\)</span> ≡ number density used in the definition for the weighting option
selected,</p>
<p><span class="math notranslate nohighlight">\(\psi(E, r)\)</span> ≡ weighting spectrum,</p>
<p><span class="math notranslate nohighlight">\(N(r)\)</span> ≡ real number density as a function of spatial position,</p>
<p><span class="math notranslate nohighlight">\(\sigma(E, r)\)</span> ≡ cross section in unreduced form.</p>
</div></blockquote>
<p>If we convert to multigroup notation and use W for the weighting
spectrum (instead of <em>ψ</em>), Eq. <a class="reference internal" href="#equation-eq9-1-48">(479)</a>  becomes</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-49">
<span class="eqno">(480)<a class="headerlink" href="#equation-eq9-1-49" title="Permalink to this equation">¶</a></span>\[\begin{split} {\overline{\sigma}}_{G}\mathrm{\mspace{6mu}}\sum_{j}^{\begin{matrix}
 \text{applicable} \\
 \text{spatial} \\
 \text{regions} \\
 \end{matrix}}{N_{D}^{j}\mathrm{\mspace{6mu}}\sum_{\text{gε}\mathrm{\,}G}^{}W_{g}^{j}}\mathrm{\quad} = \mathrm{\quad}\sum_{j}^{\begin{matrix}
 \text{applicable} \\
 \text{spatial} \\
 \text{regions} \\
 \end{matrix}}{N_{}^{j}\mathrm{\mspace{6mu}}\sum_{\text{gε}\mathrm{\,}G}^{}{\sigma_{g}^{j}W_{g}^{j}}\mathrm{\mspace{6mu}},}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-50">
<span class="eqno">(481)<a class="headerlink" href="#equation-eq9-1-50" title="Permalink to this equation">¶</a></span>\[W_{g}^{j} \equiv \int_{j} d r \int_{g} d E \psi(E, r)\]</div>
<div class="section" id="cell-weighting">
<span id="id53"></span><h4>“Cell Weighting”<a class="headerlink" href="#cell-weighting" title="Permalink to this headline">¶</a></h4>
<p>Cell weighting is consistent with homogenizing the cross sections in a
heterogeneous cell.  This is the recommended option to prepare cross sections
for a real reactor calculation that will be made with a  2- or 3-D model of the
reactor.  Most of these codes have no provisions for explicitly representing
individual fuel pins which are interspersed in a moderator region.</p>
<p>Cell-weighted cross sections are defined in a manner that attempts to preserve
the reaction rates which occur in a representative cell from the reactor.  In
Eq. <a class="reference internal" href="#equation-eq9-1-49">(480)</a> the weighting involves the following substitution:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-51">
<span class="eqno">(482)<a class="headerlink" href="#equation-eq9-1-51" title="Permalink to this equation">¶</a></span>\[N_{D}^{j} \equiv \bar{N}=\frac{\sum_{j}^{c e l l} V^{j} N^{j}}{\sum_{j}^{c e l l} V^{j}}\]</div>
<p>where</p>
<blockquote>
<div><p><em>V</em> <sub>j</sub> ≡ volume of zone j.</p>
</div></blockquote>
</div>
<div class="section" id="zone-weighting">
<span id="id54"></span><h4>“Zone” weighting<a class="headerlink" href="#zone-weighting" title="Permalink to this headline">¶</a></h4>
<p>Zone weighting is the simplest of the three XSDRNPM weighting options.
Each zone produces a unique set of cross sections which preserves
reaction rates for the zone. In Eq. <a class="reference internal" href="#equation-eq9-1-49">(480)</a>, the spatial sum is over the zone
considered, and <em>N</em> <sub>j</sub> <span class="math notranslate nohighlight">\(N_{D}^{j}\)</span> and are unity.</p>
<p>Zone weighting is used very frequently, especially for problems whose
collapsed cross sections are to be used in a problem whose geometrical
and material layout is similar to that in the weighting problem.</p>
</div>
<div class="section" id="region-weighting">
<span id="id55"></span><h4>“Region” weighting<a class="headerlink" href="#region-weighting" title="Permalink to this headline">¶</a></h4>
<p>“Region-” or “vein-” weighted cross sections are weighted
“where-the-nuclide-is.” In most problems, there are nuclides of
secondary importance which do not need a separate “zone-weighted” set
for every region in which the nuclide occurs. Examples are the
components of stainless steel. Stainless steel is encountered in a
variety of locations and flux environments, but generally one set of
cross sections for iron, chromium, manganese, nickel, etc., will suffice
for most reactor calculations.</p>
<p>In Eq. <a class="reference internal" href="#equation-eq9-1-49">(480)</a>, the spatial sum is over all zones which contain the nuclide of
interest with</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-52">
<span class="eqno">(483)<a class="headerlink" href="#equation-eq9-1-52" title="Permalink to this equation">¶</a></span>\[N_{D}^{j}=N^{j}\]</div>
</div>
<div class="section" id="inner-cell-weighting">
<span id="id56"></span><h4>“Inner-cell” weighting<a class="headerlink" href="#inner-cell-weighting" title="Permalink to this headline">¶</a></h4>
<p>For inner-cell weighting, cell weighting is performed over specified
innermost regions in the problem. Nuclides outside these regions are not
weighted.</p>
<p>This option is generally employed as follows: A “cell” is described in
exactly the same manner as for cell weighting (<a class="reference internal" href="#id53"><span class="std std-ref">“Cell Weighting”</span></a>) except
that in this case it is surrounded by a homogeneous representation for
the remainder of the core and by blankets, reflectors, etc. The flux
calculation is made over this complete system, which should have a more
realistic treatment of the leakage across the outer boundary of the
interior cell. The cell weighting is subsequently made only over the
interior cell.</p>
</div>
<div class="section" id="multigroup-weighting-equations">
<span id="id57"></span><h4>Multigroup weighting equations<a class="headerlink" href="#multigroup-weighting-equations" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Cell weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-53">
<span class="eqno">(484)<a class="headerlink" href="#equation-eq9-1-53" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G} \equiv \frac{\sum_{j}^{I Z M} N^{j} \sum_{g \varepsilon G} \sigma_{g}^{j} W_{g}^{j}}{\bar{N} \sum^{IZM}_{j} \sum_{g \varepsilon G} W_{g}^{j}}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-54">
<span class="eqno">(485)<a class="headerlink" href="#equation-eq9-1-54" title="Permalink to this equation">¶</a></span>\[\bar{N} \equiv \frac{\sum_{j}^{I Z M} V^{j} N^{j}}{\sum_{j}^{I Z M} V^{j}}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-55">
<span class="eqno">(486)<a class="headerlink" href="#equation-eq9-1-55" title="Permalink to this equation">¶</a></span>\[W_{g}^{j} \equiv \psi_{g}^{j}=\int_{j} \psi_{g}(r) d r .\]</div>
<ol class="arabic simple" start="2">
<li><p>Zone weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-56">
<span class="eqno">(487)<a class="headerlink" href="#equation-eq9-1-56" title="Permalink to this equation">¶</a></span>\[\overline{\sigma_{G}^{j}} \equiv \frac{\sum_{g \varepsilon G} \sigma_{g}^{j} W_{g}^{j}}{\sum_{g \varepsilon G} W_{G}^{j}} .\]</div>
<ol class="arabic simple" start="3">
<li><p>Region weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-57">
<span class="eqno">(488)<a class="headerlink" href="#equation-eq9-1-57" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G} \equiv \frac{\sum_{j} N^{j} \sum_{g \varepsilon G} \sigma_{g}^{j} W_{g}^{j}}{\sum_{j} N^{j} \sum_{g \varepsilon G} W_{g}^{j}} .\]</div>
</div>
<div class="section" id="transfer-matrices">
<span id="id58"></span><h4>Transfer matrices<a class="headerlink" href="#transfer-matrices" title="Permalink to this headline">¶</a></h4>
<p>Collapsing transfer matrices is not quite so simple as collapsing cross sections
with a single value per group.  A group-to-group term in the broad group sense
conserves the scattering rate from one group to the other, that is,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-58">
<span class="eqno">(489)<a class="headerlink" href="#equation-eq9-1-58" title="Permalink to this equation">¶</a></span>\[\bar{N}^{*} \bar{\sigma}\left(G \rightarrow G^{\prime}\right) \psi_{G} \equiv \int_{\text {space}} d r N(r) \int_{g} d E \psi(E, r) \int_{g^{\prime}} d E^{\prime} \sigma\left(E \rightarrow E^{\prime}\right)\]</div>
<p>where the asterisk (*) denotes that the number density on the left side
of the equation is consistent with the weighting desired. Therefore, the
multigroup forms of the weighting equations for components of the
transfer matrices are as follows:</p>
<ol class="arabic simple">
<li><p>Cell weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-59">
<span class="eqno">(490)<a class="headerlink" href="#equation-eq9-1-59" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G \rightarrow G^{\prime}} \equiv \frac{\sum_{j}^{I Z M} N^{j} \sum_{g \varepsilon G} W_{g}^{j} \sum_{g^{\prime} \varepsilon G^{\prime}} \sigma^{j}\left(g \rightarrow g^{\prime}\right)}{\bar{N} \sum_{j}^{IZM} \sum_{g \varepsilon G} W_{g}^{j}}\]</div>
<ol class="arabic simple" start="2">
<li><p>Zone weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-60">
<span class="eqno">(491)<a class="headerlink" href="#equation-eq9-1-60" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G \rightarrow G^{\prime}} \equiv \frac{\sum_{g \varepsilon G} W_{g}^{j} \sum_{g^{\prime} \varepsilon G^{\prime}} \sigma^{j}\left(g \rightarrow g^{\prime}\right)}{\sum_{g \varepsilon G} W_{g}^{j}} .\]</div>
<ol class="arabic simple" start="3">
<li><p>Region weighting</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-61">
<span class="eqno">(492)<a class="headerlink" href="#equation-eq9-1-61" title="Permalink to this equation">¶</a></span>\[\bar{\sigma}_{G \rightarrow G^{\prime}} \equiv \frac{\sum_{j} N^{j} \sum_{g \varepsilon G} W_{g}^{j} \sum_{g^{\prime} \varepsilon G^{\prime}} \sigma^{j}\left(g \rightarrow g^{\prime}\right)}{\sum_{j} N^{j} \sum_{g \varepsilon G} W_{g}^{j}} .\]</div>
<p>Theoretically, the higher-than-zero order <span class="math notranslate nohighlight">\(\sigma_{l}\left(g \rightarrow g^{\prime}\right)\)</span> should be weighted over
<em>ψ</em><sub>l</sub>. Since these functions are generally positive-negative, <em>ψ</em><sub>l</sub>
weighting does not always work in practice, and XSDRNPM weights the <span class="math notranslate nohighlight">\(\sigma_{l}\left(g \rightarrow g^{\prime}\right), \quad&gt;0\)</span>,
by the scalar flux, which is positive. This procedure gives usable values
for most cases.</p>
</div>
<div class="section" id="weighting-of-bar-v">
<span id="id59"></span><h4>Weighting of <span class="math notranslate nohighlight">\(\bar{v}\)</span><a class="headerlink" href="#weighting-of-bar-v" title="Permalink to this headline">¶</a></h4>
<p>In weighting parameters such as <span class="math notranslate nohighlight">\(\bar{v}\)</span>, the average number of neutrons produced
per fission, one is interested in preserving the fission source;
therefore, the weighting is over <em>σ</em><sub>f</sub>ψ* instead of just <em>ψ</em>. The
weighting procedure in XSDRNPM is to calculate <span class="math notranslate nohighlight">\(\left(\overline{v \sigma_{f}}\right)_{G}\)</span> and (<em>σ</em><sub>f</sub>)<em>G</em> using
the appropriate choice from Eqs. <a class="reference internal" href="#equation-eq9-1-59">(490)</a>, <a class="reference internal" href="#equation-eq9-1-60">(491)</a>, or <a class="reference internal" href="#equation-eq9-1-61">(492)</a>. Then</p>
<div class="math notranslate nohighlight">
\[\bar{v}_{G}=\frac{\left(\overline{v \sigma_{F}}\right)_{G}}{\left(\sigma_{f}\right)_{G}} .\]</div>
</div>
<div class="section" id="transport-cross-sections">
<span id="id60"></span><h4>Transport cross sections<a class="headerlink" href="#transport-cross-sections" title="Permalink to this headline">¶</a></h4>
<p>Transport cross sections are not as directly related to the physical
properties of a material as much as other group-averaged values. Instead
of a reaction rate, these numbers must attempt to preserve a “flux
gradient,” which not only depends on the cross sections of the material,
but is also very strongly influenced by the geometry and the other
nuclides in the vicinity of a material.</p>
<p>Two options are provided in XSDRNPM to generate transport
cross sections—options based on the “consistent” and “inconsistent”
methods for solving the <em>Pl</em> transport equations. These approximations
are referred to as the “outscatter” and “inscatter” approximations
because of the nature of the equations used.</p>
<div class="section" id="outscatter-approximation-inconsistent-method">
<span id="id61"></span><h5>Outscatter approximation (inconsistent method)<a class="headerlink" href="#outscatter-approximation-inconsistent-method" title="Permalink to this headline">¶</a></h5>
<p>In the outscatter approximation, the assumption is made that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-62">
<span class="eqno">(493)<a class="headerlink" href="#equation-eq9-1-62" title="Permalink to this equation">¶</a></span>\[\sigma_{t r}^{g}=\sigma_{t}^{g}-\bar{\mu}^{g} \sigma_{s}^{g} .\]</div>
<p>When one notes that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-63">
<span class="eqno">(494)<a class="headerlink" href="#equation-eq9-1-63" title="Permalink to this equation">¶</a></span>\[\bar{\mu}^{g} \equiv \frac{\sigma_{1}^{g}}{3 \sigma_{0}^{g}}\]</div>
<p>and that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-64">
<span class="eqno">(495)<a class="headerlink" href="#equation-eq9-1-64" title="Permalink to this equation">¶</a></span>\[\sigma_{1}^{g}=\sum_{g^{\prime}} \sigma_{1}\left(g \rightarrow g^{\prime}\right) ,\]</div>
<p>where the <span class="math notranslate nohighlight">\(\sigma_{l}\left(g \rightarrow g^{\prime}\right)\)</span> terms are the <em>P</em><sub>1</sub> coefficients of the scattering
matrix, the origin of the term “outscatter” to designate the
approximation is evident.</p>
</div>
<div class="section" id="inscatter-approximation-consistent-method">
<span id="id62"></span><h5>Inscatter approximation (consistent method)<a class="headerlink" href="#inscatter-approximation-consistent-method" title="Permalink to this headline">¶</a></h5>
<p>In the “consistent” solution of the <em>P</em><sub>1</sub> point transport
equations, it can be shown that</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-65">
<span class="eqno">(496)<a class="headerlink" href="#equation-eq9-1-65" title="Permalink to this equation">¶</a></span>\[\sigma_{t r}(E)=\sigma_{t}(E)-\frac{1}{3 J(E)} \int_{0}^{\infty} d E^{\prime} \sigma_{1}\left(E^{\prime} \rightarrow E\right) J\left(E^{\prime}\right) ,\]</div>
<p>where <em>J</em>(<em>E</em>′) is the current.</p>
<p>If one multiplies the equation by J(E), integrates over group g, and
converts to group-averaged form by dividing by <span class="math notranslate nohighlight">\(\int_{g} J(E) d E\)</span> the following expression
is derived:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-66">
<span class="eqno">(497)<a class="headerlink" href="#equation-eq9-1-66" title="Permalink to this equation">¶</a></span>\[\sigma_{t r}^{g}=\sigma_{t}^{g}-\frac{1}{3 J_{g}} \sum_{g^{\prime}} \sigma_{1}\left(g^{\prime} \rightarrow g\right) J_{g^{\prime}} .\]</div>
<p>This is the “inscatter” approximation. It is consistent because the
transport values are explicitly derived from the <em>P</em><sub>0</sub> and
<em>P</em><sub>1</sub> equations. As a general rule, the transport values from
this treatment are “better” than those from the “inconsistent”
treatment. However, in some cases (notably hydrogen at lower energies),
negative numbers may be calculated which are unusable and the more
approximate approach must be used.</p>
</div>
<div class="section" id="weighting-function-for-transport-cross-section">
<span id="id63"></span><h5>Weighting function for transport cross section<a class="headerlink" href="#weighting-function-for-transport-cross-section" title="Permalink to this headline">¶</a></h5>
<p>Unfortunately, the matter of choosing a current to use in the
“transport” weighting is not simple. In real problems, currents are
positive-negative as a function of energy and space. When cross sections
are averaged over positive-negative functions, the “law-of-the-mean” no
longer holds and the average value can be anything. This unbounded
nature leads to real problems in diffusion calculations.</p>
<p>Approximations that inherently guarantee positive currents are generally
used in other codes that circumvent the positive-negative problem. For
example, in <em>Bn</em> theory the current is given by</p>
<div class="math notranslate nohighlight">
\[j \sim B \psi\]</div>
<p>where B and <em>ψ</em> are both positive.</p>
<p>In XSDRNPM, more direct routes that ensure positivity are taken
(e.g., one might set <span class="math notranslate nohighlight">\(\mathrm{W}_{\mathrm{g}} \equiv\left|\mathrm{W}_{\mathrm{g}}\right|\)</span>).
This is crudely supported by the following
argument:</p>
<p>Consider a 1-D cylindrical calculation.  In two dimensions, the current is a vector combination, that is,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-67">
<span class="eqno">(498)<a class="headerlink" href="#equation-eq9-1-67" title="Permalink to this equation">¶</a></span>\[J=J_{r}+J_{z} .\]</div>
<p>In XSDRNPM, the z direction is treated by using a buckling approximation, that is,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-68">
<span class="eqno">(499)<a class="headerlink" href="#equation-eq9-1-68" title="Permalink to this equation">¶</a></span>\[J_{z}=B \psi .\]</div>
<p>In the weighting calculation, we want to weight over the magnitude of the
current.  In XSDRNPM, the z current is imaginary, since we are not calculating a
z-direction:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-69">
<span class="eqno">(500)<a class="headerlink" href="#equation-eq9-1-69" title="Permalink to this equation">¶</a></span>\[J=J_{r}+i B \psi .\]</div>
<p>The magnitude of a complex quantity is</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-70">
<span class="eqno">(501)<a class="headerlink" href="#equation-eq9-1-70" title="Permalink to this equation">¶</a></span>\[J=\frac{\left(J_{r}+i B \psi\right)\left(J_{r}-i B \psi\right)}{\sqrt{\left(\text {Value}_{r}\right)^{2}+B^{2} \psi^{2}}} ,\]</div>
<p>which is always positive.</p>
<p>In a discrete-ordinates calculation, the current is easily obtained since it is the first flux moment.</p>
<p>XSDRNPM has the following options for calculating the current:</p>
<ol class="arabic simple">
<li></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-71">
<span class="eqno">(502)<a class="headerlink" href="#equation-eq9-1-71" title="Permalink to this equation">¶</a></span>\[J_{g}=\sqrt{\left(\psi_{1}^{g}\right)^{2}+\left(D B \psi_{g}\right)^{2}}\]</div>
<ol class="arabic simple" start="2">
<li></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-72">
<span class="eqno">(503)<a class="headerlink" href="#equation-eq9-1-72" title="Permalink to this equation">¶</a></span>\[J_{g}=\left|\psi_{1}^{g}\right|\]</div>
<ol class="arabic simple" start="3">
<li></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-73">
<span class="eqno">(504)<a class="headerlink" href="#equation-eq9-1-73" title="Permalink to this equation">¶</a></span>\[J_{g}=D B^{2} \psi_{g}+\int_{0}^{1} d \mu \mu \psi\left(g, r_{\text {outside}}, \mu\right)\]</div>
<ol class="arabic simple" start="4">
<li></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-74">
<span class="eqno">(505)<a class="headerlink" href="#equation-eq9-1-74" title="Permalink to this equation">¶</a></span>\[J_{g}=\frac{\psi_{0}^{g}}{\sum_{t}^{g}}\]</div>
<ol class="arabic simple" start="5">
<li></li>
</ol>
<div class="math notranslate nohighlight" id="equation-eq9-1-75">
<span class="eqno">(506)<a class="headerlink" href="#equation-eq9-1-75" title="Permalink to this equation">¶</a></span>\[J_{g}=D B \psi_{g}\]</div>
<p>The first option is the recommended option; option 2 treats only the
current in the primary direction; option 3 will always be positive and
is a weighting over the total leakage from the system. Option 4 is
sometimes referred to as a “bootstrap” approximation; option 5 is
equivalent to that used in codes that employ <em>B</em><sub>n</sub> theory.</p>
<p>Once the currents are determined, the transport values are determined as
set forth in the equations discussed above. For example, consider cell
weighting and the “inscatter” approximation,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-76">
<span class="eqno">(507)<a class="headerlink" href="#equation-eq9-1-76" title="Permalink to this equation">¶</a></span>\[\sigma_{t r}^{G}=\frac{\sum_{j} N^{j} \sum_{g \varepsilon G}\left\{J_{g} \sigma_{t}^{g}-\frac{1}{3} \sum_{g^{\prime}} \sigma_{1}\left(g^{\prime} \rightarrow g\right) J_{g}^{\prime}\right\}}{\bar{N} \sum^{IZM}_{j} \sum_{g \varepsilon G} J_{g}}\]</div>
<p>For cell weighting and the “outscatter” approximation,</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-77">
<span class="eqno">(508)<a class="headerlink" href="#equation-eq9-1-77" title="Permalink to this equation">¶</a></span>\[\sigma_{t r}^{G}=\frac{\sum_{j} N^{j} \sum_{g \varepsilon G} J_{g}\left\{\sigma_{t}^{g}-\frac{1}{3} \sum_{g^{\prime}} \sigma_{1}\left(g^{\prime} \rightarrow g\right)\right\}}{\bar{N} \sum_{j}^{IZM} \sum_{g \varepsilon G} J_{g}}\]</div>
</div>
</div>
</div>
<div class="section" id="adjoint-calculations">
<span id="id64"></span><h3>Adjoint calculations<a class="headerlink" href="#adjoint-calculations" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM will, upon option, solve the adjoint forms of the 1-D transport
equation.</p>
<p>Several special procedures apply for the adjoint calculation:</p>
<ol class="arabic simple">
<li><p>The iteration pattern discussed in <a class="reference internal" href="#id47"><span class="std std-ref">Iteration and convergence tests</span></a> is reversed in
energy. The scheme starts with the last (lowest energy) group and
proceeds to the first group.</p></li>
<li><p>The angular quadrature is treated as if it has the reverse directions
associated with the angle (e.g., many quadratures start with
<em>μ</em><sub>1</sub> = −1.0). In the adjoint case, this direction is for
<em>μ</em><sub>1</sub> = +1.0.</p></li>
<li><p>All edits of input fluxes and collapsed cross sections are given in
their normal ordering, as opposed to many codes which require their
reversal.</p></li>
</ol>
<p>Adjoint calculations have many uses and advantages. As opposed to the
forward calculation which yields particle density values, the adjoint
fluxes are more abstract and can be thought of as particle importance.</p>
<p>Consider, for example, the problem of determining the response of a
detector to particles as a function of their energy and direction.
Assume the detector is a cylindrical fission chamber that utilizes a
foil of <sup>235</sup>U. The most obvious way to attack this problem is to
mock up the detector and make a series of runs that contain sources of
identical strength in different angles and energy groups. If an
<em>S</em><sub>8</sub> (24 angles) quadrature were used with 50 energy groups,
the 12 × 50 or 600 independent calculations could be used to completely
determine the responses. (Here we have taken note that half of the
angles will point away from a detector and, hence, produce no response.)
The adjoint calculation produces all 600 responses in one run that is no
more difficult and time consuming than the typical forward case. In the
adjoint case, the detector response (i.e., the fission cross section of
<sup>235</sup>U would be specified as a source in the foil region and the
adjoint fluxes given as a function of energy and angle would be
interpreted as the source of neutrons necessary to produce a response of
the magnitude to which one required the response to be normalized.</p>
<p>A second important use of adjoint calculations is to establish good
biasing factors for Monte Carlo codes. Two recent
reports <a class="bibtex reference internal" href="#hoffman-xsdrnpm-s-1982" id="id65">[HT82]</a> <sup>,</sup> <a class="bibtex reference internal" href="#hoffman-optimization-1982" id="id66">[Hof82]</a> discuss the time and accuracy advantages
of this approach for shielding and criticality applications and give
some real examples as to how to make the calculations.</p>
<p>Perturbation theory uses adjoint and forward fluxes in combination in a
manner that determines changes in responses that would arise from
changing parameters used in a calculation. One <a class="bibtex reference internal" href="#weisbin-review-1979" id="id67">[WRHB79]</a> interesting
application is to determine the sensitivity of a calculation to changes
in one or more cross-section value changes.</p>
<div class="section" id="generalized-adjoint-calculations">
<span id="id68"></span><h4>Generalized adjoint calculations<a class="headerlink" href="#generalized-adjoint-calculations" title="Permalink to this headline">¶</a></h4>
<p>Generalized adjoint solutions are needed for generalized perturbation theory
(GPT) applications such as sensitivity and uncertainty analysis.  The
generalized adjoint solution differs from both a conventional external source
case and a fundamental mode eigenvalue calculation: It has the transport
operator for an adjoint eigenvalue equation, but contains a fixed source term as
well.  The eigenvalue transport operator is singular, which forces certain
restrictions on the allowable sources.  The generalized adjoint source term is
associated with a particular response ratio of interest in a critical system,
such as</p>
<div class="math notranslate nohighlight">
\[R=\frac{\sum_{g=1}^{I G M} \sum_{i=1}^{I M} H_{N}(g, i) \psi_{i, g} V_{i}}{\sum_{g=1}^{I G M} \sum_{i=1}^{I M} H_{D}(g, i) \psi_{i, g} V_{i}}\]</div>
<p>where H<sub>N</sub> and H<sub>D</sub> are response functions defining the
response of interest and <span class="math notranslate nohighlight">\(\psi_{i, g}\)</span> is the scalar flux from a prior forward
eigenvalue solution of the same problem. The generalized adjoint source
for this response is defined as</p>
<div class="math notranslate nohighlight">
\[Q^{*}(g, i) \equiv \frac{1}{R} \frac{\partial R}{\partial \psi_{i, g}}=\frac{H_{N}(g, i)}{\sum_{g=1}^{IGM} \sum_{i=1}^{I M} H_{N}(g, i) \psi_{i, g} V_{i}}-\frac{H_{D}(g, i)}{\sum_{g=1}^{I G M} \sum_{i=1}^{I M} H_{D}(g, i) \psi_{i, g} V_{i}}\]</div>
<p>The above source expression is computed automatically whenever XSDRN is
executed in the TSUNAMI-1D sequence, but must it be computed and input
by the user if XSDRN is run standalone for a generalized adjoint case.</p>
<p>In order to obtain a unique solution and avoid numerical problems, the
generalized adjoint solution is “normalized” to contain no fundamental
harmonic of the adjoint eigenvalue calculation. This is done by sweeping
out the adjoint fundamental mode “contamination” from the fission source
after each outer iteration, as described in the SAMS chapter, in
<em>Generalized Perturbation Theory</em>. This operation requires both forward
and adjoint eigenvalue solutions from prior XSDRN calculations. External
files containing the fundamental mode forward and adjoint fluxes are
input to the generalized adjoint calculation.</p>
<p>Unlike conventional fixed source and eigenvalue calculations, the
generalized adjoint flux has both negative and positive components. This
causes some XSDRN acceleration features such as space-dependent
rebalance and group-banding to not function properly; and thus these are
turned off internally. Typically the outer iterations for generalized
adjoint solution converge much slower than an eigenvalue calculation.
More background on GPT and generalized adjoint properties can be found
in <a class="bibtex reference internal" href="tsurfer.html#williams-perturbation-1986" id="id69">[Wil86]</a>.</p>
</div>
</div>
<div class="section" id="coupled-neutron-photon-calculations">
<span id="id70"></span><h3>Coupled neutron-photon calculations<a class="headerlink" href="#coupled-neutron-photon-calculations" title="Permalink to this headline">¶</a></h3>
<p>In XSDRNPM, it is possible to do a neutron or a photon calculation,
depending only on whether the input libraries are for neutrons or gamma
rays. It is also possible to do a “coupled neutron-photon” calculation
which automatically determines the gamma-ray sources arising from
neutron induced interactions in its photon calculation. This
calculation, of course, requires an input cross-section library
containing three classes of data:</p>
<ol class="arabic simple">
<li><p>neutron cross sections, including neutron-to-neutron transfer
matrices,</p></li>
<li><p>photon production cross sections (i.e., neutron-to-gamma transfer
matrices), and</p></li>
<li><p>gamma-ray cross sections, including gamma-ray-to-gamma-ray transfer
matrices.</p></li>
</ol>
<p>At present there are no provisions for treating neutrons produced from
gamma interactions other than having the user introduce these sources by
hand in a sort of iterative procedure, though this reaction is certainly
not unknown (cf., deuterium, beryllium-9, and carbon-13). There are
several cases where the (<em>γ</em>,<em>n</em>) interaction can be important. If,
for example, one looks at neutrons in a water-moderated pool reactor or
in a water spent fuel storage tank at large distances from the fuel, the
dominant source is from the neutrons produced by the deuterium in the
water.</p>
<p>Normally the neutron-photon calculation requires no more input than a
single particle run, except in the case where extraneous neutron and/or
gamma-ray sources need to be specified. Most output edits will be split
into a neutron and a gamma-ray part and will be labeled as such</p>
</div>
<div class="section" id="diffusion-theory-option">
<span id="id71"></span><h3>Diffusion theory option<a class="headerlink" href="#diffusion-theory-option" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM can make a 1-D diffusion theory calculation in user-specified
energy groups (enter 1’s for the appropriate groups of the 46$ array).
In this case, the <em>P</em><sub>1</sub> diffusion equations <a class="bibtex reference internal" href="#alder-methods-1963" id="id72">[Ald63]</a> are solved:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-78">
<span class="eqno">(509)<a class="headerlink" href="#equation-eq9-1-78" title="Permalink to this equation">¶</a></span>\[A_{I+1} \psi_{1, I+1}-A_{I} \psi_{1, I}+\sigma_{0}\left(\psi_{0, I}+\psi_{0, I}\right)=S_{0}^{*}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-79">
<span class="eqno">(510)<a class="headerlink" href="#equation-eq9-1-79" title="Permalink to this equation">¶</a></span>\[\bar{A}_{I}\left(\psi_{0, I+1}-\psi_{0, I}\right)+\sigma_{1}\left(\psi_{1, I+1}+\psi_{1, I}\right)=S_{1}^{*} ,\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\psi_{1} \equiv P_{1} \text { current }\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-80">
<span class="eqno">(511)<a class="headerlink" href="#equation-eq9-1-80" title="Permalink to this equation">¶</a></span>\[\sigma_{0}=\left[\Sigma_{t}-\Sigma_{0}(g \rightarrow g)\right] \frac{V_{I}}{2.0}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-81">
<span class="eqno">(512)<a class="headerlink" href="#equation-eq9-1-81" title="Permalink to this equation">¶</a></span>\[\sigma_{1}=\left[3.0 \Sigma_{t}-\Sigma_{1}(g \rightarrow g)\right] \frac{V_{I}}{2.0}\]</div>
<div class="math notranslate nohighlight">
\[S_{0}^{*}=P_{0} \text { sources less the within-group term }\]</div>
<div class="math notranslate nohighlight">
\[S_{1}^{*}=P_{1} \text { sources less the within-group term }\]</div>
<div class="math notranslate nohighlight">
\[\bar{A}_{I}=\frac{A_{I}+A_{I+1}}{2}\]</div>
<div class="math notranslate nohighlight">
\[V_{I}=\text { volume of Ith interval. }\]</div>
<p>Solving Eq. <a class="reference internal" href="#equation-eq9-1-78">(509)</a> for <span class="math notranslate nohighlight">\(\psi_{0, I+1}\)</span> and substituting into Eq. <a class="reference internal" href="#equation-eq9-1-79">(510)</a>, one can write</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-82">
<span class="eqno">(513)<a class="headerlink" href="#equation-eq9-1-82" title="Permalink to this equation">¶</a></span>\[\psi_{1, I+1}=\frac{\bar{A}_{I} S_{0}^{*}-2 \sigma_{0} \bar{A}_{I} \psi_{0, I}-\sigma_{0} S_{1}^{*}+\psi_{1, I}\left(\sigma_{0} \sigma_{1}+\bar{A}_{I} A_{I}\right)}{\bar{A}_{I} A_{I+1}-\sigma_{0} \sigma_{1}} .\]</div>
<p>Solving Eq. <a class="reference internal" href="#equation-eq9-1-79">(510)</a> for <span class="math notranslate nohighlight">\(\psi_{1, I}\)</span> and substituting into Eq. <a class="reference internal" href="#equation-eq9-1-78">(509)</a> , one can write</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-83">
<span class="eqno">(514)<a class="headerlink" href="#equation-eq9-1-83" title="Permalink to this equation">¶</a></span>\[\psi_{0, I+1}=\frac{A_{I+1} S_{1}^{*}-2 \sigma_{1} \bar{A}_{I} \psi_{1, I}-\sigma_{1} S_{0}^{*}+\psi_{0, I}\left(\sigma_{0} \sigma_{1}+\bar{A}_{I} A_{I+1}\right)}{\bar{A}_{I} A_{I+1}-\sigma_{0} \sigma_{1}} .\]</div>
<p>If one assumes</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-84">
<span class="eqno">(515)<a class="headerlink" href="#equation-eq9-1-84" title="Permalink to this equation">¶</a></span>\[\psi_{1, I+1}=P_{I+1} \psi_{0, I+1}-q_{I+1}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-85">
<span class="eqno">(516)<a class="headerlink" href="#equation-eq9-1-85" title="Permalink to this equation">¶</a></span>\[\psi_{1, I}=P_{I} \psi_{0, I}-q_{I}\]</div>
<p>and plugs Eqs. <a class="reference internal" href="#equation-eq9-1-82">(513)</a> and  <a class="reference internal" href="#equation-eq9-1-83">(514)</a> into , solving for <span class="math notranslate nohighlight">\(\psi_{1, I}\)</span> yields:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-86">
<span class="eqno">(517)<a class="headerlink" href="#equation-eq9-1-86" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{l}
\psi_{1, I}=\frac{P_{I+1}\left(\sigma_{0} \sigma_{1}+\bar{A}_{I} A_{I+1}\right)+2 \sigma_{0} \bar{A}_{I}}{\sigma_{0} \sigma_{1}+\bar{A}_{I} A_{I}+P_{I+1} 2 \sigma_{1} \bar{A}_{I}} \psi_{0, I} \\
-\frac{S_{0}^{*}\left(\bar{A}_{I}+\sigma_{1} P_{I+1}\right)-S_{1}^{*}\left(\sigma_{0}+A_{I+1} P_{I+1}\right)+q_{I+1}\left(\bar{A}_{I} A_{I+1}-\sigma_{0} \sigma_{1}\right)}{\sigma_{0} \sigma_{1}+\bar{A}_{I} A_{I}+P_{I+1} 2 \sigma_{1} \bar{A}_{I}}
\end{array}\end{split}\]</div>
<p>which by inspection and comparison with Eq. <a class="reference internal" href="#equation-eq9-1-85">(516)</a> gives expressions for
<em>P</em><sub>I</sub> and <em>q</em><sub>I</sub>.</p>
<p>Equations <a class="reference internal" href="#equation-eq9-1-84">(515)</a> and <a class="reference internal" href="#equation-eq9-1-85">(516)</a> can be substituted into Eq. <a class="reference internal" href="#equation-eq9-1-78">(509)</a> and solved for <span class="math notranslate nohighlight">\(\psi_{0, I+1}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-87">
<span class="eqno">(518)<a class="headerlink" href="#equation-eq9-1-87" title="Permalink to this equation">¶</a></span>\[\psi_{0, I+1}=\frac{\psi_{0, I}\left(A_{I} P_{I}-\sigma_{0}\right)+A_{I+1} q_{I+1}-A_{I} q_{I}+S_{0}^{*}}{A_{I+1} P_{I+1}+\sigma_{0}} ,\]</div>
<p>which is the expression used in XSDRNPM. The procedure solves for arrays
of <em>P</em><sub>I</sub> and <em>q</em><sub>I</sub> which are plugged back into the above expression to
yield the fluxes.</p>
</div>
<div class="section" id="infinite-medium-theory-option">
<span id="id73"></span><h3>Infinite-medium theory option<a class="headerlink" href="#infinite-medium-theory-option" title="Permalink to this headline">¶</a></h3>
<p>It is possible to force the flux calculation in XSDRNPM to use an infinite
medium option for any or all energy groups by entering 2’s in the appropriate
positions in the 46$ array.  When a multiregion calculation is requested, the
program will first determine spatially averaged cross sections to use in the
infinite-medium expression and then place the infinite-medium flux in all
spatial regions for use in any subsequent calculations, such as cross-section
weighting.  All higher flux moments are set to zero.</p>
<p>The balance expression is</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-88">
<span class="eqno">(519)<a class="headerlink" href="#equation-eq9-1-88" title="Permalink to this equation">¶</a></span>\[\left[\Sigma_{t}^{g}-\Sigma(g \rightarrow g)\right] \psi_{g}=\frac{1}{k} F_{g}+S_{g} ,\]</div>
<p>where <em>F</em><sub>g</sub> is the fission source in group g, <em>S</em><sub>g</sub> is the sum of any
fixed source and inscattering source, and <span class="math notranslate nohighlight">\(\sum_{t}^{g}\)</span> and Σ(g→g) are homogenized
total and group-to-group scattering cross sections.</p>
</div>
<div class="section" id="bn-theory-option">
<span id="id74"></span><h3>B<sub>N</sub> theory option<a class="headerlink" href="#bn-theory-option" title="Permalink to this headline">¶</a></h3>
<p>XSDRNPM can make a <em>B</em><sub>N</sub> calculation in user-specified energy groups
(enter 3’s for the appropriate groups of the 46$ array). As in the
infinite-medium option discussed in <a class="reference internal" href="#id73"><span class="std std-ref">Infinite-medium theory option</span></a>, cross sections in a
multiregion system are not homogenized.</p>
<p>The <em>B</em><sub>N</sub> equations <a class="bibtex reference internal" href="#henryson-mc-1976" id="id75">[HTS76]</a> can be written</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-89">
<span class="eqno">(520)<a class="headerlink" href="#equation-eq9-1-89" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\frac{l+1}{2 l+1} i B \psi_{l+1} &amp;+\frac{l}{2 l+1} i B \psi_{l-1}+\Sigma_{t} \psi_{l}=S(u) \delta_{l}^{0} \\
&amp;+\int d u^{\prime} \Sigma_{s}^{l}\left(u^{\prime} \rightarrow u\right) \psi_{l}\left(u^{\prime}\right) \quad l=0,1, \quad, N-1
\end{aligned}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-90">
<span class="eqno">(521)<a class="headerlink" href="#equation-eq9-1-90" title="Permalink to this equation">¶</a></span>\[\frac{N}{2 N+1} i B \psi_{N-1}+\gamma \Sigma_{t} \psi_{N}=\int d u^{\prime} \Sigma_{g}^{N}\left(u^{\prime} \rightarrow u\right) \psi_{N}\left(u^{\prime}\right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-91">
<span class="eqno">(522)<a class="headerlink" href="#equation-eq9-1-91" title="Permalink to this equation">¶</a></span>\[\psi_{-1}=0\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-92">
<span class="eqno">(523)<a class="headerlink" href="#equation-eq9-1-92" title="Permalink to this equation">¶</a></span>\[\gamma=1+\frac{N+1}{2 N+1} \frac{i B}{\Sigma_{T}} \frac{Q_{N+1}\left(-\Sigma_{t} / i B\right)}{Q_{N}\left(-\Sigma_{t} / i B\right)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_{l}^{0}\)</span> is the Kronecker delta function and <em>Q</em><sub>N</sub> is a Legendre
polynomial of the second kind. In mutigroup form, the above expressions
become:</p>
<div class="math notranslate nohighlight" id="equation-eq9-1-93">
<span class="eqno">(524)<a class="headerlink" href="#equation-eq9-1-93" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\frac{l+1}{2 l+1} i B \psi_{l+1}^{g} &amp;+\frac{l}{2 l+1} i B \psi_{l-1}^{g}+\Sigma_{t}^{g} \psi_{l}^{g}=S_{g} \delta_{l}^{0} \\
&amp;+\sum_{g^{\prime}} \Sigma_{l}\left(g^{\prime} \rightarrow g\right) \psi_{l}^{g} \quad l=0,1, \quad N-1
\end{aligned}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-94">
<span class="eqno">(525)<a class="headerlink" href="#equation-eq9-1-94" title="Permalink to this equation">¶</a></span>\[\frac{N}{2 N+1} i B \psi_{N-1}^{g}+\gamma \Sigma_{t}^{g} \psi_{N}^{g}=\sum_{g^{\prime}} \Sigma_{N}\left(g^{\prime} \rightarrow g\right) \psi_{N}^{g}\]</div>
<div class="math notranslate nohighlight" id="equation-eq9-1-95">
<span class="eqno">(526)<a class="headerlink" href="#equation-eq9-1-95" title="Permalink to this equation">¶</a></span>\[\psi_{-1}^{g}=0 .\]</div>
<p>In Eqs. <a class="reference internal" href="#equation-eq9-1-89">(520)</a> and <a class="reference internal" href="#equation-eq9-1-93">(524)</a>, the S term includes fission, fixed, and scattering source components.</p>
</div>
</div>
<div class="section" id="xsdrnpm-input-data">
<span id="id76"></span><h2>XSDRNPM Input Data<a class="headerlink" href="#xsdrnpm-input-data" title="Permalink to this headline">¶</a></h2>
<p>The input data to XSDRNPM consist of a title card and up to five data blocks,
depending on the particular problem.  All data in these blocks are entered using
the FIDO formats discussed in the chapter on FIDO.</p>
<p>In the description that follows, the quantity in square brackets is the number
of items in an array.  The quantity in braces is the condition which requires
the array to be input.  If no condition is specified, an array must be input.
Default parameters that are used if an array is not input are shown in
parentheses if nonzero.</p>
<blockquote>
<div><p>*******************************************************************</p>
</div></blockquote>
<p>Title Card - Format (20A4)</p>
<p>This is the title card for the problem.  It will be used to label the problem output.</p>
<p class="centered">
<strong>Data Block 1</strong></p><p>This block contains information to set up various array dimensions and most
calculational and editing options.  Various convergence criteria and special
constants can be input.</p>
<p>0$$  Logical Assignments [17]</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>LPUN –  Logical number for punched card output (7).</p></li>
<li><p>LRSF –  Random-access scratch for fluxes (10).</p></li>
<li><p>LAWL –  Input AMPX working library (4).</p></li>
<li><p>LANC –  ANISN binary or CCCC ISOTXS library (20).</p></li>
<li><p>LOWL –  Output weighted library (3).</p></li>
<li><p>LANG –  Angular flux scratch file (16).</p></li>
<li><p>LSFF –  Scalar flux output file (17).</p></li>
<li><p>LSF2 –  Sequential scratch space (18).</p></li>
<li><p>LSF3 –  Sequential scratch space (19).</p></li>
<li><p>LRSM –  Random-access scratch for macroscopic cross sections (8).</p></li>
<li><p>LRSX –  Random-access scratch for macroscopic cross sections (9).</p></li>
<li><p>LACF –  Activities output file (75).</p></li>
<li><p>LBTF –  Balance table output file (76).</p></li>
<li><p>LIDF –  Input dump file (73).</p></li>
<li><p>LSEN –  Sensitivity output file (6).</p></li>
<li><p>LEXT –  Not used (0).</p></li>
<li><p>LISF –  Scalar flux input guess file (0).</p></li>
</ol>
</div></blockquote>
<p>1$  General Problem Description [15]</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>IGE –   problem geometry (1)</p></li>
</ol>
<blockquote>
<div><p>0 – homogeneous  (This causes a BN calculation to be made for all zones – <a class="reference internal" href="#id74"><span class="std std-ref">BN theory option</span></a>)
1 – slab
2 – cylinder
3 – sphere</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>IZM –   number of separate material regions or zones. (1)</p></li>
<li><p>IM –    number of spatial intervals in the problem. (1)</p></li>
<li><p>IBL –   the boundary condition at the left-hand boundary of the system. (1)</p></li>
</ol>
<blockquote>
<div><p>0 – vacuum boundary
1 – reflected boundary
2 – periodic boundary
3 – white/albedo boundary</p>
</div></blockquote>
</div></blockquote>
<p>Boundary conditions are discussed in <a class="reference internal" href="#id36"><span class="std std-ref">Boundary conditions</span></a>.</p>
<blockquote>
<div><ol class="arabic simple" start="5">
<li><p>IBR –   the boundary condition at the right-hand boundary of the system. (1)</p></li>
</ol>
<blockquote>
<div><p>0 – vacuum boundary
1 – reflected boundary
2 – periodic boundary
3 – white/albedo boundary</p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>MXX –   the number of compositions used in the problem mock-up.</p></li>
<li><p>MS –    the number of entries in the mixing table which specifies the makeup of the MXX compositions.</p></li>
<li><p>ISN –   the order of angular quadrature to be used.  If ISN &gt; 0, XSDRNPM will calculate an angular quadrature for the appropriate geometry.  If ISN &lt; 0, the calculation is bypassed, and the user must supply a set in the 42# and 43# arrays.</p></li>
<li><p>ISCT –  the order of scattering.  Flux moments will be calculated through this order.</p></li>
<li><p>IEVT –  the type of calculation. (1)</p></li>
</ol>
<blockquote>
<div><p>0 – fixed source
1 – k calculation
2 – α calculation (flux is assumed to have an et time variation)
3 – inoperable in present version
4 – zone width search
5 – outer radius search
6 – buckling search
7 – direct buckling search</p>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>IIM –   the inner iteration maximum used in an Sn calculation.  (10)</p></li>
<li><p>ICM –   the outer iteration maximum. (10)</p></li>
</ol>
<blockquote>
<div><p>After ICM outer iterations, the problem will be forced into the termination
phase and the program will continue as if full convergence was attained.  A
message to this effect is printed.</p>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>ICLC –  theory option. (0)</p></li>
</ol>
<blockquote>
<div><blockquote>
<div><p>0 –      use <span class="math notranslate nohighlight">\(S_n\)</span> theory always
N –      use alternative theory (diffusion, infinite medium, or Bn) for N outer iterations, after which revert back to Sn theory.</p>
</div></blockquote>
<p>-N –      always use alternative theory</p>
</div></blockquote>
</div></blockquote>
<blockquote>
<div><ol class="arabic simple" start="14">
<li><p>ITH –   forward/adjoint selector. (0)</p></li>
</ol>
<blockquote>
<div><p>0 –       solve the forward Boltzmann equation.
1 –       solve the adjoint Boltzmann equation.</p>
</div></blockquote>
<ol class="arabic" start="15">
<li><p>IFLU –  Generalized adjoint calculation flag. (0)</p>
<p>0 – standard calculation 1 – Generalized adjoint calculation. Requires
input forward and adjoint fundamental mode fluxes on units 31 and 32,
respectively</p>
</li>
</ol>
</div></blockquote>
<p>2$  Editing and Special Options [10]</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>IPRT–   fine-group mixture cross-section edits. (-1)</p></li>
</ol>
<blockquote>
<div><p>-2 –      no edits
-1 –      edit 1-D cross sections
0–N –     edit through PN cross sections.
1-D edits are made, also.</p>
</div></blockquote>
</div></blockquote>
<blockquote>
<div><ol class="arabic simple" start="2">
<li><p>ID1 –   flux editing options. (0)</p></li>
</ol>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>ID1</p></td>
<td><p>Print</p>
<p>Angular fluxes</p>
</td>
<td><p>Print</p>
<p>Scalar fluxes</p>
</td>
<td><p>Punch<em>a</em></p>
<p>Scalar fluxes</p>
</td>
</tr>
<tr class="row-even"><td><p>−1</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><em>a</em> The
fluxes will
be punched
in a format
suitable for
restarting
an XSDRNPM
calculation.</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>IPBT –  balance table edits. (0)</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>1 –       none
0 –       make fine-group balance tables
1 –       make fine- and broad-group balance tables</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>ISX –   broad-group flux edit as a function of interval.  (0) (0/1 = no/yes)</p></li>
<li><p>ISEN –  outer iteration acceleration.  Input a zero.  (0)</p></li>
<li><p>IBLN –  control number of outer iteration groups.  (0)</p></li>
<li><p>NBANDS – number of flux rebalance bands.  (0)</p></li>
</ol>
<blockquote>
<div><p>&lt; 0, then this is the number of bands in the thermal range.</p>
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>IFSN –  If &gt; 0 means no fission source if IEVT=0.  (0)</p></li>
<li><p>ISQ3 –  sequence number of file opened on unit LOWL.  (1)</p></li>
<li><p>IDM4 –  not used.  (0)</p></li>
</ol>
</div></blockquote>
<p>The structure of the “activity” and the “balance table” files are described in Appendix A.</p>
<p>3$  Various Options [12]</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>IFG –   cross-section weighting.  (0)</p></li>
</ol>
<blockquote>
<div><p>0 –       none required
1 –       collapse cross sections</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>IQM –   volumetric sources.  (0)</p></li>
</ol>
<blockquote>
<div><p>0 –       none
N –       N volumetric source spectra will be input in the 31* array</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>IPM –   boundary sources.  (0)
0 –     none
N –     N boundary source spectra will be input in the 32* array</p></li>
<li><p>IFN –   starting guess.  (0)
0 –     flux guess (33# array)
1 –     fission density guess (34# array)</p></li>
<li><p>ITMX –  maximum time allowed for the flux calculation in minutes.  A value of</p></li>
</ol>
<blockquote>
<div><p>zero specifies that the calculation should not be terminated because of time;
otherwise the problem will be forced into the termination phase when ITMX is
exceeded. (0)  Bear in mind that this is an internal timing check and has no
connection with operator or system terminations due to excessive times.</p>
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>IDAT1 – external data storage.   (0)</p></li>
</ol>
<blockquote>
<div><p>0 – keep all arrays in core if possible
1 – store mixture cross sections externally on a direct access device
2 – store cross sections and fixed sources externally on direct access devices</p>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>IPN –   diffusion coefficient option for transverse leakage corrections.  (3)</p></li>
</ol>
<blockquote>
<div><p>0 –      determine a transport cross section for each zone using P0 and P1 cross
sections and, hence, a diffusion coefficient from 1/3 <em>Σ</em><sub>tr</sub>.</p>
<p>1 – spatially average the diffusion coefficients determined as for
the above option and use it for all zones.</p>
<p>2 – spatially average the transport cross sections for all zones and
determine a diffusion coefficient to be used in all zones by taking
one over three times this value.</p>
<p>3 – flux weight the transport cross sections for all zones and
determine a diffusion coefficient to be used in all zones by taking
one over three times this value.</p>
<p>Normally, the first option (IPN = 0) is adequate; however, in cases
involving regions of low concentration (near void) and, hence, very
low transport cross sections, the very large diffusion coefficients
lead to nonphysical behavior. In this case, the IPN = 3 option has
been demonstrated to operate the best.</p>
</div></blockquote>
<ol class="arabic" start="8">
<li><p>IDFM –  density factors. (0)</p>
<blockquote>
<div><p>0 –     none
1 –     read in density factors in the 38* array</p>
</div></blockquote>
</li>
<li><p>IAZ –   activity calculation trigger. (0)</p>
<p>0 –     none
N –     calculate the reaction rates by material zone for N different processes specified in the 49$ and 50$ arrays</p>
</li>
<li><p>IAI –   spatially dependent activity rates. (0)</p>
<p>0 –     none
1 –     calculate reaction rates in each interval for IAZ processes</p>
</li>
<li><p>IFCT –  thermal upscatter scaling. (0)</p></li>
</ol>
<blockquote>
<div><blockquote>
<div><p>0 – none
1 – use upscatter scaling for accelerated problem convergence</p>
</div></blockquote>
<ol class="arabic simple" start="12">
<li><p>IPVT –  parametric eigenvalue search. (0)</p></li>
</ol>
<blockquote>
<div><p>0 –       none
1 –       a search calculation will be made for an eigenvalue equal to PV
2 –       an α loss term with α = PV will be added to the transport equation.
The term α will depend on the IEVT option selected</p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
<p>4$  Cross-Section Weighting Options <a class="bibtex reference internal" href="#emett-morse-1975" id="id77">[Eme75]</a> {IFG = 1}</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently XSDRNPM does not support outputting weighted
cross section libraries in a format other than AMPX. The following items are
still allowed to be entered into XSDRNPM input files for legacy inputs, but
anything not relating to AMPX library format will have no effect.</p>
</div>
<blockquote>
<div><ol class="arabic simple">
<li><p>ICON – type of weighting. (See <a class="reference internal" href="#id52"><span class="std std-ref">Cross-section weighting</span></a>)</p></li>
</ol>
<blockquote>
<div><p>─N – inner cell (with N zones in the cell). Cell weighting is performed
over the N innermost regions in the problem. Nuclides outside these
regions are not weighted.</p>
<p>−1 – cell</p>
<p>0 – zone</p>
<p>1 – region or vein</p>
</div></blockquote>
<ol class="arabic" start="3">
<li><p>ITP –      collapsed output format desired.</p>
<blockquote>
<div><p>0–19 –  cross sections are written only in the AMPX weighted library formats on logical 3.  A weighted library is always written when IFG= 1.
20–29 –         (deprecated feature).
30–39 –   (deprecated feature).
40–49 –   (deprecated feature).</p>
</div></blockquote>
</li>
</ol>
<blockquote>
<div><p>The various values of ITP (modulo 10) are used to select the different transport
cross-section weighting options mentioned earlier.  The options are:</p>
<p>ITP = 0    =&gt;  <span class="math notranslate nohighlight">\(\sqrt{\left(\psi_{1}^{g}+\left(D G \psi_{g}\right)\right)^{2}}\)</span></p>
<p>ITP = 1    =&gt; absolute value of current</p>
<p>ITP = 2    =&gt; <span class="math notranslate nohighlight">\(\mathrm{DB}^{2} \psi_{\mathrm{g}}+\)</span>  outside leakage</p>
<p>ITP = 3    =&gt; <span class="math notranslate nohighlight">\(\psi / \sum_{\mathrm{t}}^{\mathrm{g}}\)</span></p>
<p>ITP = 4    =&gt; <span class="math notranslate nohighlight">\(\mathrm{DB} \psi_{\mathrm{g}}\)</span></p>
<p>ITP = other values are reserved for future development and should not be used.</p>
</div></blockquote>
<ol class="arabic" start="4">
<li><p>IPP –   weighted cross-section edit option -1.</p>
<blockquote>
<div><p>−2 – none</p>
<p>−1 – edit 1-D data</p>
<p>0−N – edit through <em>PN</em> cross-section arrays. 1-D edits are given.</p>
</div></blockquote>
</li>
<li><p>IHTF –   (deprecated feature)</p></li>
<li><p>NDSF –   (deprecated feature)</p></li>
<li><p>NUSF –  (deprecated feature)</p></li>
<li><p>IAP –   (deprecated feature)</p></li>
<li><p>(deprecated feature)</p></li>
</ol>
<p>5*  Convergence Criteria and Assorted Constants [12]</p>
<ol class="arabic">
<li><p>EPS – overall problem convergence. (10:sup:<cite>−4</cite>)</p></li>
<li><p>PTC – scalar flux convergence. (10:sup:<cite>−5</cite>)</p></li>
<li><p>XNF – normalization factor. (1.0)</p>
<p>When IEVT = 0, the fixed sources are normalized to XNF.</p>
<p>For IEVT &gt; 0, the fission source is normalized to XNF.</p>
<p>When XNF = 0.0, no normalization is made.</p>
<p>XNF should only be specified as 0 for a fixed source problem (IEVT = 0).</p>
</li>
<li><p>EV – starting eigenvalue guess for search calculations.</p></li>
<li><p>EVM – eigenvalue modifier used in a search calculation. The following
is a tabulation of recommended values for EV and EVM.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 39%" />
<col style="width: 37%" />
<col style="width: 15%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>IEVT</p></td>
<td><p>Calculation type</p></td>
<td><p>EV</p></td>
<td><p>EVM</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>Fixed source</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>k-calculation</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Direct α-search</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>–</p></td>
<td><p>–</p></td>
<td><p>–</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Zone width search</p></td>
<td><p>0</p></td>
<td><p>−0.1</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Outer radius search</p></td>
<td><p>Starting outer radius</p></td>
<td><p>−0.1∗EV</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Buckling search</p></td>
<td><p>1.0</p></td>
<td><p>−0.1</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>Direct buckling search</p></td>
<td><p>0.0</p></td>
<td><p>0.0</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>6. BF – buckling factor (1.420892). This parameter is two times the
multiplier on the “extrapolation” distance used to determine where a
linearly extrapolated line from the asymptotic flux shape would go to
zero (e.g., for slabs, the extrapolation distance is  0.71*λtr* and,
hence, BF  1.42).</p>
<p>7. DY – first transverse dimension in centimeters used in a buckling
correction to calculate leakage normal to the principal calculation
direction (i.e., the height of a slab or a cylinder).</p>
<p>8. DZ – second transverse dimension in centimeters used for a buckling
correction (i.e., the width of a slab).</p>
<p>9. VSC – void streaming correction. This is the height of a void
streaming path in a cylinder or slab in centimeters. See <a class="reference internal" href="#id50"><span class="std std-ref">Void streaming correction</span></a>.</p>
<p>10. PV – parametric eigenvalue or value for α used when IPVT &gt; 0. When
IPVT = 1 and IEVT &gt; 1, this is the value of k-effective on which the
search calculation is to be made (0.0)</p>
<ol class="arabic simple" start="11">
<li><p>EQL – eigenvalue convergence for a search. (10:sup:<cite>−3</cite>)</p></li>
<li><p>XNPM – new parameter modifier used in search calculations. (0.75)</p></li>
</ol>
</div></blockquote>
<p>T Terminate data block.</p>
<p class="centered">
<strong>Data Block 2</strong></p><p>This block contains information on the composition of the materials used in the
calculation.  Also included is an array to select special cross sections for
ANISN and an array to identify cross sections written on the CCCC ISOTXS
library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently XSDRNPM does not support outputting weighted cross section
libraries in any format other than AMPX. XSDRNPM will still read the deprecated
arrays, but they will have no effect.</p>
</div>
<p>10$      (deprecated array)</p>
<p>12$       (deprecated array)</p>
<p>11$     Composition Numbers in Mixing Table [MS]</p>
<blockquote>
<div><p>If the input multigroup library was previously self-shielded by running the
XSProc module, the composition numbers are the mix numbers given in the READ
COMP block of XSProc.  If the input library has not been previously
self-shielded, enter all zeros.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this is a new array added in SCALE 6.2 which MUST be present when
using a microscopic library produced by the XSProc module.  It may be omitted
if using a macroscopic library from XSProc</p>
</div>
</div></blockquote>
<p>13$     Local Mixture Numbers in Mixing Table [MS]</p>
<blockquote>
<div><p>The values range from 1 to MXX, and are used only in XSDRN for referencing mixtures in the mixing table.</p>
</div></blockquote>
<p>14$     Isotope Identifiers in Mixing Table [MS]</p>
<blockquote>
<div><p>A set of data with this identification must be on unit LAWL, the XSDRNPM working
library, though the code will not make checks to ensure this is the case.</p>
</div></blockquote>
<p>15*     Isotope Concentrations in Mixing Table [MS]</p>
<p>16$      (deprecated array)</p>
<p>18U      (deprecated array)</p>
<p>T Terminate Data Block</p>
<p class="centered">
<strong>Data Block 3  {IEVT = 0}</strong></p><p>This block is used to specify fixed sources.</p>
<p>30$  Source Spectrum Number by Interval [IM]</p>
<p>31*  Volumetric Source Spectra [IQM*IGM]</p>
<p>32*  Surface Source Spectra [IPM*IGM*MM]</p>
<p>Each of the IQM or IPM spectra is specified in the 31* or 32* array and
are stacked one after the other in that array. If both volumetric and
surface sources are used in the same problem, the surface source number
is multiplied by (IQM + 1) when entered in the 30$ array.</p>
<p>A volumetric spectrum will consist of IGM (number of energy groups)
entries which are the relative integrated values of the source in each
group.</p>
<p>A surface source is always assumed to be on the right-hand side of a
spatial interval. It is input as was the volumetric source, except that
each group contains entries for the MM angles in the <span class="math notranslate nohighlight">\(S_n\)</span> quadrature
chosen for the problem. Note that a surface source is an <strong>integrated</strong>
value and is actually a flux condition in the Sn|equations.</p>
<p>In the 30$ array, a zero entry specifies that no source is in an
interval.</p>
<p class="centered">
<strong>Data Block 4</strong></p><p>This data block contains starting guesses for fluxes and fission
densities. If fluxes are read from an external device (LISF&gt;0), this
data block is omitted. Both arrays in this block are double-precision
arrays, which will require the use of the “#” array designator;
otherwise the number of entries read into the arrays will be incorrect
or may contain nonsensical values for the starting guess.</p>
<p>33# Flux Guess [IM*IGM] {IFN=0}</p>
<p>A guess for the scalar flux is specified in the order:
((FLUX(I,J),I=1,IM),J=1,IGM), where IM is the number of spatial
intervals and IGM is the total number of energy groups. For fixed-source
problems, without better information, use zeroes. For eigenvalue
problems, a nonzero flux guess must be used. The fluxes punched by using
the ID1 parameter in the 2$ array can be used here in restart
calculations.</p>
<p>34# Fission Density Guess [IM] {IFN=1}</p>
<p>This is a guess at the number of fission neutrons produced in an
interval. When IFN = 1, XSDRNPM uses diffusion theory for the first
outer iteration, after which it reverts to the normal mode.</p>
<p>T Terminate this data block.</p>
<p class="centered">
<strong>Data Block 5</strong></p><p>This block contains the remaining data needed for an XSDRNPM
calculation.</p>
<p>35* Interval Boundaries [IM+1] (cm)</p>
<p>This array describes the spatial quadrature into which the problem model
is divided. The boundaries are nonnegative for curvilinear geometries
and in increasing order. Usually they will start with a zero value,
though this is not necessary. The origin for slab geometry may be
negative.</p>
<p>36$ Zone Number for Each Spatial Interval [IM]</p>
<p>Spatial zones should be contiguous.</p>
<p>38* Density Factors by Interval [IM] {IDFM&gt;0} (1.0)</p>
<p>These factors are used to effect a density variation in a mixture as a
function of spatial interval. Zero for a density factor affords a
convenient way for modeling a void region.</p>
<p>39$ Mixture Numbers by Zone [IZM]</p>
<p>The mixture that is in a zone is specified here.</p>
<p>40$ Order of Scattering by Zone [IZM] (ISCT)</p>
<p>This is the order, <em>l</em>, of the *Sn Pl *calculation which is desired
in a zone. This number should be no larger than ISCT.</p>
<p>41* Radius Modifiers by Zone [IZM] {IEVT=4}</p>
<p>These parameters specify the relative movement of the width of a zone in
a zone width search. A zero indicates that a zone’s width is fixed. (See
<a class="reference internal" href="#id38"><span class="std std-ref">Dimension search calculations</span></a>)</p>
<p>42# Weights of the Angles in the Discrete-Ordinates Quadrature
[MM <a class="footnote-reference brackets" href="#id88" id="id78">2</a>]</p>
<p>Input this set if you wish to override those provided by XSDRNPM. See
<a class="reference internal" href="#id27"><span class="std std-ref">S_n quadratures for slabs</span></a>, <a class="reference internal" href="#id29"><span class="std std-ref">S_n quadratures for spheres</span></a>, or <a class="reference internal" href="#id31"><span class="std std-ref">S_n quadratures for cylinders</span></a>.</p>
<p>43# Cosines of the Angles in the Discrete-Ordinates Quadrature [MM]</p>
<p>Input this set if you wish to override those provided by XSDRNPM. See
<a class="reference internal" href="#id27"><span class="std std-ref">S_n quadratures for slabs</span></a>, <a class="reference internal" href="#id29"><span class="std std-ref">S_n quadratures for spheres</span></a>, or <a class="reference internal" href="#id31"><span class="std std-ref">S_n quadratures for cylinders</span></a>.</p>
<p>46$ Calculational Option by Group [IGM] {ICLC&gt;0}</p>
<blockquote>
<div><blockquote>
<div><p>0 - perform discrete-ordinates calculation for this group.</p>
</div></blockquote>
<p>1 - perform a diffusion calculation for this group for ICLC outer
iterations; use discrete-ordinates theory after this.</p>
<blockquote>
<div><p>2 - perform a homogeneous calculation for this group for ICLC outer
iterations; then revert back to discrete-ordinates theory.</p>
</div></blockquote>
<p>3 - perform a homogeneous calculation using <em>Bn</em> theory for this
group.</p>
</div></blockquote>
<p>47* Right-Boundary Albedos by Group [IGM] {IBR=3} (1.0)</p>
<p>A right-boundary albedo is specified for each fine group. The return
current is distributed isotropically in angle.</p>
<p>48* Left-Boundary Albedos by Group [IGM] {IBL=3} (1.0)</p>
<p>As for the 47* array but for the left boundary. Note that if IBR or IBL
is 3 and the corresponding 47* or 48* array is omitted, XSDRNPM fills
the array with 1.0’s effecting a boundary with zero net current and with
isotropic neutron return.</p>
<p>49$ Material Number for Activities [IAZ] {IAZ&gt;0}</p>
<p>50$ Process Number for Activities [IAZ] {IAZ&gt;0}</p>
<p>The 49$ and 50$ arrays provide a means of obtaining the activity
(reaction rate) for any process for which cross sections are available
in the XSDRNPM calculation. A representative activity table entry is
shown below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 81%" />
<col style="width: 19%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>ACTIVITY TABLE ENTRY</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>49$</p></td>
<td><p>50$</p></td>
</tr>
<tr class="row-odd"><td><p>M</p></td>
<td><p>N</p></td>
</tr>
</tbody>
</table>
<p>This entry specifies that the activity N for material M be calculated
for all parts of the system which contain that material.</p>
<p>If N is &lt; 0, a density of 1.0 is used to calculate activities instead of
densities in the mixing table. Allowable process identifiers are given
in Appendix M4.B.</p>
<p>If M is &lt; 0, the activities by interval will be multiplied by a 1-D area
as follows:</p>
<blockquote>
<div><p>1.0 for a slab (IGE=1)</p>
<p>2 × r for a cylinder (IGE=2)</p>
<p>4 × r<sup>2</sup> for a sphere (IGE=3)</p>
</div></blockquote>
<p>51$ Broad-Group Numbers [IGM] {IFG&gt;0}</p>
<p>This array contains the broad-group numbers into which the fine groups
are collapsed in a flux-weighting calculation. For example, if the first
five fine groups are to be collapsed to the first broad group, the first
five entries in the 51$ array are 1, etc. A zero value can be used to
ignore (or truncate) a group.</p>
<p>52$ Lower Band Group Numbers [NBANDS]</p>
<p>Group numbers giving the last group in a flux rebalance band. Overrides
the default set supplied by XSDRNPM.</p>
<div class="section" id="abbreviated-xsdrnpm-input-description">
<span id="id79"></span><h3>Abbreviated XSDRNPM input description<a class="headerlink" href="#abbreviated-xsdrnpm-input-description" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 51%" />
<col style="width: 49%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Title Card - (18A4)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>DATA BLOCK 1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>−1$ - Storage Assignment</p>
<ol class="arabic simple">
<li><p>Maximum Length of Storage Array</p></li>
</ol>
<p>0$- Logical Assignments [17]</p>
<ol class="arabic simple">
<li><p>Punched Cards (7)</p></li>
<li><p>Direct Access — Fluxes (10)</p></li>
<li><p>Working Library (4)</p></li>
<li><p>ANISN or ISOTXS (20)</p></li>
<li><p>Weighted Library (3)</p></li>
<li><p>Angular Fluxes (16)</p></li>
<li><p>Scalar Fluxes (17)</p></li>
<li><p>Scratch (18)</p></li>
<li><p>Scratch (19)</p></li>
<li><p>Direct Access (8)</p></li>
<li><p>Direct Access (9)</p></li>
<li><p>Activities (75)</p></li>
<li><p>Balances (76)</p></li>
<li><p>Input Dump (73)</p></li>
<li><p>Sensitivity Data (0)</p></li>
<li><p>Not Used (0)</p></li>
<li><p>Flux Guess (0)</p></li>
</ol>
</td>
<td><p>1$ - General Description [15]</p>
<ol class="arabic simple">
<li><p>IGE - geometry</p></li>
<li><p>IZM - number of zones</p></li>
<li><p>IM - number of intervals</p></li>
<li><p>IBL - left boundary condition</p></li>
<li><p>IBR - right boundary condition</p></li>
<li><p>MXX - number of mixtures</p></li>
<li><p>MS - mixing table length</p></li>
<li><p>ISN - angular quadrature</p></li>
<li><p>ISCT - order of scattering</p></li>
<li><p>IEVT - problem type</p></li>
<li><p>IIM - inner iteration maximum</p></li>
<li><p>ICM - outer iteration maximum</p></li>
<li><p>ICLC - optional theory</p></li>
<li><p>ITH - forward or adjoint</p></li>
<li><p>IFLU – GPT calculation flag</p></li>
</ol>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 53%" />
<col style="width: 47%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>DATA BLOCK 1 (continued)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>2$ - Editing and Control Options [10]</p>
<ol class="arabic simple">
<li><p>Fine-Group-Mixture Edit</p></li>
<li><p>Fine-Group-Flux Edit</p></li>
<li><p>Balance Table Edit</p></li>
<li><p>Broad-Group-Flux Edit</p></li>
<li><p>Not Used</p></li>
<li><p>Outers-Group-Limit-Option</p></li>
<li><p>Number of Bands</p></li>
<li><p>Suppress Fixed-Source Fission</p></li>
<li><p>Not Used</p></li>
<li><p>Not Used</p></li>
</ol>
</td>
<td><p>3$ - Other Options [12]</p>
<ol class="arabic simple">
<li><p>IFG - Weighting Option</p></li>
<li><p>IQM - Volumetric Sources</p></li>
<li><p>IPM - Boundary Sources</p></li>
<li><p>IFN - Starting Guess</p></li>
<li><p>ITMX - Time Shut-off</p></li>
<li><p>IDAT1 - Storage Scheme</p></li>
<li><p>IPN - Diff. Coeff. Option</p></li>
<li><p>IDFM - Density Factors</p></li>
<li><p>IAZ - Activities by Zone</p></li>
<li><p>IAI - Activities by Interval</p></li>
<li><p>IFCT - Thermal Scaling</p></li>
<li><p>IPVT - Search on k≠1</p></li>
</ol>
</td>
</tr>
<tr class="row-odd"><td><p>4$ - Weighting Options [9]</p>
<ol class="arabic simple">
<li><p>Type of weighting</p></li>
<li><p>Number of broad groups</p></li>
<li><p>Output format</p></li>
<li><p>Edit option</p></li>
<li><p>σ<sub>T</sub> position or number CCCC</p></li>
<li><p>σ<sub>gg</sub> position</p></li>
<li><p>Table length</p></li>
<li><p>ANISN edit option</p></li>
<li><p>Extra cross sections</p></li>
</ol>
</td>
<td><p>5* - Floating Point Values [12]</p>
<ol class="arabic simple">
<li><p>EPS - overall convergence</p></li>
<li><p>PTC - Point flux convergence</p></li>
<li><p>XNF - normalization</p></li>
<li><p>EV - starting guess for search</p></li>
<li><p>EVM - modifier for search</p></li>
<li><p>BF - buckling factor</p></li>
<li><p>DY - height</p></li>
<li><p>DZ - width</p></li>
<li><p>VSC - void streaming height</p></li>
<li><p>PV - k for search</p></li>
<li><p>EQL - search convergence</p></li>
<li><p>XNPM - search modifier</p></li>
</ol>
<p>T Terminate Data Block 1</p>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Title Card – (18A4)</p></td>
</tr>
<tr class="row-even"><td><p>DATA BLOCK 2</p></td>
</tr>
<tr class="row-odd"><td><p>10$ CCCC Transport Cross Section Selector [IHTF]</p>
<p>11$ Composition numbers</p>
<p>12$ Additional Processes to be put on ANISN Library [MSCM]</p>
<p>13$ Mixture Numbers [MS]</p>
<p>14$ Isotope Identifiers [MS]</p>
<p>15* Isotope Concentrations [MS]</p>
<p>16$ CCCC Identifiers from Working Library [IHTF]</p>
<p>18U or 18# CCCC Identifiers on ISOTXS [IHTF]</p>
<p>T Terminate the second Data Block.</p>
</td>
</tr>
<tr class="row-even"><td><p>DATA BLOCK 3</p></td>
</tr>
<tr class="row-odd"><td><p>{Required only when IQM or IPM is nonzero.}</p>
<p>30$ Spectrum Number by Interval (IQM&gt;0) or</p>
<p>Right-Hand Interval Boundary (IPM&gt;0) [IM]</p>
<p>31* Volumetric Sources [IQM*IGM]</p>
<p>32* Boundary Sources [IPM*IGM*MM]</p>
<p>T Terminate the third Data Block.</p>
</td>
</tr>
<tr class="row-even"><td><p>DATA BLOCK 4</p></td>
</tr>
<tr class="row-odd"><td><p>{When fluxes are read from an external device-IFN&gt;3-this block is
omitted.}</p>
<p>33# Flux Guess [IM*IGM] {IFN=0}</p>
<p>34# Fission Density Guess [IM] {IFN=1}</p>
<p>T Terminate the fourth Data Block.</p>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Title Card - (18A4)</p></td>
</tr>
<tr class="row-even"><td><p>DATA BLOCK 5</p></td>
</tr>
<tr class="row-odd"><td><p>35* Interval Boundaries [IM + 1]</p>
<p>36$ Zone Numbers by Interval [IM]</p>
<p>38* Density Factors [IM]</p>
<p>39$ Mixture Number by Zone [IZM]</p>
<p>40$ Order of Scattering by Zone [IZM]</p>
<p>41* Radius Modifier by Zone [IZM] {IEVT=4}</p>
<p>42# Discrete-Ordinates Cosines [MM]</p>
<p>43# Discrete-Ordinates Weights [MM]</p>
<p>46$ Alternative Theory Selection [IGM] {ICLC&gt;0}</p>
<p>47* Right-Boundary Albedos [IGM]</p>
<p>48* Left-Boundary Albedos [IGM]</p>
<p>49$ Activity Material or Nuclide Numbers [IAZ]</p>
<p>50$ Activity Process Numbers [IAZ] (See Appendix B)</p>
<p>51$ Broad-Group Numbers [IGM] {IFG&gt;0}</p>
<p>52$ Lower-Band-Group Numbers [NBANDS]</p>
<p>T Terminate the fifth Data Block.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="xsdrnpm-input-output-assignments">
<span id="id80"></span><h2>XSDRNPM Input/Output Assignments<a class="headerlink" href="#xsdrnpm-input-output-assignments" title="Permalink to this headline">¶</a></h2>
<p>The following logical units can be required in an XSDRNPM calculation.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Default</p>
<p>Logical Unit</p>
</th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3</p></td>
<td><p>Weighted Library (Produced by
XSDRNPM)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Working Library (Input)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Card Input</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Standard Output</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Punch Fluxes or ANISN Libraries</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>Scratch Direct-Access Device for
External Cross-Section Storage</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Scratch Direct-Access Device for
Mixing and Weighting Operations</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Scratch Direct-Access Device for
External Flux Moment Storage</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>Angular Fluxes</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>Scalar Fluxes</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>Scratch Device</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>Scratch Device</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>ANISN Binary Libraries or CCCC
ISOTXS Interface</p></td>
</tr>
<tr class="row-odd"><td><p>31</p></td>
<td><p>Fundamental mode forward angular
flux input unit for generalized
adjoint calculation (iflu&gt;0)</p></td>
</tr>
<tr class="row-even"><td><p>32</p></td>
<td><p>Fundamental mode adjoint angular
flux input unit for generalized
adjoint calculation (iflu&gt;0)</p></td>
</tr>
<tr class="row-odd"><td><p>73</p></td>
<td><p>Dump of Input and Derived Data</p></td>
</tr>
<tr class="row-even"><td><p>75</p></td>
<td><p>Activities</p></td>
</tr>
<tr class="row-odd"><td><p>76</p></td>
<td><p>Balance Tables</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="xsdrn-sample-problem">
<span id="id81"></span><h2>XSDRN Sample Problem<a class="headerlink" href="#xsdrn-sample-problem" title="Permalink to this headline">¶</a></h2>
<p>In this section, the input and output for a sample case involving a
bare, homogeneous 16-cm sphere of a 93% enriched <em>UO2-F2</em> solution is
presented. The input AMPX working format cross-section library will be
read from logical unit 4.</p>
<p>The input working library is a temporary 238-group library created by
CSAS-mg containing the following nuclides:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Nuclide</p></th>
<th class="head"><p>Identifier<sup>a</sup></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><sup>235</sup>U<sub>92</sub></p></td>
<td><p>92235</p></td>
</tr>
<tr class="row-odd"><td><p><sup>238</sup>U<sub>92</sub></p></td>
<td><p>92238</p></td>
</tr>
<tr class="row-even"><td><p><sup>1</sup>H</p></td>
<td><p>1001:sup:<a href="#id82"><span class="problematic" id="id83">`</span></a>b</p></td>
</tr>
<tr class="row-odd"><td><p><sup>16</sup>O<sub>8</sub></p></td>
<td><p>8016</p></td>
</tr>
<tr class="row-even"><td><p><sup>19</sup>F<sub>9</sub></p></td>
<td><p>9019</p></td>
</tr>
<tr class="row-odd"><td><p><em>a</em> These are the identifiers
of the sets of data on the
library created for the
problem.</p>
<p><em>b</em> Water-bound kernel.</p>
</td>
<td></td>
</tr>
</tbody>
</table>
<p>An S<sub>16</sub> quadrature is selected with 32 spatial intervals.
Activities are requested for <sup>235</sup>U<sub>92</sub> absorption and
fission and <sup>238</sup>U<sub>92</sub> absorption.</p>
<div class="highlight-scale notranslate"><div class="highlight"><pre><span></span><span class="nf">=xsdrn</span>
<span class="m">93</span><span class="err">%</span> <span class="err">uo</span><span class="m">2</span><span class="err">f</span><span class="m">2</span> <span class="err">solution</span> <span class="err">sphere</span>
<span class="m">1</span><span class="err">$$</span> <span class="m">3</span> <span class="m">1</span> <span class="m">32</span> <span class="m">1</span> <span class="m">0</span> <span class="m">1</span> <span class="m">5</span> <span class="m">16</span> <span class="m">1</span> <span class="m">1</span> <span class="m">30</span> <span class="m">20</span> <span class="m">0</span> <span class="m">0</span> <span class="m">0</span>
<span class="m">2</span><span class="err">$$</span> <span class="err">a</span><span class="m">7</span> <span class="err">-</span><span class="m">1</span> <span class="err">e</span>
<span class="m">3</span><span class="err">$$</span> <span class="m">1</span> <span class="err">a</span><span class="m">9</span> <span class="m">3</span> <span class="m">1</span> <span class="err">e</span>
<span class="m">4</span><span class="err">$$</span> <span class="m">0</span> <span class="m">4</span> <span class="m">0</span> <span class="err">-</span><span class="m">1</span> <span class="m">5</span> <span class="err">e</span>
<span class="m">5</span><span class="err">**</span> <span class="m">1</span><span class="err">.-</span><span class="m">7</span> <span class="m">1</span><span class="err">.-</span><span class="m">8</span> <span class="err">e</span>  <span class="m">1</span><span class="err">t</span>
<span class="m">13</span><span class="err">$$</span>        <span class="m">1</span>        <span class="m">1</span>        <span class="m">1</span>        <span class="m">1</span>        <span class="m">1</span>
<span class="m">14</span><span class="err">$$</span>     <span class="m">1001</span>     <span class="m">8016</span>     <span class="m">9019</span>    <span class="m">92235</span>    <span class="m">92238</span>
<span class="m">15</span><span class="err">**</span>  <span class="m">6</span><span class="err">.</span><span class="m">548</span><span class="err">-</span><span class="m">2</span>  <span class="m">3</span><span class="err">.</span><span class="m">342</span><span class="err">-</span><span class="m">2</span>  <span class="m">6</span><span class="err">.</span><span class="m">809</span><span class="err">-</span><span class="m">4</span>  <span class="m">3</span><span class="err">.</span><span class="m">169</span><span class="err">-</span><span class="m">4</span>  <span class="m">2</span><span class="err">.</span><span class="m">355</span><span class="err">-</span><span class="m">5</span>
<span class="m">16</span><span class="err">$$</span>    <span class="m">1001</span>    <span class="m">8016</span>    <span class="m">9019</span>   <span class="m">92235</span>   <span class="m">92238</span>
<span class="m">18</span><span class="err">##</span> <span class="m">6</span><span class="err">hh-</span><span class="m">1</span>    <span class="m">6</span><span class="err">ho-</span><span class="m">16</span>   <span class="m">6</span><span class="err">hf-</span><span class="m">19</span>   <span class="m">6</span><span class="err">hu-</span><span class="m">235</span>  <span class="m">6</span><span class="err">hu-</span><span class="m">238</span>    <span class="m">2</span><span class="err">t</span>
<span class="m">33</span><span class="err">##</span> <span class="err">f</span><span class="m">1</span>  <span class="m">4</span><span class="err">t</span>
<span class="m">35</span><span class="err">**</span> <span class="m">31</span><span class="err">i</span><span class="m">0</span><span class="err">.</span><span class="m">0</span> <span class="m">16</span><span class="err">.</span><span class="m">0</span>
<span class="m">36</span><span class="err">$$</span> <span class="err">f</span><span class="m">1</span>
<span class="m">49</span><span class="err">$$</span> <span class="m">92235</span> <span class="m">92235</span> <span class="m">92238</span>
<span class="m">50</span><span class="err">$$</span>    <span class="m">18</span>    <span class="m">27</span>    <span class="m">27</span>
<span class="m">51</span><span class="err">$$</span> <span class="m">74</span><span class="err">r</span><span class="m">1</span> <span class="m">74</span><span class="err">r</span><span class="m">2</span> <span class="m">45</span><span class="err">r</span><span class="m">3</span> <span class="m">45</span><span class="err">r</span><span class="m">4</span>   <span class="m">5</span><span class="err">t</span>
<span class="n">end</span>
</pre></div>
</div>
</div>
<div class="section" id="output-cross-sections">
<span id="id84"></span><h2>Output Cross Sections<a class="headerlink" href="#output-cross-sections" title="Permalink to this headline">¶</a></h2>
<p>One of the most common uses of XSDRNPM is to collapse cross sections and
write them onto a file for input into another computer code. At present,
two options are allowed:</p>
<ol class="arabic simple">
<li><p>Output library in AMPX Working Library format. This library is always
written when cross sections are collapsed.</p></li>
<li><p>Output library in ANISN binary or BCD <em>format</em>.<a class="bibtex reference internal" href="#joanou-gam-ii-1963" id="id85">[JD63]</a> Engle The binary
library is written on logical 20 by default; the BCD library is
produced on logical 7. The identifiers on this library range from 1
to the total number of blocks required to accommodate the data.</p></li>
</ol>
</div>
<div class="section" id="error-messages">
<span id="id86"></span><h2>Error messages<a class="headerlink" href="#error-messages" title="Permalink to this headline">¶</a></h2>
<p>During the course of a problem, XSDRNPM makes many checks to determine
if input data are in the required form. If inconsistencies are spotted,
a message is printed, and the problem may be terminated. Some of these
messages are listed below along with a brief description of their
possible cause.</p>
<p>DATA N N arrays have been input with incorrect length. See the messages
produced as arrays are read to determine specific arrays.</p>
<p>SN-1 N The Nth entry in the <span class="math notranslate nohighlight">\(S_n\)</span> quadrature directions is zero.
(43# array)</p>
<p>SN-2 0 The <span class="math notranslate nohighlight">\(S_n\)</span> weights do not sum to 1.0. (42# array)</p>
<p>SN-3 0 The sum of the products of <span class="math notranslate nohighlight">\(S_n\)</span> weights and directions is not
0.0, that is, the directions are not symmetric. (42# and 43# arrays)</p>
<p>FIXS 0 Fixed source calculation requested (IEVT=0) and total fixed
sources are zero.</p>
<p>Q-HI N A volumetric source spectrum numbered N has been requested where
N is greater than IQM.</p>
<p>B-HI N A boundary source spectrum numbered N has been requested where N
is greater than IPM.</p>
<p>FISS 0 IEVT≥1 and the total fission source is zero.</p>
<p>8101 N The N<em>th</em> radius is negative.</p>
<p>8102 N The N<em>th</em> radius is less than the (N-1)*th* radius.</p>
<p>8103 N Zone N dimensions have become negative in a zone width search.</p>
<p>MIX N A request has been made to use the N<em>th</em> component from the
mixing table, but this nuclide has not been requested from a library.</p>
<p>Several messages may be encountered during an XSDRNPM run which indicate
problems with either the code or the setup:</p>
<p>ROOT L The polynomials from which the default angles are derived are
incorrect.</p>
<p>BAND N The number of bands specified is greater than the number of
groups.</p>
<p>WAT1 N The number of sets of weighted cross sections is incorrect.</p>
<p>WAT2 N The number of sets of weighted cross sections is incorrect.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*******************************************************INFACE************************************
*** WARNING    YOU REQUESTED nn SETS OF CROSS SECTIONS, BUT ONLY mm SETS WERE FOUND *************
*******************************************************MIXEM*************************************
MAGIC WORD ERROR DETECTED IN MIXEM, MW= xx
*******************************************************SPOUT*************************************
NO PROGRAMMING PROVIDED FOR ITP= nn
*******************************************************FIDAS*************************************
****** ERROR nn ENTRIES REQUIRED IN xx? ARRAY
DATA EDIT CONTINUES
*******************************************************FIDAS*************************************
****** FILL OPTION IGNORED IN xx? ARRAY
*******************************************************FIDAS*************************************
****** WARNING ADDRESS aa IS BEYOND LIMITS OF xx? ARRAY
*******************************************************STORXS************************************
MAGIC WORD ERROR IN STORXS - GROUP gg     MIXTURE mm    L  ln
MAGIC WORD mw     IGI  ig    MXI mx    MNI mn      LLL  11
*******************************************************STORXS************************************
ERROR #1 IN STORXS.$
*******************************************************STORXS************************************
ERROR #2 IN STORXS.$
</pre></div>
</div>
<p>For the cryptic messages above (e.g., the last two), contact the code developers as to their possible cause.</p>
<p>Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="id87"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Formerly with Oak Ridge National Laboratory.</p>
</dd>
<dt class="label" id="id88"><span class="brackets"><a class="fn-backref" href="#id78">2</a></span></dt>
<dd><p><sup>∗</sup> MM = ISN + 1 for slabs and spheres,</p>
<p>= ISN*(ISN + 4)/4 for a cylinder.</p>
</dd>
</dl>
<p id="bibtex-bibliography-XSD-0"><dl class="citation">
<dt class="bibtex label" id="alder-methods-1963"><span class="brackets"><a class="fn-backref" href="#id72">Ald63</a></span></dt>
<dd><p>Berni Alder. <em>Methods in Computational Physics. V. 1</em>. Academic Press, 1963.</p>
</dd>
<dt class="bibtex label" id="carlson-discrete-1965"><span class="brackets"><a class="fn-backref" href="#id28">CL65</a></span></dt>
<dd><p>B. G. Carlson and K. D. Lathrop. Discrete ordinates angular quadrature of the neutron transport equation. <em>LA-3186, Los Alamos National Laboratory</em>, 1965.</p>
</dd>
<dt class="bibtex label" id="carmichael-standard-1974"><span class="brackets"><a class="fn-backref" href="#id13">Car74</a></span></dt>
<dd><p>B. M. Carmichael. Standard interface files and procedures for reactor physics codes, version III. Technical Report, comp.; Los Alamos Scientific Lab., N. Mex.(USA), 1974.</p>
</dd>
<dt class="bibtex label" id="emett-morse-1975"><span class="brackets">Eme75</span><span class="fn-backref">(<a href="#id16">1</a>,<a href="#id30">2</a>,<a href="#id32">3</a>,<a href="#id77">4</a>)</span></dt>
<dd><p>B. B. Emett. The MORSE Monte Carlo Radiation Transport Code. <em>ORNL-4972</em>, 1975.</p>
</dd>
<dt class="bibtex label" id="engle-jr-users-nodate"><span class="brackets"><a class="fn-backref" href="#id8">EJ67</a></span></dt>
<dd><p>W. W. Engle Jr. The User’s Manual for ANISN: A One Dimensional Discrete Ordinates Code with Anisotropic Scattering, K-1693, Oak Ridge Gaseous Diffusion Plant (1967), available from Radiation Shielding Information Center, Oak Ridge National Laboratory, Oak Ridge, Tenn. <em>Google Scholar Available from Radiation Shielding Information Center, Oak Ridge National Laboratory, Oak Ridge, Tennessee, as CCC-82/ANISN (March, 1967)</em>, 1967.</p>
</dd>
<dt class="bibtex label" id="greene-xsdrn-1969"><span class="brackets"><a class="fn-backref" href="#id4">GCJ69</a></span></dt>
<dd><p>N. M. Greene and C. W. Craven Jr. XSDRN: A DISCRETE ORDINATES SPECTRAL AVERAGING CODE. Technical Report, Union Carbide Corp., Oak Ridge, Tenn. Computing Technology Center; Oak Ridge …, 1969.</p>
</dd>
<dt class="bibtex label" id="henryson-mc-1976"><span class="brackets"><a class="fn-backref" href="#id75">HTS76</a></span></dt>
<dd><p>H. Henryson, B. J. Toppel, and C. G. Stenberg. MC 2-2: a code to calculate fast neutron spectra and multigroup cross sections. Technical Report, Argonne National Lab., 1976.</p>
</dd>
<dt class="bibtex label" id="hoffman-optimization-1982"><span class="brackets"><a class="fn-backref" href="#id66">Hof82</a></span></dt>
<dd><p>T. J. Hoffman. Optimization of Russian roulette parameters for the KENO computer code. Technical Report, Oak Ridge National Lab., TN (USA), 1982.</p>
</dd>
<dt class="bibtex label" id="hoffman-xsdrnpm-s-1982"><span class="brackets"><a class="fn-backref" href="#id65">HT82</a></span></dt>
<dd><p>T. J. Hoffman and J. S. Tang. XSDRNPM-S biasing of MORSE-SGC/S shipping-cask calculations. Technical Report, Oak Ridge National Lab., 1982.</p>
</dd>
<dt class="bibtex label" id="honeck-thermos-1961"><span class="brackets"><a class="fn-backref" href="#id9">Hon61</a></span></dt>
<dd><p>Henry C. Honeck. THERMOS. A Thermalization Transport Theory Code for Reactor Lattice Calculations. Technical Report, Brookhaven National Lab., Upton, NY, 1961.</p>
</dd>
<dt class="bibtex label" id="joanou-gam-ii-1963"><span class="brackets">JD63</span><span class="fn-backref">(<a href="#id7">1</a>,<a href="#id85">2</a>)</span></dt>
<dd><p>G. D. Joanou and J. S. Dudek. GAM-II. AB \$ sub 3\$ CODE FOR THE CALCULATION OF FAST-NEUTRON SPECTRA AND ASSOCIATED MULTIGROUP CONSTANTS. Technical Report, General Atomic Div., General Dynamics Corp., San Diego, Calif., 1963.</p>
</dd>
<dt class="bibtex label" id="olsen-void-1965"><span class="brackets"><a class="fn-backref" href="#id51">Ols65</a></span></dt>
<dd><p>Tom Olsen. Void Streaming in Sn Calculations. <em>Nuclear Science and Engineering (US)</em>, 1965. Publisher: Martin Co., Baltimore.</p>
</dd>
<dt class="bibtex label" id="rhoades-new-1977"><span class="brackets"><a class="fn-backref" href="#id34">REJ77</a></span></dt>
<dd><p>W. A. Rhoades and W. W. Engle Jr. New weighted-difference formulation for discrete-ordinates calculations. Technical Report, Oak Ridge National Lab., Tenn.(USA), 1977.</p>
</dd>
<dt class="bibtex label" id="rhoades-dot-iv-1979"><span class="brackets"><a class="fn-backref" href="#id15">RSCEJ79</a></span></dt>
<dd><p>W. A. Rhoades, D. B. Simpson, R. L. Childs, and W. W. Engle Jr. DOT-IV two-dimensional discrete ordinates transport code with space-dependent mesh and quadrature. Technical Report, Oak Ridge National Lab., 1979.</p>
</dd>
<dt class="bibtex label" id="tomlinson-flux-1980"><span class="brackets"><a class="fn-backref" href="#id35">TREJ80</a></span></dt>
<dd><p>E. T. Tomlinson, W. A. Rhoades, and W. W. Engle Jr. Flux extrapolation models used in the DOT IV discrete ordinates neutron transport code. Technical Report, Oak Ridge National Lab., 1980.</p>
</dd>
<dt class="bibtex label" id="weisbin-review-1979"><span class="brackets"><a class="fn-backref" href="#id67">WRHB79</a></span></dt>
<dd><p>C. R. Weisbin, R. W. Roussin, H. R. Hendrickson, and E. W. Bryant. Review of the theory and application of sensitivity and uncertainty analysis. Proceedings of a seminar-workshop, Oak Ridge, Tennessee. Technical Report, Oak Ridge National Lab., TN (USA), 1979.</p>
</dd>
<dt class="bibtex label" id="wiarda-ampx-2000-2015"><span class="brackets"><a class="fn-backref" href="#id14">WWCD15</a></span></dt>
<dd><p>D. Wiarda, M. L. Williams, C. Celik, and M. E. Dunn. AMPX-2000: A cross-section processing system for generating nuclear data for criticality safety applications. In <em>Proc. Int. Conf. Nuclear Criticality Safety (ICNC 2015), Charlotte, North Carolina</em>. 2015.</p>
</dd>
<dt class="bibtex label" id="williams-perturbation-1986"><span class="brackets"><a class="fn-backref" href="#id69">Wil86</a></span></dt>
<dd><p>M. L. Williams. <em>Perturbation Theory for Reactor Analysis. CRC Handbook of Nuclear Reactor Calculations</em>. CRC Press Rogen, 1986.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="XSDAppAB.html" class="btn btn-neutral float-right" title="XSDRNPM Appendices A and B" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Deterministic%20Transport%20Intro.html" class="btn btn-neutral float-left" title="Deterministic Transport Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, SCALE developers

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>